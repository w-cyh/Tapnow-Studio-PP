<!doctype html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tapnow Studio</title>
  <script type="module" crossorigin>var I1=Object.defineProperty;var Oh=e=>{throw TypeError(e)};var T1=(e,t,n)=>t in e?I1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var xn=(e,t,n)=>T1(e,typeof t!="symbol"?t+"":t,n),M1=(e,t,n)=>t.has(e)||Oh("Cannot "+n);var Uh=(e,t,n)=>t.has(e)?Oh("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n);var oc=(e,t,n)=>(M1(e,t,"access private method"),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();var ei=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function $m(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Am={exports:{}},vu={},Pm={exports:{}},Bt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tl=Symbol.for("react.element"),$1=Symbol.for("react.portal"),A1=Symbol.for("react.fragment"),P1=Symbol.for("react.strict_mode"),R1=Symbol.for("react.profiler"),D1=Symbol.for("react.provider"),L1=Symbol.for("react.context"),O1=Symbol.for("react.forward_ref"),U1=Symbol.for("react.suspense"),F1=Symbol.for("react.memo"),B1=Symbol.for("react.lazy"),Fh=Symbol.iterator;function H1(e){return e===null||typeof e!="object"?null:(e=Fh&&e[Fh]||e["@@iterator"],typeof e=="function"?e:null)}var Rm={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Dm=Object.assign,Lm={};function oa(e,t,n){this.props=e,this.context=t,this.refs=Lm,this.updater=n||Rm}oa.prototype.isReactComponent={};oa.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};oa.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Om(){}Om.prototype=oa.prototype;function Vf(e,t,n){this.props=e,this.context=t,this.refs=Lm,this.updater=n||Rm}var Kf=Vf.prototype=new Om;Kf.constructor=Vf;Dm(Kf,oa.prototype);Kf.isPureReactComponent=!0;var Bh=Array.isArray,Um=Object.prototype.hasOwnProperty,Yf={current:null},Fm={key:!0,ref:!0,__self:!0,__source:!0};function Bm(e,t,n){var r,i={},a=null,l=null;if(t!=null)for(r in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(a=""+t.key),t)Um.call(t,r)&&!Fm.hasOwnProperty(r)&&(i[r]=t[r]);var u=arguments.length-2;if(u===1)i.children=n;else if(1<u){for(var d=Array(u),y=0;y<u;y++)d[y]=arguments[y+2];i.children=d}if(e&&e.defaultProps)for(r in u=e.defaultProps,u)i[r]===void 0&&(i[r]=u[r]);return{$$typeof:Tl,type:e,key:a,ref:l,props:i,_owner:Yf.current}}function W1(e,t){return{$$typeof:Tl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Gf(e){return typeof e=="object"&&e!==null&&e.$$typeof===Tl}function V1(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Hh=/\/+/g;function id(e,t){return typeof e=="object"&&e!==null&&e.key!=null?V1(""+e.key):t.toString(36)}function $c(e,t,n,r,i){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case Tl:case $1:l=!0}}if(l)return l=e,i=i(l),e=r===""?"."+id(l,0):r,Bh(i)?(n="",e!=null&&(n=e.replace(Hh,"$&/")+"/"),$c(i,t,n,"",function(y){return y})):i!=null&&(Gf(i)&&(i=W1(i,n+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(Hh,"$&/")+"/")+e)),t.push(i)),1;if(l=0,r=r===""?".":r+":",Bh(e))for(var u=0;u<e.length;u++){a=e[u];var d=r+id(a,u);l+=$c(a,t,n,d,i)}else if(d=H1(e),typeof d=="function")for(e=d.call(e),u=0;!(a=e.next()).done;)a=a.value,d=r+id(a,u++),l+=$c(a,t,n,d,i);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function ac(e,t,n){if(e==null)return e;var r=[],i=0;return $c(e,r,"","",function(a){return t.call(n,a,i++)}),r}function K1(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var jr={current:null},Ac={transition:null},Y1={ReactCurrentDispatcher:jr,ReactCurrentBatchConfig:Ac,ReactCurrentOwner:Yf};function Hm(){throw Error("act(...) is not supported in production builds of React.")}Bt.Children={map:ac,forEach:function(e,t,n){ac(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return ac(e,function(){t++}),t},toArray:function(e){return ac(e,function(t){return t})||[]},only:function(e){if(!Gf(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Bt.Component=oa;Bt.Fragment=A1;Bt.Profiler=R1;Bt.PureComponent=Vf;Bt.StrictMode=P1;Bt.Suspense=U1;Bt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Y1;Bt.act=Hm;Bt.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Dm({},e.props),i=e.key,a=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,l=Yf.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(d in t)Um.call(t,d)&&!Fm.hasOwnProperty(d)&&(r[d]=t[d]===void 0&&u!==void 0?u[d]:t[d])}var d=arguments.length-2;if(d===1)r.children=n;else if(1<d){u=Array(d);for(var y=0;y<d;y++)u[y]=arguments[y+2];r.children=u}return{$$typeof:Tl,type:e.type,key:i,ref:a,props:r,_owner:l}};Bt.createContext=function(e){return e={$$typeof:L1,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:D1,_context:e},e.Consumer=e};Bt.createElement=Bm;Bt.createFactory=function(e){var t=Bm.bind(null,e);return t.type=e,t};Bt.createRef=function(){return{current:null}};Bt.forwardRef=function(e){return{$$typeof:O1,render:e}};Bt.isValidElement=Gf;Bt.lazy=function(e){return{$$typeof:B1,_payload:{_status:-1,_result:e},_init:K1}};Bt.memo=function(e,t){return{$$typeof:F1,type:e,compare:t===void 0?null:t}};Bt.startTransition=function(e){var t=Ac.transition;Ac.transition={};try{e()}finally{Ac.transition=t}};Bt.unstable_act=Hm;Bt.useCallback=function(e,t){return jr.current.useCallback(e,t)};Bt.useContext=function(e){return jr.current.useContext(e)};Bt.useDebugValue=function(){};Bt.useDeferredValue=function(e){return jr.current.useDeferredValue(e)};Bt.useEffect=function(e,t){return jr.current.useEffect(e,t)};Bt.useId=function(){return jr.current.useId()};Bt.useImperativeHandle=function(e,t,n){return jr.current.useImperativeHandle(e,t,n)};Bt.useInsertionEffect=function(e,t){return jr.current.useInsertionEffect(e,t)};Bt.useLayoutEffect=function(e,t){return jr.current.useLayoutEffect(e,t)};Bt.useMemo=function(e,t){return jr.current.useMemo(e,t)};Bt.useReducer=function(e,t,n){return jr.current.useReducer(e,t,n)};Bt.useRef=function(e){return jr.current.useRef(e)};Bt.useState=function(e){return jr.current.useState(e)};Bt.useSyncExternalStore=function(e,t,n){return jr.current.useSyncExternalStore(e,t,n)};Bt.useTransition=function(){return jr.current.useTransition()};Bt.version="18.3.1";Pm.exports=Bt;var H=Pm.exports;const bu=$m(H);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var G1=H,X1=Symbol.for("react.element"),Z1=Symbol.for("react.fragment"),J1=Object.prototype.hasOwnProperty,q1=G1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Q1={key:!0,ref:!0,__self:!0,__source:!0};function Wm(e,t,n){var r,i={},a=null,l=null;n!==void 0&&(a=""+n),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(l=t.ref);for(r in t)J1.call(t,r)&&!Q1.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:X1,type:e,key:a,ref:l,props:i,_owner:q1.current}}vu.Fragment=Z1;vu.jsx=Wm;vu.jsxs=Wm;Am.exports=vu;var o=Am.exports,Hd={},Vm={exports:{}},Vr={},Km={exports:{}},Ym={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(we,ae){var Re=we.length;we.push(ae);e:for(;0<Re;){var X=Re-1>>>1,oe=we[X];if(0<i(oe,ae))we[X]=ae,we[Re]=oe,Re=X;else break e}}function n(we){return we.length===0?null:we[0]}function r(we){if(we.length===0)return null;var ae=we[0],Re=we.pop();if(Re!==ae){we[0]=Re;e:for(var X=0,oe=we.length,Ve=oe>>>1;X<Ve;){var Ye=2*(X+1)-1,Ee=we[Ye],Lt=Ye+1,Zt=we[Lt];if(0>i(Ee,Re))Lt<oe&&0>i(Zt,Ee)?(we[X]=Zt,we[Lt]=Re,X=Lt):(we[X]=Ee,we[Ye]=Re,X=Ye);else if(Lt<oe&&0>i(Zt,Re))we[X]=Zt,we[Lt]=Re,X=Lt;else break e}}return ae}function i(we,ae){var Re=we.sortIndex-ae.sortIndex;return Re!==0?Re:we.id-ae.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var l=Date,u=l.now();e.unstable_now=function(){return l.now()-u}}var d=[],y=[],j=1,_=null,k=3,b=!1,E=!1,z=!1,A=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(we){for(var ae=n(y);ae!==null;){if(ae.callback===null)r(y);else if(ae.startTime<=we)r(y),ae.sortIndex=ae.expirationTime,t(d,ae);else break;ae=n(y)}}function L(we){if(z=!1,S(we),!E)if(n(d)!==null)E=!0,rt(B);else{var ae=n(y);ae!==null&&ze(L,ae.startTime-we)}}function B(we,ae){E=!1,z&&(z=!1,x(ue),ue=-1),b=!0;var Re=k;try{for(S(ae),_=n(d);_!==null&&(!(_.expirationTime>ae)||we&&!Be());){var X=_.callback;if(typeof X=="function"){_.callback=null,k=_.priorityLevel;var oe=X(_.expirationTime<=ae);ae=e.unstable_now(),typeof oe=="function"?_.callback=oe:_===n(d)&&r(d),S(ae)}else r(d);_=n(d)}if(_!==null)var Ve=!0;else{var Ye=n(y);Ye!==null&&ze(L,Ye.startTime-ae),Ve=!1}return Ve}finally{_=null,k=Re,b=!1}}var ie=!1,J=null,ue=-1,ce=5,me=-1;function Be(){return!(e.unstable_now()-me<ce)}function K(){if(J!==null){var we=e.unstable_now();me=we;var ae=!0;try{ae=J(!0,we)}finally{ae?xe():(ie=!1,J=null)}}else ie=!1}var xe;if(typeof g=="function")xe=function(){g(K)};else if(typeof MessageChannel<"u"){var v=new MessageChannel,ge=v.port2;v.port1.onmessage=K,xe=function(){ge.postMessage(null)}}else xe=function(){A(K,0)};function rt(we){J=we,ie||(ie=!0,xe())}function ze(we,ae){ue=A(function(){we(e.unstable_now())},ae)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(we){we.callback=null},e.unstable_continueExecution=function(){E||b||(E=!0,rt(B))},e.unstable_forceFrameRate=function(we){0>we||125<we?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ce=0<we?Math.floor(1e3/we):5},e.unstable_getCurrentPriorityLevel=function(){return k},e.unstable_getFirstCallbackNode=function(){return n(d)},e.unstable_next=function(we){switch(k){case 1:case 2:case 3:var ae=3;break;default:ae=k}var Re=k;k=ae;try{return we()}finally{k=Re}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(we,ae){switch(we){case 1:case 2:case 3:case 4:case 5:break;default:we=3}var Re=k;k=we;try{return ae()}finally{k=Re}},e.unstable_scheduleCallback=function(we,ae,Re){var X=e.unstable_now();switch(typeof Re=="object"&&Re!==null?(Re=Re.delay,Re=typeof Re=="number"&&0<Re?X+Re:X):Re=X,we){case 1:var oe=-1;break;case 2:oe=250;break;case 5:oe=1073741823;break;case 4:oe=1e4;break;default:oe=5e3}return oe=Re+oe,we={id:j++,callback:ae,priorityLevel:we,startTime:Re,expirationTime:oe,sortIndex:-1},Re>X?(we.sortIndex=Re,t(y,we),n(d)===null&&we===n(y)&&(z?(x(ue),ue=-1):z=!0,ze(L,Re-X))):(we.sortIndex=oe,t(d,we),E||b||(E=!0,rt(B))),we},e.unstable_shouldYield=Be,e.unstable_wrapCallback=function(we){var ae=k;return function(){var Re=k;k=ae;try{return we.apply(this,arguments)}finally{k=Re}}}})(Ym);Km.exports=Ym;var ev=Km.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tv=H,Wr=ev;function Oe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Gm=new Set,hl={};function uo(e,t){Qo(e,t),Qo(e+"Capture",t)}function Qo(e,t){for(hl[e]=t,e=0;e<t.length;e++)Gm.add(t[e])}var ii=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Wd=Object.prototype.hasOwnProperty,nv=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Wh={},Vh={};function rv(e){return Wd.call(Vh,e)?!0:Wd.call(Wh,e)?!1:nv.test(e)?Vh[e]=!0:(Wh[e]=!0,!1)}function sv(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function iv(e,t,n,r){if(t===null||typeof t>"u"||sv(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function _r(e,t,n,r,i,a,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=l}var or={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){or[e]=new _r(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];or[t]=new _r(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){or[e]=new _r(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){or[e]=new _r(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){or[e]=new _r(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){or[e]=new _r(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){or[e]=new _r(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){or[e]=new _r(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){or[e]=new _r(e,5,!1,e.toLowerCase(),null,!1,!1)});var Xf=/[\-:]([a-z])/g;function Zf(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Xf,Zf);or[t]=new _r(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Xf,Zf);or[t]=new _r(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Xf,Zf);or[t]=new _r(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){or[e]=new _r(e,1,!1,e.toLowerCase(),null,!1,!1)});or.xlinkHref=new _r("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){or[e]=new _r(e,1,!1,e.toLowerCase(),null,!0,!0)});function Jf(e,t,n,r){var i=or.hasOwnProperty(t)?or[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(iv(t,n,i,r)&&(n=null),r||i===null?rv(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var ci=tv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,lc=Symbol.for("react.element"),Po=Symbol.for("react.portal"),Ro=Symbol.for("react.fragment"),qf=Symbol.for("react.strict_mode"),Vd=Symbol.for("react.profiler"),Xm=Symbol.for("react.provider"),Zm=Symbol.for("react.context"),Qf=Symbol.for("react.forward_ref"),Kd=Symbol.for("react.suspense"),Yd=Symbol.for("react.suspense_list"),ep=Symbol.for("react.memo"),Si=Symbol.for("react.lazy"),Jm=Symbol.for("react.offscreen"),Kh=Symbol.iterator;function Ma(e){return e===null||typeof e!="object"?null:(e=Kh&&e[Kh]||e["@@iterator"],typeof e=="function"?e:null)}var Sn=Object.assign,od;function Za(e){if(od===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);od=t&&t[1]||""}return`
`+od+e}var ad=!1;function ld(e,t){if(!e||ad)return"";ad=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(y){var r=y}Reflect.construct(e,[],t)}else{try{t.call()}catch(y){r=y}e.call(t.prototype)}else{try{throw Error()}catch(y){r=y}e()}}catch(y){if(y&&r&&typeof y.stack=="string"){for(var i=y.stack.split(`
`),a=r.stack.split(`
`),l=i.length-1,u=a.length-1;1<=l&&0<=u&&i[l]!==a[u];)u--;for(;1<=l&&0<=u;l--,u--)if(i[l]!==a[u]){if(l!==1||u!==1)do if(l--,u--,0>u||i[l]!==a[u]){var d=`
`+i[l].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}while(1<=l&&0<=u);break}}}finally{ad=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Za(e):""}function ov(e){switch(e.tag){case 5:return Za(e.type);case 16:return Za("Lazy");case 13:return Za("Suspense");case 19:return Za("SuspenseList");case 0:case 2:case 15:return e=ld(e.type,!1),e;case 11:return e=ld(e.type.render,!1),e;case 1:return e=ld(e.type,!0),e;default:return""}}function Gd(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ro:return"Fragment";case Po:return"Portal";case Vd:return"Profiler";case qf:return"StrictMode";case Kd:return"Suspense";case Yd:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Zm:return(e.displayName||"Context")+".Consumer";case Xm:return(e._context.displayName||"Context")+".Provider";case Qf:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case ep:return t=e.displayName||null,t!==null?t:Gd(e.type)||"Memo";case Si:t=e._payload,e=e._init;try{return Gd(e(t))}catch{}}return null}function av(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Gd(t);case 8:return t===qf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Fi(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function qm(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function lv(e){var t=qm(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(l){r=""+l,a.call(this,l)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(l){r=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function cc(e){e._valueTracker||(e._valueTracker=lv(e))}function Qm(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=qm(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Kc(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Xd(e,t){var n=t.checked;return Sn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Yh(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Fi(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function eg(e,t){t=t.checked,t!=null&&Jf(e,"checked",t,!1)}function Zd(e,t){eg(e,t);var n=Fi(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Jd(e,t.type,n):t.hasOwnProperty("defaultValue")&&Jd(e,t.type,Fi(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Gh(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Jd(e,t,n){(t!=="number"||Kc(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Ja=Array.isArray;function Yo(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Fi(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function qd(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Oe(91));return Sn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Xh(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(Oe(92));if(Ja(n)){if(1<n.length)throw Error(Oe(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Fi(n)}}function tg(e,t){var n=Fi(t.value),r=Fi(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Zh(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function ng(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Qd(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?ng(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var uc,rg=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(uc=uc||document.createElement("div"),uc.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=uc.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ml(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var rl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},cv=["Webkit","ms","Moz","O"];Object.keys(rl).forEach(function(e){cv.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),rl[t]=rl[e]})});function sg(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||rl.hasOwnProperty(e)&&rl[e]?(""+t).trim():t+"px"}function ig(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=sg(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var uv=Sn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ef(e,t){if(t){if(uv[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Oe(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Oe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Oe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Oe(62))}}function tf(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var nf=null;function tp(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var rf=null,Go=null,Xo=null;function Jh(e){if(e=Al(e)){if(typeof rf!="function")throw Error(Oe(280));var t=e.stateNode;t&&(t=_u(t),rf(e.stateNode,e.type,t))}}function og(e){Go?Xo?Xo.push(e):Xo=[e]:Go=e}function ag(){if(Go){var e=Go,t=Xo;if(Xo=Go=null,Jh(e),t)for(e=0;e<t.length;e++)Jh(t[e])}}function lg(e,t){return e(t)}function cg(){}var cd=!1;function ug(e,t,n){if(cd)return e(t,n);cd=!0;try{return lg(e,t,n)}finally{cd=!1,(Go!==null||Xo!==null)&&(cg(),ag())}}function gl(e,t){var n=e.stateNode;if(n===null)return null;var r=_u(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(Oe(231,t,typeof n));return n}var sf=!1;if(ii)try{var $a={};Object.defineProperty($a,"passive",{get:function(){sf=!0}}),window.addEventListener("test",$a,$a),window.removeEventListener("test",$a,$a)}catch{sf=!1}function dv(e,t,n,r,i,a,l,u,d){var y=Array.prototype.slice.call(arguments,3);try{t.apply(n,y)}catch(j){this.onError(j)}}var sl=!1,Yc=null,Gc=!1,of=null,fv={onError:function(e){sl=!0,Yc=e}};function pv(e,t,n,r,i,a,l,u,d){sl=!1,Yc=null,dv.apply(fv,arguments)}function hv(e,t,n,r,i,a,l,u,d){if(pv.apply(this,arguments),sl){if(sl){var y=Yc;sl=!1,Yc=null}else throw Error(Oe(198));Gc||(Gc=!0,of=y)}}function fo(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function dg(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function qh(e){if(fo(e)!==e)throw Error(Oe(188))}function mv(e){var t=e.alternate;if(!t){if(t=fo(e),t===null)throw Error(Oe(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var a=i.alternate;if(a===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return qh(i),e;if(a===r)return qh(i),t;a=a.sibling}throw Error(Oe(188))}if(n.return!==r.return)n=i,r=a;else{for(var l=!1,u=i.child;u;){if(u===n){l=!0,n=i,r=a;break}if(u===r){l=!0,r=i,n=a;break}u=u.sibling}if(!l){for(u=a.child;u;){if(u===n){l=!0,n=a,r=i;break}if(u===r){l=!0,r=a,n=i;break}u=u.sibling}if(!l)throw Error(Oe(189))}}if(n.alternate!==r)throw Error(Oe(190))}if(n.tag!==3)throw Error(Oe(188));return n.stateNode.current===n?e:t}function fg(e){return e=mv(e),e!==null?pg(e):null}function pg(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=pg(e);if(t!==null)return t;e=e.sibling}return null}var hg=Wr.unstable_scheduleCallback,Qh=Wr.unstable_cancelCallback,gv=Wr.unstable_shouldYield,xv=Wr.unstable_requestPaint,On=Wr.unstable_now,yv=Wr.unstable_getCurrentPriorityLevel,np=Wr.unstable_ImmediatePriority,mg=Wr.unstable_UserBlockingPriority,Xc=Wr.unstable_NormalPriority,vv=Wr.unstable_LowPriority,gg=Wr.unstable_IdlePriority,wu=null,Ds=null;function bv(e){if(Ds&&typeof Ds.onCommitFiberRoot=="function")try{Ds.onCommitFiberRoot(wu,e,void 0,(e.current.flags&128)===128)}catch{}}var bs=Math.clz32?Math.clz32:zv,wv=Math.log,kv=Math.LN2;function zv(e){return e>>>=0,e===0?32:31-(wv(e)/kv|0)|0}var dc=64,fc=4194304;function qa(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Zc(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,a=e.pingedLanes,l=n&268435455;if(l!==0){var u=l&~i;u!==0?r=qa(u):(a&=l,a!==0&&(r=qa(a)))}else l=n&~i,l!==0?r=qa(l):a!==0&&(r=qa(a));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,a=t&-t,i>=a||i===16&&(a&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-bs(t),i=1<<n,r|=e[n],t&=~i;return r}function jv(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _v(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var l=31-bs(a),u=1<<l,d=i[l];d===-1?(!(u&n)||u&r)&&(i[l]=jv(u,t)):d<=t&&(e.expiredLanes|=u),a&=~u}}function af(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function xg(){var e=dc;return dc<<=1,!(dc&4194240)&&(dc=64),e}function ud(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ml(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-bs(t),e[t]=n}function Nv(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-bs(n),a=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~a}}function rp(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-bs(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var ln=0;function yg(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var vg,sp,bg,wg,kg,lf=!1,pc=[],$i=null,Ai=null,Pi=null,xl=new Map,yl=new Map,Ei=[],Sv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function e0(e,t){switch(e){case"focusin":case"focusout":$i=null;break;case"dragenter":case"dragleave":Ai=null;break;case"mouseover":case"mouseout":Pi=null;break;case"pointerover":case"pointerout":xl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":yl.delete(t.pointerId)}}function Aa(e,t,n,r,i,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},t!==null&&(t=Al(t),t!==null&&sp(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function Cv(e,t,n,r,i){switch(t){case"focusin":return $i=Aa($i,e,t,n,r,i),!0;case"dragenter":return Ai=Aa(Ai,e,t,n,r,i),!0;case"mouseover":return Pi=Aa(Pi,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return xl.set(a,Aa(xl.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,yl.set(a,Aa(yl.get(a)||null,e,t,n,r,i)),!0}return!1}function zg(e){var t=qi(e.target);if(t!==null){var n=fo(t);if(n!==null){if(t=n.tag,t===13){if(t=dg(n),t!==null){e.blockedOn=t,kg(e.priority,function(){bg(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Pc(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=cf(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);nf=r,n.target.dispatchEvent(r),nf=null}else return t=Al(n),t!==null&&sp(t),e.blockedOn=n,!1;t.shift()}return!0}function t0(e,t,n){Pc(e)&&n.delete(t)}function Ev(){lf=!1,$i!==null&&Pc($i)&&($i=null),Ai!==null&&Pc(Ai)&&(Ai=null),Pi!==null&&Pc(Pi)&&(Pi=null),xl.forEach(t0),yl.forEach(t0)}function Pa(e,t){e.blockedOn===t&&(e.blockedOn=null,lf||(lf=!0,Wr.unstable_scheduleCallback(Wr.unstable_NormalPriority,Ev)))}function vl(e){function t(i){return Pa(i,e)}if(0<pc.length){Pa(pc[0],e);for(var n=1;n<pc.length;n++){var r=pc[n];r.blockedOn===e&&(r.blockedOn=null)}}for($i!==null&&Pa($i,e),Ai!==null&&Pa(Ai,e),Pi!==null&&Pa(Pi,e),xl.forEach(t),yl.forEach(t),n=0;n<Ei.length;n++)r=Ei[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Ei.length&&(n=Ei[0],n.blockedOn===null);)zg(n),n.blockedOn===null&&Ei.shift()}var Zo=ci.ReactCurrentBatchConfig,Jc=!0;function Iv(e,t,n,r){var i=ln,a=Zo.transition;Zo.transition=null;try{ln=1,ip(e,t,n,r)}finally{ln=i,Zo.transition=a}}function Tv(e,t,n,r){var i=ln,a=Zo.transition;Zo.transition=null;try{ln=4,ip(e,t,n,r)}finally{ln=i,Zo.transition=a}}function ip(e,t,n,r){if(Jc){var i=cf(e,t,n,r);if(i===null)bd(e,t,r,qc,n),e0(e,r);else if(Cv(i,e,t,n,r))r.stopPropagation();else if(e0(e,r),t&4&&-1<Sv.indexOf(e)){for(;i!==null;){var a=Al(i);if(a!==null&&vg(a),a=cf(e,t,n,r),a===null&&bd(e,t,r,qc,n),a===i)break;i=a}i!==null&&r.stopPropagation()}else bd(e,t,r,null,n)}}var qc=null;function cf(e,t,n,r){if(qc=null,e=tp(r),e=qi(e),e!==null)if(t=fo(e),t===null)e=null;else if(n=t.tag,n===13){if(e=dg(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return qc=e,null}function jg(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(yv()){case np:return 1;case mg:return 4;case Xc:case vv:return 16;case gg:return 536870912;default:return 16}default:return 16}}var Ti=null,op=null,Rc=null;function _g(){if(Rc)return Rc;var e,t=op,n=t.length,r,i="value"in Ti?Ti.value:Ti.textContent,a=i.length;for(e=0;e<n&&t[e]===i[e];e++);var l=n-e;for(r=1;r<=l&&t[n-r]===i[a-r];r++);return Rc=i.slice(e,1<r?1-r:void 0)}function Dc(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function hc(){return!0}function n0(){return!1}function Kr(e){function t(n,r,i,a,l){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=a,this.target=l,this.currentTarget=null;for(var u in e)e.hasOwnProperty(u)&&(n=e[u],this[u]=n?n(a):a[u]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?hc:n0,this.isPropagationStopped=n0,this}return Sn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=hc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=hc)},persist:function(){},isPersistent:hc}),t}var aa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ap=Kr(aa),$l=Sn({},aa,{view:0,detail:0}),Mv=Kr($l),dd,fd,Ra,ku=Sn({},$l,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lp,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ra&&(Ra&&e.type==="mousemove"?(dd=e.screenX-Ra.screenX,fd=e.screenY-Ra.screenY):fd=dd=0,Ra=e),dd)},movementY:function(e){return"movementY"in e?e.movementY:fd}}),r0=Kr(ku),$v=Sn({},ku,{dataTransfer:0}),Av=Kr($v),Pv=Sn({},$l,{relatedTarget:0}),pd=Kr(Pv),Rv=Sn({},aa,{animationName:0,elapsedTime:0,pseudoElement:0}),Dv=Kr(Rv),Lv=Sn({},aa,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ov=Kr(Lv),Uv=Sn({},aa,{data:0}),s0=Kr(Uv),Fv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Bv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Hv={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Wv(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Hv[e])?!!t[e]:!1}function lp(){return Wv}var Vv=Sn({},$l,{key:function(e){if(e.key){var t=Fv[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Dc(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Bv[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lp,charCode:function(e){return e.type==="keypress"?Dc(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Dc(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Kv=Kr(Vv),Yv=Sn({},ku,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),i0=Kr(Yv),Gv=Sn({},$l,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lp}),Xv=Kr(Gv),Zv=Sn({},aa,{propertyName:0,elapsedTime:0,pseudoElement:0}),Jv=Kr(Zv),qv=Sn({},ku,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Qv=Kr(qv),eb=[9,13,27,32],cp=ii&&"CompositionEvent"in window,il=null;ii&&"documentMode"in document&&(il=document.documentMode);var tb=ii&&"TextEvent"in window&&!il,Ng=ii&&(!cp||il&&8<il&&11>=il),o0=" ",a0=!1;function Sg(e,t){switch(e){case"keyup":return eb.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Cg(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Do=!1;function nb(e,t){switch(e){case"compositionend":return Cg(t);case"keypress":return t.which!==32?null:(a0=!0,o0);case"textInput":return e=t.data,e===o0&&a0?null:e;default:return null}}function rb(e,t){if(Do)return e==="compositionend"||!cp&&Sg(e,t)?(e=_g(),Rc=op=Ti=null,Do=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ng&&t.locale!=="ko"?null:t.data;default:return null}}var sb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function l0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!sb[e.type]:t==="textarea"}function Eg(e,t,n,r){og(r),t=Qc(t,"onChange"),0<t.length&&(n=new ap("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var ol=null,bl=null;function ib(e){Ug(e,0)}function zu(e){var t=Uo(e);if(Qm(t))return e}function ob(e,t){if(e==="change")return t}var Ig=!1;if(ii){var hd;if(ii){var md="oninput"in document;if(!md){var c0=document.createElement("div");c0.setAttribute("oninput","return;"),md=typeof c0.oninput=="function"}hd=md}else hd=!1;Ig=hd&&(!document.documentMode||9<document.documentMode)}function u0(){ol&&(ol.detachEvent("onpropertychange",Tg),bl=ol=null)}function Tg(e){if(e.propertyName==="value"&&zu(bl)){var t=[];Eg(t,bl,e,tp(e)),ug(ib,t)}}function ab(e,t,n){e==="focusin"?(u0(),ol=t,bl=n,ol.attachEvent("onpropertychange",Tg)):e==="focusout"&&u0()}function lb(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return zu(bl)}function cb(e,t){if(e==="click")return zu(t)}function ub(e,t){if(e==="input"||e==="change")return zu(t)}function db(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ks=typeof Object.is=="function"?Object.is:db;function wl(e,t){if(ks(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Wd.call(t,i)||!ks(e[i],t[i]))return!1}return!0}function d0(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function f0(e,t){var n=d0(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=d0(n)}}function Mg(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Mg(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function $g(){for(var e=window,t=Kc();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Kc(e.document)}return t}function up(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function fb(e){var t=$g(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Mg(n.ownerDocument.documentElement,n)){if(r!==null&&up(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=r.end===void 0?a:Math.min(r.end,i),!e.extend&&a>r&&(i=r,r=a,a=i),i=f0(n,a);var l=f0(n,r);i&&l&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var pb=ii&&"documentMode"in document&&11>=document.documentMode,Lo=null,uf=null,al=null,df=!1;function p0(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;df||Lo==null||Lo!==Kc(r)||(r=Lo,"selectionStart"in r&&up(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),al&&wl(al,r)||(al=r,r=Qc(uf,"onSelect"),0<r.length&&(t=new ap("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Lo)))}function mc(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Oo={animationend:mc("Animation","AnimationEnd"),animationiteration:mc("Animation","AnimationIteration"),animationstart:mc("Animation","AnimationStart"),transitionend:mc("Transition","TransitionEnd")},gd={},Ag={};ii&&(Ag=document.createElement("div").style,"AnimationEvent"in window||(delete Oo.animationend.animation,delete Oo.animationiteration.animation,delete Oo.animationstart.animation),"TransitionEvent"in window||delete Oo.transitionend.transition);function ju(e){if(gd[e])return gd[e];if(!Oo[e])return e;var t=Oo[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Ag)return gd[e]=t[n];return e}var Pg=ju("animationend"),Rg=ju("animationiteration"),Dg=ju("animationstart"),Lg=ju("transitionend"),Og=new Map,h0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Hi(e,t){Og.set(e,t),uo(t,[e])}for(var xd=0;xd<h0.length;xd++){var yd=h0[xd],hb=yd.toLowerCase(),mb=yd[0].toUpperCase()+yd.slice(1);Hi(hb,"on"+mb)}Hi(Pg,"onAnimationEnd");Hi(Rg,"onAnimationIteration");Hi(Dg,"onAnimationStart");Hi("dblclick","onDoubleClick");Hi("focusin","onFocus");Hi("focusout","onBlur");Hi(Lg,"onTransitionEnd");Qo("onMouseEnter",["mouseout","mouseover"]);Qo("onMouseLeave",["mouseout","mouseover"]);Qo("onPointerEnter",["pointerout","pointerover"]);Qo("onPointerLeave",["pointerout","pointerover"]);uo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));uo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));uo("onBeforeInput",["compositionend","keypress","textInput","paste"]);uo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));uo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));uo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Qa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gb=new Set("cancel close invalid load scroll toggle".split(" ").concat(Qa));function m0(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,hv(r,t,void 0,e),e.currentTarget=null}function Ug(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var l=r.length-1;0<=l;l--){var u=r[l],d=u.instance,y=u.currentTarget;if(u=u.listener,d!==a&&i.isPropagationStopped())break e;m0(i,u,y),a=d}else for(l=0;l<r.length;l++){if(u=r[l],d=u.instance,y=u.currentTarget,u=u.listener,d!==a&&i.isPropagationStopped())break e;m0(i,u,y),a=d}}}if(Gc)throw e=of,Gc=!1,of=null,e}function yn(e,t){var n=t[gf];n===void 0&&(n=t[gf]=new Set);var r=e+"__bubble";n.has(r)||(Fg(t,e,2,!1),n.add(r))}function vd(e,t,n){var r=0;t&&(r|=4),Fg(n,e,r,t)}var gc="_reactListening"+Math.random().toString(36).slice(2);function kl(e){if(!e[gc]){e[gc]=!0,Gm.forEach(function(n){n!=="selectionchange"&&(gb.has(n)||vd(n,!1,e),vd(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[gc]||(t[gc]=!0,vd("selectionchange",!1,t))}}function Fg(e,t,n,r){switch(jg(t)){case 1:var i=Iv;break;case 4:i=Tv;break;default:i=ip}n=i.bind(null,t,n,e),i=void 0,!sf||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function bd(e,t,n,r,i){var a=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var l=r.tag;if(l===3||l===4){var u=r.stateNode.containerInfo;if(u===i||u.nodeType===8&&u.parentNode===i)break;if(l===4)for(l=r.return;l!==null;){var d=l.tag;if((d===3||d===4)&&(d=l.stateNode.containerInfo,d===i||d.nodeType===8&&d.parentNode===i))return;l=l.return}for(;u!==null;){if(l=qi(u),l===null)return;if(d=l.tag,d===5||d===6){r=a=l;continue e}u=u.parentNode}}r=r.return}ug(function(){var y=a,j=tp(n),_=[];e:{var k=Og.get(e);if(k!==void 0){var b=ap,E=e;switch(e){case"keypress":if(Dc(n)===0)break e;case"keydown":case"keyup":b=Kv;break;case"focusin":E="focus",b=pd;break;case"focusout":E="blur",b=pd;break;case"beforeblur":case"afterblur":b=pd;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":b=r0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":b=Av;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":b=Xv;break;case Pg:case Rg:case Dg:b=Dv;break;case Lg:b=Jv;break;case"scroll":b=Mv;break;case"wheel":b=Qv;break;case"copy":case"cut":case"paste":b=Ov;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":b=i0}var z=(t&4)!==0,A=!z&&e==="scroll",x=z?k!==null?k+"Capture":null:k;z=[];for(var g=y,S;g!==null;){S=g;var L=S.stateNode;if(S.tag===5&&L!==null&&(S=L,x!==null&&(L=gl(g,x),L!=null&&z.push(zl(g,L,S)))),A)break;g=g.return}0<z.length&&(k=new b(k,E,null,n,j),_.push({event:k,listeners:z}))}}if(!(t&7)){e:{if(k=e==="mouseover"||e==="pointerover",b=e==="mouseout"||e==="pointerout",k&&n!==nf&&(E=n.relatedTarget||n.fromElement)&&(qi(E)||E[oi]))break e;if((b||k)&&(k=j.window===j?j:(k=j.ownerDocument)?k.defaultView||k.parentWindow:window,b?(E=n.relatedTarget||n.toElement,b=y,E=E?qi(E):null,E!==null&&(A=fo(E),E!==A||E.tag!==5&&E.tag!==6)&&(E=null)):(b=null,E=y),b!==E)){if(z=r0,L="onMouseLeave",x="onMouseEnter",g="mouse",(e==="pointerout"||e==="pointerover")&&(z=i0,L="onPointerLeave",x="onPointerEnter",g="pointer"),A=b==null?k:Uo(b),S=E==null?k:Uo(E),k=new z(L,g+"leave",b,n,j),k.target=A,k.relatedTarget=S,L=null,qi(j)===y&&(z=new z(x,g+"enter",E,n,j),z.target=S,z.relatedTarget=A,L=z),A=L,b&&E)t:{for(z=b,x=E,g=0,S=z;S;S=Io(S))g++;for(S=0,L=x;L;L=Io(L))S++;for(;0<g-S;)z=Io(z),g--;for(;0<S-g;)x=Io(x),S--;for(;g--;){if(z===x||x!==null&&z===x.alternate)break t;z=Io(z),x=Io(x)}z=null}else z=null;b!==null&&g0(_,k,b,z,!1),E!==null&&A!==null&&g0(_,A,E,z,!0)}}e:{if(k=y?Uo(y):window,b=k.nodeName&&k.nodeName.toLowerCase(),b==="select"||b==="input"&&k.type==="file")var B=ob;else if(l0(k))if(Ig)B=ub;else{B=lb;var ie=ab}else(b=k.nodeName)&&b.toLowerCase()==="input"&&(k.type==="checkbox"||k.type==="radio")&&(B=cb);if(B&&(B=B(e,y))){Eg(_,B,n,j);break e}ie&&ie(e,k,y),e==="focusout"&&(ie=k._wrapperState)&&ie.controlled&&k.type==="number"&&Jd(k,"number",k.value)}switch(ie=y?Uo(y):window,e){case"focusin":(l0(ie)||ie.contentEditable==="true")&&(Lo=ie,uf=y,al=null);break;case"focusout":al=uf=Lo=null;break;case"mousedown":df=!0;break;case"contextmenu":case"mouseup":case"dragend":df=!1,p0(_,n,j);break;case"selectionchange":if(pb)break;case"keydown":case"keyup":p0(_,n,j)}var J;if(cp)e:{switch(e){case"compositionstart":var ue="onCompositionStart";break e;case"compositionend":ue="onCompositionEnd";break e;case"compositionupdate":ue="onCompositionUpdate";break e}ue=void 0}else Do?Sg(e,n)&&(ue="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(ue="onCompositionStart");ue&&(Ng&&n.locale!=="ko"&&(Do||ue!=="onCompositionStart"?ue==="onCompositionEnd"&&Do&&(J=_g()):(Ti=j,op="value"in Ti?Ti.value:Ti.textContent,Do=!0)),ie=Qc(y,ue),0<ie.length&&(ue=new s0(ue,e,null,n,j),_.push({event:ue,listeners:ie}),J?ue.data=J:(J=Cg(n),J!==null&&(ue.data=J)))),(J=tb?nb(e,n):rb(e,n))&&(y=Qc(y,"onBeforeInput"),0<y.length&&(j=new s0("onBeforeInput","beforeinput",null,n,j),_.push({event:j,listeners:y}),j.data=J))}Ug(_,t)})}function zl(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Qc(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=gl(e,n),a!=null&&r.unshift(zl(e,a,i)),a=gl(e,t),a!=null&&r.push(zl(e,a,i))),e=e.return}return r}function Io(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function g0(e,t,n,r,i){for(var a=t._reactName,l=[];n!==null&&n!==r;){var u=n,d=u.alternate,y=u.stateNode;if(d!==null&&d===r)break;u.tag===5&&y!==null&&(u=y,i?(d=gl(n,a),d!=null&&l.unshift(zl(n,d,u))):i||(d=gl(n,a),d!=null&&l.push(zl(n,d,u)))),n=n.return}l.length!==0&&e.push({event:t,listeners:l})}var xb=/\r\n?/g,yb=/\u0000|\uFFFD/g;function x0(e){return(typeof e=="string"?e:""+e).replace(xb,`
`).replace(yb,"")}function xc(e,t,n){if(t=x0(t),x0(e)!==t&&n)throw Error(Oe(425))}function eu(){}var ff=null,pf=null;function hf(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var mf=typeof setTimeout=="function"?setTimeout:void 0,vb=typeof clearTimeout=="function"?clearTimeout:void 0,y0=typeof Promise=="function"?Promise:void 0,bb=typeof queueMicrotask=="function"?queueMicrotask:typeof y0<"u"?function(e){return y0.resolve(null).then(e).catch(wb)}:mf;function wb(e){setTimeout(function(){throw e})}function wd(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),vl(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);vl(t)}function Ri(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function v0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var la=Math.random().toString(36).slice(2),As="__reactFiber$"+la,jl="__reactProps$"+la,oi="__reactContainer$"+la,gf="__reactEvents$"+la,kb="__reactListeners$"+la,zb="__reactHandles$"+la;function qi(e){var t=e[As];if(t)return t;for(var n=e.parentNode;n;){if(t=n[oi]||n[As]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=v0(e);e!==null;){if(n=e[As])return n;e=v0(e)}return t}e=n,n=e.parentNode}return null}function Al(e){return e=e[As]||e[oi],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Uo(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Oe(33))}function _u(e){return e[jl]||null}var xf=[],Fo=-1;function Wi(e){return{current:e}}function vn(e){0>Fo||(e.current=xf[Fo],xf[Fo]=null,Fo--)}function hn(e,t){Fo++,xf[Fo]=e.current,e.current=t}var Bi={},hr=Wi(Bi),Ar=Wi(!1),ro=Bi;function ea(e,t){var n=e.type.contextTypes;if(!n)return Bi;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in n)i[a]=t[a];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Pr(e){return e=e.childContextTypes,e!=null}function tu(){vn(Ar),vn(hr)}function b0(e,t,n){if(hr.current!==Bi)throw Error(Oe(168));hn(hr,t),hn(Ar,n)}function Bg(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(Oe(108,av(e)||"Unknown",i));return Sn({},n,r)}function nu(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Bi,ro=hr.current,hn(hr,e),hn(Ar,Ar.current),!0}function w0(e,t,n){var r=e.stateNode;if(!r)throw Error(Oe(169));n?(e=Bg(e,t,ro),r.__reactInternalMemoizedMergedChildContext=e,vn(Ar),vn(hr),hn(hr,e)):vn(Ar),hn(Ar,n)}var Qs=null,Nu=!1,kd=!1;function Hg(e){Qs===null?Qs=[e]:Qs.push(e)}function jb(e){Nu=!0,Hg(e)}function Vi(){if(!kd&&Qs!==null){kd=!0;var e=0,t=ln;try{var n=Qs;for(ln=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Qs=null,Nu=!1}catch(i){throw Qs!==null&&(Qs=Qs.slice(e+1)),hg(np,Vi),i}finally{ln=t,kd=!1}}return null}var Bo=[],Ho=0,ru=null,su=0,ts=[],ns=0,so=null,ni=1,ri="";function Zi(e,t){Bo[Ho++]=su,Bo[Ho++]=ru,ru=e,su=t}function Wg(e,t,n){ts[ns++]=ni,ts[ns++]=ri,ts[ns++]=so,so=e;var r=ni;e=ri;var i=32-bs(r)-1;r&=~(1<<i),n+=1;var a=32-bs(t)+i;if(30<a){var l=i-i%5;a=(r&(1<<l)-1).toString(32),r>>=l,i-=l,ni=1<<32-bs(t)+i|n<<i|r,ri=a+e}else ni=1<<a|n<<i|r,ri=e}function dp(e){e.return!==null&&(Zi(e,1),Wg(e,1,0))}function fp(e){for(;e===ru;)ru=Bo[--Ho],Bo[Ho]=null,su=Bo[--Ho],Bo[Ho]=null;for(;e===so;)so=ts[--ns],ts[ns]=null,ri=ts[--ns],ts[ns]=null,ni=ts[--ns],ts[ns]=null}var Hr=null,Br=null,zn=!1,vs=null;function Vg(e,t){var n=rs(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function k0(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Hr=e,Br=Ri(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Hr=e,Br=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=so!==null?{id:ni,overflow:ri}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=rs(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Hr=e,Br=null,!0):!1;default:return!1}}function yf(e){return(e.mode&1)!==0&&(e.flags&128)===0}function vf(e){if(zn){var t=Br;if(t){var n=t;if(!k0(e,t)){if(yf(e))throw Error(Oe(418));t=Ri(n.nextSibling);var r=Hr;t&&k0(e,t)?Vg(r,n):(e.flags=e.flags&-4097|2,zn=!1,Hr=e)}}else{if(yf(e))throw Error(Oe(418));e.flags=e.flags&-4097|2,zn=!1,Hr=e}}}function z0(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Hr=e}function yc(e){if(e!==Hr)return!1;if(!zn)return z0(e),zn=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!hf(e.type,e.memoizedProps)),t&&(t=Br)){if(yf(e))throw Kg(),Error(Oe(418));for(;t;)Vg(e,t),t=Ri(t.nextSibling)}if(z0(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Oe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Br=Ri(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Br=null}}else Br=Hr?Ri(e.stateNode.nextSibling):null;return!0}function Kg(){for(var e=Br;e;)e=Ri(e.nextSibling)}function ta(){Br=Hr=null,zn=!1}function pp(e){vs===null?vs=[e]:vs.push(e)}var _b=ci.ReactCurrentBatchConfig;function Da(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Oe(309));var r=n.stateNode}if(!r)throw Error(Oe(147,e));var i=r,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(l){var u=i.refs;l===null?delete u[a]:u[a]=l},t._stringRef=a,t)}if(typeof e!="string")throw Error(Oe(284));if(!n._owner)throw Error(Oe(290,e))}return e}function vc(e,t){throw e=Object.prototype.toString.call(t),Error(Oe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function j0(e){var t=e._init;return t(e._payload)}function Yg(e){function t(x,g){if(e){var S=x.deletions;S===null?(x.deletions=[g],x.flags|=16):S.push(g)}}function n(x,g){if(!e)return null;for(;g!==null;)t(x,g),g=g.sibling;return null}function r(x,g){for(x=new Map;g!==null;)g.key!==null?x.set(g.key,g):x.set(g.index,g),g=g.sibling;return x}function i(x,g){return x=Ui(x,g),x.index=0,x.sibling=null,x}function a(x,g,S){return x.index=S,e?(S=x.alternate,S!==null?(S=S.index,S<g?(x.flags|=2,g):S):(x.flags|=2,g)):(x.flags|=1048576,g)}function l(x){return e&&x.alternate===null&&(x.flags|=2),x}function u(x,g,S,L){return g===null||g.tag!==6?(g=Ed(S,x.mode,L),g.return=x,g):(g=i(g,S),g.return=x,g)}function d(x,g,S,L){var B=S.type;return B===Ro?j(x,g,S.props.children,L,S.key):g!==null&&(g.elementType===B||typeof B=="object"&&B!==null&&B.$$typeof===Si&&j0(B)===g.type)?(L=i(g,S.props),L.ref=Da(x,g,S),L.return=x,L):(L=Wc(S.type,S.key,S.props,null,x.mode,L),L.ref=Da(x,g,S),L.return=x,L)}function y(x,g,S,L){return g===null||g.tag!==4||g.stateNode.containerInfo!==S.containerInfo||g.stateNode.implementation!==S.implementation?(g=Id(S,x.mode,L),g.return=x,g):(g=i(g,S.children||[]),g.return=x,g)}function j(x,g,S,L,B){return g===null||g.tag!==7?(g=no(S,x.mode,L,B),g.return=x,g):(g=i(g,S),g.return=x,g)}function _(x,g,S){if(typeof g=="string"&&g!==""||typeof g=="number")return g=Ed(""+g,x.mode,S),g.return=x,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case lc:return S=Wc(g.type,g.key,g.props,null,x.mode,S),S.ref=Da(x,null,g),S.return=x,S;case Po:return g=Id(g,x.mode,S),g.return=x,g;case Si:var L=g._init;return _(x,L(g._payload),S)}if(Ja(g)||Ma(g))return g=no(g,x.mode,S,null),g.return=x,g;vc(x,g)}return null}function k(x,g,S,L){var B=g!==null?g.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return B!==null?null:u(x,g,""+S,L);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case lc:return S.key===B?d(x,g,S,L):null;case Po:return S.key===B?y(x,g,S,L):null;case Si:return B=S._init,k(x,g,B(S._payload),L)}if(Ja(S)||Ma(S))return B!==null?null:j(x,g,S,L,null);vc(x,S)}return null}function b(x,g,S,L,B){if(typeof L=="string"&&L!==""||typeof L=="number")return x=x.get(S)||null,u(g,x,""+L,B);if(typeof L=="object"&&L!==null){switch(L.$$typeof){case lc:return x=x.get(L.key===null?S:L.key)||null,d(g,x,L,B);case Po:return x=x.get(L.key===null?S:L.key)||null,y(g,x,L,B);case Si:var ie=L._init;return b(x,g,S,ie(L._payload),B)}if(Ja(L)||Ma(L))return x=x.get(S)||null,j(g,x,L,B,null);vc(g,L)}return null}function E(x,g,S,L){for(var B=null,ie=null,J=g,ue=g=0,ce=null;J!==null&&ue<S.length;ue++){J.index>ue?(ce=J,J=null):ce=J.sibling;var me=k(x,J,S[ue],L);if(me===null){J===null&&(J=ce);break}e&&J&&me.alternate===null&&t(x,J),g=a(me,g,ue),ie===null?B=me:ie.sibling=me,ie=me,J=ce}if(ue===S.length)return n(x,J),zn&&Zi(x,ue),B;if(J===null){for(;ue<S.length;ue++)J=_(x,S[ue],L),J!==null&&(g=a(J,g,ue),ie===null?B=J:ie.sibling=J,ie=J);return zn&&Zi(x,ue),B}for(J=r(x,J);ue<S.length;ue++)ce=b(J,x,ue,S[ue],L),ce!==null&&(e&&ce.alternate!==null&&J.delete(ce.key===null?ue:ce.key),g=a(ce,g,ue),ie===null?B=ce:ie.sibling=ce,ie=ce);return e&&J.forEach(function(Be){return t(x,Be)}),zn&&Zi(x,ue),B}function z(x,g,S,L){var B=Ma(S);if(typeof B!="function")throw Error(Oe(150));if(S=B.call(S),S==null)throw Error(Oe(151));for(var ie=B=null,J=g,ue=g=0,ce=null,me=S.next();J!==null&&!me.done;ue++,me=S.next()){J.index>ue?(ce=J,J=null):ce=J.sibling;var Be=k(x,J,me.value,L);if(Be===null){J===null&&(J=ce);break}e&&J&&Be.alternate===null&&t(x,J),g=a(Be,g,ue),ie===null?B=Be:ie.sibling=Be,ie=Be,J=ce}if(me.done)return n(x,J),zn&&Zi(x,ue),B;if(J===null){for(;!me.done;ue++,me=S.next())me=_(x,me.value,L),me!==null&&(g=a(me,g,ue),ie===null?B=me:ie.sibling=me,ie=me);return zn&&Zi(x,ue),B}for(J=r(x,J);!me.done;ue++,me=S.next())me=b(J,x,ue,me.value,L),me!==null&&(e&&me.alternate!==null&&J.delete(me.key===null?ue:me.key),g=a(me,g,ue),ie===null?B=me:ie.sibling=me,ie=me);return e&&J.forEach(function(K){return t(x,K)}),zn&&Zi(x,ue),B}function A(x,g,S,L){if(typeof S=="object"&&S!==null&&S.type===Ro&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case lc:e:{for(var B=S.key,ie=g;ie!==null;){if(ie.key===B){if(B=S.type,B===Ro){if(ie.tag===7){n(x,ie.sibling),g=i(ie,S.props.children),g.return=x,x=g;break e}}else if(ie.elementType===B||typeof B=="object"&&B!==null&&B.$$typeof===Si&&j0(B)===ie.type){n(x,ie.sibling),g=i(ie,S.props),g.ref=Da(x,ie,S),g.return=x,x=g;break e}n(x,ie);break}else t(x,ie);ie=ie.sibling}S.type===Ro?(g=no(S.props.children,x.mode,L,S.key),g.return=x,x=g):(L=Wc(S.type,S.key,S.props,null,x.mode,L),L.ref=Da(x,g,S),L.return=x,x=L)}return l(x);case Po:e:{for(ie=S.key;g!==null;){if(g.key===ie)if(g.tag===4&&g.stateNode.containerInfo===S.containerInfo&&g.stateNode.implementation===S.implementation){n(x,g.sibling),g=i(g,S.children||[]),g.return=x,x=g;break e}else{n(x,g);break}else t(x,g);g=g.sibling}g=Id(S,x.mode,L),g.return=x,x=g}return l(x);case Si:return ie=S._init,A(x,g,ie(S._payload),L)}if(Ja(S))return E(x,g,S,L);if(Ma(S))return z(x,g,S,L);vc(x,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,g!==null&&g.tag===6?(n(x,g.sibling),g=i(g,S),g.return=x,x=g):(n(x,g),g=Ed(S,x.mode,L),g.return=x,x=g),l(x)):n(x,g)}return A}var na=Yg(!0),Gg=Yg(!1),iu=Wi(null),ou=null,Wo=null,hp=null;function mp(){hp=Wo=ou=null}function gp(e){var t=iu.current;vn(iu),e._currentValue=t}function bf(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Jo(e,t){ou=e,hp=Wo=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&($r=!0),e.firstContext=null)}function is(e){var t=e._currentValue;if(hp!==e)if(e={context:e,memoizedValue:t,next:null},Wo===null){if(ou===null)throw Error(Oe(308));Wo=e,ou.dependencies={lanes:0,firstContext:e}}else Wo=Wo.next=e;return t}var Qi=null;function xp(e){Qi===null?Qi=[e]:Qi.push(e)}function Xg(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,xp(t)):(n.next=i.next,i.next=n),t.interleaved=n,ai(e,r)}function ai(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Ci=!1;function yp(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Zg(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function si(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Di(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Xt&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,ai(e,n)}return i=r.interleaved,i===null?(t.next=t,xp(r)):(t.next=i.next,i.next=t),r.interleaved=t,ai(e,n)}function Lc(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,rp(e,n)}}function _0(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var l={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?i=a=l:a=a.next=l,n=n.next}while(n!==null);a===null?i=a=t:a=a.next=t}else i=a=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function au(e,t,n,r){var i=e.updateQueue;Ci=!1;var a=i.firstBaseUpdate,l=i.lastBaseUpdate,u=i.shared.pending;if(u!==null){i.shared.pending=null;var d=u,y=d.next;d.next=null,l===null?a=y:l.next=y,l=d;var j=e.alternate;j!==null&&(j=j.updateQueue,u=j.lastBaseUpdate,u!==l&&(u===null?j.firstBaseUpdate=y:u.next=y,j.lastBaseUpdate=d))}if(a!==null){var _=i.baseState;l=0,j=y=d=null,u=a;do{var k=u.lane,b=u.eventTime;if((r&k)===k){j!==null&&(j=j.next={eventTime:b,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var E=e,z=u;switch(k=t,b=n,z.tag){case 1:if(E=z.payload,typeof E=="function"){_=E.call(b,_,k);break e}_=E;break e;case 3:E.flags=E.flags&-65537|128;case 0:if(E=z.payload,k=typeof E=="function"?E.call(b,_,k):E,k==null)break e;_=Sn({},_,k);break e;case 2:Ci=!0}}u.callback!==null&&u.lane!==0&&(e.flags|=64,k=i.effects,k===null?i.effects=[u]:k.push(u))}else b={eventTime:b,lane:k,tag:u.tag,payload:u.payload,callback:u.callback,next:null},j===null?(y=j=b,d=_):j=j.next=b,l|=k;if(u=u.next,u===null){if(u=i.shared.pending,u===null)break;k=u,u=k.next,k.next=null,i.lastBaseUpdate=k,i.shared.pending=null}}while(!0);if(j===null&&(d=_),i.baseState=d,i.firstBaseUpdate=y,i.lastBaseUpdate=j,t=i.shared.interleaved,t!==null){i=t;do l|=i.lane,i=i.next;while(i!==t)}else a===null&&(i.shared.lanes=0);oo|=l,e.lanes=l,e.memoizedState=_}}function N0(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(Oe(191,i));i.call(r)}}}var Pl={},Ls=Wi(Pl),_l=Wi(Pl),Nl=Wi(Pl);function eo(e){if(e===Pl)throw Error(Oe(174));return e}function vp(e,t){switch(hn(Nl,t),hn(_l,e),hn(Ls,Pl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Qd(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Qd(t,e)}vn(Ls),hn(Ls,t)}function ra(){vn(Ls),vn(_l),vn(Nl)}function Jg(e){eo(Nl.current);var t=eo(Ls.current),n=Qd(t,e.type);t!==n&&(hn(_l,e),hn(Ls,n))}function bp(e){_l.current===e&&(vn(Ls),vn(_l))}var _n=Wi(0);function lu(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var zd=[];function wp(){for(var e=0;e<zd.length;e++)zd[e]._workInProgressVersionPrimary=null;zd.length=0}var Oc=ci.ReactCurrentDispatcher,jd=ci.ReactCurrentBatchConfig,io=0,Nn=null,Wn=null,Jn=null,cu=!1,ll=!1,Sl=0,Nb=0;function dr(){throw Error(Oe(321))}function kp(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ks(e[n],t[n]))return!1;return!0}function zp(e,t,n,r,i,a){if(io=a,Nn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Oc.current=e===null||e.memoizedState===null?Ib:Tb,e=n(r,i),ll){a=0;do{if(ll=!1,Sl=0,25<=a)throw Error(Oe(301));a+=1,Jn=Wn=null,t.updateQueue=null,Oc.current=Mb,e=n(r,i)}while(ll)}if(Oc.current=uu,t=Wn!==null&&Wn.next!==null,io=0,Jn=Wn=Nn=null,cu=!1,t)throw Error(Oe(300));return e}function jp(){var e=Sl!==0;return Sl=0,e}function $s(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jn===null?Nn.memoizedState=Jn=e:Jn=Jn.next=e,Jn}function os(){if(Wn===null){var e=Nn.alternate;e=e!==null?e.memoizedState:null}else e=Wn.next;var t=Jn===null?Nn.memoizedState:Jn.next;if(t!==null)Jn=t,Wn=e;else{if(e===null)throw Error(Oe(310));Wn=e,e={memoizedState:Wn.memoizedState,baseState:Wn.baseState,baseQueue:Wn.baseQueue,queue:Wn.queue,next:null},Jn===null?Nn.memoizedState=Jn=e:Jn=Jn.next=e}return Jn}function Cl(e,t){return typeof t=="function"?t(e):t}function _d(e){var t=os(),n=t.queue;if(n===null)throw Error(Oe(311));n.lastRenderedReducer=e;var r=Wn,i=r.baseQueue,a=n.pending;if(a!==null){if(i!==null){var l=i.next;i.next=a.next,a.next=l}r.baseQueue=i=a,n.pending=null}if(i!==null){a=i.next,r=r.baseState;var u=l=null,d=null,y=a;do{var j=y.lane;if((io&j)===j)d!==null&&(d=d.next={lane:0,action:y.action,hasEagerState:y.hasEagerState,eagerState:y.eagerState,next:null}),r=y.hasEagerState?y.eagerState:e(r,y.action);else{var _={lane:j,action:y.action,hasEagerState:y.hasEagerState,eagerState:y.eagerState,next:null};d===null?(u=d=_,l=r):d=d.next=_,Nn.lanes|=j,oo|=j}y=y.next}while(y!==null&&y!==a);d===null?l=r:d.next=u,ks(r,t.memoizedState)||($r=!0),t.memoizedState=r,t.baseState=l,t.baseQueue=d,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do a=i.lane,Nn.lanes|=a,oo|=a,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Nd(e){var t=os(),n=t.queue;if(n===null)throw Error(Oe(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(i!==null){n.pending=null;var l=i=i.next;do a=e(a,l.action),l=l.next;while(l!==i);ks(a,t.memoizedState)||($r=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function qg(){}function Qg(e,t){var n=Nn,r=os(),i=t(),a=!ks(r.memoizedState,i);if(a&&(r.memoizedState=i,$r=!0),r=r.queue,_p(nx.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||Jn!==null&&Jn.memoizedState.tag&1){if(n.flags|=2048,El(9,tx.bind(null,n,r,i,t),void 0,null),qn===null)throw Error(Oe(349));io&30||ex(n,t,i)}return i}function ex(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Nn.updateQueue,t===null?(t={lastEffect:null,stores:null},Nn.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function tx(e,t,n,r){t.value=n,t.getSnapshot=r,rx(t)&&sx(e)}function nx(e,t,n){return n(function(){rx(t)&&sx(e)})}function rx(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ks(e,n)}catch{return!0}}function sx(e){var t=ai(e,1);t!==null&&ws(t,e,1,-1)}function S0(e){var t=$s();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Cl,lastRenderedState:e},t.queue=e,e=e.dispatch=Eb.bind(null,Nn,e),[t.memoizedState,e]}function El(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Nn.updateQueue,t===null?(t={lastEffect:null,stores:null},Nn.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function ix(){return os().memoizedState}function Uc(e,t,n,r){var i=$s();Nn.flags|=e,i.memoizedState=El(1|t,n,void 0,r===void 0?null:r)}function Su(e,t,n,r){var i=os();r=r===void 0?null:r;var a=void 0;if(Wn!==null){var l=Wn.memoizedState;if(a=l.destroy,r!==null&&kp(r,l.deps)){i.memoizedState=El(t,n,a,r);return}}Nn.flags|=e,i.memoizedState=El(1|t,n,a,r)}function C0(e,t){return Uc(8390656,8,e,t)}function _p(e,t){return Su(2048,8,e,t)}function ox(e,t){return Su(4,2,e,t)}function ax(e,t){return Su(4,4,e,t)}function lx(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function cx(e,t,n){return n=n!=null?n.concat([e]):null,Su(4,4,lx.bind(null,t,e),n)}function Np(){}function ux(e,t){var n=os();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&kp(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function dx(e,t){var n=os();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&kp(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function fx(e,t,n){return io&21?(ks(n,t)||(n=xg(),Nn.lanes|=n,oo|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,$r=!0),e.memoizedState=n)}function Sb(e,t){var n=ln;ln=n!==0&&4>n?n:4,e(!0);var r=jd.transition;jd.transition={};try{e(!1),t()}finally{ln=n,jd.transition=r}}function px(){return os().memoizedState}function Cb(e,t,n){var r=Oi(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},hx(e))mx(t,n);else if(n=Xg(e,t,n,r),n!==null){var i=wr();ws(n,e,r,i),gx(n,t,r)}}function Eb(e,t,n){var r=Oi(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(hx(e))mx(t,i);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var l=t.lastRenderedState,u=a(l,n);if(i.hasEagerState=!0,i.eagerState=u,ks(u,l)){var d=t.interleaved;d===null?(i.next=i,xp(t)):(i.next=d.next,d.next=i),t.interleaved=i;return}}catch{}finally{}n=Xg(e,t,i,r),n!==null&&(i=wr(),ws(n,e,r,i),gx(n,t,r))}}function hx(e){var t=e.alternate;return e===Nn||t!==null&&t===Nn}function mx(e,t){ll=cu=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function gx(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,rp(e,n)}}var uu={readContext:is,useCallback:dr,useContext:dr,useEffect:dr,useImperativeHandle:dr,useInsertionEffect:dr,useLayoutEffect:dr,useMemo:dr,useReducer:dr,useRef:dr,useState:dr,useDebugValue:dr,useDeferredValue:dr,useTransition:dr,useMutableSource:dr,useSyncExternalStore:dr,useId:dr,unstable_isNewReconciler:!1},Ib={readContext:is,useCallback:function(e,t){return $s().memoizedState=[e,t===void 0?null:t],e},useContext:is,useEffect:C0,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Uc(4194308,4,lx.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Uc(4194308,4,e,t)},useInsertionEffect:function(e,t){return Uc(4,2,e,t)},useMemo:function(e,t){var n=$s();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=$s();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Cb.bind(null,Nn,e),[r.memoizedState,e]},useRef:function(e){var t=$s();return e={current:e},t.memoizedState=e},useState:S0,useDebugValue:Np,useDeferredValue:function(e){return $s().memoizedState=e},useTransition:function(){var e=S0(!1),t=e[0];return e=Sb.bind(null,e[1]),$s().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Nn,i=$s();if(zn){if(n===void 0)throw Error(Oe(407));n=n()}else{if(n=t(),qn===null)throw Error(Oe(349));io&30||ex(r,t,n)}i.memoizedState=n;var a={value:n,getSnapshot:t};return i.queue=a,C0(nx.bind(null,r,a,e),[e]),r.flags|=2048,El(9,tx.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=$s(),t=qn.identifierPrefix;if(zn){var n=ri,r=ni;n=(r&~(1<<32-bs(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Sl++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=Nb++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Tb={readContext:is,useCallback:ux,useContext:is,useEffect:_p,useImperativeHandle:cx,useInsertionEffect:ox,useLayoutEffect:ax,useMemo:dx,useReducer:_d,useRef:ix,useState:function(){return _d(Cl)},useDebugValue:Np,useDeferredValue:function(e){var t=os();return fx(t,Wn.memoizedState,e)},useTransition:function(){var e=_d(Cl)[0],t=os().memoizedState;return[e,t]},useMutableSource:qg,useSyncExternalStore:Qg,useId:px,unstable_isNewReconciler:!1},Mb={readContext:is,useCallback:ux,useContext:is,useEffect:_p,useImperativeHandle:cx,useInsertionEffect:ox,useLayoutEffect:ax,useMemo:dx,useReducer:Nd,useRef:ix,useState:function(){return Nd(Cl)},useDebugValue:Np,useDeferredValue:function(e){var t=os();return Wn===null?t.memoizedState=e:fx(t,Wn.memoizedState,e)},useTransition:function(){var e=Nd(Cl)[0],t=os().memoizedState;return[e,t]},useMutableSource:qg,useSyncExternalStore:Qg,useId:px,unstable_isNewReconciler:!1};function xs(e,t){if(e&&e.defaultProps){t=Sn({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function wf(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Sn({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Cu={isMounted:function(e){return(e=e._reactInternals)?fo(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=wr(),i=Oi(e),a=si(r,i);a.payload=t,n!=null&&(a.callback=n),t=Di(e,a,i),t!==null&&(ws(t,e,i,r),Lc(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=wr(),i=Oi(e),a=si(r,i);a.tag=1,a.payload=t,n!=null&&(a.callback=n),t=Di(e,a,i),t!==null&&(ws(t,e,i,r),Lc(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=wr(),r=Oi(e),i=si(n,r);i.tag=2,t!=null&&(i.callback=t),t=Di(e,i,r),t!==null&&(ws(t,e,r,n),Lc(t,e,r))}};function E0(e,t,n,r,i,a,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,a,l):t.prototype&&t.prototype.isPureReactComponent?!wl(n,r)||!wl(i,a):!0}function xx(e,t,n){var r=!1,i=Bi,a=t.contextType;return typeof a=="object"&&a!==null?a=is(a):(i=Pr(t)?ro:hr.current,r=t.contextTypes,a=(r=r!=null)?ea(e,i):Bi),t=new t(n,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Cu,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function I0(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Cu.enqueueReplaceState(t,t.state,null)}function kf(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},yp(e);var a=t.contextType;typeof a=="object"&&a!==null?i.context=is(a):(a=Pr(t)?ro:hr.current,i.context=ea(e,a)),i.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(wf(e,t,a,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&Cu.enqueueReplaceState(i,i.state,null),au(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function sa(e,t){try{var n="",r=t;do n+=ov(r),r=r.return;while(r);var i=n}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:i,digest:null}}function Sd(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function zf(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var $b=typeof WeakMap=="function"?WeakMap:Map;function yx(e,t,n){n=si(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){fu||(fu=!0,$f=r),zf(e,t)},n}function vx(e,t,n){n=si(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){zf(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){zf(e,t),typeof r!="function"&&(Li===null?Li=new Set([this]):Li.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),n}function T0(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new $b;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Yb.bind(null,e,t,n),t.then(e,e))}function M0(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function $0(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=si(-1,1),t.tag=2,Di(n,t,1))),n.lanes|=1),e)}var Ab=ci.ReactCurrentOwner,$r=!1;function br(e,t,n,r){t.child=e===null?Gg(t,null,n,r):na(t,e.child,n,r)}function A0(e,t,n,r,i){n=n.render;var a=t.ref;return Jo(t,i),r=zp(e,t,n,r,a,i),n=jp(),e!==null&&!$r?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,li(e,t,i)):(zn&&n&&dp(t),t.flags|=1,br(e,t,r,i),t.child)}function P0(e,t,n,r,i){if(e===null){var a=n.type;return typeof a=="function"&&!Ap(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=a,bx(e,t,a,r,i)):(e=Wc(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&i)){var l=a.memoizedProps;if(n=n.compare,n=n!==null?n:wl,n(l,r)&&e.ref===t.ref)return li(e,t,i)}return t.flags|=1,e=Ui(a,r),e.ref=t.ref,e.return=t,t.child=e}function bx(e,t,n,r,i){if(e!==null){var a=e.memoizedProps;if(wl(a,r)&&e.ref===t.ref)if($r=!1,t.pendingProps=r=a,(e.lanes&i)!==0)e.flags&131072&&($r=!0);else return t.lanes=e.lanes,li(e,t,i)}return jf(e,t,n,r,i)}function wx(e,t,n){var r=t.pendingProps,i=r.children,a=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},hn(Ko,Ur),Ur|=n;else{if(!(n&1073741824))return e=a!==null?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,hn(Ko,Ur),Ur|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:n,hn(Ko,Ur),Ur|=r}else a!==null?(r=a.baseLanes|n,t.memoizedState=null):r=n,hn(Ko,Ur),Ur|=r;return br(e,t,i,n),t.child}function kx(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function jf(e,t,n,r,i){var a=Pr(n)?ro:hr.current;return a=ea(t,a),Jo(t,i),n=zp(e,t,n,r,a,i),r=jp(),e!==null&&!$r?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,li(e,t,i)):(zn&&r&&dp(t),t.flags|=1,br(e,t,n,i),t.child)}function R0(e,t,n,r,i){if(Pr(n)){var a=!0;nu(t)}else a=!1;if(Jo(t,i),t.stateNode===null)Fc(e,t),xx(t,n,r),kf(t,n,r,i),r=!0;else if(e===null){var l=t.stateNode,u=t.memoizedProps;l.props=u;var d=l.context,y=n.contextType;typeof y=="object"&&y!==null?y=is(y):(y=Pr(n)?ro:hr.current,y=ea(t,y));var j=n.getDerivedStateFromProps,_=typeof j=="function"||typeof l.getSnapshotBeforeUpdate=="function";_||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(u!==r||d!==y)&&I0(t,l,r,y),Ci=!1;var k=t.memoizedState;l.state=k,au(t,r,l,i),d=t.memoizedState,u!==r||k!==d||Ar.current||Ci?(typeof j=="function"&&(wf(t,n,j,r),d=t.memoizedState),(u=Ci||E0(t,n,u,r,k,d,y))?(_||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=d),l.props=r,l.state=d,l.context=y,r=u):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{l=t.stateNode,Zg(e,t),u=t.memoizedProps,y=t.type===t.elementType?u:xs(t.type,u),l.props=y,_=t.pendingProps,k=l.context,d=n.contextType,typeof d=="object"&&d!==null?d=is(d):(d=Pr(n)?ro:hr.current,d=ea(t,d));var b=n.getDerivedStateFromProps;(j=typeof b=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(u!==_||k!==d)&&I0(t,l,r,d),Ci=!1,k=t.memoizedState,l.state=k,au(t,r,l,i);var E=t.memoizedState;u!==_||k!==E||Ar.current||Ci?(typeof b=="function"&&(wf(t,n,b,r),E=t.memoizedState),(y=Ci||E0(t,n,y,r,k,E,d)||!1)?(j||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(r,E,d),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(r,E,d)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||u===e.memoizedProps&&k===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&k===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=E),l.props=r,l.state=E,l.context=d,r=y):(typeof l.componentDidUpdate!="function"||u===e.memoizedProps&&k===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&k===e.memoizedState||(t.flags|=1024),r=!1)}return _f(e,t,n,r,a,i)}function _f(e,t,n,r,i,a){kx(e,t);var l=(t.flags&128)!==0;if(!r&&!l)return i&&w0(t,n,!1),li(e,t,a);r=t.stateNode,Ab.current=t;var u=l&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&l?(t.child=na(t,e.child,null,a),t.child=na(t,null,u,a)):br(e,t,u,a),t.memoizedState=r.state,i&&w0(t,n,!0),t.child}function zx(e){var t=e.stateNode;t.pendingContext?b0(e,t.pendingContext,t.pendingContext!==t.context):t.context&&b0(e,t.context,!1),vp(e,t.containerInfo)}function D0(e,t,n,r,i){return ta(),pp(i),t.flags|=256,br(e,t,n,r),t.child}var Nf={dehydrated:null,treeContext:null,retryLane:0};function Sf(e){return{baseLanes:e,cachePool:null,transitions:null}}function jx(e,t,n){var r=t.pendingProps,i=_n.current,a=!1,l=(t.flags&128)!==0,u;if((u=l)||(u=e!==null&&e.memoizedState===null?!1:(i&2)!==0),u?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),hn(_n,i&1),e===null)return vf(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=r.children,e=r.fallback,a?(r=t.mode,a=t.child,l={mode:"hidden",children:l},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=l):a=Tu(l,r,0,null),e=no(e,r,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Sf(n),t.memoizedState=Nf,e):Sp(t,l));if(i=e.memoizedState,i!==null&&(u=i.dehydrated,u!==null))return Pb(e,t,l,r,u,i,n);if(a){a=r.fallback,l=t.mode,i=e.child,u=i.sibling;var d={mode:"hidden",children:r.children};return!(l&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=d,t.deletions=null):(r=Ui(i,d),r.subtreeFlags=i.subtreeFlags&14680064),u!==null?a=Ui(u,a):(a=no(a,l,n,null),a.flags|=2),a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,l=e.child.memoizedState,l=l===null?Sf(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=Nf,r}return a=e.child,e=a.sibling,r=Ui(a,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Sp(e,t){return t=Tu({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function bc(e,t,n,r){return r!==null&&pp(r),na(t,e.child,null,n),e=Sp(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Pb(e,t,n,r,i,a,l){if(n)return t.flags&256?(t.flags&=-257,r=Sd(Error(Oe(422))),bc(e,t,l,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=r.fallback,i=t.mode,r=Tu({mode:"visible",children:r.children},i,0,null),a=no(a,i,l,null),a.flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,t.mode&1&&na(t,e.child,null,l),t.child.memoizedState=Sf(l),t.memoizedState=Nf,a);if(!(t.mode&1))return bc(e,t,l,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var u=r.dgst;return r=u,a=Error(Oe(419)),r=Sd(a,r,void 0),bc(e,t,l,r)}if(u=(l&e.childLanes)!==0,$r||u){if(r=qn,r!==null){switch(l&-l){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|l)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,ai(e,i),ws(r,e,i,-1))}return $p(),r=Sd(Error(Oe(421))),bc(e,t,l,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=Gb.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,Br=Ri(i.nextSibling),Hr=t,zn=!0,vs=null,e!==null&&(ts[ns++]=ni,ts[ns++]=ri,ts[ns++]=so,ni=e.id,ri=e.overflow,so=t),t=Sp(t,r.children),t.flags|=4096,t)}function L0(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),bf(e.return,t,n)}function Cd(e,t,n,r,i){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function _x(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(br(e,t,r.children,n),r=_n.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&L0(e,n,t);else if(e.tag===19)L0(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(hn(_n,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&lu(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Cd(t,!1,i,n,a);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&lu(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Cd(t,!0,n,null,a);break;case"together":Cd(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Fc(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function li(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),oo|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Oe(153));if(t.child!==null){for(e=t.child,n=Ui(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Ui(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Rb(e,t,n){switch(t.tag){case 3:zx(t),ta();break;case 5:Jg(t);break;case 1:Pr(t.type)&&nu(t);break;case 4:vp(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;hn(iu,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(hn(_n,_n.current&1),t.flags|=128,null):n&t.child.childLanes?jx(e,t,n):(hn(_n,_n.current&1),e=li(e,t,n),e!==null?e.sibling:null);hn(_n,_n.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return _x(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),hn(_n,_n.current),r)break;return null;case 22:case 23:return t.lanes=0,wx(e,t,n)}return li(e,t,n)}var Nx,Cf,Sx,Cx;Nx=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Cf=function(){};Sx=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,eo(Ls.current);var a=null;switch(n){case"input":i=Xd(e,i),r=Xd(e,r),a=[];break;case"select":i=Sn({},i,{value:void 0}),r=Sn({},r,{value:void 0}),a=[];break;case"textarea":i=qd(e,i),r=qd(e,r),a=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=eu)}ef(n,r);var l;n=null;for(y in i)if(!r.hasOwnProperty(y)&&i.hasOwnProperty(y)&&i[y]!=null)if(y==="style"){var u=i[y];for(l in u)u.hasOwnProperty(l)&&(n||(n={}),n[l]="")}else y!=="dangerouslySetInnerHTML"&&y!=="children"&&y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&y!=="autoFocus"&&(hl.hasOwnProperty(y)?a||(a=[]):(a=a||[]).push(y,null));for(y in r){var d=r[y];if(u=i!=null?i[y]:void 0,r.hasOwnProperty(y)&&d!==u&&(d!=null||u!=null))if(y==="style")if(u){for(l in u)!u.hasOwnProperty(l)||d&&d.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in d)d.hasOwnProperty(l)&&u[l]!==d[l]&&(n||(n={}),n[l]=d[l])}else n||(a||(a=[]),a.push(y,n)),n=d;else y==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,u=u?u.__html:void 0,d!=null&&u!==d&&(a=a||[]).push(y,d)):y==="children"?typeof d!="string"&&typeof d!="number"||(a=a||[]).push(y,""+d):y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&(hl.hasOwnProperty(y)?(d!=null&&y==="onScroll"&&yn("scroll",e),a||u===d||(a=[])):(a=a||[]).push(y,d))}n&&(a=a||[]).push("style",n);var y=a;(t.updateQueue=y)&&(t.flags|=4)}};Cx=function(e,t,n,r){n!==r&&(t.flags|=4)};function La(e,t){if(!zn)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function fr(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Db(e,t,n){var r=t.pendingProps;switch(fp(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return fr(t),null;case 1:return Pr(t.type)&&tu(),fr(t),null;case 3:return r=t.stateNode,ra(),vn(Ar),vn(hr),wp(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(yc(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,vs!==null&&(Rf(vs),vs=null))),Cf(e,t),fr(t),null;case 5:bp(t);var i=eo(Nl.current);if(n=t.type,e!==null&&t.stateNode!=null)Sx(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(Oe(166));return fr(t),null}if(e=eo(Ls.current),yc(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[As]=t,r[jl]=a,e=(t.mode&1)!==0,n){case"dialog":yn("cancel",r),yn("close",r);break;case"iframe":case"object":case"embed":yn("load",r);break;case"video":case"audio":for(i=0;i<Qa.length;i++)yn(Qa[i],r);break;case"source":yn("error",r);break;case"img":case"image":case"link":yn("error",r),yn("load",r);break;case"details":yn("toggle",r);break;case"input":Yh(r,a),yn("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},yn("invalid",r);break;case"textarea":Xh(r,a),yn("invalid",r)}ef(n,a),i=null;for(var l in a)if(a.hasOwnProperty(l)){var u=a[l];l==="children"?typeof u=="string"?r.textContent!==u&&(a.suppressHydrationWarning!==!0&&xc(r.textContent,u,e),i=["children",u]):typeof u=="number"&&r.textContent!==""+u&&(a.suppressHydrationWarning!==!0&&xc(r.textContent,u,e),i=["children",""+u]):hl.hasOwnProperty(l)&&u!=null&&l==="onScroll"&&yn("scroll",r)}switch(n){case"input":cc(r),Gh(r,a,!0);break;case"textarea":cc(r),Zh(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=eu)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{l=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=ng(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),n==="select"&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[As]=t,e[jl]=r,Nx(e,t,!1,!1),t.stateNode=e;e:{switch(l=tf(n,r),n){case"dialog":yn("cancel",e),yn("close",e),i=r;break;case"iframe":case"object":case"embed":yn("load",e),i=r;break;case"video":case"audio":for(i=0;i<Qa.length;i++)yn(Qa[i],e);i=r;break;case"source":yn("error",e),i=r;break;case"img":case"image":case"link":yn("error",e),yn("load",e),i=r;break;case"details":yn("toggle",e),i=r;break;case"input":Yh(e,r),i=Xd(e,r),yn("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=Sn({},r,{value:void 0}),yn("invalid",e);break;case"textarea":Xh(e,r),i=qd(e,r),yn("invalid",e);break;default:i=r}ef(n,i),u=i;for(a in u)if(u.hasOwnProperty(a)){var d=u[a];a==="style"?ig(e,d):a==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,d!=null&&rg(e,d)):a==="children"?typeof d=="string"?(n!=="textarea"||d!=="")&&ml(e,d):typeof d=="number"&&ml(e,""+d):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(hl.hasOwnProperty(a)?d!=null&&a==="onScroll"&&yn("scroll",e):d!=null&&Jf(e,a,d,l))}switch(n){case"input":cc(e),Gh(e,r,!1);break;case"textarea":cc(e),Zh(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Fi(r.value));break;case"select":e.multiple=!!r.multiple,a=r.value,a!=null?Yo(e,!!r.multiple,a,!1):r.defaultValue!=null&&Yo(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=eu)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return fr(t),null;case 6:if(e&&t.stateNode!=null)Cx(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(Oe(166));if(n=eo(Nl.current),eo(Ls.current),yc(t)){if(r=t.stateNode,n=t.memoizedProps,r[As]=t,(a=r.nodeValue!==n)&&(e=Hr,e!==null))switch(e.tag){case 3:xc(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&xc(r.nodeValue,n,(e.mode&1)!==0)}a&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[As]=t,t.stateNode=r}return fr(t),null;case 13:if(vn(_n),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(zn&&Br!==null&&t.mode&1&&!(t.flags&128))Kg(),ta(),t.flags|=98560,a=!1;else if(a=yc(t),r!==null&&r.dehydrated!==null){if(e===null){if(!a)throw Error(Oe(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Oe(317));a[As]=t}else ta(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;fr(t),a=!1}else vs!==null&&(Rf(vs),vs=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||_n.current&1?Vn===0&&(Vn=3):$p())),t.updateQueue!==null&&(t.flags|=4),fr(t),null);case 4:return ra(),Cf(e,t),e===null&&kl(t.stateNode.containerInfo),fr(t),null;case 10:return gp(t.type._context),fr(t),null;case 17:return Pr(t.type)&&tu(),fr(t),null;case 19:if(vn(_n),a=t.memoizedState,a===null)return fr(t),null;if(r=(t.flags&128)!==0,l=a.rendering,l===null)if(r)La(a,!1);else{if(Vn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=lu(e),l!==null){for(t.flags|=128,La(a,!1),r=l.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)a=n,e=r,a.flags&=14680066,l=a.alternate,l===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return hn(_n,_n.current&1|2),t.child}e=e.sibling}a.tail!==null&&On()>ia&&(t.flags|=128,r=!0,La(a,!1),t.lanes=4194304)}else{if(!r)if(e=lu(l),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),La(a,!0),a.tail===null&&a.tailMode==="hidden"&&!l.alternate&&!zn)return fr(t),null}else 2*On()-a.renderingStartTime>ia&&n!==1073741824&&(t.flags|=128,r=!0,La(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(n=a.last,n!==null?n.sibling=l:t.child=l,a.last=l)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=On(),t.sibling=null,n=_n.current,hn(_n,r?n&1|2:n&1),t):(fr(t),null);case 22:case 23:return Mp(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Ur&1073741824&&(fr(t),t.subtreeFlags&6&&(t.flags|=8192)):fr(t),null;case 24:return null;case 25:return null}throw Error(Oe(156,t.tag))}function Lb(e,t){switch(fp(t),t.tag){case 1:return Pr(t.type)&&tu(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ra(),vn(Ar),vn(hr),wp(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return bp(t),null;case 13:if(vn(_n),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Oe(340));ta()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return vn(_n),null;case 4:return ra(),null;case 10:return gp(t.type._context),null;case 22:case 23:return Mp(),null;case 24:return null;default:return null}}var wc=!1,pr=!1,Ob=typeof WeakSet=="function"?WeakSet:Set,lt=null;function Vo(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){$n(e,t,r)}else n.current=null}function Ef(e,t,n){try{n()}catch(r){$n(e,t,r)}}var O0=!1;function Ub(e,t){if(ff=Jc,e=$g(),up(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var l=0,u=-1,d=-1,y=0,j=0,_=e,k=null;t:for(;;){for(var b;_!==n||i!==0&&_.nodeType!==3||(u=l+i),_!==a||r!==0&&_.nodeType!==3||(d=l+r),_.nodeType===3&&(l+=_.nodeValue.length),(b=_.firstChild)!==null;)k=_,_=b;for(;;){if(_===e)break t;if(k===n&&++y===i&&(u=l),k===a&&++j===r&&(d=l),(b=_.nextSibling)!==null)break;_=k,k=_.parentNode}_=b}n=u===-1||d===-1?null:{start:u,end:d}}else n=null}n=n||{start:0,end:0}}else n=null;for(pf={focusedElem:e,selectionRange:n},Jc=!1,lt=t;lt!==null;)if(t=lt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,lt=e;else for(;lt!==null;){t=lt;try{var E=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var z=E.memoizedProps,A=E.memoizedState,x=t.stateNode,g=x.getSnapshotBeforeUpdate(t.elementType===t.type?z:xs(t.type,z),A);x.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var S=t.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Oe(163))}}catch(L){$n(t,t.return,L)}if(e=t.sibling,e!==null){e.return=t.return,lt=e;break}lt=t.return}return E=O0,O0=!1,E}function cl(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,a!==void 0&&Ef(t,n,a)}i=i.next}while(i!==r)}}function Eu(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function If(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Ex(e){var t=e.alternate;t!==null&&(e.alternate=null,Ex(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[As],delete t[jl],delete t[gf],delete t[kb],delete t[zb])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Ix(e){return e.tag===5||e.tag===3||e.tag===4}function U0(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Ix(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Tf(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=eu));else if(r!==4&&(e=e.child,e!==null))for(Tf(e,t,n),e=e.sibling;e!==null;)Tf(e,t,n),e=e.sibling}function Mf(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Mf(e,t,n),e=e.sibling;e!==null;)Mf(e,t,n),e=e.sibling}var sr=null,ys=!1;function ji(e,t,n){for(n=n.child;n!==null;)Tx(e,t,n),n=n.sibling}function Tx(e,t,n){if(Ds&&typeof Ds.onCommitFiberUnmount=="function")try{Ds.onCommitFiberUnmount(wu,n)}catch{}switch(n.tag){case 5:pr||Vo(n,t);case 6:var r=sr,i=ys;sr=null,ji(e,t,n),sr=r,ys=i,sr!==null&&(ys?(e=sr,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):sr.removeChild(n.stateNode));break;case 18:sr!==null&&(ys?(e=sr,n=n.stateNode,e.nodeType===8?wd(e.parentNode,n):e.nodeType===1&&wd(e,n),vl(e)):wd(sr,n.stateNode));break;case 4:r=sr,i=ys,sr=n.stateNode.containerInfo,ys=!0,ji(e,t,n),sr=r,ys=i;break;case 0:case 11:case 14:case 15:if(!pr&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var a=i,l=a.destroy;a=a.tag,l!==void 0&&(a&2||a&4)&&Ef(n,t,l),i=i.next}while(i!==r)}ji(e,t,n);break;case 1:if(!pr&&(Vo(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(u){$n(n,t,u)}ji(e,t,n);break;case 21:ji(e,t,n);break;case 22:n.mode&1?(pr=(r=pr)||n.memoizedState!==null,ji(e,t,n),pr=r):ji(e,t,n);break;default:ji(e,t,n)}}function F0(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Ob),t.forEach(function(r){var i=Xb.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function ms(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var a=e,l=t,u=l;e:for(;u!==null;){switch(u.tag){case 5:sr=u.stateNode,ys=!1;break e;case 3:sr=u.stateNode.containerInfo,ys=!0;break e;case 4:sr=u.stateNode.containerInfo,ys=!0;break e}u=u.return}if(sr===null)throw Error(Oe(160));Tx(a,l,i),sr=null,ys=!1;var d=i.alternate;d!==null&&(d.return=null),i.return=null}catch(y){$n(i,t,y)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Mx(t,e),t=t.sibling}function Mx(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ms(t,e),Es(e),r&4){try{cl(3,e,e.return),Eu(3,e)}catch(z){$n(e,e.return,z)}try{cl(5,e,e.return)}catch(z){$n(e,e.return,z)}}break;case 1:ms(t,e),Es(e),r&512&&n!==null&&Vo(n,n.return);break;case 5:if(ms(t,e),Es(e),r&512&&n!==null&&Vo(n,n.return),e.flags&32){var i=e.stateNode;try{ml(i,"")}catch(z){$n(e,e.return,z)}}if(r&4&&(i=e.stateNode,i!=null)){var a=e.memoizedProps,l=n!==null?n.memoizedProps:a,u=e.type,d=e.updateQueue;if(e.updateQueue=null,d!==null)try{u==="input"&&a.type==="radio"&&a.name!=null&&eg(i,a),tf(u,l);var y=tf(u,a);for(l=0;l<d.length;l+=2){var j=d[l],_=d[l+1];j==="style"?ig(i,_):j==="dangerouslySetInnerHTML"?rg(i,_):j==="children"?ml(i,_):Jf(i,j,_,y)}switch(u){case"input":Zd(i,a);break;case"textarea":tg(i,a);break;case"select":var k=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var b=a.value;b!=null?Yo(i,!!a.multiple,b,!1):k!==!!a.multiple&&(a.defaultValue!=null?Yo(i,!!a.multiple,a.defaultValue,!0):Yo(i,!!a.multiple,a.multiple?[]:"",!1))}i[jl]=a}catch(z){$n(e,e.return,z)}}break;case 6:if(ms(t,e),Es(e),r&4){if(e.stateNode===null)throw Error(Oe(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(z){$n(e,e.return,z)}}break;case 3:if(ms(t,e),Es(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{vl(t.containerInfo)}catch(z){$n(e,e.return,z)}break;case 4:ms(t,e),Es(e);break;case 13:ms(t,e),Es(e),i=e.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(Ip=On())),r&4&&F0(e);break;case 22:if(j=n!==null&&n.memoizedState!==null,e.mode&1?(pr=(y=pr)||j,ms(t,e),pr=y):ms(t,e),Es(e),r&8192){if(y=e.memoizedState!==null,(e.stateNode.isHidden=y)&&!j&&e.mode&1)for(lt=e,j=e.child;j!==null;){for(_=lt=j;lt!==null;){switch(k=lt,b=k.child,k.tag){case 0:case 11:case 14:case 15:cl(4,k,k.return);break;case 1:Vo(k,k.return);var E=k.stateNode;if(typeof E.componentWillUnmount=="function"){r=k,n=k.return;try{t=r,E.props=t.memoizedProps,E.state=t.memoizedState,E.componentWillUnmount()}catch(z){$n(r,n,z)}}break;case 5:Vo(k,k.return);break;case 22:if(k.memoizedState!==null){H0(_);continue}}b!==null?(b.return=k,lt=b):H0(_)}j=j.sibling}e:for(j=null,_=e;;){if(_.tag===5){if(j===null){j=_;try{i=_.stateNode,y?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(u=_.stateNode,d=_.memoizedProps.style,l=d!=null&&d.hasOwnProperty("display")?d.display:null,u.style.display=sg("display",l))}catch(z){$n(e,e.return,z)}}}else if(_.tag===6){if(j===null)try{_.stateNode.nodeValue=y?"":_.memoizedProps}catch(z){$n(e,e.return,z)}}else if((_.tag!==22&&_.tag!==23||_.memoizedState===null||_===e)&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===e)break e;for(;_.sibling===null;){if(_.return===null||_.return===e)break e;j===_&&(j=null),_=_.return}j===_&&(j=null),_.sibling.return=_.return,_=_.sibling}}break;case 19:ms(t,e),Es(e),r&4&&F0(e);break;case 21:break;default:ms(t,e),Es(e)}}function Es(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Ix(n)){var r=n;break e}n=n.return}throw Error(Oe(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(ml(i,""),r.flags&=-33);var a=U0(e);Mf(e,a,i);break;case 3:case 4:var l=r.stateNode.containerInfo,u=U0(e);Tf(e,u,l);break;default:throw Error(Oe(161))}}catch(d){$n(e,e.return,d)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Fb(e,t,n){lt=e,$x(e)}function $x(e,t,n){for(var r=(e.mode&1)!==0;lt!==null;){var i=lt,a=i.child;if(i.tag===22&&r){var l=i.memoizedState!==null||wc;if(!l){var u=i.alternate,d=u!==null&&u.memoizedState!==null||pr;u=wc;var y=pr;if(wc=l,(pr=d)&&!y)for(lt=i;lt!==null;)l=lt,d=l.child,l.tag===22&&l.memoizedState!==null?W0(i):d!==null?(d.return=l,lt=d):W0(i);for(;a!==null;)lt=a,$x(a),a=a.sibling;lt=i,wc=u,pr=y}B0(e)}else i.subtreeFlags&8772&&a!==null?(a.return=i,lt=a):B0(e)}}function B0(e){for(;lt!==null;){var t=lt;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:pr||Eu(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!pr)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:xs(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&N0(t,a,r);break;case 3:var l=t.updateQueue;if(l!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}N0(t,l,n)}break;case 5:var u=t.stateNode;if(n===null&&t.flags&4){n=u;var d=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&n.focus();break;case"img":d.src&&(n.src=d.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var y=t.alternate;if(y!==null){var j=y.memoizedState;if(j!==null){var _=j.dehydrated;_!==null&&vl(_)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Oe(163))}pr||t.flags&512&&If(t)}catch(k){$n(t,t.return,k)}}if(t===e){lt=null;break}if(n=t.sibling,n!==null){n.return=t.return,lt=n;break}lt=t.return}}function H0(e){for(;lt!==null;){var t=lt;if(t===e){lt=null;break}var n=t.sibling;if(n!==null){n.return=t.return,lt=n;break}lt=t.return}}function W0(e){for(;lt!==null;){var t=lt;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Eu(4,t)}catch(d){$n(t,n,d)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(d){$n(t,i,d)}}var a=t.return;try{If(t)}catch(d){$n(t,a,d)}break;case 5:var l=t.return;try{If(t)}catch(d){$n(t,l,d)}}}catch(d){$n(t,t.return,d)}if(t===e){lt=null;break}var u=t.sibling;if(u!==null){u.return=t.return,lt=u;break}lt=t.return}}var Bb=Math.ceil,du=ci.ReactCurrentDispatcher,Cp=ci.ReactCurrentOwner,ss=ci.ReactCurrentBatchConfig,Xt=0,qn=null,Fn=null,ir=0,Ur=0,Ko=Wi(0),Vn=0,Il=null,oo=0,Iu=0,Ep=0,ul=null,Mr=null,Ip=0,ia=1/0,qs=null,fu=!1,$f=null,Li=null,kc=!1,Mi=null,pu=0,dl=0,Af=null,Bc=-1,Hc=0;function wr(){return Xt&6?On():Bc!==-1?Bc:Bc=On()}function Oi(e){return e.mode&1?Xt&2&&ir!==0?ir&-ir:_b.transition!==null?(Hc===0&&(Hc=xg()),Hc):(e=ln,e!==0||(e=window.event,e=e===void 0?16:jg(e.type)),e):1}function ws(e,t,n,r){if(50<dl)throw dl=0,Af=null,Error(Oe(185));Ml(e,n,r),(!(Xt&2)||e!==qn)&&(e===qn&&(!(Xt&2)&&(Iu|=n),Vn===4&&Ii(e,ir)),Rr(e,r),n===1&&Xt===0&&!(t.mode&1)&&(ia=On()+500,Nu&&Vi()))}function Rr(e,t){var n=e.callbackNode;_v(e,t);var r=Zc(e,e===qn?ir:0);if(r===0)n!==null&&Qh(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Qh(n),t===1)e.tag===0?jb(V0.bind(null,e)):Hg(V0.bind(null,e)),bb(function(){!(Xt&6)&&Vi()}),n=null;else{switch(yg(r)){case 1:n=np;break;case 4:n=mg;break;case 16:n=Xc;break;case 536870912:n=gg;break;default:n=Xc}n=Fx(n,Ax.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Ax(e,t){if(Bc=-1,Hc=0,Xt&6)throw Error(Oe(327));var n=e.callbackNode;if(qo()&&e.callbackNode!==n)return null;var r=Zc(e,e===qn?ir:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=hu(e,r);else{t=r;var i=Xt;Xt|=2;var a=Rx();(qn!==e||ir!==t)&&(qs=null,ia=On()+500,to(e,t));do try{Vb();break}catch(u){Px(e,u)}while(!0);mp(),du.current=a,Xt=i,Fn!==null?t=0:(qn=null,ir=0,t=Vn)}if(t!==0){if(t===2&&(i=af(e),i!==0&&(r=i,t=Pf(e,i))),t===1)throw n=Il,to(e,0),Ii(e,r),Rr(e,On()),n;if(t===6)Ii(e,r);else{if(i=e.current.alternate,!(r&30)&&!Hb(i)&&(t=hu(e,r),t===2&&(a=af(e),a!==0&&(r=a,t=Pf(e,a))),t===1))throw n=Il,to(e,0),Ii(e,r),Rr(e,On()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(Oe(345));case 2:Ji(e,Mr,qs);break;case 3:if(Ii(e,r),(r&130023424)===r&&(t=Ip+500-On(),10<t)){if(Zc(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){wr(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=mf(Ji.bind(null,e,Mr,qs),t);break}Ji(e,Mr,qs);break;case 4:if(Ii(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var l=31-bs(r);a=1<<l,l=t[l],l>i&&(i=l),r&=~a}if(r=i,r=On()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Bb(r/1960))-r,10<r){e.timeoutHandle=mf(Ji.bind(null,e,Mr,qs),r);break}Ji(e,Mr,qs);break;case 5:Ji(e,Mr,qs);break;default:throw Error(Oe(329))}}}return Rr(e,On()),e.callbackNode===n?Ax.bind(null,e):null}function Pf(e,t){var n=ul;return e.current.memoizedState.isDehydrated&&(to(e,t).flags|=256),e=hu(e,t),e!==2&&(t=Mr,Mr=n,t!==null&&Rf(t)),e}function Rf(e){Mr===null?Mr=e:Mr.push.apply(Mr,e)}function Hb(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!ks(a(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ii(e,t){for(t&=~Ep,t&=~Iu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-bs(t),r=1<<n;e[n]=-1,t&=~r}}function V0(e){if(Xt&6)throw Error(Oe(327));qo();var t=Zc(e,0);if(!(t&1))return Rr(e,On()),null;var n=hu(e,t);if(e.tag!==0&&n===2){var r=af(e);r!==0&&(t=r,n=Pf(e,r))}if(n===1)throw n=Il,to(e,0),Ii(e,t),Rr(e,On()),n;if(n===6)throw Error(Oe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ji(e,Mr,qs),Rr(e,On()),null}function Tp(e,t){var n=Xt;Xt|=1;try{return e(t)}finally{Xt=n,Xt===0&&(ia=On()+500,Nu&&Vi())}}function ao(e){Mi!==null&&Mi.tag===0&&!(Xt&6)&&qo();var t=Xt;Xt|=1;var n=ss.transition,r=ln;try{if(ss.transition=null,ln=1,e)return e()}finally{ln=r,ss.transition=n,Xt=t,!(Xt&6)&&Vi()}}function Mp(){Ur=Ko.current,vn(Ko)}function to(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,vb(n)),Fn!==null)for(n=Fn.return;n!==null;){var r=n;switch(fp(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&tu();break;case 3:ra(),vn(Ar),vn(hr),wp();break;case 5:bp(r);break;case 4:ra();break;case 13:vn(_n);break;case 19:vn(_n);break;case 10:gp(r.type._context);break;case 22:case 23:Mp()}n=n.return}if(qn=e,Fn=e=Ui(e.current,null),ir=Ur=t,Vn=0,Il=null,Ep=Iu=oo=0,Mr=ul=null,Qi!==null){for(t=0;t<Qi.length;t++)if(n=Qi[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,a=n.pending;if(a!==null){var l=a.next;a.next=i,r.next=l}n.pending=r}Qi=null}return e}function Px(e,t){do{var n=Fn;try{if(mp(),Oc.current=uu,cu){for(var r=Nn.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}cu=!1}if(io=0,Jn=Wn=Nn=null,ll=!1,Sl=0,Cp.current=null,n===null||n.return===null){Vn=1,Il=t,Fn=null;break}e:{var a=e,l=n.return,u=n,d=t;if(t=ir,u.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){var y=d,j=u,_=j.tag;if(!(j.mode&1)&&(_===0||_===11||_===15)){var k=j.alternate;k?(j.updateQueue=k.updateQueue,j.memoizedState=k.memoizedState,j.lanes=k.lanes):(j.updateQueue=null,j.memoizedState=null)}var b=M0(l);if(b!==null){b.flags&=-257,$0(b,l,u,a,t),b.mode&1&&T0(a,y,t),t=b,d=y;var E=t.updateQueue;if(E===null){var z=new Set;z.add(d),t.updateQueue=z}else E.add(d);break e}else{if(!(t&1)){T0(a,y,t),$p();break e}d=Error(Oe(426))}}else if(zn&&u.mode&1){var A=M0(l);if(A!==null){!(A.flags&65536)&&(A.flags|=256),$0(A,l,u,a,t),pp(sa(d,u));break e}}a=d=sa(d,u),Vn!==4&&(Vn=2),ul===null?ul=[a]:ul.push(a),a=l;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var x=yx(a,d,t);_0(a,x);break e;case 1:u=d;var g=a.type,S=a.stateNode;if(!(a.flags&128)&&(typeof g.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Li===null||!Li.has(S)))){a.flags|=65536,t&=-t,a.lanes|=t;var L=vx(a,u,t);_0(a,L);break e}}a=a.return}while(a!==null)}Lx(n)}catch(B){t=B,Fn===n&&n!==null&&(Fn=n=n.return);continue}break}while(!0)}function Rx(){var e=du.current;return du.current=uu,e===null?uu:e}function $p(){(Vn===0||Vn===3||Vn===2)&&(Vn=4),qn===null||!(oo&268435455)&&!(Iu&268435455)||Ii(qn,ir)}function hu(e,t){var n=Xt;Xt|=2;var r=Rx();(qn!==e||ir!==t)&&(qs=null,to(e,t));do try{Wb();break}catch(i){Px(e,i)}while(!0);if(mp(),Xt=n,du.current=r,Fn!==null)throw Error(Oe(261));return qn=null,ir=0,Vn}function Wb(){for(;Fn!==null;)Dx(Fn)}function Vb(){for(;Fn!==null&&!gv();)Dx(Fn)}function Dx(e){var t=Ux(e.alternate,e,Ur);e.memoizedProps=e.pendingProps,t===null?Lx(e):Fn=t,Cp.current=null}function Lx(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Lb(n,t),n!==null){n.flags&=32767,Fn=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Vn=6,Fn=null;return}}else if(n=Db(n,t,Ur),n!==null){Fn=n;return}if(t=t.sibling,t!==null){Fn=t;return}Fn=t=e}while(t!==null);Vn===0&&(Vn=5)}function Ji(e,t,n){var r=ln,i=ss.transition;try{ss.transition=null,ln=1,Kb(e,t,n,r)}finally{ss.transition=i,ln=r}return null}function Kb(e,t,n,r){do qo();while(Mi!==null);if(Xt&6)throw Error(Oe(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(Oe(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(Nv(e,a),e===qn&&(Fn=qn=null,ir=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||kc||(kc=!0,Fx(Xc,function(){return qo(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=ss.transition,ss.transition=null;var l=ln;ln=1;var u=Xt;Xt|=4,Cp.current=null,Ub(e,n),Mx(n,e),fb(pf),Jc=!!ff,pf=ff=null,e.current=n,Fb(n),xv(),Xt=u,ln=l,ss.transition=a}else e.current=n;if(kc&&(kc=!1,Mi=e,pu=i),a=e.pendingLanes,a===0&&(Li=null),bv(n.stateNode),Rr(e,On()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(fu)throw fu=!1,e=$f,$f=null,e;return pu&1&&e.tag!==0&&qo(),a=e.pendingLanes,a&1?e===Af?dl++:(dl=0,Af=e):dl=0,Vi(),null}function qo(){if(Mi!==null){var e=yg(pu),t=ss.transition,n=ln;try{if(ss.transition=null,ln=16>e?16:e,Mi===null)var r=!1;else{if(e=Mi,Mi=null,pu=0,Xt&6)throw Error(Oe(331));var i=Xt;for(Xt|=4,lt=e.current;lt!==null;){var a=lt,l=a.child;if(lt.flags&16){var u=a.deletions;if(u!==null){for(var d=0;d<u.length;d++){var y=u[d];for(lt=y;lt!==null;){var j=lt;switch(j.tag){case 0:case 11:case 15:cl(8,j,a)}var _=j.child;if(_!==null)_.return=j,lt=_;else for(;lt!==null;){j=lt;var k=j.sibling,b=j.return;if(Ex(j),j===y){lt=null;break}if(k!==null){k.return=b,lt=k;break}lt=b}}}var E=a.alternate;if(E!==null){var z=E.child;if(z!==null){E.child=null;do{var A=z.sibling;z.sibling=null,z=A}while(z!==null)}}lt=a}}if(a.subtreeFlags&2064&&l!==null)l.return=a,lt=l;else e:for(;lt!==null;){if(a=lt,a.flags&2048)switch(a.tag){case 0:case 11:case 15:cl(9,a,a.return)}var x=a.sibling;if(x!==null){x.return=a.return,lt=x;break e}lt=a.return}}var g=e.current;for(lt=g;lt!==null;){l=lt;var S=l.child;if(l.subtreeFlags&2064&&S!==null)S.return=l,lt=S;else e:for(l=g;lt!==null;){if(u=lt,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:Eu(9,u)}}catch(B){$n(u,u.return,B)}if(u===l){lt=null;break e}var L=u.sibling;if(L!==null){L.return=u.return,lt=L;break e}lt=u.return}}if(Xt=i,Vi(),Ds&&typeof Ds.onPostCommitFiberRoot=="function")try{Ds.onPostCommitFiberRoot(wu,e)}catch{}r=!0}return r}finally{ln=n,ss.transition=t}}return!1}function K0(e,t,n){t=sa(n,t),t=yx(e,t,1),e=Di(e,t,1),t=wr(),e!==null&&(Ml(e,1,t),Rr(e,t))}function $n(e,t,n){if(e.tag===3)K0(e,e,n);else for(;t!==null;){if(t.tag===3){K0(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Li===null||!Li.has(r))){e=sa(n,e),e=vx(t,e,1),t=Di(t,e,1),e=wr(),t!==null&&(Ml(t,1,e),Rr(t,e));break}}t=t.return}}function Yb(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=wr(),e.pingedLanes|=e.suspendedLanes&n,qn===e&&(ir&n)===n&&(Vn===4||Vn===3&&(ir&130023424)===ir&&500>On()-Ip?to(e,0):Ep|=n),Rr(e,t)}function Ox(e,t){t===0&&(e.mode&1?(t=fc,fc<<=1,!(fc&130023424)&&(fc=4194304)):t=1);var n=wr();e=ai(e,t),e!==null&&(Ml(e,t,n),Rr(e,n))}function Gb(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Ox(e,n)}function Xb(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(Oe(314))}r!==null&&r.delete(t),Ox(e,n)}var Ux;Ux=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ar.current)$r=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return $r=!1,Rb(e,t,n);$r=!!(e.flags&131072)}else $r=!1,zn&&t.flags&1048576&&Wg(t,su,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Fc(e,t),e=t.pendingProps;var i=ea(t,hr.current);Jo(t,n),i=zp(null,t,r,e,i,n);var a=jp();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Pr(r)?(a=!0,nu(t)):a=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,yp(t),i.updater=Cu,t.stateNode=i,i._reactInternals=t,kf(t,r,e,n),t=_f(null,t,r,!0,a,n)):(t.tag=0,zn&&a&&dp(t),br(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Fc(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=Jb(r),e=xs(r,e),i){case 0:t=jf(null,t,r,e,n);break e;case 1:t=R0(null,t,r,e,n);break e;case 11:t=A0(null,t,r,e,n);break e;case 14:t=P0(null,t,r,xs(r.type,e),n);break e}throw Error(Oe(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:xs(r,i),jf(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:xs(r,i),R0(e,t,r,i,n);case 3:e:{if(zx(t),e===null)throw Error(Oe(387));r=t.pendingProps,a=t.memoizedState,i=a.element,Zg(e,t),au(t,r,null,n);var l=t.memoizedState;if(r=l.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){i=sa(Error(Oe(423)),t),t=D0(e,t,r,n,i);break e}else if(r!==i){i=sa(Error(Oe(424)),t),t=D0(e,t,r,n,i);break e}else for(Br=Ri(t.stateNode.containerInfo.firstChild),Hr=t,zn=!0,vs=null,n=Gg(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ta(),r===i){t=li(e,t,n);break e}br(e,t,r,n)}t=t.child}return t;case 5:return Jg(t),e===null&&vf(t),r=t.type,i=t.pendingProps,a=e!==null?e.memoizedProps:null,l=i.children,hf(r,i)?l=null:a!==null&&hf(r,a)&&(t.flags|=32),kx(e,t),br(e,t,l,n),t.child;case 6:return e===null&&vf(t),null;case 13:return jx(e,t,n);case 4:return vp(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=na(t,null,r,n):br(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:xs(r,i),A0(e,t,r,i,n);case 7:return br(e,t,t.pendingProps,n),t.child;case 8:return br(e,t,t.pendingProps.children,n),t.child;case 12:return br(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,a=t.memoizedProps,l=i.value,hn(iu,r._currentValue),r._currentValue=l,a!==null)if(ks(a.value,l)){if(a.children===i.children&&!Ar.current){t=li(e,t,n);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var u=a.dependencies;if(u!==null){l=a.child;for(var d=u.firstContext;d!==null;){if(d.context===r){if(a.tag===1){d=si(-1,n&-n),d.tag=2;var y=a.updateQueue;if(y!==null){y=y.shared;var j=y.pending;j===null?d.next=d:(d.next=j.next,j.next=d),y.pending=d}}a.lanes|=n,d=a.alternate,d!==null&&(d.lanes|=n),bf(a.return,n,t),u.lanes|=n;break}d=d.next}}else if(a.tag===10)l=a.type===t.type?null:a.child;else if(a.tag===18){if(l=a.return,l===null)throw Error(Oe(341));l.lanes|=n,u=l.alternate,u!==null&&(u.lanes|=n),bf(l,n,t),l=a.sibling}else l=a.child;if(l!==null)l.return=a;else for(l=a;l!==null;){if(l===t){l=null;break}if(a=l.sibling,a!==null){a.return=l.return,l=a;break}l=l.return}a=l}br(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Jo(t,n),i=is(i),r=r(i),t.flags|=1,br(e,t,r,n),t.child;case 14:return r=t.type,i=xs(r,t.pendingProps),i=xs(r.type,i),P0(e,t,r,i,n);case 15:return bx(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:xs(r,i),Fc(e,t),t.tag=1,Pr(r)?(e=!0,nu(t)):e=!1,Jo(t,n),xx(t,r,i),kf(t,r,i,n),_f(null,t,r,!0,e,n);case 19:return _x(e,t,n);case 22:return wx(e,t,n)}throw Error(Oe(156,t.tag))};function Fx(e,t){return hg(e,t)}function Zb(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function rs(e,t,n,r){return new Zb(e,t,n,r)}function Ap(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Jb(e){if(typeof e=="function")return Ap(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Qf)return 11;if(e===ep)return 14}return 2}function Ui(e,t){var n=e.alternate;return n===null?(n=rs(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Wc(e,t,n,r,i,a){var l=2;if(r=e,typeof e=="function")Ap(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case Ro:return no(n.children,i,a,t);case qf:l=8,i|=8;break;case Vd:return e=rs(12,n,t,i|2),e.elementType=Vd,e.lanes=a,e;case Kd:return e=rs(13,n,t,i),e.elementType=Kd,e.lanes=a,e;case Yd:return e=rs(19,n,t,i),e.elementType=Yd,e.lanes=a,e;case Jm:return Tu(n,i,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Xm:l=10;break e;case Zm:l=9;break e;case Qf:l=11;break e;case ep:l=14;break e;case Si:l=16,r=null;break e}throw Error(Oe(130,e==null?e:typeof e,""))}return t=rs(l,n,t,i),t.elementType=e,t.type=r,t.lanes=a,t}function no(e,t,n,r){return e=rs(7,e,r,t),e.lanes=n,e}function Tu(e,t,n,r){return e=rs(22,e,r,t),e.elementType=Jm,e.lanes=n,e.stateNode={isHidden:!1},e}function Ed(e,t,n){return e=rs(6,e,null,t),e.lanes=n,e}function Id(e,t,n){return t=rs(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function qb(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ud(0),this.expirationTimes=ud(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ud(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Pp(e,t,n,r,i,a,l,u,d){return e=new qb(e,t,n,u,d),t===1?(t=1,a===!0&&(t|=8)):t=0,a=rs(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},yp(a),e}function Qb(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Po,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Bx(e){if(!e)return Bi;e=e._reactInternals;e:{if(fo(e)!==e||e.tag!==1)throw Error(Oe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Pr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Oe(171))}if(e.tag===1){var n=e.type;if(Pr(n))return Bg(e,n,t)}return t}function Hx(e,t,n,r,i,a,l,u,d){return e=Pp(n,r,!0,e,i,a,l,u,d),e.context=Bx(null),n=e.current,r=wr(),i=Oi(n),a=si(r,i),a.callback=t??null,Di(n,a,i),e.current.lanes=i,Ml(e,i,r),Rr(e,r),e}function Mu(e,t,n,r){var i=t.current,a=wr(),l=Oi(i);return n=Bx(n),t.context===null?t.context=n:t.pendingContext=n,t=si(a,l),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Di(i,t,l),e!==null&&(ws(e,i,l,a),Lc(e,i,l)),l}function mu(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Y0(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Rp(e,t){Y0(e,t),(e=e.alternate)&&Y0(e,t)}function ew(){return null}var Wx=typeof reportError=="function"?reportError:function(e){console.error(e)};function Dp(e){this._internalRoot=e}$u.prototype.render=Dp.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Oe(409));Mu(e,t,null,null)};$u.prototype.unmount=Dp.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ao(function(){Mu(null,e,null,null)}),t[oi]=null}};function $u(e){this._internalRoot=e}$u.prototype.unstable_scheduleHydration=function(e){if(e){var t=wg();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ei.length&&t!==0&&t<Ei[n].priority;n++);Ei.splice(n,0,e),n===0&&zg(e)}};function Lp(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Au(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function G0(){}function tw(e,t,n,r,i){if(i){if(typeof r=="function"){var a=r;r=function(){var y=mu(l);a.call(y)}}var l=Hx(t,r,e,0,null,!1,!1,"",G0);return e._reactRootContainer=l,e[oi]=l.current,kl(e.nodeType===8?e.parentNode:e),ao(),l}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var u=r;r=function(){var y=mu(d);u.call(y)}}var d=Pp(e,0,!1,null,null,!1,!1,"",G0);return e._reactRootContainer=d,e[oi]=d.current,kl(e.nodeType===8?e.parentNode:e),ao(function(){Mu(t,d,n,r)}),d}function Pu(e,t,n,r,i){var a=n._reactRootContainer;if(a){var l=a;if(typeof i=="function"){var u=i;i=function(){var d=mu(l);u.call(d)}}Mu(t,l,e,i)}else l=tw(n,t,e,i,r);return mu(l)}vg=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=qa(t.pendingLanes);n!==0&&(rp(t,n|1),Rr(t,On()),!(Xt&6)&&(ia=On()+500,Vi()))}break;case 13:ao(function(){var r=ai(e,1);if(r!==null){var i=wr();ws(r,e,1,i)}}),Rp(e,1)}};sp=function(e){if(e.tag===13){var t=ai(e,134217728);if(t!==null){var n=wr();ws(t,e,134217728,n)}Rp(e,134217728)}};bg=function(e){if(e.tag===13){var t=Oi(e),n=ai(e,t);if(n!==null){var r=wr();ws(n,e,t,r)}Rp(e,t)}};wg=function(){return ln};kg=function(e,t){var n=ln;try{return ln=e,t()}finally{ln=n}};rf=function(e,t,n){switch(t){case"input":if(Zd(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=_u(r);if(!i)throw Error(Oe(90));Qm(r),Zd(r,i)}}}break;case"textarea":tg(e,n);break;case"select":t=n.value,t!=null&&Yo(e,!!n.multiple,t,!1)}};lg=Tp;cg=ao;var nw={usingClientEntryPoint:!1,Events:[Al,Uo,_u,og,ag,Tp]},Oa={findFiberByHostInstance:qi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},rw={bundleType:Oa.bundleType,version:Oa.version,rendererPackageName:Oa.rendererPackageName,rendererConfig:Oa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ci.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=fg(e),e===null?null:e.stateNode},findFiberByHostInstance:Oa.findFiberByHostInstance||ew,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zc.isDisabled&&zc.supportsFiber)try{wu=zc.inject(rw),Ds=zc}catch{}}Vr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nw;Vr.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Lp(t))throw Error(Oe(200));return Qb(e,t,null,n)};Vr.createRoot=function(e,t){if(!Lp(e))throw Error(Oe(299));var n=!1,r="",i=Wx;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=Pp(e,1,!1,null,null,n,!1,r,i),e[oi]=t.current,kl(e.nodeType===8?e.parentNode:e),new Dp(t)};Vr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Oe(188)):(e=Object.keys(e).join(","),Error(Oe(268,e)));return e=fg(t),e=e===null?null:e.stateNode,e};Vr.flushSync=function(e){return ao(e)};Vr.hydrate=function(e,t,n){if(!Au(t))throw Error(Oe(200));return Pu(null,e,t,!0,n)};Vr.hydrateRoot=function(e,t,n){if(!Lp(e))throw Error(Oe(405));var r=n!=null&&n.hydratedSources||null,i=!1,a="",l=Wx;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(l=n.onRecoverableError)),t=Hx(t,null,e,1,n??null,i,!1,a,l),e[oi]=t.current,kl(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new $u(t)};Vr.render=function(e,t,n){if(!Au(t))throw Error(Oe(200));return Pu(null,e,t,!1,n)};Vr.unmountComponentAtNode=function(e){if(!Au(e))throw Error(Oe(40));return e._reactRootContainer?(ao(function(){Pu(null,null,e,!1,function(){e._reactRootContainer=null,e[oi]=null})}),!0):!1};Vr.unstable_batchedUpdates=Tp;Vr.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Au(n))throw Error(Oe(200));if(e==null||e._reactInternals===void 0)throw Error(Oe(38));return Pu(e,t,n,!1,r)};Vr.version="18.3.1-next-f1338f8080-20240426";function Vx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Vx)}catch(e){console.error(e)}}Vx(),Vm.exports=Vr;var sw=Vm.exports,X0=sw;Hd.createRoot=X0.createRoot,Hd.hydrateRoot=X0.hydrateRoot;function Op(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let po=Op();function Kx(e){po=e}const Yx=/[&<>"']/,iw=new RegExp(Yx.source,"g"),Gx=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,ow=new RegExp(Gx.source,"g"),aw={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Z0=e=>aw[e];function Fr(e,t){if(t){if(Yx.test(e))return e.replace(iw,Z0)}else if(Gx.test(e))return e.replace(ow,Z0);return e}const lw=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function cw(e){return e.replace(lw,(t,n)=>(n=n.toLowerCase(),n==="colon"?":":n.charAt(0)==="#"?n.charAt(1)==="x"?String.fromCharCode(parseInt(n.substring(2),16)):String.fromCharCode(+n.substring(1)):""))}const uw=/(^|[^\[])\^/g;function cn(e,t){let n=typeof e=="string"?e:e.source;t=t||"";const r={replace:(i,a)=>{let l=typeof a=="string"?a:a.source;return l=l.replace(uw,"$1"),n=n.replace(i,l),r},getRegex:()=>new RegExp(n,t)};return r}function J0(e){try{e=encodeURI(e).replace(/%25/g,"%")}catch{return null}return e}const fl={exec:()=>null};function q0(e,t){const n=e.replace(/\|/g,(a,l,u)=>{let d=!1,y=l;for(;--y>=0&&u[y]==="\\";)d=!d;return d?"|":" |"}),r=n.split(/ \|/);let i=0;if(r[0].trim()||r.shift(),r.length>0&&!r[r.length-1].trim()&&r.pop(),t)if(r.length>t)r.splice(t);else for(;r.length<t;)r.push("");for(;i<r.length;i++)r[i]=r[i].trim().replace(/\\\|/g,"|");return r}function jc(e,t,n){const r=e.length;if(r===0)return"";let i=0;for(;i<r&&e.charAt(r-i-1)===t;)i++;return e.slice(0,r-i)}function dw(e,t){if(e.indexOf(t[1])===-1)return-1;let n=0;for(let r=0;r<e.length;r++)if(e[r]==="\\")r++;else if(e[r]===t[0])n++;else if(e[r]===t[1]&&(n--,n<0))return r;return-1}function Q0(e,t,n,r){const i=t.href,a=t.title?Fr(t.title):null,l=e[1].replace(/\\([\[\]])/g,"$1");if(e[0].charAt(0)!=="!"){r.state.inLink=!0;const u={type:"link",raw:n,href:i,title:a,text:l,tokens:r.inlineTokens(l)};return r.state.inLink=!1,u}return{type:"image",raw:n,href:i,title:a,text:Fr(l)}}function fw(e,t){const n=e.match(/^(\s+)(?:```)/);if(n===null)return t;const r=n[1];return t.split(`
`).map(i=>{const a=i.match(/^\s+/);if(a===null)return i;const[l]=a;return l.length>=r.length?i.slice(r.length):i}).join(`
`)}class gu{constructor(t){xn(this,"options");xn(this,"rules");xn(this,"lexer");this.options=t||po}space(t){const n=this.rules.block.newline.exec(t);if(n&&n[0].length>0)return{type:"space",raw:n[0]}}code(t){const n=this.rules.block.code.exec(t);if(n){const r=n[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:n[0],codeBlockStyle:"indented",text:this.options.pedantic?r:jc(r,`
`)}}}fences(t){const n=this.rules.block.fences.exec(t);if(n){const r=n[0],i=fw(r,n[3]||"");return{type:"code",raw:r,lang:n[2]?n[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):n[2],text:i}}}heading(t){const n=this.rules.block.heading.exec(t);if(n){let r=n[2].trim();if(/#$/.test(r)){const i=jc(r,"#");(this.options.pedantic||!i||/ $/.test(i))&&(r=i.trim())}return{type:"heading",raw:n[0],depth:n[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(t){const n=this.rules.block.hr.exec(t);if(n)return{type:"hr",raw:n[0]}}blockquote(t){const n=this.rules.block.blockquote.exec(t);if(n){let r=n[0].replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`);r=jc(r.replace(/^ *>[ \t]?/gm,""),`
`);const i=this.lexer.state.top;this.lexer.state.top=!0;const a=this.lexer.blockTokens(r);return this.lexer.state.top=i,{type:"blockquote",raw:n[0],tokens:a,text:r}}}list(t){let n=this.rules.block.list.exec(t);if(n){let r=n[1].trim();const i=r.length>1,a={type:"list",raw:"",ordered:i,start:i?+r.slice(0,-1):"",loose:!1,items:[]};r=i?`\\d{1,9}\\${r.slice(-1)}`:`\\${r}`,this.options.pedantic&&(r=i?r:"[*+-]");const l=new RegExp(`^( {0,3}${r})((?:[	 ][^\\n]*)?(?:\\n|$))`);let u="",d="",y=!1;for(;t;){let j=!1;if(!(n=l.exec(t))||this.rules.block.hr.test(t))break;u=n[0],t=t.substring(u.length);let _=n[2].split(`
`,1)[0].replace(/^\t+/,x=>" ".repeat(3*x.length)),k=t.split(`
`,1)[0],b=0;this.options.pedantic?(b=2,d=_.trimStart()):(b=n[2].search(/[^ ]/),b=b>4?1:b,d=_.slice(b),b+=n[1].length);let E=!1;if(!_&&/^ *$/.test(k)&&(u+=k+`
`,t=t.substring(k.length+1),j=!0),!j){const x=new RegExp(`^ {0,${Math.min(3,b-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),g=new RegExp(`^ {0,${Math.min(3,b-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),S=new RegExp(`^ {0,${Math.min(3,b-1)}}(?:\`\`\`|~~~)`),L=new RegExp(`^ {0,${Math.min(3,b-1)}}#`);for(;t;){const B=t.split(`
`,1)[0];if(k=B,this.options.pedantic&&(k=k.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),S.test(k)||L.test(k)||x.test(k)||g.test(t))break;if(k.search(/[^ ]/)>=b||!k.trim())d+=`
`+k.slice(b);else{if(E||_.search(/[^ ]/)>=4||S.test(_)||L.test(_)||g.test(_))break;d+=`
`+k}!E&&!k.trim()&&(E=!0),u+=B+`
`,t=t.substring(B.length+1),_=k.slice(b)}}a.loose||(y?a.loose=!0:/\n *\n *$/.test(u)&&(y=!0));let z=null,A;this.options.gfm&&(z=/^\[[ xX]\] /.exec(d),z&&(A=z[0]!=="[ ] ",d=d.replace(/^\[[ xX]\] +/,""))),a.items.push({type:"list_item",raw:u,task:!!z,checked:A,loose:!1,text:d,tokens:[]}),a.raw+=u}a.items[a.items.length-1].raw=u.trimEnd(),a.items[a.items.length-1].text=d.trimEnd(),a.raw=a.raw.trimEnd();for(let j=0;j<a.items.length;j++)if(this.lexer.state.top=!1,a.items[j].tokens=this.lexer.blockTokens(a.items[j].text,[]),!a.loose){const _=a.items[j].tokens.filter(b=>b.type==="space"),k=_.length>0&&_.some(b=>/\n.*\n/.test(b.raw));a.loose=k}if(a.loose)for(let j=0;j<a.items.length;j++)a.items[j].loose=!0;return a}}html(t){const n=this.rules.block.html.exec(t);if(n)return{type:"html",block:!0,raw:n[0],pre:n[1]==="pre"||n[1]==="script"||n[1]==="style",text:n[0]}}def(t){const n=this.rules.block.def.exec(t);if(n){const r=n[1].toLowerCase().replace(/\s+/g," "),i=n[2]?n[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",a=n[3]?n[3].substring(1,n[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):n[3];return{type:"def",tag:r,raw:n[0],href:i,title:a}}}table(t){const n=this.rules.block.table.exec(t);if(!n||!/[:|]/.test(n[2]))return;const r=q0(n[1]),i=n[2].replace(/^\||\| *$/g,"").split("|"),a=n[3]&&n[3].trim()?n[3].replace(/\n[ \t]*$/,"").split(`
`):[],l={type:"table",raw:n[0],header:[],align:[],rows:[]};if(r.length===i.length){for(const u of i)/^ *-+: *$/.test(u)?l.align.push("right"):/^ *:-+: *$/.test(u)?l.align.push("center"):/^ *:-+ *$/.test(u)?l.align.push("left"):l.align.push(null);for(const u of r)l.header.push({text:u,tokens:this.lexer.inline(u)});for(const u of a)l.rows.push(q0(u,l.header.length).map(d=>({text:d,tokens:this.lexer.inline(d)})));return l}}lheading(t){const n=this.rules.block.lheading.exec(t);if(n)return{type:"heading",raw:n[0],depth:n[2].charAt(0)==="="?1:2,text:n[1],tokens:this.lexer.inline(n[1])}}paragraph(t){const n=this.rules.block.paragraph.exec(t);if(n){const r=n[1].charAt(n[1].length-1)===`
`?n[1].slice(0,-1):n[1];return{type:"paragraph",raw:n[0],text:r,tokens:this.lexer.inline(r)}}}text(t){const n=this.rules.block.text.exec(t);if(n)return{type:"text",raw:n[0],text:n[0],tokens:this.lexer.inline(n[0])}}escape(t){const n=this.rules.inline.escape.exec(t);if(n)return{type:"escape",raw:n[0],text:Fr(n[1])}}tag(t){const n=this.rules.inline.tag.exec(t);if(n)return!this.lexer.state.inLink&&/^<a /i.test(n[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(n[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(n[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(n[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:n[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:n[0]}}link(t){const n=this.rules.inline.link.exec(t);if(n){const r=n[2].trim();if(!this.options.pedantic&&/^</.test(r)){if(!/>$/.test(r))return;const l=jc(r.slice(0,-1),"\\");if((r.length-l.length)%2===0)return}else{const l=dw(n[2],"()");if(l>-1){const d=(n[0].indexOf("!")===0?5:4)+n[1].length+l;n[2]=n[2].substring(0,l),n[0]=n[0].substring(0,d).trim(),n[3]=""}}let i=n[2],a="";if(this.options.pedantic){const l=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(i);l&&(i=l[1],a=l[3])}else a=n[3]?n[3].slice(1,-1):"";return i=i.trim(),/^</.test(i)&&(this.options.pedantic&&!/>$/.test(r)?i=i.slice(1):i=i.slice(1,-1)),Q0(n,{href:i&&i.replace(this.rules.inline.anyPunctuation,"$1"),title:a&&a.replace(this.rules.inline.anyPunctuation,"$1")},n[0],this.lexer)}}reflink(t,n){let r;if((r=this.rules.inline.reflink.exec(t))||(r=this.rules.inline.nolink.exec(t))){const i=(r[2]||r[1]).replace(/\s+/g," "),a=n[i.toLowerCase()];if(!a){const l=r[0].charAt(0);return{type:"text",raw:l,text:l}}return Q0(r,a,r[0],this.lexer)}}emStrong(t,n,r=""){let i=this.rules.inline.emStrongLDelim.exec(t);if(!i||i[3]&&r.match(/[\p{L}\p{N}]/u))return;if(!(i[1]||i[2]||"")||!r||this.rules.inline.punctuation.exec(r)){const l=[...i[0]].length-1;let u,d,y=l,j=0;const _=i[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(_.lastIndex=0,n=n.slice(-1*t.length+l);(i=_.exec(n))!=null;){if(u=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!u)continue;if(d=[...u].length,i[3]||i[4]){y+=d;continue}else if((i[5]||i[6])&&l%3&&!((l+d)%3)){j+=d;continue}if(y-=d,y>0)continue;d=Math.min(d,d+y+j);const k=[...i[0]][0].length,b=t.slice(0,l+i.index+k+d);if(Math.min(l,d)%2){const z=b.slice(1,-1);return{type:"em",raw:b,text:z,tokens:this.lexer.inlineTokens(z)}}const E=b.slice(2,-2);return{type:"strong",raw:b,text:E,tokens:this.lexer.inlineTokens(E)}}}}codespan(t){const n=this.rules.inline.code.exec(t);if(n){let r=n[2].replace(/\n/g," ");const i=/[^ ]/.test(r),a=/^ /.test(r)&&/ $/.test(r);return i&&a&&(r=r.substring(1,r.length-1)),r=Fr(r,!0),{type:"codespan",raw:n[0],text:r}}}br(t){const n=this.rules.inline.br.exec(t);if(n)return{type:"br",raw:n[0]}}del(t){const n=this.rules.inline.del.exec(t);if(n)return{type:"del",raw:n[0],text:n[2],tokens:this.lexer.inlineTokens(n[2])}}autolink(t){const n=this.rules.inline.autolink.exec(t);if(n){let r,i;return n[2]==="@"?(r=Fr(n[1]),i="mailto:"+r):(r=Fr(n[1]),i=r),{type:"link",raw:n[0],text:r,href:i,tokens:[{type:"text",raw:r,text:r}]}}}url(t){var r;let n;if(n=this.rules.inline.url.exec(t)){let i,a;if(n[2]==="@")i=Fr(n[0]),a="mailto:"+i;else{let l;do l=n[0],n[0]=((r=this.rules.inline._backpedal.exec(n[0]))==null?void 0:r[0])??"";while(l!==n[0]);i=Fr(n[0]),n[1]==="www."?a="http://"+n[0]:a=n[0]}return{type:"link",raw:n[0],text:i,href:a,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(t){const n=this.rules.inline.text.exec(t);if(n){let r;return this.lexer.state.inRawBlock?r=n[0]:r=Fr(n[0]),{type:"text",raw:n[0],text:r}}}}const pw=/^(?: *(?:\n|$))+/,hw=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,mw=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Rl=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,gw=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Xx=/(?:[*+-]|\d{1,9}[.)])/,Zx=cn(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,Xx).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),Up=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,xw=/^[^\n]+/,Fp=/(?!\s*\])(?:\\.|[^\[\]\\])+/,yw=cn(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",Fp).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),vw=cn(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Xx).getRegex(),Ru="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Bp=/\x3C!--(?:-?>|[\s\S]*?(?:-->|$))/,bw=cn("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",Bp).replace("tag",Ru).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Jx=cn(Up).replace("hr",Rl).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ru).getRegex(),ww=cn(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Jx).getRegex(),Hp={blockquote:ww,code:hw,def:yw,fences:mw,heading:gw,hr:Rl,html:bw,lheading:Zx,list:vw,newline:pw,paragraph:Jx,table:fl,text:xw},em=cn("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Rl).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ru).getRegex(),kw={...Hp,table:em,paragraph:cn(Up).replace("hr",Rl).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",em).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ru).getRegex()},zw={...Hp,html:cn(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Bp).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:fl,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:cn(Up).replace("hr",Rl).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Zx).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},qx=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,jw=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Qx=/^( {2,}|\\)\n(?!\s*$)/,_w=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Dl="\\p{P}\\p{S}",Nw=cn(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,Dl).getRegex(),Sw=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,Cw=cn(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,Dl).getRegex(),Ew=cn("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,Dl).getRegex(),Iw=cn("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,Dl).getRegex(),Tw=cn(/\\([punct])/,"gu").replace(/punct/g,Dl).getRegex(),Mw=cn(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),$w=cn(Bp).replace("(?:-->|$)","-->").getRegex(),Aw=cn("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",$w).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),xu=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Pw=cn(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",xu).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),ey=cn(/^!?\[(label)\]\[(ref)\]/).replace("label",xu).replace("ref",Fp).getRegex(),ty=cn(/^!?\[(ref)\](?:\[\])?/).replace("ref",Fp).getRegex(),Rw=cn("reflink|nolink(?!\\()","g").replace("reflink",ey).replace("nolink",ty).getRegex(),Wp={_backpedal:fl,anyPunctuation:Tw,autolink:Mw,blockSkip:Sw,br:Qx,code:jw,del:fl,emStrongLDelim:Cw,emStrongRDelimAst:Ew,emStrongRDelimUnd:Iw,escape:qx,link:Pw,nolink:ty,punctuation:Nw,reflink:ey,reflinkSearch:Rw,tag:Aw,text:_w,url:fl},Dw={...Wp,link:cn(/^!?\[(label)\]\((.*?)\)/).replace("label",xu).getRegex(),reflink:cn(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",xu).getRegex()},Df={...Wp,escape:cn(qx).replace("])","~|])").getRegex(),url:cn(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Lw={...Df,br:cn(Qx).replace("{2,}","*").getRegex(),text:cn(Df.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},_c={normal:Hp,gfm:kw,pedantic:zw},Ua={normal:Wp,gfm:Df,breaks:Lw,pedantic:Dw};class Ps{constructor(t){xn(this,"tokens");xn(this,"options");xn(this,"state");xn(this,"tokenizer");xn(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=t||po,this.options.tokenizer=this.options.tokenizer||new gu,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const n={block:_c.normal,inline:Ua.normal};this.options.pedantic?(n.block=_c.pedantic,n.inline=Ua.pedantic):this.options.gfm&&(n.block=_c.gfm,this.options.breaks?n.inline=Ua.breaks:n.inline=Ua.gfm),this.tokenizer.rules=n}static get rules(){return{block:_c,inline:Ua}}static lex(t,n){return new Ps(n).lex(t)}static lexInline(t,n){return new Ps(n).inlineTokens(t)}lex(t){t=t.replace(/\r\n|\r/g,`
`),this.blockTokens(t,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){const r=this.inlineQueue[n];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,n=[]){this.options.pedantic?t=t.replace(/\t/g,"    ").replace(/^ +$/gm,""):t=t.replace(/^( *)(\t+)/gm,(u,d,y)=>d+"    ".repeat(y.length));let r,i,a,l;for(;t;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(u=>(r=u.call({lexer:this},t,n))?(t=t.substring(r.raw.length),n.push(r),!0):!1))){if(r=this.tokenizer.space(t)){t=t.substring(r.raw.length),r.raw.length===1&&n.length>0?n[n.length-1].raw+=`
`:n.push(r);continue}if(r=this.tokenizer.code(t)){t=t.substring(r.raw.length),i=n[n.length-1],i&&(i.type==="paragraph"||i.type==="text")?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue[this.inlineQueue.length-1].src=i.text):n.push(r);continue}if(r=this.tokenizer.fences(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.heading(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.hr(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.blockquote(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.list(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.html(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.def(t)){t=t.substring(r.raw.length),i=n[n.length-1],i&&(i.type==="paragraph"||i.type==="text")?(i.raw+=`
`+r.raw,i.text+=`
`+r.raw,this.inlineQueue[this.inlineQueue.length-1].src=i.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});continue}if(r=this.tokenizer.table(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.lheading(t)){t=t.substring(r.raw.length),n.push(r);continue}if(a=t,this.options.extensions&&this.options.extensions.startBlock){let u=1/0;const d=t.slice(1);let y;this.options.extensions.startBlock.forEach(j=>{y=j.call({lexer:this},d),typeof y=="number"&&y>=0&&(u=Math.min(u,y))}),u<1/0&&u>=0&&(a=t.substring(0,u+1))}if(this.state.top&&(r=this.tokenizer.paragraph(a))){i=n[n.length-1],l&&i.type==="paragraph"?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):n.push(r),l=a.length!==t.length,t=t.substring(r.raw.length);continue}if(r=this.tokenizer.text(t)){t=t.substring(r.raw.length),i=n[n.length-1],i&&i.type==="text"?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):n.push(r);continue}if(t){const u="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return this.state.top=!0,n}inline(t,n=[]){return this.inlineQueue.push({src:t,tokens:n}),n}inlineTokens(t,n=[]){let r,i,a,l=t,u,d,y;if(this.tokens.links){const j=Object.keys(this.tokens.links);if(j.length>0)for(;(u=this.tokenizer.rules.inline.reflinkSearch.exec(l))!=null;)j.includes(u[0].slice(u[0].lastIndexOf("[")+1,-1))&&(l=l.slice(0,u.index)+"["+"a".repeat(u[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(u=this.tokenizer.rules.inline.blockSkip.exec(l))!=null;)l=l.slice(0,u.index)+"["+"a".repeat(u[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(u=this.tokenizer.rules.inline.anyPunctuation.exec(l))!=null;)l=l.slice(0,u.index)+"++"+l.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;t;)if(d||(y=""),d=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(j=>(r=j.call({lexer:this},t,n))?(t=t.substring(r.raw.length),n.push(r),!0):!1))){if(r=this.tokenizer.escape(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.tag(t)){t=t.substring(r.raw.length),i=n[n.length-1],i&&r.type==="text"&&i.type==="text"?(i.raw+=r.raw,i.text+=r.text):n.push(r);continue}if(r=this.tokenizer.link(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(r.raw.length),i=n[n.length-1],i&&r.type==="text"&&i.type==="text"?(i.raw+=r.raw,i.text+=r.text):n.push(r);continue}if(r=this.tokenizer.emStrong(t,l,y)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.codespan(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.br(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.del(t)){t=t.substring(r.raw.length),n.push(r);continue}if(r=this.tokenizer.autolink(t)){t=t.substring(r.raw.length),n.push(r);continue}if(!this.state.inLink&&(r=this.tokenizer.url(t))){t=t.substring(r.raw.length),n.push(r);continue}if(a=t,this.options.extensions&&this.options.extensions.startInline){let j=1/0;const _=t.slice(1);let k;this.options.extensions.startInline.forEach(b=>{k=b.call({lexer:this},_),typeof k=="number"&&k>=0&&(j=Math.min(j,k))}),j<1/0&&j>=0&&(a=t.substring(0,j+1))}if(r=this.tokenizer.inlineText(a)){t=t.substring(r.raw.length),r.raw.slice(-1)!=="_"&&(y=r.raw.slice(-1)),d=!0,i=n[n.length-1],i&&i.type==="text"?(i.raw+=r.raw,i.text+=r.text):n.push(r);continue}if(t){const j="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(j);break}else throw new Error(j)}}return n}}class yu{constructor(t){xn(this,"options");this.options=t||po}code(t,n,r){var a;const i=(a=(n||"").match(/^\S*/))==null?void 0:a[0];return t=t.replace(/\n$/,"")+`
`,i?'<pre><code class="language-'+Fr(i)+'">'+(r?t:Fr(t,!0))+`</code></pre>
`:"<pre><code>"+(r?t:Fr(t,!0))+`</code></pre>
`}blockquote(t){return`<blockquote>
${t}</blockquote>
`}html(t,n){return t}heading(t,n,r){return`<h${n}>${t}</h${n}>
`}hr(){return`<hr>
`}list(t,n,r){const i=n?"ol":"ul",a=n&&r!==1?' start="'+r+'"':"";return"<"+i+a+`>
`+t+"</"+i+`>
`}listitem(t,n,r){return`<li>${t}</li>
`}checkbox(t){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph(t){return`<p>${t}</p>
`}table(t,n){return n&&(n=`<tbody>${n}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+n+`</table>
`}tablerow(t){return`<tr>
${t}</tr>
`}tablecell(t,n){const r=n.header?"th":"td";return(n.align?`<${r} align="${n.align}">`:`<${r}>`)+t+`</${r}>
`}strong(t){return`<strong>${t}</strong>`}em(t){return`<em>${t}</em>`}codespan(t){return`<code>${t}</code>`}br(){return"<br>"}del(t){return`<del>${t}</del>`}link(t,n,r){const i=J0(t);if(i===null)return r;t=i;let a='<a href="'+t+'"';return n&&(a+=' title="'+n+'"'),a+=">"+r+"</a>",a}image(t,n,r){const i=J0(t);if(i===null)return r;t=i;let a=`<img src="${t}" alt="${r}"`;return n&&(a+=` title="${n}"`),a+=">",a}text(t){return t}}class Vp{strong(t){return t}em(t){return t}codespan(t){return t}del(t){return t}html(t){return t}text(t){return t}link(t,n,r){return""+r}image(t,n,r){return""+r}br(){return""}}class Rs{constructor(t){xn(this,"options");xn(this,"renderer");xn(this,"textRenderer");this.options=t||po,this.options.renderer=this.options.renderer||new yu,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new Vp}static parse(t,n){return new Rs(n).parse(t)}static parseInline(t,n){return new Rs(n).parseInline(t)}parse(t,n=!0){let r="";for(let i=0;i<t.length;i++){const a=t[i];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[a.type]){const l=a,u=this.options.extensions.renderers[l.type].call({parser:this},l);if(u!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(l.type)){r+=u||"";continue}}switch(a.type){case"space":continue;case"hr":{r+=this.renderer.hr();continue}case"heading":{const l=a;r+=this.renderer.heading(this.parseInline(l.tokens),l.depth,cw(this.parseInline(l.tokens,this.textRenderer)));continue}case"code":{const l=a;r+=this.renderer.code(l.text,l.lang,!!l.escaped);continue}case"table":{const l=a;let u="",d="";for(let j=0;j<l.header.length;j++)d+=this.renderer.tablecell(this.parseInline(l.header[j].tokens),{header:!0,align:l.align[j]});u+=this.renderer.tablerow(d);let y="";for(let j=0;j<l.rows.length;j++){const _=l.rows[j];d="";for(let k=0;k<_.length;k++)d+=this.renderer.tablecell(this.parseInline(_[k].tokens),{header:!1,align:l.align[k]});y+=this.renderer.tablerow(d)}r+=this.renderer.table(u,y);continue}case"blockquote":{const l=a,u=this.parse(l.tokens);r+=this.renderer.blockquote(u);continue}case"list":{const l=a,u=l.ordered,d=l.start,y=l.loose;let j="";for(let _=0;_<l.items.length;_++){const k=l.items[_],b=k.checked,E=k.task;let z="";if(k.task){const A=this.renderer.checkbox(!!b);y?k.tokens.length>0&&k.tokens[0].type==="paragraph"?(k.tokens[0].text=A+" "+k.tokens[0].text,k.tokens[0].tokens&&k.tokens[0].tokens.length>0&&k.tokens[0].tokens[0].type==="text"&&(k.tokens[0].tokens[0].text=A+" "+k.tokens[0].tokens[0].text)):k.tokens.unshift({type:"text",text:A+" "}):z+=A+" "}z+=this.parse(k.tokens,y),j+=this.renderer.listitem(z,E,!!b)}r+=this.renderer.list(j,u,d);continue}case"html":{const l=a;r+=this.renderer.html(l.text,l.block);continue}case"paragraph":{const l=a;r+=this.renderer.paragraph(this.parseInline(l.tokens));continue}case"text":{let l=a,u=l.tokens?this.parseInline(l.tokens):l.text;for(;i+1<t.length&&t[i+1].type==="text";)l=t[++i],u+=`
`+(l.tokens?this.parseInline(l.tokens):l.text);r+=n?this.renderer.paragraph(u):u;continue}default:{const l='Token with "'+a.type+'" type was not found.';if(this.options.silent)return console.error(l),"";throw new Error(l)}}}return r}parseInline(t,n){n=n||this.renderer;let r="";for(let i=0;i<t.length;i++){const a=t[i];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[a.type]){const l=this.options.extensions.renderers[a.type].call({parser:this},a);if(l!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type)){r+=l||"";continue}}switch(a.type){case"escape":{const l=a;r+=n.text(l.text);break}case"html":{const l=a;r+=n.html(l.text);break}case"link":{const l=a;r+=n.link(l.href,l.title,this.parseInline(l.tokens,n));break}case"image":{const l=a;r+=n.image(l.href,l.title,l.text);break}case"strong":{const l=a;r+=n.strong(this.parseInline(l.tokens,n));break}case"em":{const l=a;r+=n.em(this.parseInline(l.tokens,n));break}case"codespan":{const l=a;r+=n.codespan(l.text);break}case"br":{r+=n.br();break}case"del":{const l=a;r+=n.del(this.parseInline(l.tokens,n));break}case"text":{const l=a;r+=n.text(l.text);break}default:{const l='Token with "'+a.type+'" type was not found.';if(this.options.silent)return console.error(l),"";throw new Error(l)}}}return r}}class pl{constructor(t){xn(this,"options");this.options=t||po}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}}xn(pl,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));var co,Lf,ny;class Ow{constructor(...t){Uh(this,co);xn(this,"defaults",Op());xn(this,"options",this.setOptions);xn(this,"parse",oc(this,co,Lf).call(this,Ps.lex,Rs.parse));xn(this,"parseInline",oc(this,co,Lf).call(this,Ps.lexInline,Rs.parseInline));xn(this,"Parser",Rs);xn(this,"Renderer",yu);xn(this,"TextRenderer",Vp);xn(this,"Lexer",Ps);xn(this,"Tokenizer",gu);xn(this,"Hooks",pl);this.use(...t)}walkTokens(t,n){var i,a;let r=[];for(const l of t)switch(r=r.concat(n.call(this,l)),l.type){case"table":{const u=l;for(const d of u.header)r=r.concat(this.walkTokens(d.tokens,n));for(const d of u.rows)for(const y of d)r=r.concat(this.walkTokens(y.tokens,n));break}case"list":{const u=l;r=r.concat(this.walkTokens(u.items,n));break}default:{const u=l;(a=(i=this.defaults.extensions)==null?void 0:i.childTokens)!=null&&a[u.type]?this.defaults.extensions.childTokens[u.type].forEach(d=>{const y=u[d].flat(1/0);r=r.concat(this.walkTokens(y,n))}):u.tokens&&(r=r.concat(this.walkTokens(u.tokens,n)))}}return r}use(...t){const n=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(r=>{const i={...r};if(i.async=this.defaults.async||i.async||!1,r.extensions&&(r.extensions.forEach(a=>{if(!a.name)throw new Error("extension name required");if("renderer"in a){const l=n.renderers[a.name];l?n.renderers[a.name]=function(...u){let d=a.renderer.apply(this,u);return d===!1&&(d=l.apply(this,u)),d}:n.renderers[a.name]=a.renderer}if("tokenizer"in a){if(!a.level||a.level!=="block"&&a.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const l=n[a.level];l?l.unshift(a.tokenizer):n[a.level]=[a.tokenizer],a.start&&(a.level==="block"?n.startBlock?n.startBlock.push(a.start):n.startBlock=[a.start]:a.level==="inline"&&(n.startInline?n.startInline.push(a.start):n.startInline=[a.start]))}"childTokens"in a&&a.childTokens&&(n.childTokens[a.name]=a.childTokens)}),i.extensions=n),r.renderer){const a=this.defaults.renderer||new yu(this.defaults);for(const l in r.renderer){if(!(l in a))throw new Error(`renderer '${l}' does not exist`);if(l==="options")continue;const u=l,d=r.renderer[u],y=a[u];a[u]=(...j)=>{let _=d.apply(a,j);return _===!1&&(_=y.apply(a,j)),_||""}}i.renderer=a}if(r.tokenizer){const a=this.defaults.tokenizer||new gu(this.defaults);for(const l in r.tokenizer){if(!(l in a))throw new Error(`tokenizer '${l}' does not exist`);if(["options","rules","lexer"].includes(l))continue;const u=l,d=r.tokenizer[u],y=a[u];a[u]=(...j)=>{let _=d.apply(a,j);return _===!1&&(_=y.apply(a,j)),_}}i.tokenizer=a}if(r.hooks){const a=this.defaults.hooks||new pl;for(const l in r.hooks){if(!(l in a))throw new Error(`hook '${l}' does not exist`);if(l==="options")continue;const u=l,d=r.hooks[u],y=a[u];pl.passThroughHooks.has(l)?a[u]=j=>{if(this.defaults.async)return Promise.resolve(d.call(a,j)).then(k=>y.call(a,k));const _=d.call(a,j);return y.call(a,_)}:a[u]=(...j)=>{let _=d.apply(a,j);return _===!1&&(_=y.apply(a,j)),_}}i.hooks=a}if(r.walkTokens){const a=this.defaults.walkTokens,l=r.walkTokens;i.walkTokens=function(u){let d=[];return d.push(l.call(this,u)),a&&(d=d.concat(a.call(this,u))),d}}this.defaults={...this.defaults,...i}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,n){return Ps.lex(t,n??this.defaults)}parser(t,n){return Rs.parse(t,n??this.defaults)}}co=new WeakSet,Lf=function(t,n){return(r,i)=>{const a={...i},l={...this.defaults,...a};this.defaults.async===!0&&a.async===!1&&(l.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),l.async=!0);const u=oc(this,co,ny).call(this,!!l.silent,!!l.async);if(typeof r>"u"||r===null)return u(new Error("marked(): input parameter is undefined or null"));if(typeof r!="string")return u(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected"));if(l.hooks&&(l.hooks.options=l),l.async)return Promise.resolve(l.hooks?l.hooks.preprocess(r):r).then(d=>t(d,l)).then(d=>l.hooks?l.hooks.processAllTokens(d):d).then(d=>l.walkTokens?Promise.all(this.walkTokens(d,l.walkTokens)).then(()=>d):d).then(d=>n(d,l)).then(d=>l.hooks?l.hooks.postprocess(d):d).catch(u);try{l.hooks&&(r=l.hooks.preprocess(r));let d=t(r,l);l.hooks&&(d=l.hooks.processAllTokens(d)),l.walkTokens&&this.walkTokens(d,l.walkTokens);let y=n(d,l);return l.hooks&&(y=l.hooks.postprocess(y)),y}catch(d){return u(d)}}},ny=function(t,n){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,t){const i="<p>An error occurred:</p><pre>"+Fr(r.message+"",!0)+"</pre>";return n?Promise.resolve(i):i}if(n)return Promise.reject(r);throw r}};const lo=new Ow;function an(e,t){return lo.parse(e,t)}an.options=an.setOptions=function(e){return lo.setOptions(e),an.defaults=lo.defaults,Kx(an.defaults),an};an.getDefaults=Op;an.defaults=po;an.use=function(...e){return lo.use(...e),an.defaults=lo.defaults,Kx(an.defaults),an};an.walkTokens=function(e,t){return lo.walkTokens(e,t)};an.parseInline=lo.parseInline;an.Parser=Rs;an.parser=Rs.parse;an.Renderer=yu;an.TextRenderer=Vp;an.Lexer=Ps;an.lexer=Ps.lex;an.Tokenizer=gu;an.Hooks=pl;an.parse=an;an.options;an.setOptions;an.use;an.walkTokens;an.parseInline;Rs.parse;Ps.lex;/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:ry,setPrototypeOf:tm,isFrozen:Uw,getPrototypeOf:Fw,getOwnPropertyDescriptor:Bw}=Object;let{freeze:kr,seal:as,create:Of}=Object,{apply:Uf,construct:Ff}=typeof Reflect<"u"&&Reflect;kr||(kr=function(t){return t});as||(as=function(t){return t});Uf||(Uf=function(t,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];return t.apply(n,i)});Ff||(Ff=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return new t(...r)});const Nc=zr(Array.prototype.forEach),Hw=zr(Array.prototype.lastIndexOf),nm=zr(Array.prototype.pop),Fa=zr(Array.prototype.push),Ww=zr(Array.prototype.splice),Vc=zr(String.prototype.toLowerCase),Td=zr(String.prototype.toString),Md=zr(String.prototype.match),Ba=zr(String.prototype.replace),Vw=zr(String.prototype.indexOf),Kw=zr(String.prototype.trim),gs=zr(Object.prototype.hasOwnProperty),yr=zr(RegExp.prototype.test),Ha=Yw(TypeError);function zr(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return Uf(e,t,r)}}function Yw(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Ff(e,n)}}function Dt(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Vc;tm&&tm(e,null);let r=t.length;for(;r--;){let i=t[r];if(typeof i=="string"){const a=n(i);a!==i&&(Uw(t)||(t[r]=a),i=a)}e[i]=!0}return e}function Gw(e){for(let t=0;t<e.length;t++)gs(e,t)||(e[t]=null);return e}function Ts(e){const t=Of(null);for(const[n,r]of ry(e))gs(e,n)&&(Array.isArray(r)?t[n]=Gw(r):r&&typeof r=="object"&&r.constructor===Object?t[n]=Ts(r):t[n]=r);return t}function Wa(e,t){for(;e!==null;){const r=Bw(e,t);if(r){if(r.get)return zr(r.get);if(typeof r.value=="function")return zr(r.value)}e=Fw(e)}function n(){return null}return n}const rm=kr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),$d=kr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Ad=kr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Xw=kr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Pd=kr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Zw=kr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),sm=kr(["#text"]),im=kr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Rd=kr(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),om=kr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Sc=kr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Jw=as(/\{\{[\w\W]*|[\w\W]*\}\}/gm),qw=as(/<%[\w\W]*|[\w\W]*%>/gm),Qw=as(/\$\{[\w\W]*/gm),e2=as(/^data-[\-\w.\u00B7-\uFFFF]+$/),t2=as(/^aria-[\-\w]+$/),sy=as(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),n2=as(/^(?:\w+script|data):/i),r2=as(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),iy=as(/^html$/i),s2=as(/^[a-z][.\w]*(-[.\w]+)+$/i);var am=Object.freeze({__proto__:null,ARIA_ATTR:t2,ATTR_WHITESPACE:r2,CUSTOM_ELEMENT:s2,DATA_ATTR:e2,DOCTYPE_NAME:iy,ERB_EXPR:qw,IS_ALLOWED_URI:sy,IS_SCRIPT_OR_DATA:n2,MUSTACHE_EXPR:Jw,TMPLIT_EXPR:Qw});const Va={element:1,text:3,progressingInstruction:7,comment:8,document:9},i2=function(){return typeof window>"u"?null:window},o2=function(t,n){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const a="dompurify"+(r?"#"+r:"");try{return t.createPolicy(a,{createHTML(l){return l},createScriptURL(l){return l}})}catch{return console.warn("TrustedTypes policy "+a+" could not be created."),null}},lm=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function oy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:i2();const t=vt=>oy(vt);if(t.version="3.3.1",t.removed=[],!e||!e.document||e.document.nodeType!==Va.document||!e.Element)return t.isSupported=!1,t;let{document:n}=e;const r=n,i=r.currentScript,{DocumentFragment:a,HTMLTemplateElement:l,Node:u,Element:d,NodeFilter:y,NamedNodeMap:j=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:_,DOMParser:k,trustedTypes:b}=e,E=d.prototype,z=Wa(E,"cloneNode"),A=Wa(E,"remove"),x=Wa(E,"nextSibling"),g=Wa(E,"childNodes"),S=Wa(E,"parentNode");if(typeof l=="function"){const vt=n.createElement("template");vt.content&&vt.content.ownerDocument&&(n=vt.content.ownerDocument)}let L,B="";const{implementation:ie,createNodeIterator:J,createDocumentFragment:ue,getElementsByTagName:ce}=n,{importNode:me}=r;let Be=lm();t.isSupported=typeof ry=="function"&&typeof S=="function"&&ie&&ie.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:K,ERB_EXPR:xe,TMPLIT_EXPR:v,DATA_ATTR:ge,ARIA_ATTR:rt,IS_SCRIPT_OR_DATA:ze,ATTR_WHITESPACE:we,CUSTOM_ELEMENT:ae}=am;let{IS_ALLOWED_URI:Re}=am,X=null;const oe=Dt({},[...rm,...$d,...Ad,...Pd,...sm]);let Ve=null;const Ye=Dt({},[...im,...Rd,...om,...Sc]);let Ee=Object.seal(Of(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Lt=null,Zt=null;const Et=Object.seal(Of(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let Ht=!0,bn=!0,Yt=!1,Qn=!0,Un=!1,w=!0,je=!1,he=!1,F=!1,O=!1,ee=!1,Se=!1,Te=!0,Q=!1;const ye="user-content-";let Qe=!0,De=!1,it={},jt=null;const It=Dt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let ar=null;const Os=Dt({},["audio","video","img","source","image","track"]);let mr=null;const Us=Dt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),At="http://www.w3.org/1998/Math/MathML",er="http://www.w3.org/2000/svg",Cn="http://www.w3.org/1999/xhtml";let En=Cn,Dr=!1,ui=null;const Fs=Dt({},[At,er,Cn],Td);let Nr=Dt({},["mi","mo","mn","ms","mtext"]),Bs=Dt({},["annotation-xml"]);const Hs=Dt({},["title","style","font","a","script"]);let tr=null;const zs=["application/xhtml+xml","text/html"],di="text/html";let An=null,ls=null;const Ll=n.createElement("form"),Sr=function(V){return V instanceof RegExp||V instanceof Function},Pn=function(){let V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(ls&&ls===V)){if((!V||typeof V!="object")&&(V={}),V=Ts(V),tr=zs.indexOf(V.PARSER_MEDIA_TYPE)===-1?di:V.PARSER_MEDIA_TYPE,An=tr==="application/xhtml+xml"?Td:Vc,X=gs(V,"ALLOWED_TAGS")?Dt({},V.ALLOWED_TAGS,An):oe,Ve=gs(V,"ALLOWED_ATTR")?Dt({},V.ALLOWED_ATTR,An):Ye,ui=gs(V,"ALLOWED_NAMESPACES")?Dt({},V.ALLOWED_NAMESPACES,Td):Fs,mr=gs(V,"ADD_URI_SAFE_ATTR")?Dt(Ts(Us),V.ADD_URI_SAFE_ATTR,An):Us,ar=gs(V,"ADD_DATA_URI_TAGS")?Dt(Ts(Os),V.ADD_DATA_URI_TAGS,An):Os,jt=gs(V,"FORBID_CONTENTS")?Dt({},V.FORBID_CONTENTS,An):It,Lt=gs(V,"FORBID_TAGS")?Dt({},V.FORBID_TAGS,An):Ts({}),Zt=gs(V,"FORBID_ATTR")?Dt({},V.FORBID_ATTR,An):Ts({}),it=gs(V,"USE_PROFILES")?V.USE_PROFILES:!1,Ht=V.ALLOW_ARIA_ATTR!==!1,bn=V.ALLOW_DATA_ATTR!==!1,Yt=V.ALLOW_UNKNOWN_PROTOCOLS||!1,Qn=V.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Un=V.SAFE_FOR_TEMPLATES||!1,w=V.SAFE_FOR_XML!==!1,je=V.WHOLE_DOCUMENT||!1,O=V.RETURN_DOM||!1,ee=V.RETURN_DOM_FRAGMENT||!1,Se=V.RETURN_TRUSTED_TYPE||!1,F=V.FORCE_BODY||!1,Te=V.SANITIZE_DOM!==!1,Q=V.SANITIZE_NAMED_PROPS||!1,Qe=V.KEEP_CONTENT!==!1,De=V.IN_PLACE||!1,Re=V.ALLOWED_URI_REGEXP||sy,En=V.NAMESPACE||Cn,Nr=V.MATHML_TEXT_INTEGRATION_POINTS||Nr,Bs=V.HTML_INTEGRATION_POINTS||Bs,Ee=V.CUSTOM_ELEMENT_HANDLING||{},V.CUSTOM_ELEMENT_HANDLING&&Sr(V.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ee.tagNameCheck=V.CUSTOM_ELEMENT_HANDLING.tagNameCheck),V.CUSTOM_ELEMENT_HANDLING&&Sr(V.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ee.attributeNameCheck=V.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),V.CUSTOM_ELEMENT_HANDLING&&typeof V.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Ee.allowCustomizedBuiltInElements=V.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Un&&(bn=!1),ee&&(O=!0),it&&(X=Dt({},sm),Ve=[],it.html===!0&&(Dt(X,rm),Dt(Ve,im)),it.svg===!0&&(Dt(X,$d),Dt(Ve,Rd),Dt(Ve,Sc)),it.svgFilters===!0&&(Dt(X,Ad),Dt(Ve,Rd),Dt(Ve,Sc)),it.mathMl===!0&&(Dt(X,Pd),Dt(Ve,om),Dt(Ve,Sc))),V.ADD_TAGS&&(typeof V.ADD_TAGS=="function"?Et.tagCheck=V.ADD_TAGS:(X===oe&&(X=Ts(X)),Dt(X,V.ADD_TAGS,An))),V.ADD_ATTR&&(typeof V.ADD_ATTR=="function"?Et.attributeCheck=V.ADD_ATTR:(Ve===Ye&&(Ve=Ts(Ve)),Dt(Ve,V.ADD_ATTR,An))),V.ADD_URI_SAFE_ATTR&&Dt(mr,V.ADD_URI_SAFE_ATTR,An),V.FORBID_CONTENTS&&(jt===It&&(jt=Ts(jt)),Dt(jt,V.FORBID_CONTENTS,An)),V.ADD_FORBID_CONTENTS&&(jt===It&&(jt=Ts(jt)),Dt(jt,V.ADD_FORBID_CONTENTS,An)),Qe&&(X["#text"]=!0),je&&Dt(X,["html","head","body"]),X.table&&(Dt(X,["tbody"]),delete Lt.tbody),V.TRUSTED_TYPES_POLICY){if(typeof V.TRUSTED_TYPES_POLICY.createHTML!="function")throw Ha('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof V.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Ha('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');L=V.TRUSTED_TYPES_POLICY,B=L.createHTML("")}else L===void 0&&(L=o2(b,i)),L!==null&&typeof B=="string"&&(B=L.createHTML(""));kr&&kr(V),ls=V}},fi=Dt({},[...$d,...Ad,...Xw]),ca=Dt({},[...Pd,...Zw]),ho=function(V){let Ae=S(V);(!Ae||!Ae.tagName)&&(Ae={namespaceURI:En,tagName:"template"});const Ue=Vc(V.tagName),Ot=Vc(Ae.tagName);return ui[V.namespaceURI]?V.namespaceURI===er?Ae.namespaceURI===Cn?Ue==="svg":Ae.namespaceURI===At?Ue==="svg"&&(Ot==="annotation-xml"||Nr[Ot]):!!fi[Ue]:V.namespaceURI===At?Ae.namespaceURI===Cn?Ue==="math":Ae.namespaceURI===er?Ue==="math"&&Bs[Ot]:!!ca[Ue]:V.namespaceURI===Cn?Ae.namespaceURI===er&&!Bs[Ot]||Ae.namespaceURI===At&&!Nr[Ot]?!1:!ca[Ue]&&(Hs[Ue]||!fi[Ue]):!!(tr==="application/xhtml+xml"&&ui[V.namespaceURI]):!1},Cr=function(V){Fa(t.removed,{element:V});try{S(V).removeChild(V)}catch{A(V)}},js=function(V,Ae){try{Fa(t.removed,{attribute:Ae.getAttributeNode(V),from:Ae})}catch{Fa(t.removed,{attribute:null,from:Ae})}if(Ae.removeAttribute(V),V==="is")if(O||ee)try{Cr(Ae)}catch{}else try{Ae.setAttribute(V,"")}catch{}},Ol=function(V){let Ae=null,Ue=null;if(F)V="<remove></remove>"+V;else{const Gt=Md(V,/^[\r\n\t ]+/);Ue=Gt&&Gt[0]}tr==="application/xhtml+xml"&&En===Cn&&(V='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+V+"</body></html>");const Ot=L?L.createHTML(V):V;if(En===Cn)try{Ae=new k().parseFromString(Ot,tr)}catch{}if(!Ae||!Ae.documentElement){Ae=ie.createDocument(En,"template",null);try{Ae.documentElement.innerHTML=Dr?B:Ot}catch{}}const rn=Ae.body||Ae.documentElement;return V&&Ue&&rn.insertBefore(n.createTextNode(Ue),rn.childNodes[0]||null),En===Cn?ce.call(Ae,je?"html":"body")[0]:je?Ae.documentElement:rn},mo=function(V){return J.call(V.ownerDocument||V,V,y.SHOW_ELEMENT|y.SHOW_COMMENT|y.SHOW_TEXT|y.SHOW_PROCESSING_INSTRUCTION|y.SHOW_CDATA_SECTION,null)},ua=function(V){return V instanceof _&&(typeof V.nodeName!="string"||typeof V.textContent!="string"||typeof V.removeChild!="function"||!(V.attributes instanceof j)||typeof V.removeAttribute!="function"||typeof V.setAttribute!="function"||typeof V.namespaceURI!="string"||typeof V.insertBefore!="function"||typeof V.hasChildNodes!="function")},Ws=function(V){return typeof u=="function"&&V instanceof u};function gr(vt,V,Ae){Nc(vt,Ue=>{Ue.call(t,V,Ae,ls)})}const go=function(V){let Ae=null;if(gr(Be.beforeSanitizeElements,V,null),ua(V))return Cr(V),!0;const Ue=An(V.nodeName);if(gr(Be.uponSanitizeElement,V,{tagName:Ue,allowedTags:X}),w&&V.hasChildNodes()&&!Ws(V.firstElementChild)&&yr(/<[/\w!]/g,V.innerHTML)&&yr(/<[/\w!]/g,V.textContent)||V.nodeType===Va.progressingInstruction||w&&V.nodeType===Va.comment&&yr(/<[/\w]/g,V.data))return Cr(V),!0;if(!(Et.tagCheck instanceof Function&&Et.tagCheck(Ue))&&(!X[Ue]||Lt[Ue])){if(!Lt[Ue]&&nr(Ue)&&(Ee.tagNameCheck instanceof RegExp&&yr(Ee.tagNameCheck,Ue)||Ee.tagNameCheck instanceof Function&&Ee.tagNameCheck(Ue)))return!1;if(Qe&&!jt[Ue]){const Ot=S(V)||V.parentNode,rn=g(V)||V.childNodes;if(rn&&Ot){const Gt=rn.length;for(let Kn=Gt-1;Kn>=0;--Kn){const Rn=z(rn[Kn],!0);Rn.__removalCount=(V.__removalCount||0)+1,Ot.insertBefore(Rn,x(V))}}}return Cr(V),!0}return V instanceof d&&!ho(V)||(Ue==="noscript"||Ue==="noembed"||Ue==="noframes")&&yr(/<\/no(script|embed|frames)/i,V.innerHTML)?(Cr(V),!0):(Un&&V.nodeType===Va.text&&(Ae=V.textContent,Nc([K,xe,v],Ot=>{Ae=Ba(Ae,Ot," ")}),V.textContent!==Ae&&(Fa(t.removed,{element:V.cloneNode()}),V.textContent=Ae)),gr(Be.afterSanitizeElements,V,null),!1)},pi=function(V,Ae,Ue){if(Te&&(Ae==="id"||Ae==="name")&&(Ue in n||Ue in Ll))return!1;if(!(bn&&!Zt[Ae]&&yr(ge,Ae))){if(!(Ht&&yr(rt,Ae))){if(!(Et.attributeCheck instanceof Function&&Et.attributeCheck(Ae,V))){if(!Ve[Ae]||Zt[Ae]){if(!(nr(V)&&(Ee.tagNameCheck instanceof RegExp&&yr(Ee.tagNameCheck,V)||Ee.tagNameCheck instanceof Function&&Ee.tagNameCheck(V))&&(Ee.attributeNameCheck instanceof RegExp&&yr(Ee.attributeNameCheck,Ae)||Ee.attributeNameCheck instanceof Function&&Ee.attributeNameCheck(Ae,V))||Ae==="is"&&Ee.allowCustomizedBuiltInElements&&(Ee.tagNameCheck instanceof RegExp&&yr(Ee.tagNameCheck,Ue)||Ee.tagNameCheck instanceof Function&&Ee.tagNameCheck(Ue))))return!1}else if(!mr[Ae]){if(!yr(Re,Ba(Ue,we,""))){if(!((Ae==="src"||Ae==="xlink:href"||Ae==="href")&&V!=="script"&&Vw(Ue,"data:")===0&&ar[V])){if(!(Yt&&!yr(ze,Ba(Ue,we,"")))){if(Ue)return!1}}}}}}}return!0},nr=function(V){return V!=="annotation-xml"&&Md(V,ae)},hi=function(V){gr(Be.beforeSanitizeAttributes,V,null);const{attributes:Ae}=V;if(!Ae||ua(V))return;const Ue={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Ve,forceKeepAttr:void 0};let Ot=Ae.length;for(;Ot--;){const rn=Ae[Ot],{name:Gt,namespaceURI:Kn,value:Rn}=rn,Lr=An(Gt),Yr=Rn;let Yn=Gt==="value"?Yr:Kw(Yr);if(Ue.attrName=Lr,Ue.attrValue=Yn,Ue.keepAttr=!0,Ue.forceKeepAttr=void 0,gr(Be.uponSanitizeAttribute,V,Ue),Yn=Ue.attrValue,Q&&(Lr==="id"||Lr==="name")&&(js(Gt,V),Yn=ye+Yn),w&&yr(/((--!?|])>)|<\/(style|title|textarea)/i,Yn)){js(Gt,V);continue}if(Lr==="attributename"&&Md(Yn,"href")){js(Gt,V);continue}if(Ue.forceKeepAttr)continue;if(!Ue.keepAttr){js(Gt,V);continue}if(!Qn&&yr(/\/>/i,Yn)){js(Gt,V);continue}Un&&Nc([K,xe,v],cs=>{Yn=Ba(Yn,cs," ")});const da=An(V.nodeName);if(!pi(da,Lr,Yn)){js(Gt,V);continue}if(L&&typeof b=="object"&&typeof b.getAttributeType=="function"&&!Kn)switch(b.getAttributeType(da,Lr)){case"TrustedHTML":{Yn=L.createHTML(Yn);break}case"TrustedScriptURL":{Yn=L.createScriptURL(Yn);break}}if(Yn!==Yr)try{Kn?V.setAttributeNS(Kn,Gt,Yn):V.setAttribute(Gt,Yn),ua(V)?Cr(V):nm(t.removed)}catch{js(Gt,V)}}gr(Be.afterSanitizeAttributes,V,null)},mi=function vt(V){let Ae=null;const Ue=mo(V);for(gr(Be.beforeSanitizeShadowDOM,V,null);Ae=Ue.nextNode();)gr(Be.uponSanitizeShadowNode,Ae,null),go(Ae),hi(Ae),Ae.content instanceof a&&vt(Ae.content);gr(Be.afterSanitizeShadowDOM,V,null)};return t.sanitize=function(vt){let V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Ae=null,Ue=null,Ot=null,rn=null;if(Dr=!vt,Dr&&(vt="\x3C!-->"),typeof vt!="string"&&!Ws(vt))if(typeof vt.toString=="function"){if(vt=vt.toString(),typeof vt!="string")throw Ha("dirty is not a string, aborting")}else throw Ha("toString is not a function");if(!t.isSupported)return vt;if(he||Pn(V),t.removed=[],typeof vt=="string"&&(De=!1),De){if(vt.nodeName){const Rn=An(vt.nodeName);if(!X[Rn]||Lt[Rn])throw Ha("root node is forbidden and cannot be sanitized in-place")}}else if(vt instanceof u)Ae=Ol("\x3C!---->"),Ue=Ae.ownerDocument.importNode(vt,!0),Ue.nodeType===Va.element&&Ue.nodeName==="BODY"||Ue.nodeName==="HTML"?Ae=Ue:Ae.appendChild(Ue);else{if(!O&&!Un&&!je&&vt.indexOf("<")===-1)return L&&Se?L.createHTML(vt):vt;if(Ae=Ol(vt),!Ae)return O?null:Se?B:""}Ae&&F&&Cr(Ae.firstChild);const Gt=mo(De?vt:Ae);for(;Ot=Gt.nextNode();)go(Ot),hi(Ot),Ot.content instanceof a&&mi(Ot.content);if(De)return vt;if(O){if(ee)for(rn=ue.call(Ae.ownerDocument);Ae.firstChild;)rn.appendChild(Ae.firstChild);else rn=Ae;return(Ve.shadowroot||Ve.shadowrootmode)&&(rn=me.call(r,rn,!0)),rn}let Kn=je?Ae.outerHTML:Ae.innerHTML;return je&&X["!doctype"]&&Ae.ownerDocument&&Ae.ownerDocument.doctype&&Ae.ownerDocument.doctype.name&&yr(iy,Ae.ownerDocument.doctype.name)&&(Kn="<!DOCTYPE "+Ae.ownerDocument.doctype.name+`>
`+Kn),Un&&Nc([K,xe,v],Rn=>{Kn=Ba(Kn,Rn," ")}),L&&Se?L.createHTML(Kn):Kn},t.setConfig=function(){let vt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Pn(vt),he=!0},t.clearConfig=function(){ls=null,he=!1},t.isValidAttribute=function(vt,V,Ae){ls||Pn({});const Ue=An(vt),Ot=An(V);return pi(Ue,Ot,Ae)},t.addHook=function(vt,V){typeof V=="function"&&Fa(Be[vt],V)},t.removeHook=function(vt,V){if(V!==void 0){const Ae=Hw(Be[vt],V);return Ae===-1?void 0:Ww(Be[vt],Ae,1)[0]}return nm(Be[vt])},t.removeHooks=function(vt){Be[vt]=[]},t.removeAllHooks=function(){Be=lm()},t}var a2=oy();/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var l2={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c2=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),ft=(e,t)=>{const n=H.forwardRef(({color:r="currentColor",size:i=24,strokeWidth:a=2,absoluteStrokeWidth:l,className:u="",children:d,...y},j)=>H.createElement("svg",{ref:j,...l2,width:i,height:i,stroke:r,strokeWidth:l?Number(a)*24/Number(i):a,className:["lucide",`lucide-${c2(e)}`,u].join(" "),...y},[...t.map(([_,k])=>H.createElement(_,k)),...Array.isArray(d)?d:[d]]));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cc=ft("ArrowRightSquare",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"m12 16 4-4-4-4",key:"1i9zcv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cm=ft("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u2=ft("Brush",[["path",{d:"m9.06 11.9 8.07-8.06a2.85 2.85 0 1 1 4.03 4.03l-8.06 8.08",key:"1styjt"}],["path",{d:"M7.07 14.94c-1.66 0-3 1.35-3 3.02 0 1.33-2.5 1.52-2 2.02 1.08 1.1 2.49 2.02 4 2.02 2.2 0 4-1.8 4-4.04a3.01 3.01 0 0 0-3-3.02z",key:"z0l1mu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const um=ft("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const el=ft("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d2=ft("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tl=ft("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _i=ft("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f2=ft("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nl=ft("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dd=ft("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p2=ft("ChevronsUp",[["path",{d:"m17 11-5-5-5 5",key:"e8nh98"}],["path",{d:"m17 18-5-5-5 5",key:"2avn1x"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h2=ft("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dm=ft("ClipboardCopy",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-2",key:"4jdomd"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v4",key:"3hqy98"}],["path",{d:"M21 14H11",key:"1bme5i"}],["path",{d:"m15 10-4 4 4 4",key:"5dvupr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fm=ft("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const To=ft("CopyPlus",[["line",{x1:"15",x2:"15",y1:"12",y2:"18",key:"1p7wdc"}],["line",{x1:"12",x2:"18",y1:"15",y2:"15",key:"1nscbv"}],["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ka=ft("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ay=ft("Eraser",[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pm=ft("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hm=ft("FileAudio",[["path",{d:"M17.5 22h.5a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"rslqgf"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M2 19a2 2 0 1 1 4 0v1a2 2 0 1 1-4 0v-4a6 6 0 0 1 12 0v4a2 2 0 1 1-4 0v-1a2 2 0 1 1 4 0",key:"9f7x3i"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m2=ft("FileImage",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g2=ft("FileSearch",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"1vg67v"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"5",cy:"14",r:"3",key:"ufru5t"}],["path",{d:"m9 18-1.5-1.5",key:"1j6qii"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qr=ft("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mo=ft("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mm=ft("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gm=ft("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xm=ft("ImagePlus",[["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7",key:"31hg93"}],["line",{x1:"16",x2:"22",y1:"5",y2:"5",key:"ez7e4s"}],["line",{x1:"19",x2:"19",y1:"2",y2:"8",key:"1gkr8c"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $o=ft("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x2=ft("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ya=ft("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ga=ft("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=ft("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Is=ft("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ao=ft("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y2=ft("Mic2",[["path",{d:"m12 8-9.04 9.06a2.82 2.82 0 1 0 3.98 3.98L16 12",key:"zoua8r"}],["circle",{cx:"17",cy:"7",r:"5",key:"1fomce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v2=ft("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b2=ft("MousePointer2",[["path",{d:"m4 4 7.07 17 2.51-7.39L21 11.07z",key:"1vqm48"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w2=ft("PanelsTopLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k2=ft("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z2=ft("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ym=ft("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ni=ft("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bf=ft("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j2=ft("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _2=ft("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N2=ft("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ld=ft("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S2=ft("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C2=ft("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ec=ft("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hf=ft("Split",[["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M8 3H3v5",key:"15dfkv"}],["path",{d:"M12 22v-8.3a4 4 0 0 0-1.172-2.872L3 3",key:"1qrqzj"}],["path",{d:"m15 9 6-6",key:"ko1vev"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vm=ft("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E2=ft("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ms=ft("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I2=ft("Undo2",[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5v0a5.5 5.5 0 0 1-5.5 5.5H11",key:"llx8ln"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T2=ft("Unlink",[["path",{d:"m18.84 12.25 1.72-1.71h-.02a5.004 5.004 0 0 0-.12-7.07 5.006 5.006 0 0 0-6.95 0l-1.72 1.71",key:"yqzxt4"}],["path",{d:"m5.17 11.75-1.71 1.71a5.004 5.004 0 0 0 .12 7.07 5.006 5.006 0 0 0 6.95 0l1.71-1.71",key:"4qinb0"}],["line",{x1:"8",x2:"8",y1:"2",y2:"5",key:"1041cp"}],["line",{x1:"2",x2:"5",y1:"8",y2:"8",key:"14m1p5"}],["line",{x1:"16",x2:"16",y1:"19",y2:"22",key:"rzdirn"}],["line",{x1:"19",x2:"22",y1:"16",y2:"16",key:"ox905f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M2=ft("UploadCloud",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m16 16-4-4-4 4",key:"119tzi"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bm=ft("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xa=ft("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Od=ft("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $2=ft("Wand2",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72Z",key:"1bcowg"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=ft("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wm=ft("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function Ic(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ly={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(e,t){(function(n){e.exports=n()})(function(){return function n(r,i,a){function l(y,j){if(!i[y]){if(!r[y]){var _=typeof Ic=="function"&&Ic;if(!j&&_)return _(y,!0);if(u)return u(y,!0);var k=new Error("Cannot find module '"+y+"'");throw k.code="MODULE_NOT_FOUND",k}var b=i[y]={exports:{}};r[y][0].call(b.exports,function(E){var z=r[y][1][E];return l(z||E)},b,b.exports,n,r,i,a)}return i[y].exports}for(var u=typeof Ic=="function"&&Ic,d=0;d<a.length;d++)l(a[d]);return l}({1:[function(n,r,i){var a=n("./utils"),l=n("./support"),u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(d){for(var y,j,_,k,b,E,z,A=[],x=0,g=d.length,S=g,L=a.getTypeOf(d)!=="string";x<d.length;)S=g-x,_=L?(y=d[x++],j=x<g?d[x++]:0,x<g?d[x++]:0):(y=d.charCodeAt(x++),j=x<g?d.charCodeAt(x++):0,x<g?d.charCodeAt(x++):0),k=y>>2,b=(3&y)<<4|j>>4,E=1<S?(15&j)<<2|_>>6:64,z=2<S?63&_:64,A.push(u.charAt(k)+u.charAt(b)+u.charAt(E)+u.charAt(z));return A.join("")},i.decode=function(d){var y,j,_,k,b,E,z=0,A=0,x="data:";if(d.substr(0,x.length)===x)throw new Error("Invalid base64 input, it looks like a data url.");var g,S=3*(d=d.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(d.charAt(d.length-1)===u.charAt(64)&&S--,d.charAt(d.length-2)===u.charAt(64)&&S--,S%1!=0)throw new Error("Invalid base64 input, bad content length.");for(g=l.uint8array?new Uint8Array(0|S):new Array(0|S);z<d.length;)y=u.indexOf(d.charAt(z++))<<2|(k=u.indexOf(d.charAt(z++)))>>4,j=(15&k)<<4|(b=u.indexOf(d.charAt(z++)))>>2,_=(3&b)<<6|(E=u.indexOf(d.charAt(z++))),g[A++]=y,b!==64&&(g[A++]=j),E!==64&&(g[A++]=_);return g}},{"./support":30,"./utils":32}],2:[function(n,r,i){var a=n("./external"),l=n("./stream/DataWorker"),u=n("./stream/Crc32Probe"),d=n("./stream/DataLengthProbe");function y(j,_,k,b,E){this.compressedSize=j,this.uncompressedSize=_,this.crc32=k,this.compression=b,this.compressedContent=E}y.prototype={getContentWorker:function(){var j=new l(a.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new d("data_length")),_=this;return j.on("end",function(){if(this.streamInfo.data_length!==_.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),j},getCompressedWorker:function(){return new l(a.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},y.createWorkerFrom=function(j,_,k){return j.pipe(new u).pipe(new d("uncompressedSize")).pipe(_.compressWorker(k)).pipe(new d("compressedSize")).withStreamInfo("compression",_)},r.exports=y},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,r,i){var a=n("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new a("STORE compression")},uncompressWorker:function(){return new a("STORE decompression")}},i.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,r,i){var a=n("./utils"),l=function(){for(var u,d=[],y=0;y<256;y++){u=y;for(var j=0;j<8;j++)u=1&u?3988292384^u>>>1:u>>>1;d[y]=u}return d}();r.exports=function(u,d){return u!==void 0&&u.length?a.getTypeOf(u)!=="string"?function(y,j,_,k){var b=l,E=k+_;y^=-1;for(var z=k;z<E;z++)y=y>>>8^b[255&(y^j[z])];return-1^y}(0|d,u,u.length,0):function(y,j,_,k){var b=l,E=k+_;y^=-1;for(var z=k;z<E;z++)y=y>>>8^b[255&(y^j.charCodeAt(z))];return-1^y}(0|d,u,u.length,0):0}},{"./utils":32}],5:[function(n,r,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(n,r,i){var a=null;a=typeof Promise<"u"?Promise:n("lie"),r.exports={Promise:a}},{lie:37}],7:[function(n,r,i){var a=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",l=n("pako"),u=n("./utils"),d=n("./stream/GenericWorker"),y=a?"uint8array":"array";function j(_,k){d.call(this,"FlateWorker/"+_),this._pako=null,this._pakoAction=_,this._pakoOptions=k,this.meta={}}i.magic="\b\0",u.inherits(j,d),j.prototype.processChunk=function(_){this.meta=_.meta,this._pako===null&&this._createPako(),this._pako.push(u.transformTo(y,_.data),!1)},j.prototype.flush=function(){d.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},j.prototype.cleanUp=function(){d.prototype.cleanUp.call(this),this._pako=null},j.prototype._createPako=function(){this._pako=new l[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var _=this;this._pako.onData=function(k){_.push({data:k,meta:_.meta})}},i.compressWorker=function(_){return new j("Deflate",_)},i.uncompressWorker=function(){return new j("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,r,i){function a(b,E){var z,A="";for(z=0;z<E;z++)A+=String.fromCharCode(255&b),b>>>=8;return A}function l(b,E,z,A,x,g){var S,L,B=b.file,ie=b.compression,J=g!==y.utf8encode,ue=u.transformTo("string",g(B.name)),ce=u.transformTo("string",y.utf8encode(B.name)),me=B.comment,Be=u.transformTo("string",g(me)),K=u.transformTo("string",y.utf8encode(me)),xe=ce.length!==B.name.length,v=K.length!==me.length,ge="",rt="",ze="",we=B.dir,ae=B.date,Re={crc32:0,compressedSize:0,uncompressedSize:0};E&&!z||(Re.crc32=b.crc32,Re.compressedSize=b.compressedSize,Re.uncompressedSize=b.uncompressedSize);var X=0;E&&(X|=8),J||!xe&&!v||(X|=2048);var oe=0,Ve=0;we&&(oe|=16),x==="UNIX"?(Ve=798,oe|=function(Ee,Lt){var Zt=Ee;return Ee||(Zt=Lt?16893:33204),(65535&Zt)<<16}(B.unixPermissions,we)):(Ve=20,oe|=function(Ee){return 63&(Ee||0)}(B.dosPermissions)),S=ae.getUTCHours(),S<<=6,S|=ae.getUTCMinutes(),S<<=5,S|=ae.getUTCSeconds()/2,L=ae.getUTCFullYear()-1980,L<<=4,L|=ae.getUTCMonth()+1,L<<=5,L|=ae.getUTCDate(),xe&&(rt=a(1,1)+a(j(ue),4)+ce,ge+="up"+a(rt.length,2)+rt),v&&(ze=a(1,1)+a(j(Be),4)+K,ge+="uc"+a(ze.length,2)+ze);var Ye="";return Ye+=`
\0`,Ye+=a(X,2),Ye+=ie.magic,Ye+=a(S,2),Ye+=a(L,2),Ye+=a(Re.crc32,4),Ye+=a(Re.compressedSize,4),Ye+=a(Re.uncompressedSize,4),Ye+=a(ue.length,2),Ye+=a(ge.length,2),{fileRecord:_.LOCAL_FILE_HEADER+Ye+ue+ge,dirRecord:_.CENTRAL_FILE_HEADER+a(Ve,2)+Ye+a(Be.length,2)+"\0\0\0\0"+a(oe,4)+a(A,4)+ue+ge+Be}}var u=n("../utils"),d=n("../stream/GenericWorker"),y=n("../utf8"),j=n("../crc32"),_=n("../signature");function k(b,E,z,A){d.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=E,this.zipPlatform=z,this.encodeFileName=A,this.streamFiles=b,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}u.inherits(k,d),k.prototype.push=function(b){var E=b.meta.percent||0,z=this.entriesCount,A=this._sources.length;this.accumulate?this.contentBuffer.push(b):(this.bytesWritten+=b.data.length,d.prototype.push.call(this,{data:b.data,meta:{currentFile:this.currentFile,percent:z?(E+100*(z-A-1))/z:100}}))},k.prototype.openedSource=function(b){this.currentSourceOffset=this.bytesWritten,this.currentFile=b.file.name;var E=this.streamFiles&&!b.file.dir;if(E){var z=l(b,E,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:z.fileRecord,meta:{percent:0}})}else this.accumulate=!0},k.prototype.closedSource=function(b){this.accumulate=!1;var E=this.streamFiles&&!b.file.dir,z=l(b,E,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(z.dirRecord),E)this.push({data:function(A){return _.DATA_DESCRIPTOR+a(A.crc32,4)+a(A.compressedSize,4)+a(A.uncompressedSize,4)}(b),meta:{percent:100}});else for(this.push({data:z.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},k.prototype.flush=function(){for(var b=this.bytesWritten,E=0;E<this.dirRecords.length;E++)this.push({data:this.dirRecords[E],meta:{percent:100}});var z=this.bytesWritten-b,A=function(x,g,S,L,B){var ie=u.transformTo("string",B(L));return _.CENTRAL_DIRECTORY_END+"\0\0\0\0"+a(x,2)+a(x,2)+a(g,4)+a(S,4)+a(ie.length,2)+ie}(this.dirRecords.length,z,b,this.zipComment,this.encodeFileName);this.push({data:A,meta:{percent:100}})},k.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},k.prototype.registerPrevious=function(b){this._sources.push(b);var E=this;return b.on("data",function(z){E.processChunk(z)}),b.on("end",function(){E.closedSource(E.previous.streamInfo),E._sources.length?E.prepareNextSource():E.end()}),b.on("error",function(z){E.error(z)}),this},k.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},k.prototype.error=function(b){var E=this._sources;if(!d.prototype.error.call(this,b))return!1;for(var z=0;z<E.length;z++)try{E[z].error(b)}catch{}return!0},k.prototype.lock=function(){d.prototype.lock.call(this);for(var b=this._sources,E=0;E<b.length;E++)b[E].lock()},r.exports=k},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,r,i){var a=n("../compressions"),l=n("./ZipFileWorker");i.generateWorker=function(u,d,y){var j=new l(d.streamFiles,y,d.platform,d.encodeFileName),_=0;try{u.forEach(function(k,b){_++;var E=function(g,S){var L=g||S,B=a[L];if(!B)throw new Error(L+" is not a valid compression method !");return B}(b.options.compression,d.compression),z=b.options.compressionOptions||d.compressionOptions||{},A=b.dir,x=b.date;b._compressWorker(E,z).withStreamInfo("file",{name:k,dir:A,date:x,comment:b.comment||"",unixPermissions:b.unixPermissions,dosPermissions:b.dosPermissions}).pipe(j)}),j.entriesCount=_}catch(k){j.error(k)}return j}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,r,i){function a(){if(!(this instanceof a))return new a;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var l=new a;for(var u in this)typeof this[u]!="function"&&(l[u]=this[u]);return l}}(a.prototype=n("./object")).loadAsync=n("./load"),a.support=n("./support"),a.defaults=n("./defaults"),a.version="3.10.1",a.loadAsync=function(l,u){return new a().loadAsync(l,u)},a.external=n("./external"),r.exports=a},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,r,i){var a=n("./utils"),l=n("./external"),u=n("./utf8"),d=n("./zipEntries"),y=n("./stream/Crc32Probe"),j=n("./nodejsUtils");function _(k){return new l.Promise(function(b,E){var z=k.decompressed.getContentWorker().pipe(new y);z.on("error",function(A){E(A)}).on("end",function(){z.streamInfo.crc32!==k.decompressed.crc32?E(new Error("Corrupted zip : CRC32 mismatch")):b()}).resume()})}r.exports=function(k,b){var E=this;return b=a.extend(b||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:u.utf8decode}),j.isNode&&j.isStream(k)?l.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):a.prepareContent("the loaded zip file",k,!0,b.optimizedBinaryString,b.base64).then(function(z){var A=new d(b);return A.load(z),A}).then(function(z){var A=[l.Promise.resolve(z)],x=z.files;if(b.checkCRC32)for(var g=0;g<x.length;g++)A.push(_(x[g]));return l.Promise.all(A)}).then(function(z){for(var A=z.shift(),x=A.files,g=0;g<x.length;g++){var S=x[g],L=S.fileNameStr,B=a.resolve(S.fileNameStr);E.file(B,S.decompressed,{binary:!0,optimizedBinaryString:!0,date:S.date,dir:S.dir,comment:S.fileCommentStr.length?S.fileCommentStr:null,unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions,createFolders:b.createFolders}),S.dir||(E.file(B).unsafeOriginalName=L)}return A.zipComment.length&&(E.comment=A.zipComment),E})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,r,i){var a=n("../utils"),l=n("../stream/GenericWorker");function u(d,y){l.call(this,"Nodejs stream input adapter for "+d),this._upstreamEnded=!1,this._bindStream(y)}a.inherits(u,l),u.prototype._bindStream=function(d){var y=this;(this._stream=d).pause(),d.on("data",function(j){y.push({data:j,meta:{percent:0}})}).on("error",function(j){y.isPaused?this.generatedError=j:y.error(j)}).on("end",function(){y.isPaused?y._upstreamEnded=!0:y.end()})},u.prototype.pause=function(){return!!l.prototype.pause.call(this)&&(this._stream.pause(),!0)},u.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=u},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,r,i){var a=n("readable-stream").Readable;function l(u,d,y){a.call(this,d),this._helper=u;var j=this;u.on("data",function(_,k){j.push(_)||j._helper.pause(),y&&y(k)}).on("error",function(_){j.emit("error",_)}).on("end",function(){j.push(null)})}n("../utils").inherits(l,a),l.prototype._read=function(){this._helper.resume()},r.exports=l},{"../utils":32,"readable-stream":16}],14:[function(n,r,i){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(a,l){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(a,l);if(typeof a=="number")throw new Error('The "data" argument must not be a number');return new Buffer(a,l)},allocBuffer:function(a){if(Buffer.alloc)return Buffer.alloc(a);var l=new Buffer(a);return l.fill(0),l},isBuffer:function(a){return Buffer.isBuffer(a)},isStream:function(a){return a&&typeof a.on=="function"&&typeof a.pause=="function"&&typeof a.resume=="function"}}},{}],15:[function(n,r,i){function a(B,ie,J){var ue,ce=u.getTypeOf(ie),me=u.extend(J||{},j);me.date=me.date||new Date,me.compression!==null&&(me.compression=me.compression.toUpperCase()),typeof me.unixPermissions=="string"&&(me.unixPermissions=parseInt(me.unixPermissions,8)),me.unixPermissions&&16384&me.unixPermissions&&(me.dir=!0),me.dosPermissions&&16&me.dosPermissions&&(me.dir=!0),me.dir&&(B=x(B)),me.createFolders&&(ue=A(B))&&g.call(this,ue,!0);var Be=ce==="string"&&me.binary===!1&&me.base64===!1;J&&J.binary!==void 0||(me.binary=!Be),(ie instanceof _&&ie.uncompressedSize===0||me.dir||!ie||ie.length===0)&&(me.base64=!1,me.binary=!0,ie="",me.compression="STORE",ce="string");var K=null;K=ie instanceof _||ie instanceof d?ie:E.isNode&&E.isStream(ie)?new z(B,ie):u.prepareContent(B,ie,me.binary,me.optimizedBinaryString,me.base64);var xe=new k(B,K,me);this.files[B]=xe}var l=n("./utf8"),u=n("./utils"),d=n("./stream/GenericWorker"),y=n("./stream/StreamHelper"),j=n("./defaults"),_=n("./compressedObject"),k=n("./zipObject"),b=n("./generate"),E=n("./nodejsUtils"),z=n("./nodejs/NodejsStreamInputAdapter"),A=function(B){B.slice(-1)==="/"&&(B=B.substring(0,B.length-1));var ie=B.lastIndexOf("/");return 0<ie?B.substring(0,ie):""},x=function(B){return B.slice(-1)!=="/"&&(B+="/"),B},g=function(B,ie){return ie=ie!==void 0?ie:j.createFolders,B=x(B),this.files[B]||a.call(this,B,null,{dir:!0,createFolders:ie}),this.files[B]};function S(B){return Object.prototype.toString.call(B)==="[object RegExp]"}var L={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(B){var ie,J,ue;for(ie in this.files)ue=this.files[ie],(J=ie.slice(this.root.length,ie.length))&&ie.slice(0,this.root.length)===this.root&&B(J,ue)},filter:function(B){var ie=[];return this.forEach(function(J,ue){B(J,ue)&&ie.push(ue)}),ie},file:function(B,ie,J){if(arguments.length!==1)return B=this.root+B,a.call(this,B,ie,J),this;if(S(B)){var ue=B;return this.filter(function(me,Be){return!Be.dir&&ue.test(me)})}var ce=this.files[this.root+B];return ce&&!ce.dir?ce:null},folder:function(B){if(!B)return this;if(S(B))return this.filter(function(ce,me){return me.dir&&B.test(ce)});var ie=this.root+B,J=g.call(this,ie),ue=this.clone();return ue.root=J.name,ue},remove:function(B){B=this.root+B;var ie=this.files[B];if(ie||(B.slice(-1)!=="/"&&(B+="/"),ie=this.files[B]),ie&&!ie.dir)delete this.files[B];else for(var J=this.filter(function(ce,me){return me.name.slice(0,B.length)===B}),ue=0;ue<J.length;ue++)delete this.files[J[ue].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(B){var ie,J={};try{if((J=u.extend(B||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:l.utf8encode})).type=J.type.toLowerCase(),J.compression=J.compression.toUpperCase(),J.type==="binarystring"&&(J.type="string"),!J.type)throw new Error("No output type specified.");u.checkSupport(J.type),J.platform!=="darwin"&&J.platform!=="freebsd"&&J.platform!=="linux"&&J.platform!=="sunos"||(J.platform="UNIX"),J.platform==="win32"&&(J.platform="DOS");var ue=J.comment||this.comment||"";ie=b.generateWorker(this,J,ue)}catch(ce){(ie=new d("error")).error(ce)}return new y(ie,J.type||"string",J.mimeType)},generateAsync:function(B,ie){return this.generateInternalStream(B).accumulate(ie)},generateNodeStream:function(B,ie){return(B=B||{}).type||(B.type="nodebuffer"),this.generateInternalStream(B).toNodejsStream(ie)}};r.exports=L},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,r,i){r.exports=n("stream")},{stream:void 0}],17:[function(n,r,i){var a=n("./DataReader");function l(u){a.call(this,u);for(var d=0;d<this.data.length;d++)u[d]=255&u[d]}n("../utils").inherits(l,a),l.prototype.byteAt=function(u){return this.data[this.zero+u]},l.prototype.lastIndexOfSignature=function(u){for(var d=u.charCodeAt(0),y=u.charCodeAt(1),j=u.charCodeAt(2),_=u.charCodeAt(3),k=this.length-4;0<=k;--k)if(this.data[k]===d&&this.data[k+1]===y&&this.data[k+2]===j&&this.data[k+3]===_)return k-this.zero;return-1},l.prototype.readAndCheckSignature=function(u){var d=u.charCodeAt(0),y=u.charCodeAt(1),j=u.charCodeAt(2),_=u.charCodeAt(3),k=this.readData(4);return d===k[0]&&y===k[1]&&j===k[2]&&_===k[3]},l.prototype.readData=function(u){if(this.checkOffset(u),u===0)return[];var d=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,d},r.exports=l},{"../utils":32,"./DataReader":18}],18:[function(n,r,i){var a=n("../utils");function l(u){this.data=u,this.length=u.length,this.index=0,this.zero=0}l.prototype={checkOffset:function(u){this.checkIndex(this.index+u)},checkIndex:function(u){if(this.length<this.zero+u||u<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+u+"). Corrupted zip ?")},setIndex:function(u){this.checkIndex(u),this.index=u},skip:function(u){this.setIndex(this.index+u)},byteAt:function(){},readInt:function(u){var d,y=0;for(this.checkOffset(u),d=this.index+u-1;d>=this.index;d--)y=(y<<8)+this.byteAt(d);return this.index+=u,y},readString:function(u){return a.transformTo("string",this.readData(u))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var u=this.readInt(4);return new Date(Date.UTC(1980+(u>>25&127),(u>>21&15)-1,u>>16&31,u>>11&31,u>>5&63,(31&u)<<1))}},r.exports=l},{"../utils":32}],19:[function(n,r,i){var a=n("./Uint8ArrayReader");function l(u){a.call(this,u)}n("../utils").inherits(l,a),l.prototype.readData=function(u){this.checkOffset(u);var d=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,d},r.exports=l},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,r,i){var a=n("./DataReader");function l(u){a.call(this,u)}n("../utils").inherits(l,a),l.prototype.byteAt=function(u){return this.data.charCodeAt(this.zero+u)},l.prototype.lastIndexOfSignature=function(u){return this.data.lastIndexOf(u)-this.zero},l.prototype.readAndCheckSignature=function(u){return u===this.readData(4)},l.prototype.readData=function(u){this.checkOffset(u);var d=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,d},r.exports=l},{"../utils":32,"./DataReader":18}],21:[function(n,r,i){var a=n("./ArrayReader");function l(u){a.call(this,u)}n("../utils").inherits(l,a),l.prototype.readData=function(u){if(this.checkOffset(u),u===0)return new Uint8Array(0);var d=this.data.subarray(this.zero+this.index,this.zero+this.index+u);return this.index+=u,d},r.exports=l},{"../utils":32,"./ArrayReader":17}],22:[function(n,r,i){var a=n("../utils"),l=n("../support"),u=n("./ArrayReader"),d=n("./StringReader"),y=n("./NodeBufferReader"),j=n("./Uint8ArrayReader");r.exports=function(_){var k=a.getTypeOf(_);return a.checkSupport(k),k!=="string"||l.uint8array?k==="nodebuffer"?new y(_):l.uint8array?new j(a.transformTo("uint8array",_)):new u(a.transformTo("array",_)):new d(_)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,r,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,r,i){var a=n("./GenericWorker"),l=n("../utils");function u(d){a.call(this,"ConvertWorker to "+d),this.destType=d}l.inherits(u,a),u.prototype.processChunk=function(d){this.push({data:l.transformTo(this.destType,d.data),meta:d.meta})},r.exports=u},{"../utils":32,"./GenericWorker":28}],25:[function(n,r,i){var a=n("./GenericWorker"),l=n("../crc32");function u(){a.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(u,a),u.prototype.processChunk=function(d){this.streamInfo.crc32=l(d.data,this.streamInfo.crc32||0),this.push(d)},r.exports=u},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,r,i){var a=n("../utils"),l=n("./GenericWorker");function u(d){l.call(this,"DataLengthProbe for "+d),this.propName=d,this.withStreamInfo(d,0)}a.inherits(u,l),u.prototype.processChunk=function(d){if(d){var y=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=y+d.data.length}l.prototype.processChunk.call(this,d)},r.exports=u},{"../utils":32,"./GenericWorker":28}],27:[function(n,r,i){var a=n("../utils"),l=n("./GenericWorker");function u(d){l.call(this,"DataWorker");var y=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,d.then(function(j){y.dataIsReady=!0,y.data=j,y.max=j&&j.length||0,y.type=a.getTypeOf(j),y.isPaused||y._tickAndRepeat()},function(j){y.error(j)})}a.inherits(u,l),u.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this.data=null},u.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,a.delay(this._tickAndRepeat,[],this)),!0)},u.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(a.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},u.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var d=null,y=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":d=this.data.substring(this.index,y);break;case"uint8array":d=this.data.subarray(this.index,y);break;case"array":case"nodebuffer":d=this.data.slice(this.index,y)}return this.index=y,this.push({data:d,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=u},{"../utils":32,"./GenericWorker":28}],28:[function(n,r,i){function a(l){this.name=l||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}a.prototype={push:function(l){this.emit("data",l)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(l){this.emit("error",l)}return!0},error:function(l){return!this.isFinished&&(this.isPaused?this.generatedError=l:(this.isFinished=!0,this.emit("error",l),this.previous&&this.previous.error(l),this.cleanUp()),!0)},on:function(l,u){return this._listeners[l].push(u),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(l,u){if(this._listeners[l])for(var d=0;d<this._listeners[l].length;d++)this._listeners[l][d].call(this,u)},pipe:function(l){return l.registerPrevious(this)},registerPrevious:function(l){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=l.streamInfo,this.mergeStreamInfo(),this.previous=l;var u=this;return l.on("data",function(d){u.processChunk(d)}),l.on("end",function(){u.end()}),l.on("error",function(d){u.error(d)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var l=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),l=!0),this.previous&&this.previous.resume(),!l},flush:function(){},processChunk:function(l){this.push(l)},withStreamInfo:function(l,u){return this.extraStreamInfo[l]=u,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var l in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,l)&&(this.streamInfo[l]=this.extraStreamInfo[l])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var l="Worker "+this.name;return this.previous?this.previous+" -> "+l:l}},r.exports=a},{}],29:[function(n,r,i){var a=n("../utils"),l=n("./ConvertWorker"),u=n("./GenericWorker"),d=n("../base64"),y=n("../support"),j=n("../external"),_=null;if(y.nodestream)try{_=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function k(E,z){return new j.Promise(function(A,x){var g=[],S=E._internalType,L=E._outputType,B=E._mimeType;E.on("data",function(ie,J){g.push(ie),z&&z(J)}).on("error",function(ie){g=[],x(ie)}).on("end",function(){try{var ie=function(J,ue,ce){switch(J){case"blob":return a.newBlob(a.transformTo("arraybuffer",ue),ce);case"base64":return d.encode(ue);default:return a.transformTo(J,ue)}}(L,function(J,ue){var ce,me=0,Be=null,K=0;for(ce=0;ce<ue.length;ce++)K+=ue[ce].length;switch(J){case"string":return ue.join("");case"array":return Array.prototype.concat.apply([],ue);case"uint8array":for(Be=new Uint8Array(K),ce=0;ce<ue.length;ce++)Be.set(ue[ce],me),me+=ue[ce].length;return Be;case"nodebuffer":return Buffer.concat(ue);default:throw new Error("concat : unsupported type '"+J+"'")}}(S,g),B);A(ie)}catch(J){x(J)}g=[]}).resume()})}function b(E,z,A){var x=z;switch(z){case"blob":case"arraybuffer":x="uint8array";break;case"base64":x="string"}try{this._internalType=x,this._outputType=z,this._mimeType=A,a.checkSupport(x),this._worker=E.pipe(new l(x)),E.lock()}catch(g){this._worker=new u("error"),this._worker.error(g)}}b.prototype={accumulate:function(E){return k(this,E)},on:function(E,z){var A=this;return E==="data"?this._worker.on(E,function(x){z.call(A,x.data,x.meta)}):this._worker.on(E,function(){a.delay(z,arguments,A)}),this},resume:function(){return a.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(E){if(a.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new _(this,{objectMode:this._outputType!=="nodebuffer"},E)}},r.exports=b},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,r,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var a=new ArrayBuffer(0);try{i.blob=new Blob([a],{type:"application/zip"}).size===0}catch{try{var l=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);l.append(a),i.blob=l.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!n("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(n,r,i){for(var a=n("./utils"),l=n("./support"),u=n("./nodejsUtils"),d=n("./stream/GenericWorker"),y=new Array(256),j=0;j<256;j++)y[j]=252<=j?6:248<=j?5:240<=j?4:224<=j?3:192<=j?2:1;y[254]=y[254]=1;function _(){d.call(this,"utf-8 decode"),this.leftOver=null}function k(){d.call(this,"utf-8 encode")}i.utf8encode=function(b){return l.nodebuffer?u.newBufferFrom(b,"utf-8"):function(E){var z,A,x,g,S,L=E.length,B=0;for(g=0;g<L;g++)(64512&(A=E.charCodeAt(g)))==55296&&g+1<L&&(64512&(x=E.charCodeAt(g+1)))==56320&&(A=65536+(A-55296<<10)+(x-56320),g++),B+=A<128?1:A<2048?2:A<65536?3:4;for(z=l.uint8array?new Uint8Array(B):new Array(B),g=S=0;S<B;g++)(64512&(A=E.charCodeAt(g)))==55296&&g+1<L&&(64512&(x=E.charCodeAt(g+1)))==56320&&(A=65536+(A-55296<<10)+(x-56320),g++),A<128?z[S++]=A:(A<2048?z[S++]=192|A>>>6:(A<65536?z[S++]=224|A>>>12:(z[S++]=240|A>>>18,z[S++]=128|A>>>12&63),z[S++]=128|A>>>6&63),z[S++]=128|63&A);return z}(b)},i.utf8decode=function(b){return l.nodebuffer?a.transformTo("nodebuffer",b).toString("utf-8"):function(E){var z,A,x,g,S=E.length,L=new Array(2*S);for(z=A=0;z<S;)if((x=E[z++])<128)L[A++]=x;else if(4<(g=y[x]))L[A++]=65533,z+=g-1;else{for(x&=g===2?31:g===3?15:7;1<g&&z<S;)x=x<<6|63&E[z++],g--;1<g?L[A++]=65533:x<65536?L[A++]=x:(x-=65536,L[A++]=55296|x>>10&1023,L[A++]=56320|1023&x)}return L.length!==A&&(L.subarray?L=L.subarray(0,A):L.length=A),a.applyFromCharCode(L)}(b=a.transformTo(l.uint8array?"uint8array":"array",b))},a.inherits(_,d),_.prototype.processChunk=function(b){var E=a.transformTo(l.uint8array?"uint8array":"array",b.data);if(this.leftOver&&this.leftOver.length){if(l.uint8array){var z=E;(E=new Uint8Array(z.length+this.leftOver.length)).set(this.leftOver,0),E.set(z,this.leftOver.length)}else E=this.leftOver.concat(E);this.leftOver=null}var A=function(g,S){var L;for((S=S||g.length)>g.length&&(S=g.length),L=S-1;0<=L&&(192&g[L])==128;)L--;return L<0||L===0?S:L+y[g[L]]>S?L:S}(E),x=E;A!==E.length&&(l.uint8array?(x=E.subarray(0,A),this.leftOver=E.subarray(A,E.length)):(x=E.slice(0,A),this.leftOver=E.slice(A,E.length))),this.push({data:i.utf8decode(x),meta:b.meta})},_.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=_,a.inherits(k,d),k.prototype.processChunk=function(b){this.push({data:i.utf8encode(b.data),meta:b.meta})},i.Utf8EncodeWorker=k},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,r,i){var a=n("./support"),l=n("./base64"),u=n("./nodejsUtils"),d=n("./external");function y(z){return z}function j(z,A){for(var x=0;x<z.length;++x)A[x]=255&z.charCodeAt(x);return A}n("setimmediate"),i.newBlob=function(z,A){i.checkSupport("blob");try{return new Blob([z],{type:A})}catch{try{var x=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return x.append(z),x.getBlob(A)}catch{throw new Error("Bug : can't construct the Blob.")}}};var _={stringifyByChunk:function(z,A,x){var g=[],S=0,L=z.length;if(L<=x)return String.fromCharCode.apply(null,z);for(;S<L;)A==="array"||A==="nodebuffer"?g.push(String.fromCharCode.apply(null,z.slice(S,Math.min(S+x,L)))):g.push(String.fromCharCode.apply(null,z.subarray(S,Math.min(S+x,L)))),S+=x;return g.join("")},stringifyByChar:function(z){for(var A="",x=0;x<z.length;x++)A+=String.fromCharCode(z[x]);return A},applyCanBeUsed:{uint8array:function(){try{return a.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return a.nodebuffer&&String.fromCharCode.apply(null,u.allocBuffer(1)).length===1}catch{return!1}}()}};function k(z){var A=65536,x=i.getTypeOf(z),g=!0;if(x==="uint8array"?g=_.applyCanBeUsed.uint8array:x==="nodebuffer"&&(g=_.applyCanBeUsed.nodebuffer),g)for(;1<A;)try{return _.stringifyByChunk(z,x,A)}catch{A=Math.floor(A/2)}return _.stringifyByChar(z)}function b(z,A){for(var x=0;x<z.length;x++)A[x]=z[x];return A}i.applyFromCharCode=k;var E={};E.string={string:y,array:function(z){return j(z,new Array(z.length))},arraybuffer:function(z){return E.string.uint8array(z).buffer},uint8array:function(z){return j(z,new Uint8Array(z.length))},nodebuffer:function(z){return j(z,u.allocBuffer(z.length))}},E.array={string:k,array:y,arraybuffer:function(z){return new Uint8Array(z).buffer},uint8array:function(z){return new Uint8Array(z)},nodebuffer:function(z){return u.newBufferFrom(z)}},E.arraybuffer={string:function(z){return k(new Uint8Array(z))},array:function(z){return b(new Uint8Array(z),new Array(z.byteLength))},arraybuffer:y,uint8array:function(z){return new Uint8Array(z)},nodebuffer:function(z){return u.newBufferFrom(new Uint8Array(z))}},E.uint8array={string:k,array:function(z){return b(z,new Array(z.length))},arraybuffer:function(z){return z.buffer},uint8array:y,nodebuffer:function(z){return u.newBufferFrom(z)}},E.nodebuffer={string:k,array:function(z){return b(z,new Array(z.length))},arraybuffer:function(z){return E.nodebuffer.uint8array(z).buffer},uint8array:function(z){return b(z,new Uint8Array(z.length))},nodebuffer:y},i.transformTo=function(z,A){if(A=A||"",!z)return A;i.checkSupport(z);var x=i.getTypeOf(A);return E[x][z](A)},i.resolve=function(z){for(var A=z.split("/"),x=[],g=0;g<A.length;g++){var S=A[g];S==="."||S===""&&g!==0&&g!==A.length-1||(S===".."?x.pop():x.push(S))}return x.join("/")},i.getTypeOf=function(z){return typeof z=="string"?"string":Object.prototype.toString.call(z)==="[object Array]"?"array":a.nodebuffer&&u.isBuffer(z)?"nodebuffer":a.uint8array&&z instanceof Uint8Array?"uint8array":a.arraybuffer&&z instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(z){if(!a[z.toLowerCase()])throw new Error(z+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(z){var A,x,g="";for(x=0;x<(z||"").length;x++)g+="\\x"+((A=z.charCodeAt(x))<16?"0":"")+A.toString(16).toUpperCase();return g},i.delay=function(z,A,x){setImmediate(function(){z.apply(x||null,A||[])})},i.inherits=function(z,A){function x(){}x.prototype=A.prototype,z.prototype=new x},i.extend=function(){var z,A,x={};for(z=0;z<arguments.length;z++)for(A in arguments[z])Object.prototype.hasOwnProperty.call(arguments[z],A)&&x[A]===void 0&&(x[A]=arguments[z][A]);return x},i.prepareContent=function(z,A,x,g,S){return d.Promise.resolve(A).then(function(L){return a.blob&&(L instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(L))!==-1)&&typeof FileReader<"u"?new d.Promise(function(B,ie){var J=new FileReader;J.onload=function(ue){B(ue.target.result)},J.onerror=function(ue){ie(ue.target.error)},J.readAsArrayBuffer(L)}):L}).then(function(L){var B=i.getTypeOf(L);return B?(B==="arraybuffer"?L=i.transformTo("uint8array",L):B==="string"&&(S?L=l.decode(L):x&&g!==!0&&(L=function(ie){return j(ie,a.uint8array?new Uint8Array(ie.length):new Array(ie.length))}(L))),L):d.Promise.reject(new Error("Can't read the data of '"+z+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,r,i){var a=n("./reader/readerFor"),l=n("./utils"),u=n("./signature"),d=n("./zipEntry"),y=n("./support");function j(_){this.files=[],this.loadOptions=_}j.prototype={checkSignature:function(_){if(!this.reader.readAndCheckSignature(_)){this.reader.index-=4;var k=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+l.pretty(k)+", expected "+l.pretty(_)+")")}},isSignature:function(_,k){var b=this.reader.index;this.reader.setIndex(_);var E=this.reader.readString(4)===k;return this.reader.setIndex(b),E},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var _=this.reader.readData(this.zipCommentLength),k=y.uint8array?"uint8array":"array",b=l.transformTo(k,_);this.zipComment=this.loadOptions.decodeFileName(b)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var _,k,b,E=this.zip64EndOfCentralSize-44;0<E;)_=this.reader.readInt(2),k=this.reader.readInt(4),b=this.reader.readData(k),this.zip64ExtensibleData[_]={id:_,length:k,value:b}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var _,k;for(_=0;_<this.files.length;_++)k=this.files[_],this.reader.setIndex(k.localHeaderOffset),this.checkSignature(u.LOCAL_FILE_HEADER),k.readLocalPart(this.reader),k.handleUTF8(),k.processAttributes()},readCentralDir:function(){var _;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(u.CENTRAL_FILE_HEADER);)(_=new d({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(_);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var _=this.reader.lastIndexOfSignature(u.CENTRAL_DIRECTORY_END);if(_<0)throw this.isSignature(0,u.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(_);var k=_;if(this.checkSignature(u.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===l.MAX_VALUE_16BITS||this.diskWithCentralDirStart===l.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===l.MAX_VALUE_16BITS||this.centralDirRecords===l.MAX_VALUE_16BITS||this.centralDirSize===l.MAX_VALUE_32BITS||this.centralDirOffset===l.MAX_VALUE_32BITS){if(this.zip64=!0,(_=this.reader.lastIndexOfSignature(u.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(_),this.checkSignature(u.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,u.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(u.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(u.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var b=this.centralDirOffset+this.centralDirSize;this.zip64&&(b+=20,b+=12+this.zip64EndOfCentralSize);var E=k-b;if(0<E)this.isSignature(k,u.CENTRAL_FILE_HEADER)||(this.reader.zero=E);else if(E<0)throw new Error("Corrupted zip: missing "+Math.abs(E)+" bytes.")},prepareReader:function(_){this.reader=a(_)},load:function(_){this.prepareReader(_),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=j},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,r,i){var a=n("./reader/readerFor"),l=n("./utils"),u=n("./compressedObject"),d=n("./crc32"),y=n("./utf8"),j=n("./compressions"),_=n("./support");function k(b,E){this.options=b,this.loadOptions=E}k.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(b){var E,z;if(b.skip(22),this.fileNameLength=b.readInt(2),z=b.readInt(2),this.fileName=b.readData(this.fileNameLength),b.skip(z),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((E=function(A){for(var x in j)if(Object.prototype.hasOwnProperty.call(j,x)&&j[x].magic===A)return j[x];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+l.pretty(this.compressionMethod)+" unknown (inner file : "+l.transformTo("string",this.fileName)+")");this.decompressed=new u(this.compressedSize,this.uncompressedSize,this.crc32,E,b.readData(this.compressedSize))},readCentralPart:function(b){this.versionMadeBy=b.readInt(2),b.skip(2),this.bitFlag=b.readInt(2),this.compressionMethod=b.readString(2),this.date=b.readDate(),this.crc32=b.readInt(4),this.compressedSize=b.readInt(4),this.uncompressedSize=b.readInt(4);var E=b.readInt(2);if(this.extraFieldsLength=b.readInt(2),this.fileCommentLength=b.readInt(2),this.diskNumberStart=b.readInt(2),this.internalFileAttributes=b.readInt(2),this.externalFileAttributes=b.readInt(4),this.localHeaderOffset=b.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");b.skip(E),this.readExtraFields(b),this.parseZIP64ExtraField(b),this.fileComment=b.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var b=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),b==0&&(this.dosPermissions=63&this.externalFileAttributes),b==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var b=a(this.extraFields[1].value);this.uncompressedSize===l.MAX_VALUE_32BITS&&(this.uncompressedSize=b.readInt(8)),this.compressedSize===l.MAX_VALUE_32BITS&&(this.compressedSize=b.readInt(8)),this.localHeaderOffset===l.MAX_VALUE_32BITS&&(this.localHeaderOffset=b.readInt(8)),this.diskNumberStart===l.MAX_VALUE_32BITS&&(this.diskNumberStart=b.readInt(4))}},readExtraFields:function(b){var E,z,A,x=b.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});b.index+4<x;)E=b.readInt(2),z=b.readInt(2),A=b.readData(z),this.extraFields[E]={id:E,length:z,value:A};b.setIndex(x)},handleUTF8:function(){var b=_.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=y.utf8decode(this.fileName),this.fileCommentStr=y.utf8decode(this.fileComment);else{var E=this.findExtraFieldUnicodePath();if(E!==null)this.fileNameStr=E;else{var z=l.transformTo(b,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(z)}var A=this.findExtraFieldUnicodeComment();if(A!==null)this.fileCommentStr=A;else{var x=l.transformTo(b,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(x)}}},findExtraFieldUnicodePath:function(){var b=this.extraFields[28789];if(b){var E=a(b.value);return E.readInt(1)!==1||d(this.fileName)!==E.readInt(4)?null:y.utf8decode(E.readData(b.length-5))}return null},findExtraFieldUnicodeComment:function(){var b=this.extraFields[25461];if(b){var E=a(b.value);return E.readInt(1)!==1||d(this.fileComment)!==E.readInt(4)?null:y.utf8decode(E.readData(b.length-5))}return null}},r.exports=k},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,r,i){function a(E,z,A){this.name=E,this.dir=A.dir,this.date=A.date,this.comment=A.comment,this.unixPermissions=A.unixPermissions,this.dosPermissions=A.dosPermissions,this._data=z,this._dataBinary=A.binary,this.options={compression:A.compression,compressionOptions:A.compressionOptions}}var l=n("./stream/StreamHelper"),u=n("./stream/DataWorker"),d=n("./utf8"),y=n("./compressedObject"),j=n("./stream/GenericWorker");a.prototype={internalStream:function(E){var z=null,A="string";try{if(!E)throw new Error("No output type specified.");var x=(A=E.toLowerCase())==="string"||A==="text";A!=="binarystring"&&A!=="text"||(A="string"),z=this._decompressWorker();var g=!this._dataBinary;g&&!x&&(z=z.pipe(new d.Utf8EncodeWorker)),!g&&x&&(z=z.pipe(new d.Utf8DecodeWorker))}catch(S){(z=new j("error")).error(S)}return new l(z,A,"")},async:function(E,z){return this.internalStream(E).accumulate(z)},nodeStream:function(E,z){return this.internalStream(E||"nodebuffer").toNodejsStream(z)},_compressWorker:function(E,z){if(this._data instanceof y&&this._data.compression.magic===E.magic)return this._data.getCompressedWorker();var A=this._decompressWorker();return this._dataBinary||(A=A.pipe(new d.Utf8EncodeWorker)),y.createWorkerFrom(A,E,z)},_decompressWorker:function(){return this._data instanceof y?this._data.getContentWorker():this._data instanceof j?this._data:new u(this._data)}};for(var _=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],k=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},b=0;b<_.length;b++)a.prototype[_[b]]=k;r.exports=a},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,r,i){(function(a){var l,u,d=a.MutationObserver||a.WebKitMutationObserver;if(d){var y=0,j=new d(E),_=a.document.createTextNode("");j.observe(_,{characterData:!0}),l=function(){_.data=y=++y%2}}else if(a.setImmediate||a.MessageChannel===void 0)l="document"in a&&"onreadystatechange"in a.document.createElement("script")?function(){var z=a.document.createElement("script");z.onreadystatechange=function(){E(),z.onreadystatechange=null,z.parentNode.removeChild(z),z=null},a.document.documentElement.appendChild(z)}:function(){setTimeout(E,0)};else{var k=new a.MessageChannel;k.port1.onmessage=E,l=function(){k.port2.postMessage(0)}}var b=[];function E(){var z,A;u=!0;for(var x=b.length;x;){for(A=b,b=[],z=-1;++z<x;)A[z]();x=b.length}u=!1}r.exports=function(z){b.push(z)!==1||u||l()}}).call(this,typeof ei<"u"?ei:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,r,i){var a=n("immediate");function l(){}var u={},d=["REJECTED"],y=["FULFILLED"],j=["PENDING"];function _(x){if(typeof x!="function")throw new TypeError("resolver must be a function");this.state=j,this.queue=[],this.outcome=void 0,x!==l&&z(this,x)}function k(x,g,S){this.promise=x,typeof g=="function"&&(this.onFulfilled=g,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}function b(x,g,S){a(function(){var L;try{L=g(S)}catch(B){return u.reject(x,B)}L===x?u.reject(x,new TypeError("Cannot resolve promise with itself")):u.resolve(x,L)})}function E(x){var g=x&&x.then;if(x&&(typeof x=="object"||typeof x=="function")&&typeof g=="function")return function(){g.apply(x,arguments)}}function z(x,g){var S=!1;function L(J){S||(S=!0,u.reject(x,J))}function B(J){S||(S=!0,u.resolve(x,J))}var ie=A(function(){g(B,L)});ie.status==="error"&&L(ie.value)}function A(x,g){var S={};try{S.value=x(g),S.status="success"}catch(L){S.status="error",S.value=L}return S}(r.exports=_).prototype.finally=function(x){if(typeof x!="function")return this;var g=this.constructor;return this.then(function(S){return g.resolve(x()).then(function(){return S})},function(S){return g.resolve(x()).then(function(){throw S})})},_.prototype.catch=function(x){return this.then(null,x)},_.prototype.then=function(x,g){if(typeof x!="function"&&this.state===y||typeof g!="function"&&this.state===d)return this;var S=new this.constructor(l);return this.state!==j?b(S,this.state===y?x:g,this.outcome):this.queue.push(new k(S,x,g)),S},k.prototype.callFulfilled=function(x){u.resolve(this.promise,x)},k.prototype.otherCallFulfilled=function(x){b(this.promise,this.onFulfilled,x)},k.prototype.callRejected=function(x){u.reject(this.promise,x)},k.prototype.otherCallRejected=function(x){b(this.promise,this.onRejected,x)},u.resolve=function(x,g){var S=A(E,g);if(S.status==="error")return u.reject(x,S.value);var L=S.value;if(L)z(x,L);else{x.state=y,x.outcome=g;for(var B=-1,ie=x.queue.length;++B<ie;)x.queue[B].callFulfilled(g)}return x},u.reject=function(x,g){x.state=d,x.outcome=g;for(var S=-1,L=x.queue.length;++S<L;)x.queue[S].callRejected(g);return x},_.resolve=function(x){return x instanceof this?x:u.resolve(new this(l),x)},_.reject=function(x){var g=new this(l);return u.reject(g,x)},_.all=function(x){var g=this;if(Object.prototype.toString.call(x)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=x.length,L=!1;if(!S)return this.resolve([]);for(var B=new Array(S),ie=0,J=-1,ue=new this(l);++J<S;)ce(x[J],J);return ue;function ce(me,Be){g.resolve(me).then(function(K){B[Be]=K,++ie!==S||L||(L=!0,u.resolve(ue,B))},function(K){L||(L=!0,u.reject(ue,K))})}},_.race=function(x){var g=this;if(Object.prototype.toString.call(x)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=x.length,L=!1;if(!S)return this.resolve([]);for(var B=-1,ie=new this(l);++B<S;)J=x[B],g.resolve(J).then(function(ue){L||(L=!0,u.resolve(ie,ue))},function(ue){L||(L=!0,u.reject(ie,ue))});var J;return ie}},{immediate:36}],38:[function(n,r,i){var a={};(0,n("./lib/utils/common").assign)(a,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),r.exports=a},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,r,i){var a=n("./zlib/deflate"),l=n("./utils/common"),u=n("./utils/strings"),d=n("./zlib/messages"),y=n("./zlib/zstream"),j=Object.prototype.toString,_=0,k=-1,b=0,E=8;function z(x){if(!(this instanceof z))return new z(x);this.options=l.assign({level:k,method:E,chunkSize:16384,windowBits:15,memLevel:8,strategy:b,to:""},x||{});var g=this.options;g.raw&&0<g.windowBits?g.windowBits=-g.windowBits:g.gzip&&0<g.windowBits&&g.windowBits<16&&(g.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new y,this.strm.avail_out=0;var S=a.deflateInit2(this.strm,g.level,g.method,g.windowBits,g.memLevel,g.strategy);if(S!==_)throw new Error(d[S]);if(g.header&&a.deflateSetHeader(this.strm,g.header),g.dictionary){var L;if(L=typeof g.dictionary=="string"?u.string2buf(g.dictionary):j.call(g.dictionary)==="[object ArrayBuffer]"?new Uint8Array(g.dictionary):g.dictionary,(S=a.deflateSetDictionary(this.strm,L))!==_)throw new Error(d[S]);this._dict_set=!0}}function A(x,g){var S=new z(g);if(S.push(x,!0),S.err)throw S.msg||d[S.err];return S.result}z.prototype.push=function(x,g){var S,L,B=this.strm,ie=this.options.chunkSize;if(this.ended)return!1;L=g===~~g?g:g===!0?4:0,typeof x=="string"?B.input=u.string2buf(x):j.call(x)==="[object ArrayBuffer]"?B.input=new Uint8Array(x):B.input=x,B.next_in=0,B.avail_in=B.input.length;do{if(B.avail_out===0&&(B.output=new l.Buf8(ie),B.next_out=0,B.avail_out=ie),(S=a.deflate(B,L))!==1&&S!==_)return this.onEnd(S),!(this.ended=!0);B.avail_out!==0&&(B.avail_in!==0||L!==4&&L!==2)||(this.options.to==="string"?this.onData(u.buf2binstring(l.shrinkBuf(B.output,B.next_out))):this.onData(l.shrinkBuf(B.output,B.next_out)))}while((0<B.avail_in||B.avail_out===0)&&S!==1);return L===4?(S=a.deflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===_):L!==2||(this.onEnd(_),!(B.avail_out=0))},z.prototype.onData=function(x){this.chunks.push(x)},z.prototype.onEnd=function(x){x===_&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=x,this.msg=this.strm.msg},i.Deflate=z,i.deflate=A,i.deflateRaw=function(x,g){return(g=g||{}).raw=!0,A(x,g)},i.gzip=function(x,g){return(g=g||{}).gzip=!0,A(x,g)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,r,i){var a=n("./zlib/inflate"),l=n("./utils/common"),u=n("./utils/strings"),d=n("./zlib/constants"),y=n("./zlib/messages"),j=n("./zlib/zstream"),_=n("./zlib/gzheader"),k=Object.prototype.toString;function b(z){if(!(this instanceof b))return new b(z);this.options=l.assign({chunkSize:16384,windowBits:0,to:""},z||{});var A=this.options;A.raw&&0<=A.windowBits&&A.windowBits<16&&(A.windowBits=-A.windowBits,A.windowBits===0&&(A.windowBits=-15)),!(0<=A.windowBits&&A.windowBits<16)||z&&z.windowBits||(A.windowBits+=32),15<A.windowBits&&A.windowBits<48&&!(15&A.windowBits)&&(A.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new j,this.strm.avail_out=0;var x=a.inflateInit2(this.strm,A.windowBits);if(x!==d.Z_OK)throw new Error(y[x]);this.header=new _,a.inflateGetHeader(this.strm,this.header)}function E(z,A){var x=new b(A);if(x.push(z,!0),x.err)throw x.msg||y[x.err];return x.result}b.prototype.push=function(z,A){var x,g,S,L,B,ie,J=this.strm,ue=this.options.chunkSize,ce=this.options.dictionary,me=!1;if(this.ended)return!1;g=A===~~A?A:A===!0?d.Z_FINISH:d.Z_NO_FLUSH,typeof z=="string"?J.input=u.binstring2buf(z):k.call(z)==="[object ArrayBuffer]"?J.input=new Uint8Array(z):J.input=z,J.next_in=0,J.avail_in=J.input.length;do{if(J.avail_out===0&&(J.output=new l.Buf8(ue),J.next_out=0,J.avail_out=ue),(x=a.inflate(J,d.Z_NO_FLUSH))===d.Z_NEED_DICT&&ce&&(ie=typeof ce=="string"?u.string2buf(ce):k.call(ce)==="[object ArrayBuffer]"?new Uint8Array(ce):ce,x=a.inflateSetDictionary(this.strm,ie)),x===d.Z_BUF_ERROR&&me===!0&&(x=d.Z_OK,me=!1),x!==d.Z_STREAM_END&&x!==d.Z_OK)return this.onEnd(x),!(this.ended=!0);J.next_out&&(J.avail_out!==0&&x!==d.Z_STREAM_END&&(J.avail_in!==0||g!==d.Z_FINISH&&g!==d.Z_SYNC_FLUSH)||(this.options.to==="string"?(S=u.utf8border(J.output,J.next_out),L=J.next_out-S,B=u.buf2string(J.output,S),J.next_out=L,J.avail_out=ue-L,L&&l.arraySet(J.output,J.output,S,L,0),this.onData(B)):this.onData(l.shrinkBuf(J.output,J.next_out)))),J.avail_in===0&&J.avail_out===0&&(me=!0)}while((0<J.avail_in||J.avail_out===0)&&x!==d.Z_STREAM_END);return x===d.Z_STREAM_END&&(g=d.Z_FINISH),g===d.Z_FINISH?(x=a.inflateEnd(this.strm),this.onEnd(x),this.ended=!0,x===d.Z_OK):g!==d.Z_SYNC_FLUSH||(this.onEnd(d.Z_OK),!(J.avail_out=0))},b.prototype.onData=function(z){this.chunks.push(z)},b.prototype.onEnd=function(z){z===d.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=z,this.msg=this.strm.msg},i.Inflate=b,i.inflate=E,i.inflateRaw=function(z,A){return(A=A||{}).raw=!0,E(z,A)},i.ungzip=E},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,r,i){var a=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(d){for(var y=Array.prototype.slice.call(arguments,1);y.length;){var j=y.shift();if(j){if(typeof j!="object")throw new TypeError(j+"must be non-object");for(var _ in j)j.hasOwnProperty(_)&&(d[_]=j[_])}}return d},i.shrinkBuf=function(d,y){return d.length===y?d:d.subarray?d.subarray(0,y):(d.length=y,d)};var l={arraySet:function(d,y,j,_,k){if(y.subarray&&d.subarray)d.set(y.subarray(j,j+_),k);else for(var b=0;b<_;b++)d[k+b]=y[j+b]},flattenChunks:function(d){var y,j,_,k,b,E;for(y=_=0,j=d.length;y<j;y++)_+=d[y].length;for(E=new Uint8Array(_),y=k=0,j=d.length;y<j;y++)b=d[y],E.set(b,k),k+=b.length;return E}},u={arraySet:function(d,y,j,_,k){for(var b=0;b<_;b++)d[k+b]=y[j+b]},flattenChunks:function(d){return[].concat.apply([],d)}};i.setTyped=function(d){d?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,l)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,u))},i.setTyped(a)},{}],42:[function(n,r,i){var a=n("./common"),l=!0,u=!0;try{String.fromCharCode.apply(null,[0])}catch{l=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{u=!1}for(var d=new a.Buf8(256),y=0;y<256;y++)d[y]=252<=y?6:248<=y?5:240<=y?4:224<=y?3:192<=y?2:1;function j(_,k){if(k<65537&&(_.subarray&&u||!_.subarray&&l))return String.fromCharCode.apply(null,a.shrinkBuf(_,k));for(var b="",E=0;E<k;E++)b+=String.fromCharCode(_[E]);return b}d[254]=d[254]=1,i.string2buf=function(_){var k,b,E,z,A,x=_.length,g=0;for(z=0;z<x;z++)(64512&(b=_.charCodeAt(z)))==55296&&z+1<x&&(64512&(E=_.charCodeAt(z+1)))==56320&&(b=65536+(b-55296<<10)+(E-56320),z++),g+=b<128?1:b<2048?2:b<65536?3:4;for(k=new a.Buf8(g),z=A=0;A<g;z++)(64512&(b=_.charCodeAt(z)))==55296&&z+1<x&&(64512&(E=_.charCodeAt(z+1)))==56320&&(b=65536+(b-55296<<10)+(E-56320),z++),b<128?k[A++]=b:(b<2048?k[A++]=192|b>>>6:(b<65536?k[A++]=224|b>>>12:(k[A++]=240|b>>>18,k[A++]=128|b>>>12&63),k[A++]=128|b>>>6&63),k[A++]=128|63&b);return k},i.buf2binstring=function(_){return j(_,_.length)},i.binstring2buf=function(_){for(var k=new a.Buf8(_.length),b=0,E=k.length;b<E;b++)k[b]=_.charCodeAt(b);return k},i.buf2string=function(_,k){var b,E,z,A,x=k||_.length,g=new Array(2*x);for(b=E=0;b<x;)if((z=_[b++])<128)g[E++]=z;else if(4<(A=d[z]))g[E++]=65533,b+=A-1;else{for(z&=A===2?31:A===3?15:7;1<A&&b<x;)z=z<<6|63&_[b++],A--;1<A?g[E++]=65533:z<65536?g[E++]=z:(z-=65536,g[E++]=55296|z>>10&1023,g[E++]=56320|1023&z)}return j(g,E)},i.utf8border=function(_,k){var b;for((k=k||_.length)>_.length&&(k=_.length),b=k-1;0<=b&&(192&_[b])==128;)b--;return b<0||b===0?k:b+d[_[b]]>k?b:k}},{"./common":41}],43:[function(n,r,i){r.exports=function(a,l,u,d){for(var y=65535&a|0,j=a>>>16&65535|0,_=0;u!==0;){for(u-=_=2e3<u?2e3:u;j=j+(y=y+l[d++]|0)|0,--_;);y%=65521,j%=65521}return y|j<<16|0}},{}],44:[function(n,r,i){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,r,i){var a=function(){for(var l,u=[],d=0;d<256;d++){l=d;for(var y=0;y<8;y++)l=1&l?3988292384^l>>>1:l>>>1;u[d]=l}return u}();r.exports=function(l,u,d,y){var j=a,_=y+d;l^=-1;for(var k=y;k<_;k++)l=l>>>8^j[255&(l^u[k])];return-1^l}},{}],46:[function(n,r,i){var a,l=n("../utils/common"),u=n("./trees"),d=n("./adler32"),y=n("./crc32"),j=n("./messages"),_=0,k=4,b=0,E=-2,z=-1,A=4,x=2,g=8,S=9,L=286,B=30,ie=19,J=2*L+1,ue=15,ce=3,me=258,Be=me+ce+1,K=42,xe=113,v=1,ge=2,rt=3,ze=4;function we(w,je){return w.msg=j[je],je}function ae(w){return(w<<1)-(4<w?9:0)}function Re(w){for(var je=w.length;0<=--je;)w[je]=0}function X(w){var je=w.state,he=je.pending;he>w.avail_out&&(he=w.avail_out),he!==0&&(l.arraySet(w.output,je.pending_buf,je.pending_out,he,w.next_out),w.next_out+=he,je.pending_out+=he,w.total_out+=he,w.avail_out-=he,je.pending-=he,je.pending===0&&(je.pending_out=0))}function oe(w,je){u._tr_flush_block(w,0<=w.block_start?w.block_start:-1,w.strstart-w.block_start,je),w.block_start=w.strstart,X(w.strm)}function Ve(w,je){w.pending_buf[w.pending++]=je}function Ye(w,je){w.pending_buf[w.pending++]=je>>>8&255,w.pending_buf[w.pending++]=255&je}function Ee(w,je){var he,F,O=w.max_chain_length,ee=w.strstart,Se=w.prev_length,Te=w.nice_match,Q=w.strstart>w.w_size-Be?w.strstart-(w.w_size-Be):0,ye=w.window,Qe=w.w_mask,De=w.prev,it=w.strstart+me,jt=ye[ee+Se-1],It=ye[ee+Se];w.prev_length>=w.good_match&&(O>>=2),Te>w.lookahead&&(Te=w.lookahead);do if(ye[(he=je)+Se]===It&&ye[he+Se-1]===jt&&ye[he]===ye[ee]&&ye[++he]===ye[ee+1]){ee+=2,he++;do;while(ye[++ee]===ye[++he]&&ye[++ee]===ye[++he]&&ye[++ee]===ye[++he]&&ye[++ee]===ye[++he]&&ye[++ee]===ye[++he]&&ye[++ee]===ye[++he]&&ye[++ee]===ye[++he]&&ye[++ee]===ye[++he]&&ee<it);if(F=me-(it-ee),ee=it-me,Se<F){if(w.match_start=je,Te<=(Se=F))break;jt=ye[ee+Se-1],It=ye[ee+Se]}}while((je=De[je&Qe])>Q&&--O!=0);return Se<=w.lookahead?Se:w.lookahead}function Lt(w){var je,he,F,O,ee,Se,Te,Q,ye,Qe,De=w.w_size;do{if(O=w.window_size-w.lookahead-w.strstart,w.strstart>=De+(De-Be)){for(l.arraySet(w.window,w.window,De,De,0),w.match_start-=De,w.strstart-=De,w.block_start-=De,je=he=w.hash_size;F=w.head[--je],w.head[je]=De<=F?F-De:0,--he;);for(je=he=De;F=w.prev[--je],w.prev[je]=De<=F?F-De:0,--he;);O+=De}if(w.strm.avail_in===0)break;if(Se=w.strm,Te=w.window,Q=w.strstart+w.lookahead,ye=O,Qe=void 0,Qe=Se.avail_in,ye<Qe&&(Qe=ye),he=Qe===0?0:(Se.avail_in-=Qe,l.arraySet(Te,Se.input,Se.next_in,Qe,Q),Se.state.wrap===1?Se.adler=d(Se.adler,Te,Qe,Q):Se.state.wrap===2&&(Se.adler=y(Se.adler,Te,Qe,Q)),Se.next_in+=Qe,Se.total_in+=Qe,Qe),w.lookahead+=he,w.lookahead+w.insert>=ce)for(ee=w.strstart-w.insert,w.ins_h=w.window[ee],w.ins_h=(w.ins_h<<w.hash_shift^w.window[ee+1])&w.hash_mask;w.insert&&(w.ins_h=(w.ins_h<<w.hash_shift^w.window[ee+ce-1])&w.hash_mask,w.prev[ee&w.w_mask]=w.head[w.ins_h],w.head[w.ins_h]=ee,ee++,w.insert--,!(w.lookahead+w.insert<ce)););}while(w.lookahead<Be&&w.strm.avail_in!==0)}function Zt(w,je){for(var he,F;;){if(w.lookahead<Be){if(Lt(w),w.lookahead<Be&&je===_)return v;if(w.lookahead===0)break}if(he=0,w.lookahead>=ce&&(w.ins_h=(w.ins_h<<w.hash_shift^w.window[w.strstart+ce-1])&w.hash_mask,he=w.prev[w.strstart&w.w_mask]=w.head[w.ins_h],w.head[w.ins_h]=w.strstart),he!==0&&w.strstart-he<=w.w_size-Be&&(w.match_length=Ee(w,he)),w.match_length>=ce)if(F=u._tr_tally(w,w.strstart-w.match_start,w.match_length-ce),w.lookahead-=w.match_length,w.match_length<=w.max_lazy_match&&w.lookahead>=ce){for(w.match_length--;w.strstart++,w.ins_h=(w.ins_h<<w.hash_shift^w.window[w.strstart+ce-1])&w.hash_mask,he=w.prev[w.strstart&w.w_mask]=w.head[w.ins_h],w.head[w.ins_h]=w.strstart,--w.match_length!=0;);w.strstart++}else w.strstart+=w.match_length,w.match_length=0,w.ins_h=w.window[w.strstart],w.ins_h=(w.ins_h<<w.hash_shift^w.window[w.strstart+1])&w.hash_mask;else F=u._tr_tally(w,0,w.window[w.strstart]),w.lookahead--,w.strstart++;if(F&&(oe(w,!1),w.strm.avail_out===0))return v}return w.insert=w.strstart<ce-1?w.strstart:ce-1,je===k?(oe(w,!0),w.strm.avail_out===0?rt:ze):w.last_lit&&(oe(w,!1),w.strm.avail_out===0)?v:ge}function Et(w,je){for(var he,F,O;;){if(w.lookahead<Be){if(Lt(w),w.lookahead<Be&&je===_)return v;if(w.lookahead===0)break}if(he=0,w.lookahead>=ce&&(w.ins_h=(w.ins_h<<w.hash_shift^w.window[w.strstart+ce-1])&w.hash_mask,he=w.prev[w.strstart&w.w_mask]=w.head[w.ins_h],w.head[w.ins_h]=w.strstart),w.prev_length=w.match_length,w.prev_match=w.match_start,w.match_length=ce-1,he!==0&&w.prev_length<w.max_lazy_match&&w.strstart-he<=w.w_size-Be&&(w.match_length=Ee(w,he),w.match_length<=5&&(w.strategy===1||w.match_length===ce&&4096<w.strstart-w.match_start)&&(w.match_length=ce-1)),w.prev_length>=ce&&w.match_length<=w.prev_length){for(O=w.strstart+w.lookahead-ce,F=u._tr_tally(w,w.strstart-1-w.prev_match,w.prev_length-ce),w.lookahead-=w.prev_length-1,w.prev_length-=2;++w.strstart<=O&&(w.ins_h=(w.ins_h<<w.hash_shift^w.window[w.strstart+ce-1])&w.hash_mask,he=w.prev[w.strstart&w.w_mask]=w.head[w.ins_h],w.head[w.ins_h]=w.strstart),--w.prev_length!=0;);if(w.match_available=0,w.match_length=ce-1,w.strstart++,F&&(oe(w,!1),w.strm.avail_out===0))return v}else if(w.match_available){if((F=u._tr_tally(w,0,w.window[w.strstart-1]))&&oe(w,!1),w.strstart++,w.lookahead--,w.strm.avail_out===0)return v}else w.match_available=1,w.strstart++,w.lookahead--}return w.match_available&&(F=u._tr_tally(w,0,w.window[w.strstart-1]),w.match_available=0),w.insert=w.strstart<ce-1?w.strstart:ce-1,je===k?(oe(w,!0),w.strm.avail_out===0?rt:ze):w.last_lit&&(oe(w,!1),w.strm.avail_out===0)?v:ge}function Ht(w,je,he,F,O){this.good_length=w,this.max_lazy=je,this.nice_length=he,this.max_chain=F,this.func=O}function bn(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=g,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new l.Buf16(2*J),this.dyn_dtree=new l.Buf16(2*(2*B+1)),this.bl_tree=new l.Buf16(2*(2*ie+1)),Re(this.dyn_ltree),Re(this.dyn_dtree),Re(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new l.Buf16(ue+1),this.heap=new l.Buf16(2*L+1),Re(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new l.Buf16(2*L+1),Re(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Yt(w){var je;return w&&w.state?(w.total_in=w.total_out=0,w.data_type=x,(je=w.state).pending=0,je.pending_out=0,je.wrap<0&&(je.wrap=-je.wrap),je.status=je.wrap?K:xe,w.adler=je.wrap===2?0:1,je.last_flush=_,u._tr_init(je),b):we(w,E)}function Qn(w){var je=Yt(w);return je===b&&function(he){he.window_size=2*he.w_size,Re(he.head),he.max_lazy_match=a[he.level].max_lazy,he.good_match=a[he.level].good_length,he.nice_match=a[he.level].nice_length,he.max_chain_length=a[he.level].max_chain,he.strstart=0,he.block_start=0,he.lookahead=0,he.insert=0,he.match_length=he.prev_length=ce-1,he.match_available=0,he.ins_h=0}(w.state),je}function Un(w,je,he,F,O,ee){if(!w)return E;var Se=1;if(je===z&&(je=6),F<0?(Se=0,F=-F):15<F&&(Se=2,F-=16),O<1||S<O||he!==g||F<8||15<F||je<0||9<je||ee<0||A<ee)return we(w,E);F===8&&(F=9);var Te=new bn;return(w.state=Te).strm=w,Te.wrap=Se,Te.gzhead=null,Te.w_bits=F,Te.w_size=1<<Te.w_bits,Te.w_mask=Te.w_size-1,Te.hash_bits=O+7,Te.hash_size=1<<Te.hash_bits,Te.hash_mask=Te.hash_size-1,Te.hash_shift=~~((Te.hash_bits+ce-1)/ce),Te.window=new l.Buf8(2*Te.w_size),Te.head=new l.Buf16(Te.hash_size),Te.prev=new l.Buf16(Te.w_size),Te.lit_bufsize=1<<O+6,Te.pending_buf_size=4*Te.lit_bufsize,Te.pending_buf=new l.Buf8(Te.pending_buf_size),Te.d_buf=1*Te.lit_bufsize,Te.l_buf=3*Te.lit_bufsize,Te.level=je,Te.strategy=ee,Te.method=he,Qn(w)}a=[new Ht(0,0,0,0,function(w,je){var he=65535;for(he>w.pending_buf_size-5&&(he=w.pending_buf_size-5);;){if(w.lookahead<=1){if(Lt(w),w.lookahead===0&&je===_)return v;if(w.lookahead===0)break}w.strstart+=w.lookahead,w.lookahead=0;var F=w.block_start+he;if((w.strstart===0||w.strstart>=F)&&(w.lookahead=w.strstart-F,w.strstart=F,oe(w,!1),w.strm.avail_out===0)||w.strstart-w.block_start>=w.w_size-Be&&(oe(w,!1),w.strm.avail_out===0))return v}return w.insert=0,je===k?(oe(w,!0),w.strm.avail_out===0?rt:ze):(w.strstart>w.block_start&&(oe(w,!1),w.strm.avail_out),v)}),new Ht(4,4,8,4,Zt),new Ht(4,5,16,8,Zt),new Ht(4,6,32,32,Zt),new Ht(4,4,16,16,Et),new Ht(8,16,32,32,Et),new Ht(8,16,128,128,Et),new Ht(8,32,128,256,Et),new Ht(32,128,258,1024,Et),new Ht(32,258,258,4096,Et)],i.deflateInit=function(w,je){return Un(w,je,g,15,8,0)},i.deflateInit2=Un,i.deflateReset=Qn,i.deflateResetKeep=Yt,i.deflateSetHeader=function(w,je){return w&&w.state?w.state.wrap!==2?E:(w.state.gzhead=je,b):E},i.deflate=function(w,je){var he,F,O,ee;if(!w||!w.state||5<je||je<0)return w?we(w,E):E;if(F=w.state,!w.output||!w.input&&w.avail_in!==0||F.status===666&&je!==k)return we(w,w.avail_out===0?-5:E);if(F.strm=w,he=F.last_flush,F.last_flush=je,F.status===K)if(F.wrap===2)w.adler=0,Ve(F,31),Ve(F,139),Ve(F,8),F.gzhead?(Ve(F,(F.gzhead.text?1:0)+(F.gzhead.hcrc?2:0)+(F.gzhead.extra?4:0)+(F.gzhead.name?8:0)+(F.gzhead.comment?16:0)),Ve(F,255&F.gzhead.time),Ve(F,F.gzhead.time>>8&255),Ve(F,F.gzhead.time>>16&255),Ve(F,F.gzhead.time>>24&255),Ve(F,F.level===9?2:2<=F.strategy||F.level<2?4:0),Ve(F,255&F.gzhead.os),F.gzhead.extra&&F.gzhead.extra.length&&(Ve(F,255&F.gzhead.extra.length),Ve(F,F.gzhead.extra.length>>8&255)),F.gzhead.hcrc&&(w.adler=y(w.adler,F.pending_buf,F.pending,0)),F.gzindex=0,F.status=69):(Ve(F,0),Ve(F,0),Ve(F,0),Ve(F,0),Ve(F,0),Ve(F,F.level===9?2:2<=F.strategy||F.level<2?4:0),Ve(F,3),F.status=xe);else{var Se=g+(F.w_bits-8<<4)<<8;Se|=(2<=F.strategy||F.level<2?0:F.level<6?1:F.level===6?2:3)<<6,F.strstart!==0&&(Se|=32),Se+=31-Se%31,F.status=xe,Ye(F,Se),F.strstart!==0&&(Ye(F,w.adler>>>16),Ye(F,65535&w.adler)),w.adler=1}if(F.status===69)if(F.gzhead.extra){for(O=F.pending;F.gzindex<(65535&F.gzhead.extra.length)&&(F.pending!==F.pending_buf_size||(F.gzhead.hcrc&&F.pending>O&&(w.adler=y(w.adler,F.pending_buf,F.pending-O,O)),X(w),O=F.pending,F.pending!==F.pending_buf_size));)Ve(F,255&F.gzhead.extra[F.gzindex]),F.gzindex++;F.gzhead.hcrc&&F.pending>O&&(w.adler=y(w.adler,F.pending_buf,F.pending-O,O)),F.gzindex===F.gzhead.extra.length&&(F.gzindex=0,F.status=73)}else F.status=73;if(F.status===73)if(F.gzhead.name){O=F.pending;do{if(F.pending===F.pending_buf_size&&(F.gzhead.hcrc&&F.pending>O&&(w.adler=y(w.adler,F.pending_buf,F.pending-O,O)),X(w),O=F.pending,F.pending===F.pending_buf_size)){ee=1;break}ee=F.gzindex<F.gzhead.name.length?255&F.gzhead.name.charCodeAt(F.gzindex++):0,Ve(F,ee)}while(ee!==0);F.gzhead.hcrc&&F.pending>O&&(w.adler=y(w.adler,F.pending_buf,F.pending-O,O)),ee===0&&(F.gzindex=0,F.status=91)}else F.status=91;if(F.status===91)if(F.gzhead.comment){O=F.pending;do{if(F.pending===F.pending_buf_size&&(F.gzhead.hcrc&&F.pending>O&&(w.adler=y(w.adler,F.pending_buf,F.pending-O,O)),X(w),O=F.pending,F.pending===F.pending_buf_size)){ee=1;break}ee=F.gzindex<F.gzhead.comment.length?255&F.gzhead.comment.charCodeAt(F.gzindex++):0,Ve(F,ee)}while(ee!==0);F.gzhead.hcrc&&F.pending>O&&(w.adler=y(w.adler,F.pending_buf,F.pending-O,O)),ee===0&&(F.status=103)}else F.status=103;if(F.status===103&&(F.gzhead.hcrc?(F.pending+2>F.pending_buf_size&&X(w),F.pending+2<=F.pending_buf_size&&(Ve(F,255&w.adler),Ve(F,w.adler>>8&255),w.adler=0,F.status=xe)):F.status=xe),F.pending!==0){if(X(w),w.avail_out===0)return F.last_flush=-1,b}else if(w.avail_in===0&&ae(je)<=ae(he)&&je!==k)return we(w,-5);if(F.status===666&&w.avail_in!==0)return we(w,-5);if(w.avail_in!==0||F.lookahead!==0||je!==_&&F.status!==666){var Te=F.strategy===2?function(Q,ye){for(var Qe;;){if(Q.lookahead===0&&(Lt(Q),Q.lookahead===0)){if(ye===_)return v;break}if(Q.match_length=0,Qe=u._tr_tally(Q,0,Q.window[Q.strstart]),Q.lookahead--,Q.strstart++,Qe&&(oe(Q,!1),Q.strm.avail_out===0))return v}return Q.insert=0,ye===k?(oe(Q,!0),Q.strm.avail_out===0?rt:ze):Q.last_lit&&(oe(Q,!1),Q.strm.avail_out===0)?v:ge}(F,je):F.strategy===3?function(Q,ye){for(var Qe,De,it,jt,It=Q.window;;){if(Q.lookahead<=me){if(Lt(Q),Q.lookahead<=me&&ye===_)return v;if(Q.lookahead===0)break}if(Q.match_length=0,Q.lookahead>=ce&&0<Q.strstart&&(De=It[it=Q.strstart-1])===It[++it]&&De===It[++it]&&De===It[++it]){jt=Q.strstart+me;do;while(De===It[++it]&&De===It[++it]&&De===It[++it]&&De===It[++it]&&De===It[++it]&&De===It[++it]&&De===It[++it]&&De===It[++it]&&it<jt);Q.match_length=me-(jt-it),Q.match_length>Q.lookahead&&(Q.match_length=Q.lookahead)}if(Q.match_length>=ce?(Qe=u._tr_tally(Q,1,Q.match_length-ce),Q.lookahead-=Q.match_length,Q.strstart+=Q.match_length,Q.match_length=0):(Qe=u._tr_tally(Q,0,Q.window[Q.strstart]),Q.lookahead--,Q.strstart++),Qe&&(oe(Q,!1),Q.strm.avail_out===0))return v}return Q.insert=0,ye===k?(oe(Q,!0),Q.strm.avail_out===0?rt:ze):Q.last_lit&&(oe(Q,!1),Q.strm.avail_out===0)?v:ge}(F,je):a[F.level].func(F,je);if(Te!==rt&&Te!==ze||(F.status=666),Te===v||Te===rt)return w.avail_out===0&&(F.last_flush=-1),b;if(Te===ge&&(je===1?u._tr_align(F):je!==5&&(u._tr_stored_block(F,0,0,!1),je===3&&(Re(F.head),F.lookahead===0&&(F.strstart=0,F.block_start=0,F.insert=0))),X(w),w.avail_out===0))return F.last_flush=-1,b}return je!==k?b:F.wrap<=0?1:(F.wrap===2?(Ve(F,255&w.adler),Ve(F,w.adler>>8&255),Ve(F,w.adler>>16&255),Ve(F,w.adler>>24&255),Ve(F,255&w.total_in),Ve(F,w.total_in>>8&255),Ve(F,w.total_in>>16&255),Ve(F,w.total_in>>24&255)):(Ye(F,w.adler>>>16),Ye(F,65535&w.adler)),X(w),0<F.wrap&&(F.wrap=-F.wrap),F.pending!==0?b:1)},i.deflateEnd=function(w){var je;return w&&w.state?(je=w.state.status)!==K&&je!==69&&je!==73&&je!==91&&je!==103&&je!==xe&&je!==666?we(w,E):(w.state=null,je===xe?we(w,-3):b):E},i.deflateSetDictionary=function(w,je){var he,F,O,ee,Se,Te,Q,ye,Qe=je.length;if(!w||!w.state||(ee=(he=w.state).wrap)===2||ee===1&&he.status!==K||he.lookahead)return E;for(ee===1&&(w.adler=d(w.adler,je,Qe,0)),he.wrap=0,Qe>=he.w_size&&(ee===0&&(Re(he.head),he.strstart=0,he.block_start=0,he.insert=0),ye=new l.Buf8(he.w_size),l.arraySet(ye,je,Qe-he.w_size,he.w_size,0),je=ye,Qe=he.w_size),Se=w.avail_in,Te=w.next_in,Q=w.input,w.avail_in=Qe,w.next_in=0,w.input=je,Lt(he);he.lookahead>=ce;){for(F=he.strstart,O=he.lookahead-(ce-1);he.ins_h=(he.ins_h<<he.hash_shift^he.window[F+ce-1])&he.hash_mask,he.prev[F&he.w_mask]=he.head[he.ins_h],he.head[he.ins_h]=F,F++,--O;);he.strstart=F,he.lookahead=ce-1,Lt(he)}return he.strstart+=he.lookahead,he.block_start=he.strstart,he.insert=he.lookahead,he.lookahead=0,he.match_length=he.prev_length=ce-1,he.match_available=0,w.next_in=Te,w.input=Q,w.avail_in=Se,he.wrap=ee,b},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,r,i){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,r,i){r.exports=function(a,l){var u,d,y,j,_,k,b,E,z,A,x,g,S,L,B,ie,J,ue,ce,me,Be,K,xe,v,ge;u=a.state,d=a.next_in,v=a.input,y=d+(a.avail_in-5),j=a.next_out,ge=a.output,_=j-(l-a.avail_out),k=j+(a.avail_out-257),b=u.dmax,E=u.wsize,z=u.whave,A=u.wnext,x=u.window,g=u.hold,S=u.bits,L=u.lencode,B=u.distcode,ie=(1<<u.lenbits)-1,J=(1<<u.distbits)-1;e:do{S<15&&(g+=v[d++]<<S,S+=8,g+=v[d++]<<S,S+=8),ue=L[g&ie];t:for(;;){if(g>>>=ce=ue>>>24,S-=ce,(ce=ue>>>16&255)===0)ge[j++]=65535&ue;else{if(!(16&ce)){if(!(64&ce)){ue=L[(65535&ue)+(g&(1<<ce)-1)];continue t}if(32&ce){u.mode=12;break e}a.msg="invalid literal/length code",u.mode=30;break e}me=65535&ue,(ce&=15)&&(S<ce&&(g+=v[d++]<<S,S+=8),me+=g&(1<<ce)-1,g>>>=ce,S-=ce),S<15&&(g+=v[d++]<<S,S+=8,g+=v[d++]<<S,S+=8),ue=B[g&J];n:for(;;){if(g>>>=ce=ue>>>24,S-=ce,!(16&(ce=ue>>>16&255))){if(!(64&ce)){ue=B[(65535&ue)+(g&(1<<ce)-1)];continue n}a.msg="invalid distance code",u.mode=30;break e}if(Be=65535&ue,S<(ce&=15)&&(g+=v[d++]<<S,(S+=8)<ce&&(g+=v[d++]<<S,S+=8)),b<(Be+=g&(1<<ce)-1)){a.msg="invalid distance too far back",u.mode=30;break e}if(g>>>=ce,S-=ce,(ce=j-_)<Be){if(z<(ce=Be-ce)&&u.sane){a.msg="invalid distance too far back",u.mode=30;break e}if(xe=x,(K=0)===A){if(K+=E-ce,ce<me){for(me-=ce;ge[j++]=x[K++],--ce;);K=j-Be,xe=ge}}else if(A<ce){if(K+=E+A-ce,(ce-=A)<me){for(me-=ce;ge[j++]=x[K++],--ce;);if(K=0,A<me){for(me-=ce=A;ge[j++]=x[K++],--ce;);K=j-Be,xe=ge}}}else if(K+=A-ce,ce<me){for(me-=ce;ge[j++]=x[K++],--ce;);K=j-Be,xe=ge}for(;2<me;)ge[j++]=xe[K++],ge[j++]=xe[K++],ge[j++]=xe[K++],me-=3;me&&(ge[j++]=xe[K++],1<me&&(ge[j++]=xe[K++]))}else{for(K=j-Be;ge[j++]=ge[K++],ge[j++]=ge[K++],ge[j++]=ge[K++],2<(me-=3););me&&(ge[j++]=ge[K++],1<me&&(ge[j++]=ge[K++]))}break}}break}}while(d<y&&j<k);d-=me=S>>3,g&=(1<<(S-=me<<3))-1,a.next_in=d,a.next_out=j,a.avail_in=d<y?y-d+5:5-(d-y),a.avail_out=j<k?k-j+257:257-(j-k),u.hold=g,u.bits=S}},{}],49:[function(n,r,i){var a=n("../utils/common"),l=n("./adler32"),u=n("./crc32"),d=n("./inffast"),y=n("./inftrees"),j=1,_=2,k=0,b=-2,E=1,z=852,A=592;function x(K){return(K>>>24&255)+(K>>>8&65280)+((65280&K)<<8)+((255&K)<<24)}function g(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new a.Buf16(320),this.work=new a.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function S(K){var xe;return K&&K.state?(xe=K.state,K.total_in=K.total_out=xe.total=0,K.msg="",xe.wrap&&(K.adler=1&xe.wrap),xe.mode=E,xe.last=0,xe.havedict=0,xe.dmax=32768,xe.head=null,xe.hold=0,xe.bits=0,xe.lencode=xe.lendyn=new a.Buf32(z),xe.distcode=xe.distdyn=new a.Buf32(A),xe.sane=1,xe.back=-1,k):b}function L(K){var xe;return K&&K.state?((xe=K.state).wsize=0,xe.whave=0,xe.wnext=0,S(K)):b}function B(K,xe){var v,ge;return K&&K.state?(ge=K.state,xe<0?(v=0,xe=-xe):(v=1+(xe>>4),xe<48&&(xe&=15)),xe&&(xe<8||15<xe)?b:(ge.window!==null&&ge.wbits!==xe&&(ge.window=null),ge.wrap=v,ge.wbits=xe,L(K))):b}function ie(K,xe){var v,ge;return K?(ge=new g,(K.state=ge).window=null,(v=B(K,xe))!==k&&(K.state=null),v):b}var J,ue,ce=!0;function me(K){if(ce){var xe;for(J=new a.Buf32(512),ue=new a.Buf32(32),xe=0;xe<144;)K.lens[xe++]=8;for(;xe<256;)K.lens[xe++]=9;for(;xe<280;)K.lens[xe++]=7;for(;xe<288;)K.lens[xe++]=8;for(y(j,K.lens,0,288,J,0,K.work,{bits:9}),xe=0;xe<32;)K.lens[xe++]=5;y(_,K.lens,0,32,ue,0,K.work,{bits:5}),ce=!1}K.lencode=J,K.lenbits=9,K.distcode=ue,K.distbits=5}function Be(K,xe,v,ge){var rt,ze=K.state;return ze.window===null&&(ze.wsize=1<<ze.wbits,ze.wnext=0,ze.whave=0,ze.window=new a.Buf8(ze.wsize)),ge>=ze.wsize?(a.arraySet(ze.window,xe,v-ze.wsize,ze.wsize,0),ze.wnext=0,ze.whave=ze.wsize):(ge<(rt=ze.wsize-ze.wnext)&&(rt=ge),a.arraySet(ze.window,xe,v-ge,rt,ze.wnext),(ge-=rt)?(a.arraySet(ze.window,xe,v-ge,ge,0),ze.wnext=ge,ze.whave=ze.wsize):(ze.wnext+=rt,ze.wnext===ze.wsize&&(ze.wnext=0),ze.whave<ze.wsize&&(ze.whave+=rt))),0}i.inflateReset=L,i.inflateReset2=B,i.inflateResetKeep=S,i.inflateInit=function(K){return ie(K,15)},i.inflateInit2=ie,i.inflate=function(K,xe){var v,ge,rt,ze,we,ae,Re,X,oe,Ve,Ye,Ee,Lt,Zt,Et,Ht,bn,Yt,Qn,Un,w,je,he,F,O=0,ee=new a.Buf8(4),Se=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!K||!K.state||!K.output||!K.input&&K.avail_in!==0)return b;(v=K.state).mode===12&&(v.mode=13),we=K.next_out,rt=K.output,Re=K.avail_out,ze=K.next_in,ge=K.input,ae=K.avail_in,X=v.hold,oe=v.bits,Ve=ae,Ye=Re,je=k;e:for(;;)switch(v.mode){case E:if(v.wrap===0){v.mode=13;break}for(;oe<16;){if(ae===0)break e;ae--,X+=ge[ze++]<<oe,oe+=8}if(2&v.wrap&&X===35615){ee[v.check=0]=255&X,ee[1]=X>>>8&255,v.check=u(v.check,ee,2,0),oe=X=0,v.mode=2;break}if(v.flags=0,v.head&&(v.head.done=!1),!(1&v.wrap)||(((255&X)<<8)+(X>>8))%31){K.msg="incorrect header check",v.mode=30;break}if((15&X)!=8){K.msg="unknown compression method",v.mode=30;break}if(oe-=4,w=8+(15&(X>>>=4)),v.wbits===0)v.wbits=w;else if(w>v.wbits){K.msg="invalid window size",v.mode=30;break}v.dmax=1<<w,K.adler=v.check=1,v.mode=512&X?10:12,oe=X=0;break;case 2:for(;oe<16;){if(ae===0)break e;ae--,X+=ge[ze++]<<oe,oe+=8}if(v.flags=X,(255&v.flags)!=8){K.msg="unknown compression method",v.mode=30;break}if(57344&v.flags){K.msg="unknown header flags set",v.mode=30;break}v.head&&(v.head.text=X>>8&1),512&v.flags&&(ee[0]=255&X,ee[1]=X>>>8&255,v.check=u(v.check,ee,2,0)),oe=X=0,v.mode=3;case 3:for(;oe<32;){if(ae===0)break e;ae--,X+=ge[ze++]<<oe,oe+=8}v.head&&(v.head.time=X),512&v.flags&&(ee[0]=255&X,ee[1]=X>>>8&255,ee[2]=X>>>16&255,ee[3]=X>>>24&255,v.check=u(v.check,ee,4,0)),oe=X=0,v.mode=4;case 4:for(;oe<16;){if(ae===0)break e;ae--,X+=ge[ze++]<<oe,oe+=8}v.head&&(v.head.xflags=255&X,v.head.os=X>>8),512&v.flags&&(ee[0]=255&X,ee[1]=X>>>8&255,v.check=u(v.check,ee,2,0)),oe=X=0,v.mode=5;case 5:if(1024&v.flags){for(;oe<16;){if(ae===0)break e;ae--,X+=ge[ze++]<<oe,oe+=8}v.length=X,v.head&&(v.head.extra_len=X),512&v.flags&&(ee[0]=255&X,ee[1]=X>>>8&255,v.check=u(v.check,ee,2,0)),oe=X=0}else v.head&&(v.head.extra=null);v.mode=6;case 6:if(1024&v.flags&&(ae<(Ee=v.length)&&(Ee=ae),Ee&&(v.head&&(w=v.head.extra_len-v.length,v.head.extra||(v.head.extra=new Array(v.head.extra_len)),a.arraySet(v.head.extra,ge,ze,Ee,w)),512&v.flags&&(v.check=u(v.check,ge,Ee,ze)),ae-=Ee,ze+=Ee,v.length-=Ee),v.length))break e;v.length=0,v.mode=7;case 7:if(2048&v.flags){if(ae===0)break e;for(Ee=0;w=ge[ze+Ee++],v.head&&w&&v.length<65536&&(v.head.name+=String.fromCharCode(w)),w&&Ee<ae;);if(512&v.flags&&(v.check=u(v.check,ge,Ee,ze)),ae-=Ee,ze+=Ee,w)break e}else v.head&&(v.head.name=null);v.length=0,v.mode=8;case 8:if(4096&v.flags){if(ae===0)break e;for(Ee=0;w=ge[ze+Ee++],v.head&&w&&v.length<65536&&(v.head.comment+=String.fromCharCode(w)),w&&Ee<ae;);if(512&v.flags&&(v.check=u(v.check,ge,Ee,ze)),ae-=Ee,ze+=Ee,w)break e}else v.head&&(v.head.comment=null);v.mode=9;case 9:if(512&v.flags){for(;oe<16;){if(ae===0)break e;ae--,X+=ge[ze++]<<oe,oe+=8}if(X!==(65535&v.check)){K.msg="header crc mismatch",v.mode=30;break}oe=X=0}v.head&&(v.head.hcrc=v.flags>>9&1,v.head.done=!0),K.adler=v.check=0,v.mode=12;break;case 10:for(;oe<32;){if(ae===0)break e;ae--,X+=ge[ze++]<<oe,oe+=8}K.adler=v.check=x(X),oe=X=0,v.mode=11;case 11:if(v.havedict===0)return K.next_out=we,K.avail_out=Re,K.next_in=ze,K.avail_in=ae,v.hold=X,v.bits=oe,2;K.adler=v.check=1,v.mode=12;case 12:if(xe===5||xe===6)break e;case 13:if(v.last){X>>>=7&oe,oe-=7&oe,v.mode=27;break}for(;oe<3;){if(ae===0)break e;ae--,X+=ge[ze++]<<oe,oe+=8}switch(v.last=1&X,oe-=1,3&(X>>>=1)){case 0:v.mode=14;break;case 1:if(me(v),v.mode=20,xe!==6)break;X>>>=2,oe-=2;break e;case 2:v.mode=17;break;case 3:K.msg="invalid block type",v.mode=30}X>>>=2,oe-=2;break;case 14:for(X>>>=7&oe,oe-=7&oe;oe<32;){if(ae===0)break e;ae--,X+=ge[ze++]<<oe,oe+=8}if((65535&X)!=(X>>>16^65535)){K.msg="invalid stored block lengths",v.mode=30;break}if(v.length=65535&X,oe=X=0,v.mode=15,xe===6)break e;case 15:v.mode=16;case 16:if(Ee=v.length){if(ae<Ee&&(Ee=ae),Re<Ee&&(Ee=Re),Ee===0)break e;a.arraySet(rt,ge,ze,Ee,we),ae-=Ee,ze+=Ee,Re-=Ee,we+=Ee,v.length-=Ee;break}v.mode=12;break;case 17:for(;oe<14;){if(ae===0)break e;ae--,X+=ge[ze++]<<oe,oe+=8}if(v.nlen=257+(31&X),X>>>=5,oe-=5,v.ndist=1+(31&X),X>>>=5,oe-=5,v.ncode=4+(15&X),X>>>=4,oe-=4,286<v.nlen||30<v.ndist){K.msg="too many length or distance symbols",v.mode=30;break}v.have=0,v.mode=18;case 18:for(;v.have<v.ncode;){for(;oe<3;){if(ae===0)break e;ae--,X+=ge[ze++]<<oe,oe+=8}v.lens[Se[v.have++]]=7&X,X>>>=3,oe-=3}for(;v.have<19;)v.lens[Se[v.have++]]=0;if(v.lencode=v.lendyn,v.lenbits=7,he={bits:v.lenbits},je=y(0,v.lens,0,19,v.lencode,0,v.work,he),v.lenbits=he.bits,je){K.msg="invalid code lengths set",v.mode=30;break}v.have=0,v.mode=19;case 19:for(;v.have<v.nlen+v.ndist;){for(;Ht=(O=v.lencode[X&(1<<v.lenbits)-1])>>>16&255,bn=65535&O,!((Et=O>>>24)<=oe);){if(ae===0)break e;ae--,X+=ge[ze++]<<oe,oe+=8}if(bn<16)X>>>=Et,oe-=Et,v.lens[v.have++]=bn;else{if(bn===16){for(F=Et+2;oe<F;){if(ae===0)break e;ae--,X+=ge[ze++]<<oe,oe+=8}if(X>>>=Et,oe-=Et,v.have===0){K.msg="invalid bit length repeat",v.mode=30;break}w=v.lens[v.have-1],Ee=3+(3&X),X>>>=2,oe-=2}else if(bn===17){for(F=Et+3;oe<F;){if(ae===0)break e;ae--,X+=ge[ze++]<<oe,oe+=8}oe-=Et,w=0,Ee=3+(7&(X>>>=Et)),X>>>=3,oe-=3}else{for(F=Et+7;oe<F;){if(ae===0)break e;ae--,X+=ge[ze++]<<oe,oe+=8}oe-=Et,w=0,Ee=11+(127&(X>>>=Et)),X>>>=7,oe-=7}if(v.have+Ee>v.nlen+v.ndist){K.msg="invalid bit length repeat",v.mode=30;break}for(;Ee--;)v.lens[v.have++]=w}}if(v.mode===30)break;if(v.lens[256]===0){K.msg="invalid code -- missing end-of-block",v.mode=30;break}if(v.lenbits=9,he={bits:v.lenbits},je=y(j,v.lens,0,v.nlen,v.lencode,0,v.work,he),v.lenbits=he.bits,je){K.msg="invalid literal/lengths set",v.mode=30;break}if(v.distbits=6,v.distcode=v.distdyn,he={bits:v.distbits},je=y(_,v.lens,v.nlen,v.ndist,v.distcode,0,v.work,he),v.distbits=he.bits,je){K.msg="invalid distances set",v.mode=30;break}if(v.mode=20,xe===6)break e;case 20:v.mode=21;case 21:if(6<=ae&&258<=Re){K.next_out=we,K.avail_out=Re,K.next_in=ze,K.avail_in=ae,v.hold=X,v.bits=oe,d(K,Ye),we=K.next_out,rt=K.output,Re=K.avail_out,ze=K.next_in,ge=K.input,ae=K.avail_in,X=v.hold,oe=v.bits,v.mode===12&&(v.back=-1);break}for(v.back=0;Ht=(O=v.lencode[X&(1<<v.lenbits)-1])>>>16&255,bn=65535&O,!((Et=O>>>24)<=oe);){if(ae===0)break e;ae--,X+=ge[ze++]<<oe,oe+=8}if(Ht&&!(240&Ht)){for(Yt=Et,Qn=Ht,Un=bn;Ht=(O=v.lencode[Un+((X&(1<<Yt+Qn)-1)>>Yt)])>>>16&255,bn=65535&O,!(Yt+(Et=O>>>24)<=oe);){if(ae===0)break e;ae--,X+=ge[ze++]<<oe,oe+=8}X>>>=Yt,oe-=Yt,v.back+=Yt}if(X>>>=Et,oe-=Et,v.back+=Et,v.length=bn,Ht===0){v.mode=26;break}if(32&Ht){v.back=-1,v.mode=12;break}if(64&Ht){K.msg="invalid literal/length code",v.mode=30;break}v.extra=15&Ht,v.mode=22;case 22:if(v.extra){for(F=v.extra;oe<F;){if(ae===0)break e;ae--,X+=ge[ze++]<<oe,oe+=8}v.length+=X&(1<<v.extra)-1,X>>>=v.extra,oe-=v.extra,v.back+=v.extra}v.was=v.length,v.mode=23;case 23:for(;Ht=(O=v.distcode[X&(1<<v.distbits)-1])>>>16&255,bn=65535&O,!((Et=O>>>24)<=oe);){if(ae===0)break e;ae--,X+=ge[ze++]<<oe,oe+=8}if(!(240&Ht)){for(Yt=Et,Qn=Ht,Un=bn;Ht=(O=v.distcode[Un+((X&(1<<Yt+Qn)-1)>>Yt)])>>>16&255,bn=65535&O,!(Yt+(Et=O>>>24)<=oe);){if(ae===0)break e;ae--,X+=ge[ze++]<<oe,oe+=8}X>>>=Yt,oe-=Yt,v.back+=Yt}if(X>>>=Et,oe-=Et,v.back+=Et,64&Ht){K.msg="invalid distance code",v.mode=30;break}v.offset=bn,v.extra=15&Ht,v.mode=24;case 24:if(v.extra){for(F=v.extra;oe<F;){if(ae===0)break e;ae--,X+=ge[ze++]<<oe,oe+=8}v.offset+=X&(1<<v.extra)-1,X>>>=v.extra,oe-=v.extra,v.back+=v.extra}if(v.offset>v.dmax){K.msg="invalid distance too far back",v.mode=30;break}v.mode=25;case 25:if(Re===0)break e;if(Ee=Ye-Re,v.offset>Ee){if((Ee=v.offset-Ee)>v.whave&&v.sane){K.msg="invalid distance too far back",v.mode=30;break}Lt=Ee>v.wnext?(Ee-=v.wnext,v.wsize-Ee):v.wnext-Ee,Ee>v.length&&(Ee=v.length),Zt=v.window}else Zt=rt,Lt=we-v.offset,Ee=v.length;for(Re<Ee&&(Ee=Re),Re-=Ee,v.length-=Ee;rt[we++]=Zt[Lt++],--Ee;);v.length===0&&(v.mode=21);break;case 26:if(Re===0)break e;rt[we++]=v.length,Re--,v.mode=21;break;case 27:if(v.wrap){for(;oe<32;){if(ae===0)break e;ae--,X|=ge[ze++]<<oe,oe+=8}if(Ye-=Re,K.total_out+=Ye,v.total+=Ye,Ye&&(K.adler=v.check=v.flags?u(v.check,rt,Ye,we-Ye):l(v.check,rt,Ye,we-Ye)),Ye=Re,(v.flags?X:x(X))!==v.check){K.msg="incorrect data check",v.mode=30;break}oe=X=0}v.mode=28;case 28:if(v.wrap&&v.flags){for(;oe<32;){if(ae===0)break e;ae--,X+=ge[ze++]<<oe,oe+=8}if(X!==(4294967295&v.total)){K.msg="incorrect length check",v.mode=30;break}oe=X=0}v.mode=29;case 29:je=1;break e;case 30:je=-3;break e;case 31:return-4;case 32:default:return b}return K.next_out=we,K.avail_out=Re,K.next_in=ze,K.avail_in=ae,v.hold=X,v.bits=oe,(v.wsize||Ye!==K.avail_out&&v.mode<30&&(v.mode<27||xe!==4))&&Be(K,K.output,K.next_out,Ye-K.avail_out)?(v.mode=31,-4):(Ve-=K.avail_in,Ye-=K.avail_out,K.total_in+=Ve,K.total_out+=Ye,v.total+=Ye,v.wrap&&Ye&&(K.adler=v.check=v.flags?u(v.check,rt,Ye,K.next_out-Ye):l(v.check,rt,Ye,K.next_out-Ye)),K.data_type=v.bits+(v.last?64:0)+(v.mode===12?128:0)+(v.mode===20||v.mode===15?256:0),(Ve==0&&Ye===0||xe===4)&&je===k&&(je=-5),je)},i.inflateEnd=function(K){if(!K||!K.state)return b;var xe=K.state;return xe.window&&(xe.window=null),K.state=null,k},i.inflateGetHeader=function(K,xe){var v;return K&&K.state&&2&(v=K.state).wrap?((v.head=xe).done=!1,k):b},i.inflateSetDictionary=function(K,xe){var v,ge=xe.length;return K&&K.state?(v=K.state).wrap!==0&&v.mode!==11?b:v.mode===11&&l(1,xe,ge,0)!==v.check?-3:Be(K,xe,ge,ge)?(v.mode=31,-4):(v.havedict=1,k):b},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,r,i){var a=n("../utils/common"),l=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],u=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],d=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],y=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(j,_,k,b,E,z,A,x){var g,S,L,B,ie,J,ue,ce,me,Be=x.bits,K=0,xe=0,v=0,ge=0,rt=0,ze=0,we=0,ae=0,Re=0,X=0,oe=null,Ve=0,Ye=new a.Buf16(16),Ee=new a.Buf16(16),Lt=null,Zt=0;for(K=0;K<=15;K++)Ye[K]=0;for(xe=0;xe<b;xe++)Ye[_[k+xe]]++;for(rt=Be,ge=15;1<=ge&&Ye[ge]===0;ge--);if(ge<rt&&(rt=ge),ge===0)return E[z++]=20971520,E[z++]=20971520,x.bits=1,0;for(v=1;v<ge&&Ye[v]===0;v++);for(rt<v&&(rt=v),K=ae=1;K<=15;K++)if(ae<<=1,(ae-=Ye[K])<0)return-1;if(0<ae&&(j===0||ge!==1))return-1;for(Ee[1]=0,K=1;K<15;K++)Ee[K+1]=Ee[K]+Ye[K];for(xe=0;xe<b;xe++)_[k+xe]!==0&&(A[Ee[_[k+xe]]++]=xe);if(J=j===0?(oe=Lt=A,19):j===1?(oe=l,Ve-=257,Lt=u,Zt-=257,256):(oe=d,Lt=y,-1),K=v,ie=z,we=xe=X=0,L=-1,B=(Re=1<<(ze=rt))-1,j===1&&852<Re||j===2&&592<Re)return 1;for(;;){for(ue=K-we,me=A[xe]<J?(ce=0,A[xe]):A[xe]>J?(ce=Lt[Zt+A[xe]],oe[Ve+A[xe]]):(ce=96,0),g=1<<K-we,v=S=1<<ze;E[ie+(X>>we)+(S-=g)]=ue<<24|ce<<16|me|0,S!==0;);for(g=1<<K-1;X&g;)g>>=1;if(g!==0?(X&=g-1,X+=g):X=0,xe++,--Ye[K]==0){if(K===ge)break;K=_[k+A[xe]]}if(rt<K&&(X&B)!==L){for(we===0&&(we=rt),ie+=v,ae=1<<(ze=K-we);ze+we<ge&&!((ae-=Ye[ze+we])<=0);)ze++,ae<<=1;if(Re+=1<<ze,j===1&&852<Re||j===2&&592<Re)return 1;E[L=X&B]=rt<<24|ze<<16|ie-z|0}}return X!==0&&(E[ie+X]=K-we<<24|64<<16|0),x.bits=rt,0}},{"../utils/common":41}],51:[function(n,r,i){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,r,i){var a=n("../utils/common"),l=0,u=1;function d(O){for(var ee=O.length;0<=--ee;)O[ee]=0}var y=0,j=29,_=256,k=_+1+j,b=30,E=19,z=2*k+1,A=15,x=16,g=7,S=256,L=16,B=17,ie=18,J=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ue=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],me=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Be=new Array(2*(k+2));d(Be);var K=new Array(2*b);d(K);var xe=new Array(512);d(xe);var v=new Array(256);d(v);var ge=new Array(j);d(ge);var rt,ze,we,ae=new Array(b);function Re(O,ee,Se,Te,Q){this.static_tree=O,this.extra_bits=ee,this.extra_base=Se,this.elems=Te,this.max_length=Q,this.has_stree=O&&O.length}function X(O,ee){this.dyn_tree=O,this.max_code=0,this.stat_desc=ee}function oe(O){return O<256?xe[O]:xe[256+(O>>>7)]}function Ve(O,ee){O.pending_buf[O.pending++]=255&ee,O.pending_buf[O.pending++]=ee>>>8&255}function Ye(O,ee,Se){O.bi_valid>x-Se?(O.bi_buf|=ee<<O.bi_valid&65535,Ve(O,O.bi_buf),O.bi_buf=ee>>x-O.bi_valid,O.bi_valid+=Se-x):(O.bi_buf|=ee<<O.bi_valid&65535,O.bi_valid+=Se)}function Ee(O,ee,Se){Ye(O,Se[2*ee],Se[2*ee+1])}function Lt(O,ee){for(var Se=0;Se|=1&O,O>>>=1,Se<<=1,0<--ee;);return Se>>>1}function Zt(O,ee,Se){var Te,Q,ye=new Array(A+1),Qe=0;for(Te=1;Te<=A;Te++)ye[Te]=Qe=Qe+Se[Te-1]<<1;for(Q=0;Q<=ee;Q++){var De=O[2*Q+1];De!==0&&(O[2*Q]=Lt(ye[De]++,De))}}function Et(O){var ee;for(ee=0;ee<k;ee++)O.dyn_ltree[2*ee]=0;for(ee=0;ee<b;ee++)O.dyn_dtree[2*ee]=0;for(ee=0;ee<E;ee++)O.bl_tree[2*ee]=0;O.dyn_ltree[2*S]=1,O.opt_len=O.static_len=0,O.last_lit=O.matches=0}function Ht(O){8<O.bi_valid?Ve(O,O.bi_buf):0<O.bi_valid&&(O.pending_buf[O.pending++]=O.bi_buf),O.bi_buf=0,O.bi_valid=0}function bn(O,ee,Se,Te){var Q=2*ee,ye=2*Se;return O[Q]<O[ye]||O[Q]===O[ye]&&Te[ee]<=Te[Se]}function Yt(O,ee,Se){for(var Te=O.heap[Se],Q=Se<<1;Q<=O.heap_len&&(Q<O.heap_len&&bn(ee,O.heap[Q+1],O.heap[Q],O.depth)&&Q++,!bn(ee,Te,O.heap[Q],O.depth));)O.heap[Se]=O.heap[Q],Se=Q,Q<<=1;O.heap[Se]=Te}function Qn(O,ee,Se){var Te,Q,ye,Qe,De=0;if(O.last_lit!==0)for(;Te=O.pending_buf[O.d_buf+2*De]<<8|O.pending_buf[O.d_buf+2*De+1],Q=O.pending_buf[O.l_buf+De],De++,Te===0?Ee(O,Q,ee):(Ee(O,(ye=v[Q])+_+1,ee),(Qe=J[ye])!==0&&Ye(O,Q-=ge[ye],Qe),Ee(O,ye=oe(--Te),Se),(Qe=ue[ye])!==0&&Ye(O,Te-=ae[ye],Qe)),De<O.last_lit;);Ee(O,S,ee)}function Un(O,ee){var Se,Te,Q,ye=ee.dyn_tree,Qe=ee.stat_desc.static_tree,De=ee.stat_desc.has_stree,it=ee.stat_desc.elems,jt=-1;for(O.heap_len=0,O.heap_max=z,Se=0;Se<it;Se++)ye[2*Se]!==0?(O.heap[++O.heap_len]=jt=Se,O.depth[Se]=0):ye[2*Se+1]=0;for(;O.heap_len<2;)ye[2*(Q=O.heap[++O.heap_len]=jt<2?++jt:0)]=1,O.depth[Q]=0,O.opt_len--,De&&(O.static_len-=Qe[2*Q+1]);for(ee.max_code=jt,Se=O.heap_len>>1;1<=Se;Se--)Yt(O,ye,Se);for(Q=it;Se=O.heap[1],O.heap[1]=O.heap[O.heap_len--],Yt(O,ye,1),Te=O.heap[1],O.heap[--O.heap_max]=Se,O.heap[--O.heap_max]=Te,ye[2*Q]=ye[2*Se]+ye[2*Te],O.depth[Q]=(O.depth[Se]>=O.depth[Te]?O.depth[Se]:O.depth[Te])+1,ye[2*Se+1]=ye[2*Te+1]=Q,O.heap[1]=Q++,Yt(O,ye,1),2<=O.heap_len;);O.heap[--O.heap_max]=O.heap[1],function(It,ar){var Os,mr,Us,At,er,Cn,En=ar.dyn_tree,Dr=ar.max_code,ui=ar.stat_desc.static_tree,Fs=ar.stat_desc.has_stree,Nr=ar.stat_desc.extra_bits,Bs=ar.stat_desc.extra_base,Hs=ar.stat_desc.max_length,tr=0;for(At=0;At<=A;At++)It.bl_count[At]=0;for(En[2*It.heap[It.heap_max]+1]=0,Os=It.heap_max+1;Os<z;Os++)Hs<(At=En[2*En[2*(mr=It.heap[Os])+1]+1]+1)&&(At=Hs,tr++),En[2*mr+1]=At,Dr<mr||(It.bl_count[At]++,er=0,Bs<=mr&&(er=Nr[mr-Bs]),Cn=En[2*mr],It.opt_len+=Cn*(At+er),Fs&&(It.static_len+=Cn*(ui[2*mr+1]+er)));if(tr!==0){do{for(At=Hs-1;It.bl_count[At]===0;)At--;It.bl_count[At]--,It.bl_count[At+1]+=2,It.bl_count[Hs]--,tr-=2}while(0<tr);for(At=Hs;At!==0;At--)for(mr=It.bl_count[At];mr!==0;)Dr<(Us=It.heap[--Os])||(En[2*Us+1]!==At&&(It.opt_len+=(At-En[2*Us+1])*En[2*Us],En[2*Us+1]=At),mr--)}}(O,ee),Zt(ye,jt,O.bl_count)}function w(O,ee,Se){var Te,Q,ye=-1,Qe=ee[1],De=0,it=7,jt=4;for(Qe===0&&(it=138,jt=3),ee[2*(Se+1)+1]=65535,Te=0;Te<=Se;Te++)Q=Qe,Qe=ee[2*(Te+1)+1],++De<it&&Q===Qe||(De<jt?O.bl_tree[2*Q]+=De:Q!==0?(Q!==ye&&O.bl_tree[2*Q]++,O.bl_tree[2*L]++):De<=10?O.bl_tree[2*B]++:O.bl_tree[2*ie]++,ye=Q,jt=(De=0)===Qe?(it=138,3):Q===Qe?(it=6,3):(it=7,4))}function je(O,ee,Se){var Te,Q,ye=-1,Qe=ee[1],De=0,it=7,jt=4;for(Qe===0&&(it=138,jt=3),Te=0;Te<=Se;Te++)if(Q=Qe,Qe=ee[2*(Te+1)+1],!(++De<it&&Q===Qe)){if(De<jt)for(;Ee(O,Q,O.bl_tree),--De!=0;);else Q!==0?(Q!==ye&&(Ee(O,Q,O.bl_tree),De--),Ee(O,L,O.bl_tree),Ye(O,De-3,2)):De<=10?(Ee(O,B,O.bl_tree),Ye(O,De-3,3)):(Ee(O,ie,O.bl_tree),Ye(O,De-11,7));ye=Q,jt=(De=0)===Qe?(it=138,3):Q===Qe?(it=6,3):(it=7,4)}}d(ae);var he=!1;function F(O,ee,Se,Te){Ye(O,(y<<1)+(Te?1:0),3),function(Q,ye,Qe,De){Ht(Q),Ve(Q,Qe),Ve(Q,~Qe),a.arraySet(Q.pending_buf,Q.window,ye,Qe,Q.pending),Q.pending+=Qe}(O,ee,Se)}i._tr_init=function(O){he||(function(){var ee,Se,Te,Q,ye,Qe=new Array(A+1);for(Q=Te=0;Q<j-1;Q++)for(ge[Q]=Te,ee=0;ee<1<<J[Q];ee++)v[Te++]=Q;for(v[Te-1]=Q,Q=ye=0;Q<16;Q++)for(ae[Q]=ye,ee=0;ee<1<<ue[Q];ee++)xe[ye++]=Q;for(ye>>=7;Q<b;Q++)for(ae[Q]=ye<<7,ee=0;ee<1<<ue[Q]-7;ee++)xe[256+ye++]=Q;for(Se=0;Se<=A;Se++)Qe[Se]=0;for(ee=0;ee<=143;)Be[2*ee+1]=8,ee++,Qe[8]++;for(;ee<=255;)Be[2*ee+1]=9,ee++,Qe[9]++;for(;ee<=279;)Be[2*ee+1]=7,ee++,Qe[7]++;for(;ee<=287;)Be[2*ee+1]=8,ee++,Qe[8]++;for(Zt(Be,k+1,Qe),ee=0;ee<b;ee++)K[2*ee+1]=5,K[2*ee]=Lt(ee,5);rt=new Re(Be,J,_+1,k,A),ze=new Re(K,ue,0,b,A),we=new Re(new Array(0),ce,0,E,g)}(),he=!0),O.l_desc=new X(O.dyn_ltree,rt),O.d_desc=new X(O.dyn_dtree,ze),O.bl_desc=new X(O.bl_tree,we),O.bi_buf=0,O.bi_valid=0,Et(O)},i._tr_stored_block=F,i._tr_flush_block=function(O,ee,Se,Te){var Q,ye,Qe=0;0<O.level?(O.strm.data_type===2&&(O.strm.data_type=function(De){var it,jt=4093624447;for(it=0;it<=31;it++,jt>>>=1)if(1&jt&&De.dyn_ltree[2*it]!==0)return l;if(De.dyn_ltree[18]!==0||De.dyn_ltree[20]!==0||De.dyn_ltree[26]!==0)return u;for(it=32;it<_;it++)if(De.dyn_ltree[2*it]!==0)return u;return l}(O)),Un(O,O.l_desc),Un(O,O.d_desc),Qe=function(De){var it;for(w(De,De.dyn_ltree,De.l_desc.max_code),w(De,De.dyn_dtree,De.d_desc.max_code),Un(De,De.bl_desc),it=E-1;3<=it&&De.bl_tree[2*me[it]+1]===0;it--);return De.opt_len+=3*(it+1)+5+5+4,it}(O),Q=O.opt_len+3+7>>>3,(ye=O.static_len+3+7>>>3)<=Q&&(Q=ye)):Q=ye=Se+5,Se+4<=Q&&ee!==-1?F(O,ee,Se,Te):O.strategy===4||ye===Q?(Ye(O,2+(Te?1:0),3),Qn(O,Be,K)):(Ye(O,4+(Te?1:0),3),function(De,it,jt,It){var ar;for(Ye(De,it-257,5),Ye(De,jt-1,5),Ye(De,It-4,4),ar=0;ar<It;ar++)Ye(De,De.bl_tree[2*me[ar]+1],3);je(De,De.dyn_ltree,it-1),je(De,De.dyn_dtree,jt-1)}(O,O.l_desc.max_code+1,O.d_desc.max_code+1,Qe+1),Qn(O,O.dyn_ltree,O.dyn_dtree)),Et(O),Te&&Ht(O)},i._tr_tally=function(O,ee,Se){return O.pending_buf[O.d_buf+2*O.last_lit]=ee>>>8&255,O.pending_buf[O.d_buf+2*O.last_lit+1]=255&ee,O.pending_buf[O.l_buf+O.last_lit]=255&Se,O.last_lit++,ee===0?O.dyn_ltree[2*Se]++:(O.matches++,ee--,O.dyn_ltree[2*(v[Se]+_+1)]++,O.dyn_dtree[2*oe(ee)]++),O.last_lit===O.lit_bufsize-1},i._tr_align=function(O){Ye(O,2,3),Ee(O,S,Be),function(ee){ee.bi_valid===16?(Ve(ee,ee.bi_buf),ee.bi_buf=0,ee.bi_valid=0):8<=ee.bi_valid&&(ee.pending_buf[ee.pending++]=255&ee.bi_buf,ee.bi_buf>>=8,ee.bi_valid-=8)}(O)}},{"../utils/common":41}],53:[function(n,r,i){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,r,i){(function(a){(function(l,u){if(!l.setImmediate){var d,y,j,_,k=1,b={},E=!1,z=l.document,A=Object.getPrototypeOf&&Object.getPrototypeOf(l);A=A&&A.setTimeout?A:l,d={}.toString.call(l.process)==="[object process]"?function(L){process.nextTick(function(){g(L)})}:function(){if(l.postMessage&&!l.importScripts){var L=!0,B=l.onmessage;return l.onmessage=function(){L=!1},l.postMessage("","*"),l.onmessage=B,L}}()?(_="setImmediate$"+Math.random()+"$",l.addEventListener?l.addEventListener("message",S,!1):l.attachEvent("onmessage",S),function(L){l.postMessage(_+L,"*")}):l.MessageChannel?((j=new MessageChannel).port1.onmessage=function(L){g(L.data)},function(L){j.port2.postMessage(L)}):z&&"onreadystatechange"in z.createElement("script")?(y=z.documentElement,function(L){var B=z.createElement("script");B.onreadystatechange=function(){g(L),B.onreadystatechange=null,y.removeChild(B),B=null},y.appendChild(B)}):function(L){setTimeout(g,0,L)},A.setImmediate=function(L){typeof L!="function"&&(L=new Function(""+L));for(var B=new Array(arguments.length-1),ie=0;ie<B.length;ie++)B[ie]=arguments[ie+1];var J={callback:L,args:B};return b[k]=J,d(k),k++},A.clearImmediate=x}function x(L){delete b[L]}function g(L){if(E)setTimeout(g,0,L);else{var B=b[L];if(B){E=!0;try{(function(ie){var J=ie.callback,ue=ie.args;switch(ue.length){case 0:J();break;case 1:J(ue[0]);break;case 2:J(ue[0],ue[1]);break;case 3:J(ue[0],ue[1],ue[2]);break;default:J.apply(u,ue)}})(B)}finally{x(L),E=!1}}}}function S(L){L.source===l&&typeof L.data=="string"&&L.data.indexOf(_)===0&&g(+L.data.slice(_.length))}})(typeof self>"u"?a===void 0?this:a:self)}).call(this,typeof ei<"u"?ei:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(ly);var A2=ly.exports;const P2=$m(A2);var cy={exports:{}};(function(e,t){(function(n,r){r()})(ei,function(){function n(y,j){return typeof j>"u"?j={autoBom:!1}:typeof j!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),j={autoBom:!j}),j.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(y.type)?new Blob(["\uFEFF",y],{type:y.type}):y}function r(y,j,_){var k=new XMLHttpRequest;k.open("GET",y),k.responseType="blob",k.onload=function(){d(k.response,j,_)},k.onerror=function(){console.error("could not download file")},k.send()}function i(y){var j=new XMLHttpRequest;j.open("HEAD",y,!1);try{j.send()}catch{}return 200<=j.status&&299>=j.status}function a(y){try{y.dispatchEvent(new MouseEvent("click"))}catch{var j=document.createEvent("MouseEvents");j.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),y.dispatchEvent(j)}}var l=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof ei=="object"&&ei.global===ei?ei:void 0,u=l.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),d=l.saveAs||(typeof window!="object"||window!==l?function(){}:"download"in HTMLAnchorElement.prototype&&!u?function(y,j,_){var k=l.URL||l.webkitURL,b=document.createElement("a");j=j||y.name||"download",b.download=j,b.rel="noopener",typeof y=="string"?(b.href=y,b.origin===location.origin?a(b):i(b.href)?r(y,j,_):a(b,b.target="_blank")):(b.href=k.createObjectURL(y),setTimeout(function(){k.revokeObjectURL(b.href)},4e4),setTimeout(function(){a(b)},0))}:"msSaveOrOpenBlob"in navigator?function(y,j,_){if(j=j||y.name||"download",typeof y!="string")navigator.msSaveOrOpenBlob(n(y,_),j);else if(i(y))r(y,j,_);else{var k=document.createElement("a");k.href=y,k.target="_blank",setTimeout(function(){a(k)})}}:function(y,j,_,k){if(k=k||open("","_blank"),k&&(k.document.title=k.document.body.innerText="downloading..."),typeof y=="string")return r(y,j,_);var b=y.type==="application/octet-stream",E=/constructor/i.test(l.HTMLElement)||l.safari,z=/CriOS\/[\d]+/.test(navigator.userAgent);if((z||b&&E||u)&&typeof FileReader<"u"){var A=new FileReader;A.onloadend=function(){var S=A.result;S=z?S:S.replace(/^data:[^;]*;/,"data:attachment/file;"),k?k.location.href=S:location=S,k=null},A.readAsDataURL(y)}else{var x=l.URL||l.webkitURL,g=x.createObjectURL(y);k?k.location=g:location.href=g,k=null,setTimeout(function(){x.revokeObjectURL(g)},4e4)}});l.saveAs=d.saveAs=d,e.exports=d})})(cy);var R2=cy.exports;(function(){const e=console.error,t=console.warn,n=console.log,r=i=>{for(let a of i){let l="";if(typeof a=="string"?l=a:a&&typeof a=="object"?a.message?l=a.message:a.toString?l=a.toString():l=JSON.stringify(a):a!=null&&(l=String(a)),l.includes("Unable to preventDefault inside passive event listener")||l.includes("passive event listener invocation")||l.includes("preventDefault")&&l.includes("passive"))return!0}return!1};console.error=function(...i){r(i)||e.apply(console,i)},console.warn=function(...i){r(i)||t.apply(console,i)},console.log=function(...i){r(i)||n.apply(console,i)}})();const D2=({canvasRef:e,isDrawing:t})=>{const[n,r]=H.useState(""),i=H.useRef(null),a=H.useCallback(()=>{e.current&&r(e.current.toDataURL())},[e]);return H.useEffect(()=>{e.current&&a()},[e,a]),H.useEffect(()=>{if(!t){a();return}const l=()=>{a(),t&&(i.current=requestAnimationFrame(l))};return i.current=requestAnimationFrame(l),()=>{i.current&&cancelAnimationFrame(i.current)}},[t,a]),n?o.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{background:"rgba(255, 0, 0, 0.3)",mixBlendMode:"multiply",WebkitMaskImage:`url(${n})`,maskImage:`url(${n})`,WebkitMaskSize:"100% 100%",maskSize:"100% 100%",WebkitMaskRepeat:"no-repeat",maskRepeat:"no-repeat"}}):null},ti=(()=>{const e="tapnow_images_db",n="images";let r=null,i=null;const a=new Map,l=()=>i||(i=new Promise((b,E)=>{if(!window.indexedDB){console.warn("[LocalImageManager] IndexedDB not supported, falling back to memory"),b(null);return}const z=indexedDB.open(e,1);z.onerror=A=>{console.error("[LocalImageManager] IndexedDB init failed:",A.target.error),b(null)},z.onsuccess=A=>{r=A.target.result,console.log("[LocalImageManager] IndexedDB initialized"),b(r)},z.onupgradeneeded=A=>{const x=A.target.result;x.objectStoreNames.contains(n)||(x.createObjectStore(n,{keyPath:"id"}).createIndex("timestamp","timestamp",{unique:!1}),console.log("[LocalImageManager] Object store created"))}}),i),u=()=>`img_${Date.now()}_${Math.random().toString(36).substring(2,9)}`;return{saveImage:async(b,E=null)=>{const z=await l();if(!z)return null;const A=E||u();return new Promise((x,g)=>{var S;try{let L;if(typeof b=="string"&&b.startsWith("data:")){const ce=b.split(","),me=((S=ce[0].match(/:(.*?);/))==null?void 0:S[1])||"image/png",Be=atob(ce[1]),K=new Uint8Array(Be.length);for(let xe=0;xe<Be.length;xe++)K[xe]=Be.charCodeAt(xe);L=new Blob([K],{type:me})}else if(b instanceof Blob)L=b;else{console.warn("[LocalImageManager] Invalid data type for saveImage"),x(null);return}const ie=z.transaction([n],"readwrite").objectStore(n),J={id:A,blob:L,timestamp:Date.now(),size:L.size},ue=ie.put(J);ue.onsuccess=()=>{console.log(`[LocalImageManager] Saved image: ${A} (${(L.size/1024).toFixed(1)}KB)`),x(A)},ue.onerror=ce=>{console.error("[LocalImageManager] Save failed:",ce.target.error),x(null)}}catch(L){console.error("[LocalImageManager] Save error:",L),x(null)}})},getImage:async b=>{if(a.has(b))return a.get(b);const E=await l();return E?new Promise(z=>{try{const g=E.transaction([n],"readonly").objectStore(n).get(b);g.onsuccess=()=>{const S=g.result;if(S&&S.blob){const L=URL.createObjectURL(S.blob);a.set(b,L),z(L)}else z(null)},g.onerror=()=>z(null)}catch(A){console.error("[LocalImageManager] Get error:",A),z(null)}}):null},deleteImage:async b=>{const E=await l();return E?(a.has(b)&&(URL.revokeObjectURL(a.get(b)),a.delete(b)),new Promise(z=>{const g=E.transaction([n],"readwrite").objectStore(n).delete(b);g.onsuccess=()=>z(!0),g.onerror=()=>z(!1)})):!1},getStats:async()=>{const b=await l();return b?new Promise(E=>{const x=b.transaction([n],"readonly").objectStore(n).getAll();x.onsuccess=()=>{const g=x.result||[],S=g.reduce((L,B)=>L+(B.size||0),0);E({count:g.length,totalSize:S})},x.onerror=()=>E({count:0,totalSize:0})}):{count:0,totalSize:0}},isImageId:b=>typeof b=="string"&&b.startsWith("img_"),initDB:l}})();window.LocalImageManager=ti;const Hn=({src:e,className:t,alt:n,onError:r,onLoad:i,...a})=>{const[l,u]=H.useState(null),[d,y]=H.useState(!1),[j,_]=H.useState(!1),k=H.useRef(null);return H.useEffect(()=>{if(!e||e.startsWith("blob:")||e.startsWith("http://")||e.startsWith("https://")){u(e),_(!1);return}if(ti.isImageId(e)){_(!0),(async()=>{try{const E=await ti.getImage(e);E?(k.current=E,u(E)):(console.warn(`[LazyBase64Image] Image not found in IDB: ${e}`),y(!0))}catch(E){console.error("[LazyBase64Image] IDB resolve failed:",E),y(!0)}_(!1)})();return}return e.startsWith("data:")?(async()=>{try{const z=await(await fetch(e)).blob(),A=URL.createObjectURL(z);k.current=A,u(A)}catch(E){console.error("Base64Blob",E),y(!0),u(e)}})():u(e),()=>{k.current&&k.current.startsWith("blob:")&&(URL.revokeObjectURL(k.current),k.current=null)}},[e]),j||d&&!l||!l||ti.isImageId(l)?null:o.jsx("img",{src:l,className:t,alt:n,onError:r,onLoad:i,...a})},L2=({visible:e,progress:t,status:n,type:r})=>e?o.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/40 backdrop-blur-[2px] animate-in fade-in duration-300 pointer-events-none select-none",children:o.jsxs("div",{className:"relative bg-[#09090b]/90 border border-white/10 rounded-2xl p-8 shadow-2xl flex flex-col items-center min-w-[300px] backdrop-blur-xl",children:[o.jsx("div",{className:"absolute -top-10 left-1/2 -translate-x-1/2 w-20 h-20 bg-blue-500/20 blur-[50px] rounded-full pointer-events-none"}),o.jsxs("div",{className:"flex flex-col items-center gap-1 mb-6 z-10",children:[o.jsx("span",{className:"font-mono text-[10px] tracking-[0.3em] uppercase text-zinc-500",children:r==="import"?"DATA INGESTION":"SYSTEM ARCHIVING"}),o.jsxs("div",{className:"text-4xl font-bold text-zinc-200 tracking-tighter font-sans",children:[t.toFixed(0),o.jsx("span",{className:"text-sm text-zinc-500 ml-1",children:"%"})]})]}),o.jsx("div",{className:"relative w-full h-[2px] bg-zinc-800 rounded-full overflow-hidden mb-4",children:o.jsx("div",{className:"absolute top-0 left-0 h-full bg-white shadow-[0_0_10px_rgba(255,255,255,0.5)] transition-all duration-100 ease-linear",style:{width:`${t}%`}})}),o.jsx("span",{className:"text-[10px] font-mono text-zinc-400 tracking-widest uppercase animate-pulse",children:n})]})}):null,km=H.memo(({item:e,theme:t,lightboxItem:n,onDelete:r,onClick:i,onContextMenu:a,onImageClick:l,onImageContextMenu:u,onRefresh:d,performanceMode:y,localServerUrl:j,isSelected:_,onSelect:k,providers:b,defaultProviders:E})=>{var z,A,x;return o.jsxs("div",{className:`group rounded-lg overflow-hidden border relative cursor-pointer transition-colors ${_?"border-blue-500 ring-2 ring-blue-500/30":t==="dark"?"bg-zinc-900 border-zinc-800 hover:border-blue-500/50":"bg-white border-zinc-200 hover:border-blue-500/50"}`,style:{contentVisibility:"auto",containIntrinsicSize:"1px 300px"},onClick:i,onContextMenu:a,children:[k&&o.jsx("button",{onClick:g=>{g.stopPropagation(),g.preventDefault(),console.log("[V3.5.1 Debug] Selection button clicked for:",e.id,"current isSelected:",_),k(e.id)},className:`absolute bottom-2 right-2 z-20 w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all ${_?"bg-green-500 border-green-400 opacity-100":"border-white/60 bg-black/50 opacity-100 hover:bg-black/70"}`,title:_?"":"",children:_&&o.jsx(el,{size:16,className:"text-white"})}),o.jsxs("div",{className:`bg-black relative ${e.mjImages&&(e.mjImages.length===4||e.mjImages.length>1)||e.mjNeedsSplit&&((A=(z=e.apiConfig)==null?void 0:z.modelId)!=null&&A.includes("mj"))?(()=>{const g=e.mjRatio||"1:1";return g==="16:9"?"aspect-video":g==="9:16"?"aspect-[9/16]":g==="4:3"?"aspect-[4/3]":g==="3:4"?"aspect-[3/4]":g==="21:9"?"aspect-[21/9]":"aspect-square"})():"aspect-video"}`,children:[e.status==="completed"?e.mjImages&&(e.mjImages.length===4||e.mjImages.length>1)?o.jsx("div",{className:`w-full h-full grid gap-0.5 p-0.5 ${e.mjImages.length===4?"grid-cols-2 grid-rows-2":"grid-cols-2"}`,children:e.mjImages.map((g,S)=>(e.mjImageInfo&&e.mjImageInfo[S],o.jsxs("div",{onClick:L=>l&&l(L,e,g,S),onContextMenu:L=>u&&u(L,e,g,S),className:`relative w-full h-full cursor-pointer border-2 transition-all overflow-hidden ${e.selectedMjImageIndex===S&&n&&n.id===e.id?"border-blue-500 scale-95":"border-transparent hover:border-blue-500/50"}`,children:[o.jsx(Hn,{src:g,loading:"lazy",className:"w-full h-full object-contain",alt:` ${S+1}`,onError:L=>{console.error(` ${S+1} `),L.target.style.display="none"}}),e.selectedMjImageIndex===S&&n&&n.id===e.id&&o.jsx("div",{className:"absolute top-1 right-1 w-3 h-3 bg-blue-500 rounded-full flex items-center justify-center z-10",children:o.jsx("svg",{className:"w-2 h-2 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]},S)))}):e.type==="image"?o.jsx(Hn,{src:e.url||e.mjOriginalUrl,loading:"lazy",className:"w-full h-full object-cover",alt:e.prompt||"",onError:g=>{console.error(":",e.url||e.mjOriginalUrl),g.target.style.display="none"}}):o.jsx("video",{src:e.url,className:"w-full h-full object-cover",muted:!0,loop:!0,playsInline:!0,preload:"metadata",onError:g=>{console.error(":",e.url)}}):o.jsx("div",{className:"w-full h-full flex items-center justify-center",children:o.jsx(Js,{className:"animate-spin text-zinc-600"})}),o.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-zinc-800",children:o.jsx("div",{className:"h-full bg-blue-500 transition-all",style:{width:`${e.progress}%`}})})]}),o.jsxs("div",{className:"p-2",children:[o.jsxs("div",{className:"flex justify-between items-start gap-2",children:[o.jsx("p",{className:`text-[10px] line-clamp-1 flex-1 ${t==="dark"?"text-zinc-400":"text-zinc-600"}`,children:e.prompt}),o.jsx("button",{onClick:g=>{g.stopPropagation(),r&&r(e.id)},className:`shrink-0 p-0.5 mr-1 ${t==="dark"?"text-zinc-500 hover:text-red-500":"text-zinc-400 hover:text-red-500"}`,title:"",children:o.jsx(Ms,{size:12})}),e.type==="video"&&(e.status==="generating"||e.status==="failed")&&o.jsx("button",{onClick:g=>{g.stopPropagation(),d&&d(e)},className:`shrink-0 p-0.5 ${t==="dark"?"text-zinc-500 hover:text-white":"text-zinc-400 hover:text-zinc-900"}`,title:"",children:o.jsx(Bf,{size:12})})]}),e.status==="failed"&&e.errorMsg&&o.jsx("p",{className:"text-[9px] text-red-500 mt-1 break-words whitespace-pre-wrap",children:e.errorMsg.split(`
`).map((g,S)=>o.jsxs("span",{children:[g,S<e.errorMsg.split(`
`).length-1&&o.jsx("br",{})]},S))}),e.status==="generating"&&o.jsx("p",{className:"text-[9px] text-blue-500 mt-1",children:e.errorMsg||"..."})]}),o.jsx("div",{className:"flex items-center justify-between px-3 py-2 text-[11px]",children:o.jsxs("div",{className:"flex flex-col",children:[o.jsxs("span",{className:t==="dark"?"text-zinc-300":"text-zinc-700",children:[((x=e.prompt)==null?void 0:x.slice(0,40))||"Untitled",e.prompt&&e.prompt.length>40?"":""]}),o.jsxs("span",{className:t==="dark"?"text-zinc-500":"text-zinc-400",title:`${e.provider||"Provider"} - ${e.modelName}`,children:[e.time,"  ",o.jsx("span",{title:e.provider,children:e.modelName}),typeof e.durationMs=="number"&&e.durationMs>0&&o.jsxs(o.Fragment,{children:["   ",(e.durationMs/1e3).toFixed(1),"s"]})]})]})})]})},(e,t)=>{var n,r;return e.item===t.item&&e.theme===t.theme&&((n=e.lightboxItem)==null?void 0:n.id)===((r=t.lightboxItem)==null?void 0:r.id)&&e.isSelected===t.isSelected}),O2=({nodeId:e,imageUrl:t,imageDimensions:n,isActive:r,onClose:i,onSave:a,theme:l,view:u,maskContent:d,onUpdateNode:y})=>{const j=H.useRef(null),_=H.useRef(null),[k,b]=H.useState(30),[E,z]=H.useState(!1),[A,x]=H.useState([]),[g,S]=H.useState(-1),L=10;H.useEffect(()=>{if(!r||!j.current||!n)return;const v=j.current,ge=v.getContext("2d");if(_.current=ge,v.width=n.w,v.height=n.h,ge.clearRect(0,0,v.width,v.height),d){const rt=new Image;rt.onload=()=>{ge.drawImage(rt,0,0),B()},rt.src=d}else B()},[r,n,e,d]);const B=()=>{if(!j.current||!_.current)return;const v=j.current,rt=_.current.getImageData(0,0,v.width,v.height),ze=A.slice(0,g+1);ze.push(rt),ze.length>L&&ze.shift(),x(ze),S(ze.length-1)},ie=v=>{if(!j.current)return null;const ge=j.current,rt=ge.getBoundingClientRect(),ze=v.clientX-rt.left,we=v.clientY-rt.top,ae=ge.width/rt.width,Re=ge.height/rt.height;return{x:Math.round(ze*ae),y:Math.round(we*Re)}},J=v=>{if(!E||!j.current||!_.current)return;const ge=ie(v);if(!ge)return;const rt=_.current;rt.globalCompositeOperation="source-over",rt.fillStyle="#FFFFFF",rt.beginPath(),rt.arc(ge.x,ge.y,k/2,0,Math.PI*2),rt.fill()},ue=v=>{v.button===0&&(v.preventDefault(),v.stopPropagation(),z(!0),B(),J(v))},ce=v=>{E&&(v.preventDefault(),v.stopPropagation(),J(v))},me=v=>{E&&(v.preventDefault(),v.stopPropagation(),z(!1),B())},Be=()=>{if(g<=0||!j.current||!_.current)return;const v=g-1;S(v),_.current.putImageData(A[v],0,0)},K=()=>{if(!j.current||!_.current)return;_.current.clearRect(0,0,j.current.width,j.current.height),B()},xe=()=>{if(!j.current)return;const ge=j.current.toDataURL("image/png");y&&y(e,{maskContent:ge,isMasking:!1}),a&&a(ge),i&&i()};return H.useEffect(()=>{if(!r)return;const v=ge=>{(ge.ctrlKey||ge.metaKey)&&ge.key==="z"&&!ge.shiftKey&&(ge.preventDefault(),Be())};return window.addEventListener("keydown",v),()=>window.removeEventListener("keydown",v)},[r,g,A]),!r||!t||!n?null:o.jsxs("div",{className:"absolute inset-0 z-50 pointer-events-auto",style:{mixBlendMode:"normal"},onMouseDown:v=>v.stopPropagation(),onMouseMove:v=>v.stopPropagation(),onMouseUp:v=>v.stopPropagation(),children:[o.jsx("canvas",{ref:j,className:"absolute inset-0 w-full h-full",style:{opacity:.5,mixBlendMode:"multiply",cursor:"crosshair",pointerEvents:"auto",imageRendering:"pixelated"},onMouseDown:ue,onMouseMove:ce,onMouseUp:me,onMouseLeave:me}),o.jsx(D2,{canvasRef:j,isDrawing:E}),o.jsxs("div",{className:`absolute bottom-4 left-1/2 -translate-x-1/2 flex flex-row items-center gap-4 p-2 rounded-full border backdrop-blur-md shadow-xl ${l==="dark"?"bg-zinc-900/90 border-zinc-700 text-zinc-200":"bg-white/90 border-zinc-300 text-zinc-800"}`,onMouseDown:v=>v.stopPropagation(),children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-[10px] font-medium whitespace-nowrap",children:""}),o.jsx("input",{type:"range",min:"10",max:"100",value:k,onChange:v=>b(Number(v.target.value)),className:"w-20",onMouseDown:v=>v.stopPropagation()}),o.jsxs("span",{className:"text-[10px] w-8 text-right whitespace-nowrap",children:[k,"px"]})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{onClick:Be,disabled:g<=0,className:`p-1.5 rounded-full transition-colors ${l==="dark"?"hover:bg-zinc-800 disabled:opacity-50 disabled:cursor-not-allowed":"hover:bg-zinc-100 disabled:opacity-50 disabled:cursor-not-allowed"}`,title:" (Ctrl+Z)",children:o.jsx(I2,{size:14})}),o.jsx("button",{onClick:K,className:`p-1.5 rounded-full transition-colors ${l==="dark"?"hover:bg-zinc-800":"hover:bg-zinc-100"}`,title:"",children:o.jsx(ay,{size:14})}),o.jsx("button",{onClick:xe,className:"p-1.5 rounded-full bg-blue-600 hover:bg-blue-500 text-white transition-colors",title:"/",children:o.jsx(tl,{size:14})})]})]})]})},U2=`
        /*  */
        * {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            text-rendering: optimizeLegibility;
        }
        
        /*  */
        #canvas-bg {
            transform: translateZ(0);
            backface-visibility: hidden;
            perspective: 1000px;
        }
        
        /*  */
        #canvas-bg > div[style*="transform"] {
            transform: translateZ(0);
            will-change: transform;
        }
        
        /*  */
        .node-wrapper {
            transform: translateZ(0);
            backface-visibility: hidden;
            contain: layout style;
            will-change: transform, left, top;
        }
        
        /*  -  */
        .node-wrapper img,
        .node-wrapper video {
            image-rendering: auto;
            image-rendering: -webkit-optimize-contrast;
            transform: translateZ(0);
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
            pointer-events: none;
        }
        
        /*  */
        svg {
            shape-rendering: geometricPrecision;
            text-rendering: optimizeLegibility;
        }
        
        /*  */
        .perf-mode .node-wrapper {
            box-shadow: none !important;
            backdrop-filter: none !important;
            border-radius: 0 !important;
            transition: none !important;
        }
        .perf-mode .connection-group {
            opacity: 1 !important;
        }
        
        /*  */
        .interacting .node-wrapper img {
            image-rendering: pixelated;
        }
        .interacting .connection-group {
            display: none;
            pointer-events: none;
        }
        
        .custom-scrollbar::-webkit-scrollbar { width: 4px; height: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #3f3f46; border-radius: 2px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #52525b; }
        .resize-handle { cursor: nwse-resize; opacity: 0; transition: opacity 0.2s; }
        .node-wrapper:hover .resize-handle { opacity: 1; }
        
        /*  */
        .connector { position: absolute; top: 50%; transform: translateY(-50%); width: 0.9rem; height: 0.9rem; background-color: #27272a; border: 1px solid #71717a; color: #a1a1aa; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: crosshair; transition: all 0.2s; z-index: 30; opacity: 0; pointer-events: auto; }
        .node-wrapper:hover .connector { opacity: 1; }
        .connector:hover, .connector.active { background-color: #d4d4d8; border-color: #fff; transform: translateY(-50%) scale(1.2); opacity: 1; color: #000; }
        .connector-right { right: -0.45rem; }
        
        /*  */
        .input-point { position: absolute; top: 50%; transform: translateY(-50%); left: -0.25rem; width: 0.5rem; height: 0.5rem; background-color: #52525b; border-radius: 50%; border: 1px solid #18181b; transition: all 0.2s; z-index: 20; cursor: crosshair; }
        .node-wrapper:hover .input-point { background-color: #a1a1aa; }
        .input-point.connected { background-color: #60a5fa; box-shadow: 0 0 6px #60a5fa; }
        .input-point.active { background-color: #60a5fa; border-color: #fff; transform: translateY(-50%) scale(1.3); box-shadow: 0 0 8px #60a5fa; }

        /* Lightbox & Overlay */
        .lightbox-overlay { background-color: rgba(0, 0, 0, 0.95); backdrop-filter: blur(5px); }
        
        /* Stack Items */
        .thumb-stack-item {
             transition: transform 0.2s, z-index 0.2s;
        }
        .thumb-stack-item:hover {
            transform: scale(1.1) translateY(-2px);
            z-index: 10 !important;
            border-color: #60a5fa;
        }

        /*  */
        .connection-delete {
            opacity: 0;
            transition: opacity 0.2s;
            pointer-events: auto; /*  */
        }
        /*  */
        .connection-group:hover .connection-delete {
            opacity: 1;
        }

        /*  */
        .drop-zone {
            border: 2px dashed transparent;
            transition: all 0.3s;
        }
        .drop-zone.drag-over {
            border-color: #60a5fa;
            background-color: rgba(96, 165, 250, 0.1);
        }

        /* Markdown Styles for Chat */
        .markdown-body { font-size: 13px; line-height: 1.5; color: #e4e4e7; word-wrap: break-word; user-select: text !important; cursor: text; }
        .markdown-body * { user-select: text !important; cursor: text; }
        .markdown-body pre { background: #27272a; padding: 10px; border-radius: 6px; overflow-x: auto; margin: 8px 0; white-space: pre-wrap; word-wrap: break-word; user-select: text !important; cursor: text; }
        .markdown-body code { font-family: monospace; background: #3f3f46; padding: 2px 4px; border-radius: 4px; font-size: 12px; user-select: text !important; cursor: text; }
        .markdown-body pre code { background: transparent; padding: 0; color: #a1a1aa; user-select: text !important; cursor: text; }
        .markdown-body p { margin-bottom: 8px; user-select: text !important; cursor: text; }
        .markdown-body ul, .markdown-body ol { margin-left: 20px; margin-bottom: 8px; list-style: disc; user-select: text !important; cursor: text; }
        .markdown-body li { user-select: text !important; cursor: text; }
        .markdown-body video { max-width: 100%; border-radius: 0.5rem; margin-top: 0.5rem; }
        .markdown-body table { border-collapse: collapse; width: 100%; margin: 12px 0; }
        .markdown-body table th, .markdown-body table td { border: 1px solid #3f3f46; padding: 8px 12px; text-align: left; }
        .markdown-body table th { background-color: #3f3f46; font-weight: 600; }
        .markdown-body table tr:nth-child(even) { background-color: #27272a; }
        .theme-light .markdown-body table th, .theme-light .markdown-body table td { border-color: #d4d4d8; }
        .theme-light .markdown-body table th { background-color: #e4e4e7; }
        .theme-light .markdown-body table tr:nth-child(even) { background-color: #f4f4f5; }
        .theme-light .markdown-body { color: #18181b; }
        .theme-light .markdown-body pre { background: #f4f4f5; color: #18181b; }
        .theme-light .markdown-body code { background: #e4e4e7; color: #18181b; }
        .theme-light .markdown-body pre code { color: #18181b; }
        `,F2=4e3,B2=4e3,vr="https://ai.comfly.chat",H2="http://localhost:5100",Ud={openai:{key:"",url:vr},google:{key:"",url:vr},deepseek:{key:"",url:vr},flux:{key:"",url:vr},midjourney:{key:"",url:"https://api.midjourney.com"},jimeng:{key:"",url:H2},grok:{key:"",url:"https://ai.t8star.cn"}},W2=[{id:"gpt-5.1",provider:"openai",type:"Chat"},{id:"gpt-5.2",provider:"openai",type:"Chat"},{id:"gpt-4o",provider:"openai",type:"Chat"},{id:"deepseek-v3-1-250821",provider:"deepseek",type:"Chat"},{id:"gemini-3-pro-preview",provider:"google",type:"Chat"},{id:"MJ V6",provider:"midjourney",type:"Image"},{id:"flux-kontext-pro",provider:"flux",type:"Image"},{id:"gpt-4o-image",provider:"openai",type:"Image"},{id:"jimeng-4.5",provider:"jimeng",type:"Image"},{id:"jimeng-4.1",provider:"jimeng",type:"Image"},{id:"jimeng-4.0",provider:"jimeng",type:"Image"},{id:"jimeng-3.1",provider:"jimeng",type:"Image"},{id:"jimeng-3.0",provider:"jimeng",type:"Image"},{id:"jimeng-2.1",provider:"jimeng",type:"Image"},{id:"jimeng-xl-pro",provider:"jimeng",type:"Image"},{id:"nanobananapro",provider:"jimeng",type:"Image"},{id:"nanobanana",provider:"jimeng",type:"Image"},{id:"sora-2",provider:"openai",type:"Video",durations:["5s","10s"]},{id:"sora-2-pro",provider:"openai",type:"Video",durations:["15s","25s"]},{id:"jimeng-video-3.5-pro",provider:"jimeng",type:"Video",durations:["5s","10s"]},{id:"jimeng-video-veo3",provider:"jimeng",type:"Video",durations:["8s"]},{id:"jimeng-video-veo3.1",provider:"jimeng",type:"Video",durations:["8s"]},{id:"jimeng-video-sora2",provider:"jimeng",type:"Video",durations:["5s","10s"]},{id:"jimeng-video-3.0-pro",provider:"jimeng",type:"Video",durations:["5s","10s"]},{id:"jimeng-video-3.0",provider:"jimeng",type:"Video",durations:["5s","10s"]},{id:"jimeng-video-3.0-fast",provider:"jimeng",type:"Video",durations:["5s","10s"]},{id:"jimeng-video-2.0-pro",provider:"jimeng",type:"Video",durations:["5s","10s"]},{id:"jimeng-video-2.0",provider:"jimeng",type:"Video",durations:["5s","10s"]},{id:"grok-video-3",provider:"grok",type:"Video",durations:["8s","5s"]}],Wf=["Auto","1:1","16:9","9:16","4:3","3:4","21:9","3:2","2:3"],V2=["3:2","2:3","1:1"],K2=["1080P","720P"],zm="tapnow_prompt_library",jm="3x3 gridKeep character strictly consistent9Character Sheet",_m="UpscaleSharpeningDenoisingBest quality, 8k, masterpiece, highres, ultra detailed, sharp focus, image restoration, upscale, faithful to original.",Nm=`you are a veteran Hollywood storyboard artist with years of experience. You have the ability to accurately analyze character features and scene characteristics based on images. Provide me with the most suitable camera angles and storyboards. Strictly base this on the uploaded character and scene images, while maintaining a consistent visual style.

MANDATORY LAYOUT: Create a precise 3x3 GRID containing exactly 9 distinct panels.

- The output image MUST be a single image divided into a 3 (rows) by 3 (columns) matrix.
- There must be EXACTLY 3 horizontal rows and 3 vertical columns.
- Each panel must be completely separated by a thin, distinct, solid black line.
- DO NOT create a collage. DO NOT overlap images. DO NOT create random sizes. 
- The grid structure must be perfectly aligned for slicing.

Subject Content: "[]"

Styling Instructions:
- Each panel shows the SAME subject/scene from a DIFFERENT angle (e.g., Front, Side, Back, Action, Close-up).
- Maintain perfect consistency of the character/object across all panels.
- Cinematic lighting, high fidelity, 8k resolution.

Negative Constraints:
- No text, no captions, no UI elements.
- No watermarks.
- No broken grid lines.`,Sm=`(strictly mimic source image art style:1.5), (same visual style:1.4),
score_9, score_8_up, masterpiece, best quality, (character sheet:1.4), (reference sheet:1.3), (consistent art style:1.3), matching visual style, 

[Structure & General Annotations]:
multiple views, full body central figure, clean background, 
(heavy annotation:1.4), (text labels with arrows:1.3), handwriting, data readout,

[SPECIAL CHARACTER DESCRIPTION AREA]:
(prominent character profile text box:1.6), (dedicated biography section:1.5), large descriptive text block,
[],

[Clothing Breakdown]:
(clothing breakdown:1.5), (outfit decomposition:1.4), garment analysis, (floating apparel:1.3), 
displaying outerwear, displaying upper body garment, displaying lower body garment, 

[Footwear Focus]:
(detailed footwear display:1.5), (floating shoes:1.4), shoe design breakdown, focus on shoes, 

[Inventory & Details]:
(inventory knolling:1.2), open container, personal accessories, organized items display, expression panels`,Cm=`# Directive: Create a "Rich Narrative Mood Board" (8-Grid Layout)

## 1. PROJECT INPUT 

**A. [Story & Concept / ]**
> []

**B. [Key Symbols /  (Optional)]**
> []

**C. [Color Preferences /  (Optional)]**
> []

**D. [Reference Images / ]**
> (See attached images / )

---

## 2. Role Definition
Act as a **Senior Art Director**. Synthesize the Input above into a single, cohesive, high-density **Visual Mood Board** using a complex **8-Panel Asymmetrical Grid Layout**.

## 3. Layout Mapping (Strict Adherence)
You must design a visual composition that tells the story through **8 distinct panels** within one image. **Do not** generate random grids. Map the content exactly as follows:

* **Panel 1 (The World):** A wide, cinematic establishing shot of the environment (based on Input A).
* **Panel 2 (The Protagonist):** A portrait close-up (based on reference images), focusing on micro-expressions.
* **Panel 3 (The Metaphor):** An **abstract symbolic object** representing the core theme (based on Input B).
* **Panel 4 (The Palette):** A graphical **Color Palette Strip** showcasing 5 specific colors extracted from the scene.
* **Panel 5 (The Texture):** Extreme macro close-up of a material surface (e.g., rust, skin, fabric) to add tactile richness.
* **Panel 6 (The Motion):** A motion-blurred or long-exposure shot representing time/chaos.
* **Panel 7 (The Detail):** A focused shot of a specific prop or accessory relevant to the plot.
* **Panel 8 (The AI Art Interpretation - CRITICAL):** This is your **free creative space**. Generate an artistic, surreal, or abstract re-interpretation of the story's emotion. **Do not just copy the inputs.** Create a "Vibe Image" (e.g., Double Exposure, Oil Painting style, or abstract geometry) that captures the *soul* of the narrative.

## 4. Execution Requirements
* **Composition Style:** High-end Editorial / Magazine Layout. Clean, thin white borders.
* **Visual Unity:** All panels must share the same lighting conditions and color grading logic (Unified Aesthetic).
* **Task:** Provide the **Final English Image Prompt** that explicitly describes this 8-grid layout, ensuring Panel 8 stands out as an artistic variation.`,Em=["gemini-image","qwen-image","doubao-seedream","jimeng","hailuo-02","kling-v1-6","wan-2.5"],Im=e=>e&&e.includes("grok")?V2:Wf,Tm=["Auto","1K","2K","4K"],Fd=e=>e&&e.includes("jimeng-4.5")?["2K","4K"]:Tm,Bd=[{label:"MJ V7",value:"--v 7"},{label:"MJ V6.1",value:"--v 6.1"},{label:"MJ V6",value:"--v 6"},{label:"MJ V5.2",value:"--v 5.2"},{label:"MJ V5.1",value:"--v 5.1"},{label:"Niji V6",value:"--niji 6"},{label:"Niji V5",value:"--niji 5"},{label:"Niji V4",value:"--niji 4"}],uy=(e,t)=>{let n=1024,r=1024;if(t==="1080P"?(n=1920,r=1080):t==="720P"?(n=1280,r=720):t==="2K"?(n=2048,r=2048):t==="4K"&&(n=3840,r=2160),e==="Auto")return{str:`${n}x${r}`,w:n,h:r};const[i,a]=e.split(":").map(Number);if(!i||!a)return{str:"1024x1024",w:1024,h:1024};let l,u;return Math.abs(i-a)<.1?(l=n,u=r):i>a?(l=t==="Auto"||t==="1K"?1280:n,u=Math.round(l*(a/i))):(u=t==="Auto"||t==="1K"?1280:n,l=Math.round(u*(i/a))),l=Math.round(l/16)*16,u=Math.round(u/16)*16,{str:`${l}x${u}`,w:l,h:u}},Y2=(e,t,n)=>{const{str:r,w:i,h:a}=uy(t,n);return e.includes("minimax")?{sizeStr:n==="4K"?"1080p":"720p",w:i,h:a}:e.includes("jimeng")||e.includes("veo")?{sizeStr:t,w:i,h:a}:e.includes("grok")?{sizeStr:t,w:i,h:a}:{sizeStr:r,w:i,h:a}},Tr=e=>new Promise((t,n)=>{const r=new Image;r.onload=()=>t({w:r.naturalWidth,h:r.naturalHeight}),r.onerror=()=>n(new Error("Failed to load image")),r.src=e}),Zn=e=>{if(!e)return!1;if(e.startsWith("data:video")||e.includes("force_video_display=true"))return!0;const t=e.split(".").pop().split("?")[0].toLowerCase();return["mp4","webm","ogg","mov"].includes(t)},Mm=e=>new Promise((t,n)=>{const r=document.createElement("video");r.preload="metadata",r.muted=!0,r.playsInline=!0,r.onloadedmetadata=()=>{t({duration:Number(r.duration)||0,w:r.videoWidth||0,h:r.videoHeight||0})},r.onerror=()=>n(new Error("")),r.src=e}),G2=(e,{fps:t=2}={})=>new Promise((n,r)=>{const i=document.createElement("video"),a=document.createElement("canvas"),l=a.getContext("2d");i.muted=!0,i.playsInline=!0,i.crossOrigin="anonymous",i.src=e;const u=[],d=()=>r(new Error(""));i.onerror=d,i.onloadedmetadata=()=>{const y=Number(i.duration)||0;if(!y||!isFinite(y)){r(new Error(""));return}a.width=i.videoWidth||1280,a.height=i.videoHeight||720;const j=1/Math.max(.1,t);let _=0;const k=()=>{l.drawImage(i,0,0,a.width,a.height),u.push({time:Number(_.toFixed(2)),url:a.toDataURL("image/jpeg",.82)}),_+=j,_<=y?i.currentTime=Math.min(_,y):n(u)};i.onseeked=k,i.currentTime=0}}),X2=bu.memo(({img1:e,img2:t})=>{const[n,r]=H.useState(50),i=H.useRef(null),[a,l]=H.useState(!1),u=H.useRef(),d=H.useCallback(_=>{i.current&&(u.current||(u.current=requestAnimationFrame(()=>{if(!i.current)return;const k=i.current.getBoundingClientRect(),b=_.touches?_.touches[0].clientX:_.clientX,E=Math.max(0,Math.min(b-k.left,k.width));r(E/k.width*100),u.current=null})))},[]);H.useEffect(()=>()=>{u.current&&cancelAnimationFrame(u.current)},[]);const y=e,j=t||e;return y?o.jsxs("div",{ref:i,className:"relative w-full h-full cursor-col-resize overflow-hidden group rounded-lg select-none shadow-2xl border border-zinc-800 bg-[#09090b]",onMouseMove:d,onTouchMove:d,onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),children:[o.jsx("div",{className:"absolute inset-0 opacity-20 pointer-events-none",style:{backgroundImage:"conic-gradient(#333 90deg, transparent 90deg), conic-gradient(transparent 90deg, #333 90deg)",backgroundSize:"20px 20px",backgroundPosition:"0 0, 10px 10px"}}),o.jsx("img",{src:y,loading:"lazy",decoding:"async",className:"absolute inset-0 w-full h-full object-contain pointer-events-none select-none",draggable:!1}),o.jsx("div",{className:"absolute inset-0 w-full h-full overflow-hidden pointer-events-none select-none",style:{clipPath:`inset(0 0 0 ${n}%)`},children:o.jsx("img",{src:j,loading:"lazy",decoding:"async",className:"absolute inset-0 w-full h-full object-contain",draggable:!1})}),o.jsx("div",{className:"absolute top-0 bottom-0 w-0.5 bg-white/80 shadow-[0_0_10px_rgba(0,0,0,0.5)] pointer-events-none",style:{left:`${n}%`},children:o.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-6 h-6 bg-white rounded-full shadow-lg flex items-center justify-center text-black",children:o.jsx(Hf,{size:12,className:"rotate-90"})})}),o.jsx("div",{className:`absolute bottom-2 left-2 bg-black/70 text-white text-[10px] font-medium px-2 py-0.5 rounded border border-white/10 transition-opacity duration-200 pointer-events-none ${a?"opacity-100":"opacity-60"}`,children:""}),o.jsx("div",{className:`absolute bottom-2 right-2 bg-blue-600/80 text-white text-[10px] font-medium px-2 py-0.5 rounded border border-white/10 transition-opacity duration-200 pointer-events-none ${a?"opacity-100":"opacity-60"}`,children:""})]}):o.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center text-zinc-500 bg-zinc-900/50 rounded-lg border border-zinc-800 border-dashed pointer-events-none",children:[o.jsx(Hf,{size:24,className:"mb-2 opacity-50"}),o.jsx("span",{className:"text-xs font-medium",children:""})]})}),Tc=bu.memo(({children:e,onClick:t,className:n="",variant:r="primary",icon:i,disabled:a=!1,title:l=""})=>{const u="flex items-center justify-center px-3 py-1.5 rounded-lg transition-all duration-200 font-medium text-xs select-none disabled:opacity-50 disabled:cursor-not-allowed",d={primary:"bg-blue-600 hover:bg-blue-500 text-white shadow-lg shadow-blue-900/20 active:scale-95",secondary:"bg-zinc-800 hover:bg-zinc-700 text-zinc-300 border border-zinc-700 active:scale-95",ghost:"bg-transparent hover:bg-zinc-800 text-zinc-400 hover:text-white",danger:"bg-red-900/30 hover:bg-red-800 text-red-200 border border-red-800 active:scale-95"};return o.jsxs("button",{onClick:t,disabled:a,className:`${u} ${d[r]} ${n}`,title:l,children:[i&&o.jsx(i,{size:14,className:e?"mr-1.5":""}),e]})}),Mc=(e,t)=>{let n;return function(...i){const a=()=>{clearTimeout(n),e(...i)};clearTimeout(n),n=setTimeout(a,t)}},Z2=({isOpen:e,onClose:t,title:n,children:r,theme:i="dark"})=>{if(!e)return null;const a=i==="dark";return o.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-sm",onMouseDown:t,children:o.jsxs("div",{className:`rounded-xl shadow-2xl w-[680px] max-w-[90vw] overflow-hidden animate-in fade-in zoom-in-95 duration-200 flex flex-col max-h-[85vh] border ${a?"bg-[#09090b] border-zinc-800":"bg-white border-zinc-200"}`,onMouseDown:l=>l.stopPropagation(),onClick:l=>l.stopPropagation(),children:[o.jsxs("div",{className:`flex items-center justify-between p-5 border-b shrink-0 ${a?"border-zinc-800/50":"border-zinc-200"}`,children:[o.jsx("h3",{className:`font-bold text-lg ${a?"text-white":"text-zinc-900"}`,children:n}),o.jsx("button",{onClick:t,className:a?"text-zinc-500 hover:text-white":"text-zinc-500 hover:text-zinc-900",children:o.jsx(es,{size:20})})]}),o.jsx("div",{className:`p-0 overflow-y-auto custom-scrollbar flex-1 ${a?"bg-[#09090b]":"bg-white"}`,children:r})]})})},J2=({item:e,onClose:t,onNavigate:n})=>{if(!e)return null;const r=H.useRef(e);return H.useEffect(()=>{r.current=e},[e]),H.useEffect(()=>{if(!e)return;const i=a=>{const l=r.current;if(l&&!(!l.mjImages||l.mjImages.length<=1)&&!(a.target.tagName==="INPUT"||a.target.tagName==="TEXTAREA")){if(a.key==="ArrowLeft"||a.key==="Left"){a.preventDefault(),a.stopPropagation();const u=l.selectedMjImageIndex!==void 0?l.selectedMjImageIndex:0,d=u>0?u-1:l.mjImages.length-1;d>=0&&d<l.mjImages.length&&n&&n(d)}else if(a.key==="ArrowRight"||a.key==="Right"){a.preventDefault(),a.stopPropagation();const u=l.selectedMjImageIndex!==void 0?l.selectedMjImageIndex:0,d=u<l.mjImages.length-1?u+1:0;d>=0&&d<l.mjImages.length&&n&&n(d)}}};return window.addEventListener("keydown",i),()=>{window.removeEventListener("keydown",i)}},[e,n]),o.jsxs("div",{className:"fixed inset-0 z-[200] lightbox-overlay flex flex-col items-center justify-center animate-in fade-in duration-200",onClick:t,children:[o.jsx("button",{className:"absolute top-4 right-4 text-white/70 hover:text-white p-2 bg-black/50 rounded-full transition-colors",onClick:t,children:o.jsx(es,{size:24})}),o.jsxs("div",{className:"max-w-[90vw] max-h-[85vh] relative",onClick:i=>i.stopPropagation(),children:[e.type==="image"?o.jsx(Hn,{src:e.url,alt:e.prompt,className:"max-w-full max-h-[85vh] rounded-lg shadow-2xl object-contain"}):o.jsx("video",{src:e.url,controls:!0,autoPlay:!0,className:"max-w-full max-h-[85vh] rounded-lg shadow-2xl"}),o.jsxs("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 bg-black/60 backdrop-blur-md px-6 py-3 rounded-full text-white text-sm font-medium border border-white/10 text-center shadow-2xl",children:[o.jsx("div",{className:"line-clamp-1 max-w-xl",children:e.prompt}),o.jsxs("div",{className:"text-[10px] text-zinc-400 mt-1",children:[e.width,"x",e.height,"  ",e.id,e.mjImages&&e.mjImages.length>1&&o.jsxs("span",{className:"ml-2",children:["(",(e.selectedMjImageIndex!==void 0?e.selectedMjImageIndex:0)+1,"/",e.mjImages.length,")"]})]})]}),e.mjImages&&e.mjImages.length>1&&o.jsxs(o.Fragment,{children:[o.jsx("button",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-white/70 hover:text-white p-3 bg-black/50 rounded-full transition-colors",onClick:i=>{i.stopPropagation();const a=e.selectedMjImageIndex!==void 0?e.selectedMjImageIndex:0,l=a>0?a-1:e.mjImages.length-1;n&&n(l)},title:" ()",children:o.jsx(f2,{size:24})}),o.jsx("button",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-white/70 hover:text-white p-3 bg-black/50 rounded-full transition-colors",onClick:i=>{i.stopPropagation();const a=e.selectedMjImageIndex!==void 0?e.selectedMjImageIndex:0,l=a<e.mjImages.length-1?a+1:0;n&&n(l)},title:" ()",children:o.jsx(nl,{size:24})})]})]})]})};function q2(){var Dh;const[e,t]=H.useState(()=>{try{return localStorage.getItem("tapnow_theme")||"dark"}catch{return"dark"}});H.useEffect(()=>{const s=document.createElement("style");return s.innerText=U2,document.head.appendChild(s),()=>{document.head.removeChild(s)}},[]),H.useEffect(()=>{try{localStorage.setItem("tapnow_theme",e)}catch{}const s=document.documentElement;e==="dark"?(s.classList.add("theme-dark"),s.classList.remove("theme-light"),document.body.style.backgroundColor="#09090b"):(s.classList.add("theme-light"),s.classList.remove("theme-dark"),document.body.style.backgroundColor="#f4f4f5")},[e]),H.useEffect(()=>{const s=setInterval(()=>{try{const c={nodes:Xr.current,connections:ba.current,timestamp:Date.now()};localStorage.setItem("tapnow_autosave",JSON.stringify(c)),console.log("[AutoSave] ",new Date().toLocaleTimeString())}catch(c){console.warn("[AutoSave] :",c.message)}},6e4);return()=>clearInterval(s)},[]),H.useEffect(()=>{const s=c=>{if(Xr.current&&Xr.current.length>0)return c.preventDefault(),c.returnValue="",c.returnValue};return window.addEventListener("beforeunload",s),()=>window.removeEventListener("beforeunload",s)},[]);const[n,r]=H.useState(()=>{try{const s=localStorage.getItem("tapnow_autosave");if(s)return JSON.parse(s).nodes||[];const c=localStorage.getItem("tapnow_nodes");return c?JSON.parse(c):[]}catch{return[]}}),[i,a]=H.useState(()=>{try{const s=localStorage.getItem("tapnow_autosave");if(s)return JSON.parse(s).connections||[];const c=localStorage.getItem("tapnow_connections");return c?JSON.parse(c):[]}catch{return[]}}),[l,u]=H.useState(()=>{const s=localStorage.getItem("tapnow_max_undo_steps");return s?Math.min(30,Math.max(1,parseInt(s)||5)):5}),[d,y]=H.useState([]),[j,_]=H.useState([]),k=H.useRef(!1),[b,E]=H.useState(null),[z,A]=H.useState(null),[x,g]=H.useState(null),[S,L]=H.useState([]),[B,ie]=H.useState(0),[J,ue]=H.useState(0),ce=H.useRef(new Set),me=H.useCallback(()=>{k.current||(y(s=>[...s,{nodes:JSON.parse(JSON.stringify(n)),connections:JSON.parse(JSON.stringify(i))}].slice(-l)),_([]))},[n,i]),Be=H.useRef(me);H.useEffect(()=>{Be.current=me},[me]),H.useEffect(()=>{if(S.length===0)return;let s=0;n.forEach(h=>{var p;(p=h.settings)!=null&&p.shots&&h.settings.shots.forEach(m=>{m.status==="generating"&&s++;const N=`${h.id}:${m.id}`;ce.current.has(N)&&(m.status==="generating"||m.status==="done"||m.status==="failed")&&ce.current.delete(N)})});const c=s+ce.current.size;let f=0;if(J===0?f=S.length:f=J-c,f>0){const h=S.slice(0,f),p=S.slice(f);h.length>0&&(console.log(`[Batch] Starting ${h.length} shots. Active: ${s}, Pending: ${ce.current.size}, Concurrency: ${J}`,h),h.forEach((m,N)=>{var I,M;const T=n.find($=>$.id===m.nodeId);if(T){const $=(M=(I=T.settings)==null?void 0:I.shots)==null?void 0:M.find(D=>D.id===m.shotId);$&&$.status!=="generating"&&$.status!=="done"&&(ce.current.add(`${m.nodeId}:${m.shotId}`),setTimeout(()=>{m.mode==="image"?Ih(m.nodeId,$):Eh(m.nodeId,$)},N*1e3))}}),L(p))}},[S,J,n]);const K=H.useCallback(()=>{if(d.length===0)return;k.current=!0;const s=d[d.length-1];_(c=>[...c,{nodes:JSON.parse(JSON.stringify(n)),connections:JSON.parse(JSON.stringify(i))}]),r(s.nodes),a(s.connections),y(c=>c.slice(0,-1)),setTimeout(()=>{k.current=!1},100)},[d,n,i]),xe=H.useCallback(()=>{if(j.length===0)return;k.current=!0;const s=j[j.length-1];y(c=>[...c,{nodes:JSON.parse(JSON.stringify(n)),connections:JSON.parse(JSON.stringify(i))}]),r(s.nodes),a(s.connections),_(c=>c.slice(0,-1)),setTimeout(()=>{k.current=!1},100)},[j,n,i]);H.useEffect(()=>{const s=c=>{(c.ctrlKey||c.metaKey)&&c.key==="z"&&(c.shiftKey?(c.preventDefault(),xe()):(c.preventDefault(),K()))};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[K,xe]);const[v,ge]=H.useState({x:0,y:0,zoom:1}),rt=H.useRef({x:0,y:0,zoom:1});H.useRef(null),H.useRef(new Map),H.useRef(new Map);const[ze,we]=H.useState(null),[ae,Re]=H.useState(()=>{const s=localStorage.getItem("tapnow_api_configs");if(s)try{let c=JSON.parse(s);return c=c.map(f=>{if(f.modelName&&f.modelName!==f.id)return{id:f.modelName,provider:f.provider,type:f.type,...f.durations?{durations:f.durations}:{}};const{displayName:h,modelName:p,isCustom:m,...N}=f;return N}),c=c.filter(f=>!Em.includes(f.id)),c}catch(c){console.error("[V3.6.0]  apiConfigs :",c)}return[...W2]}),[X,oe]=H.useState(()=>{try{const s=localStorage.getItem("tapnow_providers");if(s)return JSON.parse(s)}catch(s){console.error(" providers :",s)}return{...Ud}});H.useEffect(()=>{try{localStorage.setItem("tapnow_providers",JSON.stringify(X))}catch(s){console.error(" providers :",s)}},[X]),H.useCallback(s=>{const c=ae.find(h=>h.id===s);if(!c)return{key:"",url:vr,id:s};const f=X[c.provider]||{};return{...c,modelName:c.id,key:f.key||"",url:f.url||vr}},[ae,X]);const[Ve,Ye]=H.useState(()=>localStorage.getItem("tapnow_global_key")||""),[Ee,Lt]=H.useState(()=>{try{const s=localStorage.getItem("tapnow_api_blacklist");if(!s)return{};const c=JSON.parse(s),f=new Date().toDateString();return c.date!==f?{}:c.blacklist||{}}catch{return{}}});H.useEffect(()=>{try{localStorage.setItem("tapnow_api_blacklist",JSON.stringify({date:new Date().toDateString(),blacklist:Ee}))}catch{}},[Ee]);const Zt=H.useRef(Ee);H.useEffect(()=>{Zt.current=Ee},[Ee]);const Et=(s,c)=>{if(!s)return;const f={date:new Date().toDateString(),reason:c,timestamp:Date.now()},h=Zt.current||{};Zt.current={...h,[s]:f},console.log("[V3.5.1 Debug] addToBlacklist called:"),console.log("  - Key ending:","..."+s.slice(-6)),console.log("  - Reason:",c),console.log("  - Old blacklist size:",Object.keys(h).length),console.log("  - New blacklist size:",Object.keys(Zt.current).length),Lt(p=>({...p,[s]:f})),console.log(` API Key "...${s.slice(-4)}" : ${c}`)},[Ht,bn]=H.useState(()=>{const s=localStorage.getItem("tapnow_jimeng_use_local_file");return s!==null?s==="true":!0}),[Yt,Qn]=H.useState(()=>{try{const s=localStorage.getItem("tapnow_nodes");return!s||JSON.parse(s).length===0?(localStorage.removeItem("tapnow_project_name"),""):localStorage.getItem("tapnow_project_name")||""}catch{return""}}),[Un,w]=H.useState(!1),je=H.useRef(null),[he,F]=H.useState({visible:!1,progress:0,status:"",type:"import"}),[O,ee]=H.useState(()=>localStorage.getItem("tapnow_performance_mode")||"off"),[Se,Te]=H.useState(()=>localStorage.getItem("tapnow_local_server_url")||"http://127.0.0.1:9527");H.useEffect(()=>{localStorage.setItem("tapnow_performance_mode",O)},[O]),H.useEffect(()=>{localStorage.setItem("tapnow_local_server_url",Se)},[Se]);const[Q,ye]=H.useState(()=>{try{const s=localStorage.getItem("tapnow_history");return s?JSON.parse(s).map(f=>{var h,p;return f.mjNeedsSplit&&f.mjOriginalUrl&&((p=(h=f.apiConfig)==null?void 0:h.modelId)!=null&&p.includes("mj"))?{...f,url:f.mjOriginalUrl,mjImages:null,mjNeedsSplit:!0}:f}):[]}catch(s){return console.error(":",s),[]}}),[Qe]=H.useState(()=>Date.now()),[De,it]=H.useState({active:!1,current:0,total:0,filename:""}),[jt,It]=H.useState(new Set),[ar,Os]=H.useState(()=>{try{const s=localStorage.getItem("tapnow_auto_save_config");return s?JSON.parse(s):{enabled:!1,interval:5,folderPath:""}}catch{return{enabled:!1,interval:5,folderPath:""}}}),[mr,Us]=H.useState(!1),[At,er]=H.useState(()=>{try{const s=localStorage.getItem("tapnow_chat_sessions");return s?JSON.parse(s):[{id:"default",title:"",messages:[]}]}catch{return[{id:"default",title:"",messages:[]}]}}),[Cn,En]=H.useState("default"),[Dr,ui]=H.useState(""),[Fs,Nr]=H.useState(!1),[Bs,Hs]=H.useState(400),[tr,zs]=H.useState([]),[di,An]=H.useState("gemini-3-pro"),[ls,Ll]=H.useState(!1),[Sr,Pn]=H.useState(null),[fi,ca]=H.useState(()=>{try{const s=localStorage.getItem(zm),c=s?JSON.parse(s):[],f=[{id:"grid-default",name:"",prompt:jm},{id:"upscale-default",name:"",prompt:_m},{id:"moodboard-default",name:"",prompt:Cm},{id:"storyboard-default",name:"",prompt:Nm},{id:"character-sheet-default",name:"",prompt:Sm}],h=new Set((c||[]).map(m=>m.id)),p=[...c];return f.forEach(m=>{const N=p.some(T=>T.name===m.name);!h.has(m.id)&&!N&&p.unshift(m)}),p}catch{return[{id:"grid-default",name:"",prompt:jm},{id:"upscale-default",name:"",prompt:_m},{id:"moodboard-default",name:"",prompt:Cm},{id:"storyboard-default",name:"",prompt:Nm},{id:"character-sheet-default",name:"",prompt:Sm}]}}),[ho,Cr]=H.useState({name:"",prompt:""}),[js,Ol]=H.useState(!1),[mo,ua]=H.useState(!1);H.useEffect(()=>{try{localStorage.setItem(zm,JSON.stringify(fi))}catch{}},[fi]);const[Ws,gr]=H.useState(!1),[go,pi]=H.useState(!1),[nr,hi]=H.useState(null),[mi,vt]=H.useState(null),[V,Ae]=H.useState(null),[Ue,Ot]=H.useState(null),[rn,Gt]=H.useState(null),[Kn,Rn]=H.useState({x:0,y:0}),[Lr,Yr]=H.useState(null),[Yn,da]=H.useState(!1),[cs,Du]=H.useState(!1),[us,Lu]=H.useState(null),[Dn,Er]=H.useState(new Set),Vs=H.useRef(!1),[gi,xo]=H.useState({x:0,y:0,worldX:0,worldY:0,visible:!1}),[lr,ds]=H.useState({visible:!1,x:0,y:0,worldX:0,worldY:0,item:null}),[Or,fa]=H.useState({nodeId:null,shotId:null}),[xi,Ou]=H.useState({visible:!1,x:0,y:0,nodeId:null,frame:null}),[yo,Kp]=H.useState({visible:!1,x:0,y:0,item:null}),[pa,Yp]=H.useState({visible:!1,x:0,y:0,nodeId:null}),[dy,yi]=H.useState(!1),[Gp,Uu]=H.useState(!1),[Xp,vo]=H.useState(!1),[In,Fu]=H.useState(()=>{try{const s=localStorage.getItem("tapnow_characters");return s?JSON.parse(s):[]}catch(s){return console.error(":",s),[]}}),[fy,ha]=H.useState(!1),[Ks,Ul]=H.useState("url"),[bo,Fl]=H.useState(""),[wo,Bl]=H.useState(""),[ko,Zp]=H.useState(1),[zo,Jp]=H.useState(3),[qp,ma]=H.useState(""),[Bu,jo]=H.useState(!1),[Qp,ga]=H.useState(null),[eh,Hl]=H.useState({}),[py,Wl]=H.useState(!1),[Ir,Ki]=H.useState(new Set),[th,Hu]=H.useState(!1),[hy,my]=H.useState("select"),[Ge,mn]=H.useState(null),[cr,Gr]=H.useState(null),[xa,Wu]=H.useState({}),[_o,Vl]=H.useState(null),[gy,Vu]=H.useState(null),[nh,Ku]=H.useState(null),[Yu,ya]=H.useState({}),[xy,yy]=H.useState({}),[vy,rh]=H.useState(()=>{try{return localStorage.getItem("tapnow_last_image_model")||"nano-banana"}catch{return"nano-banana"}}),[sh,ih]=H.useState(()=>{try{return localStorage.getItem("tapnow_last_video_model")||"sora-2"}catch{return"sora-2"}}),[oh,by]=H.useState(()=>{try{return localStorage.getItem("tapnow_last_ratio")||"1:1"}catch{return"1:1"}}),[wy,ky]=H.useState(()=>{try{return localStorage.getItem("tapnow_last_image_res")||"Auto"}catch{return"Auto"}}),[zy,jy]=H.useState(()=>{try{return localStorage.getItem("tapnow_last_video_res")||"720P"}catch{return"720P"}}),[_y,Ny]=H.useState(()=>{try{return localStorage.getItem("tapnow_last_segment_duration")||"3"}catch{return"3"}}),[Sy,Cy]=H.useState(()=>{try{return localStorage.getItem("tapnow_last_analyze_model")||"gemini-3-pro"}catch{return"gemini-3-pro"}}),Ys=H.useRef(null),va=H.useRef({x:0,y:0}),ah=H.useRef(null),Xr=H.useRef(n),vi=H.useRef(ze),_s=H.useRef(Dn),ba=H.useRef(i),Kl=H.useRef({}),Gs=H.useRef(null),No=H.useRef(!1),Xs=H.useRef(null),Ns=H.useRef(null),bi=H.useRef(null),wa=H.useRef(null);H.useEffect(()=>{localStorage.setItem("tapnow_api_configs",JSON.stringify(ae))},[ae]);const Gu=H.useCallback(s=>{me(),r(c=>c.filter(f=>f.id!==s)),a(c=>c.filter(f=>f.from!==s&&f.to!==s)),ze===s&&we(null)},[ze,me]),Nt=H.useCallback((s,c)=>{r(f=>f.map(h=>h.id===s?{...h,settings:{...h.settings,...c}}:h))},[]),ka=(s,c)=>{if(!c)return;const f=new FileReader;f.onload=async h=>{const p=h.target.result;let m={duration:0,w:0,h:0};try{m=await Mm(p)}catch(N){console.warn("",N)}r(N=>N.map(T=>T.id===s?{...T,content:p,videoMeta:m,frames:[],selectedKeyframes:[],extractingFrames:!1,videoFileName:c.name}:T))},f.readAsDataURL(c)};H.useEffect(()=>{const s=c=>{if(!(c.target.tagName==="INPUT"||c.target.tagName==="TEXTAREA"||c.target.isContentEditable)&&(c.key==="Delete"||c.key==="Del")){c.preventDefault(),c.stopPropagation();const f=vi.current,h=_s.current;if(f)Gu(f),we(null);else if(h&&h.size>0){Be.current&&Be.current();const p=new Set(h);r(m=>m.filter(N=>!p.has(N.id))),a(m=>m.filter(N=>!p.has(N.from)&&!p.has(N.to))),Er(new Set)}}};return window.addEventListener("keydown",s),()=>{window.removeEventListener("keydown",s)}},[]);const lh=H.useMemo(()=>Mc(s=>{try{localStorage.setItem("tapnow_characters",JSON.stringify(s))}catch(c){console.error(":",c)}},500),[]);H.useEffect(()=>{lh(In)},[In,lh]),H.useEffect(()=>{ga(null)},[bo,wo,Ks]);const za=H.useMemo(()=>Mc(s=>{try{localStorage.setItem("tapnow_history",JSON.stringify(s))}catch(c){console.error(":",c);try{const f=s.map(h=>{var p;return{id:h.id,type:h.type,url:h.url,prompt:((p=h.prompt)==null?void 0:p.substring(0,200))||"",time:h.time,status:h.status,modelName:h.modelName,width:h.width,height:h.height,ratio:h.ratio,mjImages:h.mjImages,selectedMjImageIndex:h.selectedMjImageIndex,mjRatio:h.mjRatio,mjNeedsSplit:h.mjNeedsSplit,mjImageInfo:h.mjImageInfo}});localStorage.setItem("tapnow_history",JSON.stringify(f))}catch(f){console.error(":",f);try{const h=s.map(p=>{var m;return{id:p.id,type:p.type,url:p.url,prompt:((m=p.prompt)==null?void 0:m.substring(0,100))||"",time:p.time,status:p.status,modelName:p.modelName}});za(h)}catch(h){console.error(":",h)}}}},1e3),[]),ch=H.useMemo(()=>Mc(s=>{localStorage.setItem("tapnow_global_key",s)},1e3),[]);H.useEffect(()=>{ch(Ve)},[Ve,ch]),H.useEffect(()=>{try{const s=Q.map(c=>{var p,m,N,T;const f={...c},h=((m=(p=c.apiConfig)==null?void 0:p.modelId)==null?void 0:m.includes("mj"))||((T=(N=c.modelName)==null?void 0:N.toLowerCase())==null?void 0:T.includes("midjourney"));return c.mjImages&&c.mjImages.length===4&&h&&(f.mjImages=null,f.mjNeedsSplit=!0,f.mjOriginalUrl=c.mjOriginalUrl||c.url),c.url&&c.url.startsWith("data:")&&c.url.length>5e3&&(f.url=c.url.substring(0,100)+"..."),delete f.mjImageInfo,f});za(s)}catch(s){console.error(":",s);try{const c=Q.slice(0,20).map(f=>{const h={...f};return h.url&&h.url.startsWith("data:")&&(h.url=h.url.substring(0,100)+"..."),h.mjImages&&(h.mjImages=null),h.mjImageInfo&&delete h.mjImageInfo,h});za(c)}catch(c){console.error(":",c);try{const f=Q.slice(0,10).map(h=>{var p;return{id:h.id,type:h.type,prompt:(p=h.prompt)==null?void 0:p.substring(0,100),time:h.time,status:h.status,modelName:h.modelName}});za(f)}catch(f){console.error(":",f)}}}},[Q,za]);const uh=H.useMemo(()=>Mc(s=>{try{localStorage.setItem("tapnow_chat_sessions",JSON.stringify(s))}catch{}},1e3),[]);H.useEffect(()=>{uh(At)},[At,uh]),H.useEffect(()=>{Xr.current=n,vi.current=ze,_s.current=Dn,ba.current=i,Vs.current=cs},[n,ze,Dn,i,cs]);const Ut=H.useMemo(()=>{const s=new Map;return n.forEach(c=>{s.set(c.id,c)}),s},[n]),en=H.useMemo(()=>{const s=new Map;return ae.forEach(c=>{s.set(c.id,c)}),s},[ae]),wi=H.useCallback(s=>{const c=en.get(s);if(!c)return{key:Ve,url:vr.replace(/\/+$/,""),modelName:s,displayName:s};const f=X[c.provider],h=(f==null?void 0:f.key)||Ve,p=((f==null?void 0:f.url)||vr).replace(/\/+$/,"");return{key:h,url:p,modelName:c.modelName,displayName:c.displayName,provider:c.provider,type:c.type}},[en,X,Ve]),Ss=H.useMemo(()=>{const s={};return Object.entries(X).forEach(([c])=>{s[c]={name:c,models:[]}}),ae.forEach(c=>{if(Em.includes(c.id))return;const f=c.provider||"Other";s[f]||(s[f]={name:f,models:[]}),s[f].models.push(c)}),s},[ae,X]),ja=H.useMemo(()=>{const s=new Map;return Q.forEach(c=>{s.set(c.id,c)}),s},[Q]),Yl=H.useMemo(()=>{if(!Ys.current)return n;const s=Ys.current.getBoundingClientRect(),c=200,f=rt.current,h=(-f.x-c)/f.zoom,p=(s.width-f.x+c)/f.zoom,m=(-f.y-c)/f.zoom,N=(s.height-f.y+c)/f.zoom;return n.filter(T=>{const I=T.x+(T.width||0),M=T.y+(T.height||0);return T.x<p&&I>h&&T.y<N&&M>m})},[n,v.x,v.y,v.zoom]);H.useCallback(s=>s>=.8?"high":s>=.4?"medium":"low",[]),H.useEffect(()=>{rt.current=v},[v]);const So=H.useMemo(()=>{const s={to:new Map,from:new Map};return i.forEach(c=>{s.to.has(c.to)||s.to.set(c.to,[]),s.to.get(c.to).push(c),s.from.has(c.from)||s.from.set(c.from,[]),s.from.get(c.from).push(c)}),s},[i]);H.useEffect(()=>{const s=setInterval(()=>{const c=Date.now(),f=Q.filter(p=>p.sourceNodeId&&p.status==="generating"&&p.startTime),h={};f.forEach(p=>{const m=Math.floor((c-p.startTime)/100);h[p.sourceNodeId]=m/10}),yy(h)},500);return()=>clearInterval(s)},[Q]);const Gl=H.useRef(new Set);H.useEffect(()=>{Q.forEach(s=>{var c,f;if(s.mjNeedsSplit&&s.mjOriginalUrl&&((f=(c=s.apiConfig)==null?void 0:c.modelId)!=null&&f.includes("mj"))&&s.status==="completed"){if(Gl.current.has(s.id))return;Gl.current.add(s.id),setTimeout(()=>{let h=s.mjRatio||"1:1";if(s.prompt&&s.prompt.includes("--ar ")){const p=s.prompt.match(/--ar\s+([\d:]+)/);p&&p[1]&&(h=p[1])}console.log(`Midjourney: ID: ${s.id}, : ${h}`),_h(s.mjOriginalUrl,h).then(p=>{const m=p.map(I=>typeof I=="string"?I:I.url),N=p[0],T=typeof N=="string"?N:N.url;ye(I=>I.map(M=>M.id===s.id?{...M,mjImages:m,url:T,selectedMjImageIndex:0,mjRatio:h,mjNeedsSplit:!1,mjImageInfo:p.map($=>typeof $=="string"?null:{width:$.width,height:$.height,ratio:$.ratio})}:M)),Gl.current.delete(s.id),console.log(`Midjourney: ID: ${s.id}`)}).catch(p=>{console.error("Midjourney: :",p),Gl.current.delete(s.id),ye(m=>m.map(N=>N.id===s.id?{...N,mjNeedsSplit:!0}:N))})},500)}})},[Q]);const Xu=H.useRef(new Set);H.useEffect(()=>{const s=n.filter(c=>{var f,h;return c.type==="local-save"&&((f=c.settings)==null?void 0:f.autoSave)&&((h=c.settings)==null?void 0:h.serverStatus)==="connected"});s.length!==0&&s.forEach(async c=>{var N;const f=Ju(c.id);if(f.length===0)return;const h=((N=c.settings)==null?void 0:N.lastSavedUrls)||[],p=f.filter(T=>!h.includes(T));if(p.length===0)return;const m=`${c.id}-${p.join(",")}`;Xu.current.has(m)||(Xu.current.add(m),setTimeout(async()=>{var T,I,M;try{const $={images:p,path:((T=c.settings)==null?void 0:T.savePath)||"",subfolder:((I=c.settings)==null?void 0:I.subfolder)||"",format:"jpg"},D=await fetch(`${Se}/save`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify($)});if(D.ok){const P=await D.json(),W=[...h,...p];Nt(c.id,{lastSavedUrls:W,lastSaved:new Date().toLocaleString(),savedFiles:[...((M=c.settings)==null?void 0:M.savedFiles)||[],...P.files]})}}catch($){console.error(":",$)}finally{Xu.current.delete(m)}},1e3))})},[n,Q,Se]);const Ey=s=>{s.preventDefault(),dh(!0)},[Xl,dh]=H.useState(!1),Zl=H.useCallback(s=>{if(!Xl)return;const c=window.innerWidth-s.clientX;Hs(Math.max(300,Math.min(c,800)))},[Xl]),Jl=H.useCallback(()=>{dh(!1)},[]);H.useEffect(()=>{const s=console.error,c=console.warn,f=h=>{const p=h.map(m=>typeof m=="string"?m:m&&m.toString?m.toString():"").join(" ");return p.includes("Unable to preventDefault")||p.includes("passive event listener")||p.includes("preventDefault")&&p.includes("passive")};return console.error=function(...h){f(h)||s.apply(console,h)},console.warn=function(...h){f(h)||c.apply(console,h)},()=>{console.error=s,console.warn=c}},[]),H.useEffect(()=>{const s=f=>{if(f.ctrlKey)try{f.cancelable&&(f.preventDefault(),f.stopPropagation())}catch{}},c={passive:!1,capture:!0};return window.addEventListener("wheel",s,c),document.addEventListener("wheel",s,c),window.addEventListener("mousewheel",s,c),document.addEventListener("mousewheel",s,c),()=>{window.removeEventListener("wheel",s,c),document.removeEventListener("wheel",s,c),window.removeEventListener("mousewheel",s,c),document.removeEventListener("mousewheel",s,c)}},[]),H.useEffect(()=>{const s=Ys.current;if(!s)return;const c=f=>{if(f.ctrlKey){try{f.cancelable&&(f.preventDefault(),f.stopPropagation())}catch{}return}const h=f.target;let p=!1,m=null,N=h;for(;N&&N!==s;){if(N.classList){const $=N.classList.contains("flex")&&N.classList.contains("flex-col")&&N.classList.contains("h-full")&&N.classList.contains("rounded-xl")&&N.classList.contains("overflow-hidden");if(N.classList.contains("video-input-container")||N.classList.contains("video-analyze-container")||$){if(p=!0,$)m=N.querySelector(".flex-1.overflow-y-auto.custom-scrollbar"),m||(m=N.querySelector(".flex-1.overflow-y-auto"));else if(m=N.querySelector('.overflow-y-auto, .custom-scrollbar, [class*="overflow-y"]'),!m){const W=window.getComputedStyle(N);(W.overflowY==="auto"||W.overflowY==="scroll"||N.classList.contains("custom-scrollbar"))&&(m=N)}break}const D=N.closest(".video-input-container, .video-analyze-container");if(D){if(p=!0,m=D.querySelector('.overflow-y-auto, .custom-scrollbar, [class*="overflow-y"]'),!m){const W=window.getComputedStyle(D);(W.overflowY==="auto"||W.overflowY==="scroll")&&(m=D)}break}const P=N.closest(".flex.flex-col.h-full.rounded-xl.overflow-hidden");if(P){p=!0,m=P.querySelector(".flex-1.overflow-y-auto.custom-scrollbar"),m||(m=P.querySelector(".flex-1.overflow-y-auto"));break}}N=N.parentElement}if(p&&m){try{f.cancelable&&(f.preventDefault(),f.stopPropagation())}catch{}const $=m.scrollHeight-m.clientHeight,D=m.scrollTop,P=Math.max(0,Math.min($,D+f.deltaY));m.scrollTop=P;return}try{f.cancelable&&f.preventDefault()}catch{}const T=s.getBoundingClientRect(),I=f.clientX-T.left,M=f.clientY-T.top;ge($=>{const D=f.deltaY>0?.9:1.1;let P=Math.min(Math.max($.zoom*D,.2),3);const W=P/$.zoom;return{zoom:P,x:I-(I-$.x)*W,y:M-(M-$.y)*W}})};return s.addEventListener("wheel",c,{passive:!1}),()=>{s.removeEventListener("wheel",c)}},[v]),H.useEffect(()=>(Xl?(window.addEventListener("mousemove",Zl),window.addEventListener("mouseup",Jl)):(window.removeEventListener("mousemove",Zl),window.removeEventListener("mouseup",Jl)),()=>{window.removeEventListener("mousemove",Zl),window.removeEventListener("mouseup",Jl)}),[Xl,Zl,Jl]);const un=H.useCallback((s,c)=>{var m;const f=(m=Ys.current)==null?void 0:m.getBoundingClientRect(),h=f?s-f.left:s,p=f?c-f.top:c;return{x:(h-v.x)/v.zoom,y:(p-v.y)/v.zoom}},[v]),Iy=s=>{var c;if((s.button===0||s.button===1)&&s.currentTarget.id==="canvas-bg"){const f=s.target;if(f&&(f.tagName==="INPUT"||f.tagName==="TEXTAREA"||f.tagName==="SELECT"||f.tagName==="BUTTON"||f.isContentEditable||f.closest('input, textarea, select, button, [contenteditable="true"]')))return;const h=window.getSelection();if(h&&h.toString().length>0&&h.removeAllRanges(),s.button===0&&(s.ctrlKey||s.metaKey)){s.preventDefault(),Du(!0),Vs.current=!0,gr(!1);const p=(c=Ys.current)==null?void 0:c.getBoundingClientRect(),m=s.clientX-((p==null?void 0:p.left)||0),N=s.clientY-((p==null?void 0:p.top)||0);Lu({startX:m,startY:N,endX:m,endY:N}),Er(new Set),we(null);return}Vs.current||(gr(!0),No.current=!0,pi(!1),va.current={x:s.clientX,y:s.clientY})}},ql=H.useRef(null),Zr=H.useRef(null),ki=H.useRef(null),_a=H.useCallback(()=>{if(ki.current){const f=ki.current,h=new Map(f.map(({nodeId:p})=>[p,!0]));r(p=>{if(p.length>50&&f.length>10){const m=new Map;p.forEach((I,M)=>{h.has(I.id)&&m.set(I.id,M)});const N=[...p];let T=!1;return f.forEach(({nodeId:I,updater:M})=>{const $=m.get(I);if($!==void 0){const D=M(N[$]);D!==N[$]&&(N[$]=D,T=!0)}}),T?N:p}else{const m=[...p];let N=!1;return f.forEach(({nodeId:T,updater:I})=>{const M=m.findIndex($=>$.id===T);if(M!==-1){const $=I(m[M]);$!==m[M]&&(m[M]=$,N=!0)}}),N?m:p}}),ki.current=null,Zr.current=null;return}if(!ql.current){Zr.current=null;return}const{nodeId:s,updater:c}=ql.current;r(f=>{const h=f.findIndex(N=>N.id===s);if(h===-1)return f;const p=c(f[h]);if(p===f[h])return f;const m=[...f];return m[h]=p,m}),ql.current=null,Zr.current=null},[]),Zu=H.useCallback((s,c)=>{ql.current={nodeId:s,updater:c},Zr.current||(Zr.current=requestAnimationFrame(_a))},[_a]),fh=H.useCallback(s=>{if(ki.current&&Zr.current){const c=ki.current,f=new Map;c.forEach(({nodeId:h,updater:p})=>{f.set(h,p)}),s.forEach(({nodeId:h,updater:p})=>{f.set(h,p)}),ki.current=Array.from(f.entries()).map(([h,p])=>({nodeId:h,updater:p}))}else ki.current=s;Zr.current||(Zr.current=requestAnimationFrame(_a))},[_a]);H.useEffect(()=>()=>{Zr.current&&cancelAnimationFrame(Zr.current),Xs.current&&cancelAnimationFrame(Xs.current)},[]);const Na=H.useRef(null),Ql=H.useRef(null),ph=H.useCallback(s=>{var p;const{clientX:c,clientY:f}=s,h=un(c,f);if(Rn(h),cs||Vs.current){cs||Du(!0);const m=(p=Ys.current)==null?void 0:p.getBoundingClientRect(),N=c-((m==null?void 0:m.left)||0),T=f-((m==null?void 0:m.top)||0);Lu(I=>I?{...I,endX:N,endY:T}:null),Ql.current={endX:N,endY:T,rect:m},Na.current||(Na.current=requestAnimationFrame(()=>{if(!Ql.current){Na.current=null;return}const{endX:I,endY:M,rect:$}=Ql.current,D=us;if(!D){Na.current=null;return}const P=Math.min(D.startX,I),W=Math.min(D.startY,M),C=Math.max(D.startX,I),Y=Math.max(D.startY,M),Z=un(P+(($==null?void 0:$.left)||0),W+(($==null?void 0:$.top)||0)),te=un(C+(($==null?void 0:$.left)||0),Y+(($==null?void 0:$.top)||0)),ne=Xr.current,re=new Set;ne.forEach(ke=>{const Ce=ke.x+(ke.width||260),He=ke.y+(ke.height||200);ke.x<te.x&&Ce>Z.x&&ke.y<te.y&&He>Z.y&&re.add(ke.id)}),Er(re),Ql.current=null,Na.current=null}));return}if((Ws||No.current)&&!Vs.current){pi(!0);const m=c-va.current.x,N=f-va.current.y;if(Math.abs(m)<1&&Math.abs(N)<1)return;Ns.current?(Ns.current.dx+=m,Ns.current.dy+=N):Ns.current={dx:m,dy:N},Xs.current||(Xs.current=requestAnimationFrame(()=>{if(!Ns.current){Xs.current=null;return}const{dx:T,dy:I}=Ns.current;ge(M=>{const $=Math.max(.2,Math.min(3,M.zoom)),D=$<.5||$>2.5?1e3:100;return{...M,zoom:$,x:Math.round((M.x+T)*D)/D,y:Math.round((M.y+I)*D)/D}}),Ns.current=null,Xs.current=null})),va.current={x:c,y:f};return}if(mi)Zu(mi,m=>({...m,width:Math.max(250,h.x-m.x),height:Math.max(250,h.y-m.y)}));else if(nr){const m=Math.max(.2,Math.min(3,v.zoom)),N=s.movementX/m,T=s.movementY/m,I=m<.5||m>2.5?.5:1;if(Math.abs(N)<I&&Math.abs(T)<I)return;const M=_s.current;if(M&&M.size>1&&M.has(nr)){const $=Xr.current,D=Math.max(.2,Math.min(3,v.zoom));(!bi.current||wa.current!==null&&Math.abs(wa.current-D)>.01)&&(bi.current={mouseX:c,mouseY:f,nodes:new Map(Array.from(M).map(Y=>{const Z=$.find(te=>te.id===Y);return Z?[Y,{x:Z.x,y:Z.y}]:null}).filter(Boolean))}),wa.current=D;const P=(c-bi.current.mouseX)/D,W=(f-bi.current.mouseY)/D,C=Array.from(bi.current.nodes.entries()).map(([Y,Z])=>({nodeId:Y,updater:te=>({...te,x:Z.x+P,y:Z.y+W})}));fh(C)}else bi.current=null,Zu(nr,$=>({...$,x:$.x+N,y:$.y+T}))}},[Ws,cs,us,nr,mi,un,v.zoom,Zu,fh]),hh=()=>{if(Xs.current&&(cancelAnimationFrame(Xs.current),Xs.current=null),Ns.current){const{dx:s,dy:c}=Ns.current;ge(f=>{const h=Math.max(.2,Math.min(3,f.zoom)),p=h<.5||h>2.5?1e3:100;return{...f,zoom:h,x:Math.round((f.x+s)*p)/p,y:Math.round((f.y+c)*p)/p}}),Ns.current=null}if(ki.current&&Zr.current&&(cancelAnimationFrame(Zr.current),_a()),cs||Vs.current){if(Du(!1),Vs.current=!1,Lu(null),Dn.size===1){const s=Array.from(Dn)[0];we(s)}else Dn.size===0&&we(null);pi(!1),gr(!1),No.current=!1,bi.current=null,wa.current=null;return}(Ws||No.current)&&(gr(!1),No.current=!1,pi(!1),!V&&!Ue&&!nr&&!mi&&(we(null),Er(new Set),xo(s=>({...s,visible:!1})),mn(null),ds(s=>({...s,visible:!1})))),!V&&!Ue&&(hi(null),vt(null),bi.current=null,wa.current=null),pi(!1),Vs.current=!1,va.current={x:0,y:0}};H.useEffect(()=>{if(!(Ws||No.current||go||nr||mi||cs||Vs.current||V||Ue))return;const c=h=>{h.movementX===void 0&&(h.movementX=0),h.movementY===void 0&&(h.movementY=0),ph(h)},f=()=>{hh()};return window.addEventListener("pointermove",c,{passive:!1}),window.addEventListener("pointerup",f,{passive:!1}),()=>{window.removeEventListener("pointermove",c),window.removeEventListener("pointerup",f)}},[Ws,go,nr,mi,cs,V,Ue,ph,hh]);const fs=H.useCallback((s,c,f="default")=>{if(c.stopPropagation(),V&&V!==s)i.some(p=>p.from===V&&p.to===s&&(p.inputType||"default")===f)||(f!=="default"&&a(p=>p.filter(m=>!(m.to===s&&(m.inputType||"default")===f))),a(p=>[...p,{id:`conn-${Date.now()}`,from:V,to:s,inputType:f!=="default"?f:void 0}]));else if(Ue&&Ue!==s){const h=rn||f;i.some(m=>m.from===s&&m.to===Ue&&(m.inputType||"default")===h)||(h!=="default"&&a(m=>m.filter(N=>!(N.to===Ue&&(N.inputType||"default")===h))),a(m=>[...m,{id:`conn-${Date.now()}`,from:s,to:Ue,inputType:h!=="default"?h:void 0}]))}Ae(null),Ot(null),Gt(null),Yr(null),gr(!1),hi(null),vt(null)},[V,Ue,rn,i]),Ty=s=>{if(V){const c=un(s.clientX,s.clientY);xo({visible:!0,x:s.clientX,y:s.clientY,worldX:c.x,worldY:c.y,sourceNodeId:V}),Ae(null)}else if(Ue){const c=un(s.clientX,s.clientY);xo({visible:!0,x:s.clientX,y:s.clientY,worldX:c.x,worldY:c.y,targetNodeId:Ue,inputType:rn}),Ot(null),Gt(null)}},My=s=>{if(s.currentTarget.id==="canvas-bg"){const c=un(s.clientX,s.clientY);xo({visible:!0,x:s.clientX,y:s.clientY,worldX:c.x,worldY:c.y,sourceNodeId:void 0})}},mh=H.useMemo(()=>{const s=new Map;return i.forEach(c=>{var m,N;const f=c.inputType||"default";s.has(c.to)||s.set(c.to,new Map);const h=s.get(c.to);h.has(f)||h.set(f,[]);const p=Ut.get(c.from);if(p){let T=[];if(p.type==="video-input"){const I=p.selectedKeyframes&&p.selectedKeyframes.length>0?p.selectedKeyframes.map(M=>M.url):[];I.length>0?T=I:p.frames&&p.frames.length>0&&(T=[p.frames[0].url])}else if(p.type==="input-image"||p.type==="gen-image"||p.type==="preview")p.content&&T.push(p.content),p.previewMjImages&&T.push(...p.previewMjImages);else if(p.type==="storyboard-node"){const I=((m=p.settings)==null?void 0:m.shots)||[],M=((N=p.settings)==null?void 0:N.mode)||"video";console.log(`[connectedImagesCache] storyboard-node ${p.id}: ${I.length} shots, mode=${M}`),I.forEach($=>{if(!$.outputEnabled){console.log(`[connectedImagesCache] Shot ${$.id} skipped: outputEnabled=false`);return}if(M==="image"){const D=$.selectedImageIndex??-1;D>=0&&$.output_images&&$.output_images.length>0&&$.output_images[D]?(T.push($.output_images[D]),console.log(`[connectedImagesCache] Shot ${$.id} provides output_images[${D}]`)):console.log(`[connectedImagesCache] Shot ${$.id} skipped: selectedImageIndex=${D} (no selection or no image)`)}else $.output_url?T.push($.output_url):$.image_url&&T.push($.image_url)}),console.log(`[connectedImagesCache] Storyboard provides ${T.length} enabled images`)}T.length>0&&h.get(f).push(...T)}}),s},[i,Ut,n,Or]),Ju=H.useCallback((s,c="default")=>{const f=mh.get(s);return f?f.get(c)||[]:[]},[mh]),gh=H.useMemo(()=>{const s=new Map;return i.forEach(c=>{var f,h,p;if(!s.has(c.to)){const m=Ut.get(c.from);if(m){if(m.type==="video-input")s.set(c.to,m);else if(m.type==="input-image"){const N={...m,type:"input-image-as-video",videoFileName:"",videoMeta:{duration:0},frames:m.content?[{time:0,url:m.content}]:[],selectedKeyframes:m.content?[{time:0,url:m.content}]:[],isImageInput:!0};s.set(c.to,N)}else if(m.type==="storyboard-node"){const N=((f=m.settings)==null?void 0:f.shots)||[],T=((h=m.settings)==null?void 0:h.mode)||"video",I=((p=m.settings)==null?void 0:p.projectTitle)||"",M=[];N.forEach((D,P)=>{if(!D.outputEnabled)return;let W=null,C=D.image_filename||`${P+1}`;if(T==="image"){const Y=D.selectedImageIndex??-1;Y>=0&&D.output_images&&D.output_images[Y]&&(W=D.output_images[Y])}else W=D.output_url||D.image_url;W&&M.push({time:P,url:W,filename:C})});const $={...m,type:"storyboard-as-video",videoFileName:I,videoMeta:{duration:N.length},frames:M,selectedKeyframes:M,isStoryboardInput:!0};s.set(c.to,$),console.log(`[connectedVideoInputCache] storyboard-node ${m.id} provides ${M.length} keyframes to downstream`)}}}}),s},[i,Ut]),Sa=H.useCallback(s=>gh.get(s)||null,[gh]),$y=H.useCallback(s=>{for(const c of i)if(c.to===s){const f=Ut.get(c.from);if(f&&f.type==="video-analyze")return f}return null},[i,Ut]),Ca=H.useCallback(s=>{const c=[];return i.forEach(f=>{var h;if(f.to===s){const p=Ut.get(f.from);if(p&&p.type==="text-node"){const m=((h=p.settings)==null?void 0:h.text)||"";m&&c.push(m)}}}),c},[i,Ut]),xh=H.useMemo(()=>{const s=new Map;return i.forEach(c=>{const f=c.inputType||"default",h=`${c.to}:${f}`;if(!s.has(h)){const p=Ut.get(c.from);if(p){let m=null;if(p.type==="video-input"){const N=p.selectedKeyframes&&p.selectedKeyframes.length>0?p.selectedKeyframes[0].url:null;N?m=N:p.frames&&p.frames[0]&&(m=p.frames[0].url)}else p.type==="input-image"&&p.content&&(m=p.content);m&&s.set(h,m)}}}),s},[i,Ut,n]),ec=H.useCallback((s,c)=>{const f=`${s}:${c||"default"}`;return xh.get(f)||null},[xh]),Cs=(s,c,f="image",h=null,p=null,m=null)=>{if(!c&&(!p||p.length===0))return;let N=h;if(!N){const I=ja.get(s);N=I==null?void 0:I.sourceNodeId}if(!N){console.warn("[Tapnow] updatePreviewFromTask:  sourceNodeId for taskId:",s);return}setTimeout(()=>{var M;const I=Ut.get(N);if(I&&(I.type==="gen-image"||I.type==="gen-video")){const $=i.filter(D=>D.to===N);for(const D of $){const P=Ut.get(D.from),W=P&&P.type==="storyboard-node"?P:null;if(W&&((M=W.settings)!=null&&M.shots)){const C=W.settings.shots.find(Y=>Y.status==="generating");if(C){const Y=c||(p&&p.length>0?p[0]:null);if(Y){Kt(W.id,C.id,{image_url:Y,image_filename:m||C.image_filename,status:"done"});break}}}}}},0);const T=ba.current;console.log("[Tapnow] updatePreviewFromTask: ",{taskId:s,url:c,contentType:f,sourceNodeId:N,mjImages:p,filename:m}),r(I=>{const M=T.filter($=>$.from===N).map($=>$.to);return M.length?I.map($=>M.includes($.id)&&$.type==="preview"?{...$,content:c||(p&&p.length>0?p[0]:c),previewType:f,previewMjImages:p,previewFilename:m||$.previewFilename||""}:$):I})},yh=s=>{ye(c=>{const f=c.filter(h=>h.id!==s);try{localStorage.setItem("tapnow_history",JSON.stringify(f))}catch(h){console.error(":",h)}return f}),lr.item&&lr.item.id===s&&ds({visible:!1,x:0,y:0,item:null})},vh=(s,c)=>Re(f=>f.map(h=>h.id===s?{...h,...c}:h)),Ay=s=>Re(c=>c.filter(f=>f.id!==s)),Py=async s=>{Ku(s),ya(h=>({...h,[s]:"idle"}));const{key:c,url:f}=wi(s);if(!c){ya(h=>({...h,[s]:"error"})),Ku(null);return}try{(await fetch(`${f}/v1/models`,{method:"GET",headers:{Authorization:`Bearer ${c}`}})).ok?ya(p=>({...p,[s]:"success"})):ya(p=>({...p,[s]:"error"}))}catch{ya(h=>({...h,[s]:"error"}))}Ku(null)},Yi=s=>{if(!s)return"bg-zinc-600";const c=Yu[s];if(c==="success")return"bg-green-500 shadow-[0_0_8px_rgba(34,197,94,0.8)]";if(c==="error")return"bg-red-500";const{key:f}=wi(s);return f?"bg-zinc-400":"bg-zinc-700"},Co=H.useMemo(()=>At.find(s=>s.id===Cn)||At[0],[At,Cn]),Ry=()=>{var s;(s=ah.current)==null||s.scrollIntoView({behavior:"smooth"})};H.useEffect(()=>{Ry()},[Co==null?void 0:Co.messages,Fs]);const Dy=()=>{const s=`chat-${Date.now()}`,c={id:s,title:"",messages:[]};er(f=>[c,...f]),En(s)},Ly=(s,c)=>{s.stopPropagation();const f=At.filter(h=>h.id!==c);f.length===0?(er([{id:"default",title:"",messages:[]}]),En("default")):(er(f),Cn===c&&En(f[0].id))},Oy=s=>{Array.from(s.target.files).forEach(f=>{const h=new FileReader;h.onload=p=>{var C;const m=p.target.result,N=((C=f.name.split(".").pop())==null?void 0:C.toLowerCase())||"",T=f.type.startsWith("image/"),I=f.type.startsWith("video/"),M=f.type.startsWith("audio/"),$=f.type==="application/pdf"||N==="pdf",D=["doc","docx"].includes(N)||f.type.includes("word"),P=["xls","xlsx"].includes(N)||f.type.includes("excel")||f.type.includes("spreadsheet"),W=["js","jsx","ts","tsx","py","java","cpp","c","html","css","json","xml","yaml","yml","md","txt","sh","bash"].includes(N);zs(Y=>[...Y,{name:f.name,type:f.type,content:m,isImage:T,isVideo:I,isAudio:M,isPDF:$,isDoc:D,isExcel:P,isCode:W,fileExt:N}])},f.type.startsWith("image/")||f.type.startsWith("video/")||f.type.startsWith("audio/")||f.type==="application/pdf"?h.readAsDataURL(f):f.name.match(/\.(txt|md|js|jsx|ts|tsx|py|html|css|json|csv|xml|yaml|yml|sh|bash|java|cpp|c)$/i)?h.readAsText(f):h.readAsDataURL(f)}),s.target.value=""},Uy=s=>{zs(c=>c.filter((f,h)=>h!==s))},bh=async()=>{var W,C,Y,Z,te,ne,re,ke,Ce,He,qe;if(!Dr.trim()&&tr.length===0||ls)return;const s=en.get(di),{key:c,url:f,modelName:h}=wi(di);if(!c){alert(" API  Key"),yi(!0);return}const p=Cn||((W=At[0])==null?void 0:W.id),m=At.find(G=>G.id===p)||At[0],N=(m==null?void 0:m.messages)||[];m&&m.id!==Cn&&En(m.id),Ll(!0);const T={id:`msg-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,role:"user",content:Dr,files:[...tr],timestamp:Date.now(),modelId:di};er(G=>G.map(de=>de.id===p?{...de,messages:[...de.messages,T],title:de.messages.length===0?Dr.slice(0,20):de.title}:de)),ui(""),zs([]);const I=[...N,T],M=20,$=I.length>M?I.slice(-M):I;let D=[{role:"system",content:"AI"},...$.map(G=>({role:G.role,content:G.content}))];const P=[];T.content&&P.push({type:"text",text:T.content}),T.files.forEach(G=>{const de=((s==null?void 0:s.modelName)??"").toLowerCase().includes("gemini");G.isImage?P.push({type:"image_url",image_url:{url:G.content}}):G.isVideo?de?P.push({type:"image_url",image_url:{url:G.content}}):P.push({type:"text",text:`
[User attached video: ${G.name}]
`}):G.isAudio?P.push({type:"text",text:`
[User attached audio: ${G.name}]
`}):G.isPDF||G.isDoc||G.isExcel?P.push({type:"text",text:`
[User attached document: ${G.name} (${G.isPDF?"PDF":G.isDoc?"Word":"Excel"})]
`}):G.isCode||G.content&&typeof G.content=="string"&&G.content.length<5e4?P.push({type:"text",text:`
[File: ${G.name}]
\`\`\`${G.fileExt||"text"}
${G.content}
\`\`\`
`}):P.push({type:"text",text:`
[User attached file: ${G.name}]
`})}),D.push({role:"user",content:P});try{const G=await fetch(`${f}/v1/chat/completions`,{method:"POST",headers:{Authorization:`Bearer ${c}`,"Content-Type":"application/json"},body:JSON.stringify({model:(s==null?void 0:s.modelName)||"gemini-3-pro-preview",messages:D,stream:!1})});if(!G.ok){const tt=await G.text();throw new Error(tt||`API Error: ${G.status}`)}const de=await G.json();let Fe=null;de.choices&&de.choices.length>0?Fe=(Y=(C=de.choices[0])==null?void 0:C.message)==null?void 0:Y.content:de.content?Fe=de.content:de.text?Fe=de.text:de.message?Fe=typeof de.message=="string"?de.message:de.message.content:de.result?Fe=typeof de.result=="string"?de.result:de.result.content:(re=(ne=(te=(Z=de.data)==null?void 0:Z.choices)==null?void 0:te[0])==null?void 0:ne.message)!=null&&re.content?Fe=de.data.choices[0].message.content:(ke=de.data)!=null&&ke.content?Fe=de.data.content:(Ce=de.data)!=null&&Ce.text?Fe=de.data.text:(He=de.data)!=null&&He.message?Fe=typeof de.data.message=="string"?de.data.message:de.data.message.content:(qe=de.data)!=null&&qe.result&&(Fe=typeof de.data.result=="string"?de.data.result:de.data.result.content),(!Fe||Fe.trim()==="")&&(console.error("[] API :",de),Fe="No response");const gt={id:`msg-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,role:"assistant",content:Fe,timestamp:Date.now(),modelId:di};er(tt=>tt.map(pt=>pt.id===Cn?{...pt,messages:[...pt.messages,gt]}:pt))}catch(G){console.error("Chat Error",G);const de={id:`msg-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,role:"assistant",content:`Error: ${G.message}`,isError:!0,timestamp:Date.now()};er(Fe=>Fe.map(gt=>gt.id===Cn?{...gt,messages:[...gt.messages,de]}:gt))}finally{Ll(!1)}},Zs=async s=>await(await fetch(s)).blob(),Gn=async s=>{if(s.startsWith("data:"))return s.split(",")[1];const c=await Zs(s);return new Promise((f,h)=>{const p=new FileReader;p.onloadend=()=>{const m=p.result;f(m.split(",")[1])},p.onerror=h,p.readAsDataURL(c)})},wh=s=>new Promise((c,f)=>{const h=new FileReader;h.onloadend=()=>c(h.result),h.onerror=f,h.readAsDataURL(s)}),kh=async(s,c=2048,f=8)=>new Promise((h,p)=>{const m=new Image;m.crossOrigin="anonymous",m.onload=()=>{var Z,te;const N=m.width,T=m.height;let I=N,M=T;if(N>c||T>c){const ne=c/Math.max(N,T);I=Math.floor(N*ne),M=Math.floor(T*ne),console.log(`Midjourney:  ${N}x${T} -> ${I}x${M}`)}const $=document.createElement("canvas");$.width=I,$.height=M;const D=$.getContext("2d");D.imageSmoothingEnabled=!0,D.imageSmoothingQuality="high",D.drawImage(m,0,0,I,M);let P=.92,W=$.toDataURL("image/jpeg",P);const Y=(((Z=W.split(",")[1])==null?void 0:Z.length)||0)*3/4/(1024*1024);if(Y>f){console.log(`Midjourney:  ${Y.toFixed(2)}MB ...`),P=.75,W=$.toDataURL("image/jpeg",P);const re=(((te=W.split(",")[1])==null?void 0:te.length)||0)*3/4/(1024*1024);console.log(`Midjourney:  ${re.toFixed(2)}MB`)}h(W)},m.onerror=N=>{console.error("Midjourney: ",N),h(s)},m.src=s}),Fy=async(s,c,f)=>{var h,p;try{console.log(`Midjourney:  ${s.length} /...`);const N=(await Promise.all(s.map(async(P,W)=>{if(P.startsWith("data:"))try{const C=await kh(P,2048,8);return console.log(`Midjourney: [${W}]`),C}catch(C){return console.error(`Midjourney: [${W}]`,C),P}else try{const C=await Zs(P),Y=await wh(C),Z=await kh(Y,2048,8);return console.log(`Midjourney: [${W}]URL`),Z}catch(C){throw console.error(`Midjourney: [${W}]URL`,C),C}}))).map((P,W)=>{let C=P;if(typeof C!="string")throw new Error(`base64[${W}]`);C.includes(",")?C=C.split(",")[1]:C.startsWith("data:")&&(C=C.replace(/^data:[^;]*;base64,?/i,""));const Y=C.length;C=C.replace(/[^A-Za-z0-9+/=]/g,"");const Z=C.length;if(Y!==Z&&console.log(`Midjourney: base64[${W}] ${Y-Z} `),!C||C.length<100)throw new Error(`base64[${W}]: ${(C==null?void 0:C.length)||0}`);const te=/^[A-Za-z0-9+/]+={0,2}$/;if(!te.test(C))throw console.error(`Midjourney: base64[${W}]: ${C.length}, 50: ${C.substring(0,50)}`),new Error(`invalid_base64_format: base64[${W}]`);const ne=C.length%4;if(ne!==0&&(C=C.replace(/=+$/,""),C+="=".repeat(4-ne),!te.test(C)))throw console.error(`Midjourney: base64[${W}]: ${C.length}`),new Error(`invalid_base64_format: base64[${W}]`);try{const ke=atob(C);if(!ke||ke.length===0)throw new Error("base64");console.log(`Midjourney: base64[${W}]: ${ke.length}`)}catch(ke){throw console.error(`Midjourney: base64[${W}]:`,ke),new Error(`invalid_base64_format: base64[${W}]`)}const re=`data:image/jpeg;base64,${C}`;return console.log(`Midjourney: base64[${W}]: ${C.length}, 20: ${C.substring(0,20)}`),re}),T=`${c}/mj/submit/upload-discord-images`;console.log("Midjourney: base64:",N.length,"data URL:",(h=N[0])==null?void 0:h.length,"50:",(p=N[0])==null?void 0:p.substring(0,50)),N.forEach((P,W)=>{if(!P||typeof P!="string")throw new Error(`base64[${W}]`);if(!P.startsWith("data:image/"))throw new Error(`base64[${W}]data URL`);let C="";if(P.includes(","))C=P.split(",")[1];else throw new Error(`base64[${W}]data URL`);if(!C||C.length<100)throw new Error(`base64[${W}]`);if(!/^[A-Za-z0-9+/]+={0,2}$/.test(C))throw console.error(`Midjourney: base64[${W}]`),new Error(`base64[${W}]`);if(C.length%4!==0)throw new Error(`base64[${W}]4: ${C.length}`);try{atob(C)}catch(Z){throw new Error(`base64[${W}]: ${Z.message}`)}});const M=JSON.stringify({base64Array:N});console.log("Midjourney: JSON:",M.length,"base64:",N.length);const $=await fetch(T,{method:"POST",headers:{Authorization:`Bearer ${f}`,"Content-Type":"application/json"},body:M});if(!$.ok){let P="";try{P=await $.text();try{const W=JSON.parse(P);throw new Error(`: ${$.status} - ${W.description||W.message||P}`)}catch{throw new Error(`: ${$.status} - ${P}`)}}catch(W){throw new Error(`: ${$.status} - ${W.message||P}`)}}const D=await $.json();if(console.log("Midjourney: :",D),D.code===1&&D.result&&Array.isArray(D.result))return console.log("Midjourney: URLs:",D.result),D.result;{const P=D.description||D.message||"";throw console.error("Midjourney: :",D),new Error(P)}}catch(m){throw console.error("Midjourney: :",m),m}},qu=async(s,c=1920,f=1920)=>new Promise((h,p)=>{const m=new Image;m.crossOrigin="anonymous",m.onload=()=>{const N=m.width,T=m.height;if(N<=c&&T<=f){console.log(`Veo:  ${N}x${T} `),s.startsWith("data:")?h(s):Gn(s).then(W=>{h(`data:image/png;base64,${W}`)}).catch(p);return}let I=N,M=T;if(N>c||T>f){const W=Math.min(c/N,f/T);I=Math.round(N*W),M=Math.round(T*W),I=I%2===0?I:I-1,M=M%2===0?M:M-1}console.log(`Veo:  ${N}x${T} -> ${I}x${M}`);const $=document.createElement("canvas");$.width=I,$.height=M;const D=$.getContext("2d");D.imageSmoothingEnabled=!0,D.imageSmoothingQuality="high",D.drawImage(m,0,0,I,M);const P=$.toDataURL("image/png",.95);h(P)},m.onerror=N=>{console.error("Veo: ",N),p(new Error(""))},s.startsWith("data:")||s.startsWith("blob:")?m.src=s:Zs(s).then(N=>{const T=URL.createObjectURL(N);m.src=T}).catch(p)}),Qu=H.useCallback(s=>{a(c=>c.filter(h=>h.id!==s))},[]),By=(s,c)=>{c.preventDefault(),c.stopPropagation(),c.currentTarget.classList.remove("drag-over");const h=Array.from(c.dataTransfer.files).filter(p=>p.type.startsWith("image/"));if(h.length>0){const p=h[0],m=new FileReader;m.onload=async N=>{const T=N.target.result;let I={w:0,h:0};try{I=await Tr(T)}catch{}me(),r(M=>M.map($=>$.id===s?{...$,content:T,dimensions:I}:$))},m.readAsDataURL(p)}},zh=s=>{s.preventDefault(),s.stopPropagation(),s.currentTarget.classList.add("drag-over")},jh=s=>{s.preventDefault(),s.stopPropagation(),s.currentTarget.classList.remove("drag-over")};H.useEffect(()=>{const s=async h=>{const p=h.target;if(p.tagName==="INPUT"||p.tagName==="TEXTAREA"||p.isContentEditable){const M=window.getSelection();if(M&&M.toString().trim())return;h.preventDefault();return}const N=vi.current,T=_s.current,I=N?[N]:T&&T.size>0?Array.from(T):[];if(I.length>0){h.preventDefault(),h.stopPropagation();const M=Xr.current.filter(P=>I.includes(P.id)),D=ba.current.filter(P=>I.includes(P.from)||I.includes(P.to)).filter(P=>I.includes(P.from)&&I.includes(P.to));Gs.current={nodes:M.map(P=>({...P})),connections:D.map(P=>({...P})),timestamp:Date.now()},console.log(` ${M.length} `)}},c=async h=>{const p=h.target;if(p.tagName==="INPUT"||p.tagName==="TEXTAREA"||p.isContentEditable)return;const N=vi.current;let T=null;if(N&&(T=Xr.current.find(I=>I.id===N)),T&&(T.type==="input-image"||T.type==="video-input")){const I=Array.from(h.clipboardData.items),M=I.find(D=>D.type.startsWith("image/")),$=I.find(D=>D.type.startsWith("video/"));if(M&&T.type==="input-image"){h.preventDefault();const D=M.getAsFile();if(D){const P=new FileReader;P.onload=async W=>{const C=W.target.result;let Y={w:0,h:0};try{Y=await Tr(C)}catch{}me(),r(Z=>Z.map(te=>te.id===T.id?{...te,content:C,dimensions:Y}:te))},P.readAsDataURL(D)}return}else if($&&T.type==="video-input"){h.preventDefault();const D=$.getAsFile();D&&ka(T.id,D);return}}if(Gs.current&&Gs.current.nodes&&Gs.current.nodes.length>0){h.preventDefault(),h.stopPropagation();const I=Gs.current,M=Ys.current;let $=0,D=0;if(M){const de=M.getBoundingClientRect(),Fe=(de.left+de.width/2-v.x)/v.zoom,gt=(de.top+de.height/2-v.y)/v.zoom;$=Fe,D=gt}const P=I.nodes;if(P.length===0)return;const W=Math.min(...P.map(de=>de.x||0)),C=Math.min(...P.map(de=>de.y||0)),Y=Math.max(...P.map(de=>(de.x||0)+(de.width||0))),Z=Math.max(...P.map(de=>(de.y||0)+(de.height||0))),te=(W+Y)/2,ne=(C+Z)/2,re=$-te,ke=D-ne,Ce=new Map,He=Date.now();I.nodes.forEach((de,Fe)=>{const gt=`node-${He}-${Fe}-${Math.random().toString(36).substr(2,9)}`;Ce.set(de.id,gt)});const qe=I.nodes.map(de=>({...de,id:Ce.get(de.id),x:de.x+re,y:de.y+ke})),G=(I.connections||[]).filter(de=>de&&Ce.has(de.from)&&Ce.has(de.to)).map((de,Fe)=>({...de,id:`conn-${He}-${Fe}-${Math.random().toString(36).substr(2,9)}`,from:Ce.get(de.from),to:Ce.get(de.to)}));me(),r(de=>[...de,...qe]),a(de=>[...de,...G]),qe.length===1?(we(qe[0].id),Er(new Set([qe[0].id]))):qe.length>1&&(we(null),Er(new Set(qe.map(de=>de.id)))),console.log(` ${qe.length} `)}},f=h=>{const p=h.target;if(!(p.tagName==="INPUT"||p.tagName==="TEXTAREA"||p.isContentEditable)&&(h.ctrlKey||h.metaKey)&&h.key==="v"){const N=vi.current;if(N){const T=Xr.current.find(I=>I.id===N);if(T&&(T.type==="input-image"||T.type==="video-input"))return}if(Gs.current&&Gs.current.nodes&&Gs.current.nodes.length>0){h.preventDefault(),h.stopPropagation();const T=Gs.current,I=Ys.current;let M=0,$=0;if(I){const G=I.getBoundingClientRect(),de=(G.left+G.width/2-v.x)/v.zoom,Fe=(G.top+G.height/2-v.y)/v.zoom;M=de,$=Fe}const D=T.nodes;if(D.length===0)return;const P=Math.min(...D.map(G=>G.x||0)),W=Math.min(...D.map(G=>G.y||0)),C=Math.max(...D.map(G=>(G.x||0)+(G.width||0))),Y=Math.max(...D.map(G=>(G.y||0)+(G.height||0))),Z=(P+C)/2,te=(W+Y)/2,ne=M-Z,re=$-te,ke=new Map,Ce=Date.now();T.nodes.forEach((G,de)=>{const Fe=`node-${Ce}-${de}-${Math.random().toString(36).substr(2,9)}`;ke.set(G.id,Fe)});const He=T.nodes.map(G=>({...G,id:ke.get(G.id),x:G.x+ne,y:G.y+re})),qe=(T.connections||[]).filter(G=>G&&ke.has(G.from)&&ke.has(G.to)).map((G,de)=>({...G,id:`conn-${Ce}-${de}-${Math.random().toString(36).substr(2,9)}`,from:ke.get(G.from),to:ke.get(G.to)}));me(),r(G=>[...G,...He]),a(G=>[...G,...qe]),He.length===1?(we(He[0].id),Er(new Set([He[0].id]))):He.length>1&&(we(null),Er(new Set(He.map(G=>G.id)))),console.log(` ${He.length} `)}}};return window.addEventListener("copy",s),window.addEventListener("paste",c),window.addEventListener("keydown",f),()=>{window.removeEventListener("copy",s),window.removeEventListener("paste",c),window.removeEventListener("keydown",f)}},[Nt,ka,r,a,we,Er,v]);const zi=async(s,c,f,h,p,m,N=0)=>{if(N>90){ye($=>$.map(D=>D.id===c?{...D,status:"failed",errorMsg:"Veo "}:D));const M=rr.current.get(c);M&&(console.log("[] Veo:",{taskId:c,nodeId:M.nodeId,shotId:M.shotId}),Kt(M.nodeId,M.shotId,{status:"draft"}),rr.current.delete(c));return}fetch(`${f}/v2/videos/generations/${s}`,{method:"GET",headers:{Authorization:`Bearer ${h}`}}).then(async M=>{var Z,te,ne,re,ke,Ce,He,qe;const $=await M.text();let D;try{D=JSON.parse($)}catch{setTimeout(()=>zi(s,c,f,h,p,m,N+1),4e3);return}console.log("[Tapnow] Veo Poll:",D);const P=((Z=D==null?void 0:D.data)==null?void 0:Z.status)||(D==null?void 0:D.status)||((te=D==null?void 0:D.data)==null?void 0:te.task_status),W=((ne=D==null?void 0:D.data)==null?void 0:ne.progress)||(D==null?void 0:D.progress)||"0%",C=((re=D==null?void 0:D.data)==null?void 0:re.fail_reason)||(D==null?void 0:D.fail_reason)||"";if(P==="SUCCESS"||P==="succeeded"||P==="FINISHED"||P==="completed"){const G=((ke=D==null?void 0:D.data)==null?void 0:ke.output)||(D==null?void 0:D.output)||((Ce=D==null?void 0:D.data)==null?void 0:Ce.video_url)||(D==null?void 0:D.video_url)||((qe=(He=D==null?void 0:D.data)==null?void 0:He.data)==null?void 0:qe.output);if(!G){console.warn("[Tapnow] Veo: URL",D),ye(Fe=>Fe.map(gt=>gt.id===c?{...gt,status:"failed",errorMsg:"URL"}:gt));return}console.log("[Tapnow] Veo: URL:",G);const de=Date.now();ye(Fe=>{const gt=Fe.find(dt=>dt.id===c),tt=gt==null?void 0:gt.sourceNodeId,pt=gt==null?void 0:gt.ratio,Ke=de-((gt==null?void 0:gt.startTime)||de);console.log("[Tapnow] Veo: ",{taskId:c,originalRatio:pt,sourceNodeId:tt,historyItem:gt});let ot=p,_t=m;return(async()=>{try{const dt=await Mm(G);if(dt&&dt.w>0&&dt.h>0){console.log("[Tapnow] Veo: ",{w:dt.w,h:dt.h,requestedRatio:pt});const Mt=dt.w,Rt=dt.h;if(pt==="16:9"){const Pt=Mt/Rt,$t=16/9;Math.abs(Pt-$t)>.1?(console.warn(`[Tapnow] Veo:  ${Pt.toFixed(2)}  16:9 (${$t.toFixed(2)})`),console.warn(`[Tapnow] Veo: : ${Mt}x${Rt}, : 16:9`),console.warn(`[Tapnow] Veo:  16:9 : ${p}x${Math.round(p/(16/9))}`),ot=p,_t=Math.round(p/(16/9))):(console.log("[Tapnow] Veo:  16:9"),ot=Mt,_t=Rt)}else if(pt==="9:16"){const Pt=Mt/Rt,$t=9/16;Math.abs(Pt-$t)>.1?(console.warn(`[Tapnow] Veo:  ${Pt.toFixed(2)}  9:16 (${$t.toFixed(2)})`),console.warn(`[Tapnow] Veo: : ${Mt}x${Rt}, : 9:16`),console.warn(`[Tapnow] Veo:  9:16 : ${Math.round(m*(9/16))}x${m}`),ot=Math.round(m*(9/16)),_t=m):(console.log("[Tapnow] Veo:  9:16"),ot=Mt,_t=Rt)}else ot=Mt,_t=Rt;ye(Pt=>Pt.map($t=>$t.id===c?{...$t,status:"completed",progress:100,url:G,width:ot,height:_t,durationMs:Ke,ratio:pt||$t.ratio}:$t));const St=rr.current.get(c);St?(console.log("[] Veo:",{taskId:c,nodeId:St.nodeId,shotId:St.shotId,videoUrl:G}),Kt(St.nodeId,St.shotId,{video_url:G,status:"done"}),rr.current.delete(c)):tt&&setTimeout(()=>{console.log("[Tapnow] Veo: ",{taskId:c,videoUrl:G,sourceNodeId:tt}),Cs(c,G,"video",tt)},0)}}catch(dt){console.warn("[Tapnow] Veo: ",dt);let Mt=p,Rt=m;if(pt==="16:9"){const Pt=Mt/Rt;Math.abs(Pt-16/9)>.1&&(Rt=Math.round(Mt/(16/9)))}else if(pt==="9:16"){const Pt=Mt/Rt;Math.abs(Pt-9/16)>.1&&(Mt=Math.round(Rt*(9/16)))}ye(Pt=>Pt.map($t=>$t.id===c?{...$t,status:"completed",progress:100,url:G,width:Mt,height:Rt,durationMs:Ke,ratio:pt||$t.ratio}:$t));const St=rr.current.get(c);St?(console.log("[] Veofallback:",{taskId:c,nodeId:St.nodeId,shotId:St.shotId,videoUrl:G}),Kt(St.nodeId,St.shotId,{video_url:G,status:"done"}),rr.current.delete(c)):tt&&setTimeout(()=>{console.log("[Tapnow] Veo: ",{taskId:c,videoUrl:G,sourceNodeId:tt}),Cs(c,G,"video",tt)},0)}})(),Fe});return}if(P==="FAILED"||P==="ERROR"||P==="CANCELLED"){let G=`: ${P}`;if(C)try{const de=typeof C=="string"?JSON.parse(C):C;G=(de==null?void 0:de.message)||(de==null?void 0:de.code)||C}catch{G=C||G}console.error("[Tapnow] Veo: ",{status:P,failReason:C,errorMsg:G}),ye(de=>de.map(Fe=>Fe.id===c?{...Fe,status:"failed",errorMsg:G}:Fe));return}if(P==="NOT_START"||P==="PENDING"||P==="QUEUED"){console.log(`[Tapnow] Veo:  ${P} ${W}...`);const G=parseInt(W)||0;ye(de=>de.map(Fe=>Fe.id===c?{...Fe,status:"generating",progress:Math.max(5,G),errorMsg:P==="NOT_START"?"...":void 0}:Fe)),setTimeout(()=>zi(s,c,f,h,p,m,N+1),4e3);return}const Y=parseInt(W)||Math.min(95,N*2+10);console.log(`[Tapnow] Veo:  ${P} ${W}...`),ye(G=>G.map(de=>de.id===c?{...de,status:"generating",progress:Y}:de)),setTimeout(()=>zi(s,c,f,h,p,m,N+1),4e3)}).catch(M=>setTimeout(()=>zi(s,c,f,h,p,m,N+1),4e3))},Gi=(s,c,f,h,p,m,N="",T=0)=>{if(!s||s==="null"||s==="undefined"){console.error(`[Poll Error] Invalid JobId: ${s} for task ${c}`),ye(D=>D.map(P=>P.id===c?{...P,status:"failed",errorMsg:"Task failed: No Job ID returned",durationMs:Date.now()-(P.startTime||Date.now())}:P));return}const I=N==="sora-2-pro"?360:80,M=5e3;if(T>I){ye(P=>P.map(W=>W.id===c?{...W,status:"failed",errorMsg:"Sora "}:W));const D=rr.current.get(c);D&&(console.log("[] Sora:",{taskId:c,nodeId:D.nodeId,shotId:D.shotId}),Kt(D.nodeId,D.shotId,{status:"draft"}),rr.current.delete(c));return}const $=N!=null&&N.includes("grok")?`${f}/v2/videos/generations/${encodeURIComponent(s)}`:`${f}/v1/videos/${encodeURIComponent(s)}`;fetch($,{method:"GET",headers:{Authorization:`Bearer ${h}`}}).then(D=>{if(!D.ok)throw new Error(`HTTP ${D.status}: ${D.statusText}`);return D.text()}).then(D=>{var C,Y,Z,te,ne;let P;try{P=JSON.parse(D)}catch(re){console.error("[Tapnow] Sora/Grok Poll JSON :",re,D),setTimeout(()=>Gi(s,c,f,h,p,m,N,T+1),M);return}console.log("[Tapnow] Sora/Grok Poll:",P);const W=((C=P==null?void 0:P.data)==null?void 0:C.status)||(P==null?void 0:P.status)||((Y=P==null?void 0:P.data)==null?void 0:Y.task_status)||(P==null?void 0:P.task_status);if(W==="SUCCESS"||W==="succeeded"||W==="FINISHED"||W==="completed"){const re=((Z=P==null?void 0:P.data)==null?void 0:Z.output)||(P==null?void 0:P.output)||((te=P==null?void 0:P.data)==null?void 0:te.video_url)||((ne=P==null?void 0:P.data)==null?void 0:ne.url)||(P==null?void 0:P.video_url)||(P==null?void 0:P.url);if(!re){ye(qe=>qe.map(G=>G.id===c?{...G,status:"failed",errorMsg:"URL"}:G));return}const ke=Date.now(),Ce=ja.get(c);Ce==null||Ce.sourceNodeId;const He=ke-((Ce==null?void 0:Ce.startTime)||ke);ye(qe=>{const G=qe.map(Fe=>Fe.id===c?{...Fe,status:"completed",progress:100,url:re,width:p,height:m,durationMs:He}:Fe),de=rr.current.get(c);if(de)console.log("[] Sora:",{taskId:c,nodeId:de.nodeId,shotId:de.shotId,videoUrl:re}),Kt(de.nodeId,de.shotId,{video_url:re,status:"done"}),rr.current.delete(c);else{const Fe=G.find(gt=>gt.id===c);Fe!=null&&Fe.sourceNodeId?setTimeout(()=>{console.log("[Tapnow] Sora: ",{taskId:c,videoUrl:re,sourceNodeId:Fe.sourceNodeId}),Cs(c,re,"video",Fe.sourceNodeId)},0):console.warn("[Tapnow] Sora:  sourceNodeId",{taskId:c,updatedItem:Fe})}return G});return}if(W==="FAILED"||W==="ERROR"||W==="CANCELLED"){ye(re=>re.map(ke=>ke.id===c?{...ke,status:"failed",errorMsg:`: ${W}`}:ke));return}ye(re=>re.map(ke=>ke.id===c?{...ke,status:"generating",progress:Math.min(95,(ke.progress||10)+2)}:ke)),setTimeout(()=>Gi(s,c,f,h,p,m,N,T+1),M)}).catch(D=>{console.error("[Tapnow] Sora/Grok Poll :",D),T<I-5?setTimeout(()=>Gi(s,c,f,h,p,m,N,T+1),M):ye(P=>P.map(W=>W.id===c?{...W,status:"failed",errorMsg:`: ${D.message||""}`}:W))})},_h=async(s,c="1:1")=>new Promise((f,h)=>{const p=new Image;p.crossOrigin="anonymous";const m=setTimeout(()=>{h(new Error(""))},3e4);p.onload=()=>{clearTimeout(m);try{const N=document.createElement("canvas"),T=N.getContext("2d"),I=Math.floor(p.width/2),M=Math.floor(p.height/2),$=I/M,D=[];for(let P=0;P<2;P++)for(let W=0;W<2;W++){const C=Math.max(0,Math.min(W*I,p.width-I)),Y=Math.max(0,Math.min(P*M,p.height-M)),Z=Math.min(I,p.width-C),te=Math.min(M,p.height-Y);N.width=Z,N.height=te,T.fillStyle="#ffffff",T.fillRect(0,0,Z,te),T.drawImage(p,C,Y,Z,te,0,0,Z,te);const ne=N.toDataURL("image/png");D.push({url:ne,width:Z,height:te,ratio:$})}console.log(`Midjourney:  ${p.width}x${p.height} ${I}x${M} ${$.toFixed(2)}`),f(D)}catch(N){console.error("Midjourney: :",N),h(N)}},p.onerror=N=>{clearTimeout(m),console.error("Midjourney: Failed to load image for splitting:",N),h(new Error(""))},p.src=s}),tc=(s,c,f,h,p,m,N,T=0,I=!1)=>{const M=I?160:300,$=5e3;if(T>M){const W=I?800:1500;ye(C=>C.map(Y=>Y.id===s?{...Y,status:"failed",errorMsg:`${W}`}:Y));return}const P=`${f.replace(/\/+$/,"")}/v1/images/tasks/${c}`;fetch(P,{method:"GET",headers:{Authorization:`Bearer ${h}`,"Content-Type":"application/json"}}).then(W=>W.text()).then(W=>{var Ce,He,qe,G,de,Fe,gt,tt,pt;let C;try{C=JSON.parse(W)}catch(Ke){console.error("[Async Image] Failed to parse response:",Ke),setTimeout(()=>tc(s,c,f,h,p,m,N,T+1,I),delayMs);return}console.log("[Async Image] Poll:",C);const Y=(((Ce=C==null?void 0:C.data)==null?void 0:Ce.status)||(C==null?void 0:C.status)||"").toUpperCase();console.log("[Async Image] :",Y,":",{hasData:!!(C!=null&&C.data),hasDataData:!!((He=C==null?void 0:C.data)!=null&&He.data),hasDataStatus:!!((qe=C==null?void 0:C.data)!=null&&qe.status),hasStatus:!!(C!=null&&C.status),dataKeys:C?Object.keys(C):[]});let Z=[];if((G=C==null?void 0:C.data)!=null&&G.data&&Array.isArray(C.data.data)&&C.data.data.length>0?(Z=C.data.data,console.log("[Async Image]  data.data.data :",Z.length,"")):(de=C==null?void 0:C.data)!=null&&de.images&&Array.isArray(C.data.images)&&C.data.images.length>0?(Z=C.data.images,console.log("[Async Image]  data.data.images :",Z.length,"")):C!=null&&C.images&&Array.isArray(C.images)&&C.images.length>0?(Z=C.images,console.log("[Async Image]  data.images :",Z.length,"")):C!=null&&C.data&&Array.isArray(C.data)&&C.data.length>0&&(Z=C.data,console.log("[Async Image]  data.data :",Z.length,"")),Z.length===0){if((Fe=C==null?void 0:C.data)!=null&&Fe.data&&Array.isArray(C.data.data)&&C.data.data.length>0){const Ke=C.data.data[0];if(Ke!=null&&Ke.revised_prompt){const ot=Ke.revised_prompt.match(/!\[.*?\]\((https?:\/\/[^\s\)]+)\)/);ot&&ot[1]&&(Z=[{url:ot[1]}],console.log("[Async Image]  revised_prompt URL:",ot[1]))}}if(Z.length===0&&((gt=C==null?void 0:C.data)!=null&&gt.revised_prompt)){const Ke=C.data.revised_prompt.match(/!\[.*?\]\((https?:\/\/[^\s\)]+)\)/);Ke&&Ke[1]&&(Z=[{url:Ke[1]}],console.log("[Async Image]  data.data.revised_prompt URL:",Ke[1]))}if(Z.length===0&&((tt=C==null?void 0:C.data)!=null&&tt.data)&&Array.isArray(C.data.data)&&C.data.data.length>0){const Ke=C.data.data.filter(ot=>(ot==null?void 0:ot.url)||(ot==null?void 0:ot.image_url)||(ot==null?void 0:ot.imageUrl));Ke.length>0&&(Z=Ke,console.log("[Async Image]  data.data.data :",Z.length,""))}if(Z.length===0&&(Y==="COMPLETED"||Y==="SUCCESS"||Y==="FINISHED"||Y==="DONE")){console.log("[Async Image] 0");const Ke=(_t,dt=0,Mt=new WeakSet)=>{if(dt>5||!_t||typeof _t!="object"||Mt.has(_t))return null;Mt.add(_t);const Rt=["url","image_url","imageUrl","image","src","link","href"];for(const St of Rt)if(_t[St]&&typeof _t[St]=="string"&&_t[St].startsWith("http"))return _t[St];if(Array.isArray(_t)&&_t.length>0){const St=Ke(_t[0],dt+1,Mt);if(St)return St}for(const St in _t)if(_t.hasOwnProperty(St)&&!Rt.includes(St)){const Pt=Ke(_t[St],dt+1,Mt);if(Pt)return Pt}return null},ot=Ke(C);ot?(Z=[{url:ot}],console.log("[Async Image] URL:",ot)):console.warn("[Async Image] URL:",JSON.stringify(C,null,2).substring(0,500))}}const te=(C==null?void 0:C.message)||(C==null?void 0:C.error)||(C==null?void 0:C.fail_reason)||"";ye(Ke=>{const ot=Ke.map(dt=>{var Mt,Rt,St,Pt,$t,Ct,Jt,dn,fn,Jr,gn,Ln;if(dt.id===s)if(Y==="COMPLETED"||Y==="SUCCESS"||Y==="FINISHED"||Y==="DONE"){console.log("[Async Image] :",Y,":",Z.length);const qt=dt.sourceNodeId||N;if(Z&&Z.length>0){const tn=Z.map(nn=>typeof nn=="string"?nn:(nn==null?void 0:nn.url)||(nn==null?void 0:nn.image_url)||(nn==null?void 0:nn.imageUrl)||"").filter(Boolean);if(console.log("[Async Image] URLs:",tn),tn.length>0){const nn=tn[0],Ft=rr.current.get(s);Ft&&Ft.isImageMode&&(console.log("[] :",{taskId:s,nodeId:Ft.nodeId,shotId:Ft.shotId,primaryUrl:nn}),Kt(Ft.nodeId,Ft.shotId,{output_url:nn,status:"done"}),rr.current.delete(s));let pn=null;const Tn=((Mt=C==null?void 0:C.data)==null?void 0:Mt.duration)||((Rt=C==null?void 0:C.data)==null?void 0:Rt.cost_time)||((St=C==null?void 0:C.data)==null?void 0:St.elapsed_time)||((Pt=C==null?void 0:C.data)==null?void 0:Pt.time_cost)||(($t=C==null?void 0:C.data)==null?void 0:$t.spent_time)||(C==null?void 0:C.duration)||(C==null?void 0:C.cost_time)||(C==null?void 0:C.elapsed_time)||(C==null?void 0:C.time_cost)||(C==null?void 0:C.spent_time);if(Tn!=null){if(typeof Tn=="number")pn=Tn<1e4?Tn*1e3:Tn;else if(typeof Tn=="string"){const U=Tn.match(/(\d+\.?\d*)\s*(s|ms||)/i);if(U){const Ne=parseFloat(U[1]),ht=U[2].toLowerCase();pn=ht==="s"||ht===""?Ne*1e3:Ne}else{const Ne=parseFloat(Tn);isNaN(Ne)||(pn=Ne<1e4?Ne*1e3:Ne)}}}if(pn===null){const U=Date.now();pn=U-(dt.startTime||U)}console.log("[Async Image] UI:",{taskId:s,url:nn,sourceNodeId:qt,imageCount:tn.length,durationMs:pn,backendDuration:Tn,frontendCalculated:pn===null?null:Date.now()-(dt.startTime||Date.now())});const Xn=qt||dt.sourceNodeId;return console.log("[Async Image] ",{taskId:s,url:nn,sourceNodeId:Xn,savedSourceNodeId:qt,hItemSourceNodeId:dt.sourceNodeId,imageCount:tn.length}),requestAnimationFrame(()=>{Cs(s,nn,"image",Xn,tn.length>1?tn:null)}),{...dt,status:"completed",progress:100,url:nn,width:p,height:m,durationMs:pn,errorMsg:null,sourceNodeId:qt||dt.sourceNodeId,...tn.length>1?{mjImages:tn,selectedMjImageIndex:0}:{}}}else console.error("[Async Image] URL:",Z)}else{console.error("[Async Image] :",{status:Y,hasData:!!(C!=null&&C.data),hasDataData:!!((Ct=C==null?void 0:C.data)!=null&&Ct.data),fullData:JSON.stringify(C,null,2).substring(0,1e3)});const tn=(Ft,pn=0)=>{if(pn>5||!Ft||typeof Ft!="object")return null;if(Ft.url&&typeof Ft.url=="string"&&Ft.url.startsWith("http"))return Ft.url;if(Ft.image_url&&typeof Ft.image_url=="string"&&Ft.image_url.startsWith("http"))return Ft.image_url;if(Ft.imageUrl&&typeof Ft.imageUrl=="string"&&Ft.imageUrl.startsWith("http"))return Ft.imageUrl;for(const Tn in Ft)if(Ft.hasOwnProperty(Tn)){const Xn=tn(Ft[Tn],pn+1);if(Xn)return Xn}return null},nn=tn(C);if(nn){console.log("[Async Image] URL:",nn);let Ft=null;const pn=((Jt=C==null?void 0:C.data)==null?void 0:Jt.duration)||((dn=C==null?void 0:C.data)==null?void 0:dn.cost_time)||((fn=C==null?void 0:C.data)==null?void 0:fn.elapsed_time)||((Jr=C==null?void 0:C.data)==null?void 0:Jr.time_cost)||((gn=C==null?void 0:C.data)==null?void 0:gn.spent_time)||(C==null?void 0:C.duration)||(C==null?void 0:C.cost_time)||(C==null?void 0:C.elapsed_time)||(C==null?void 0:C.time_cost)||(C==null?void 0:C.spent_time);if(pn!=null){if(typeof pn=="number")Ft=pn<1e4?pn*1e3:pn;else if(typeof pn=="string"){const Xn=pn.match(/(\d+\.?\d*)\s*(s|ms||)/i);if(Xn){const U=parseFloat(Xn[1]),Ne=Xn[2].toLowerCase();Ft=Ne==="s"||Ne===""?U*1e3:U}else{const U=parseFloat(pn);isNaN(U)||(Ft=U<1e4?U*1e3:U)}}}if(Ft===null){const Xn=Date.now();Ft=Xn-(dt.startTime||Xn)}const Tn=qt||dt.sourceNodeId;return console.log("[Async Image] ",{taskId:s,url:nn,sourceNodeId:Tn,savedSourceNodeId:qt,hItemSourceNodeId:dt.sourceNodeId}),requestAnimationFrame(()=>{Cs(s,nn,"image",Tn,null)}),{...dt,status:"completed",progress:100,url:nn,width:p,height:m,durationMs:Ft,errorMsg:null,sourceNodeId:qt||dt.sourceNodeId}}}return{...dt,status:"failed",errorMsg:te||""}}else{if(Y==="FAILED"||Y==="ERROR"||Y==="CANCELLED"||Y==="FAILURE")return{...dt,status:"failed",errorMsg:te||`: ${Y}`};if(Y==="PENDING"||Y==="PROCESSING"||Y==="GENERATING"||Y==="IN_PROGRESS"||Y==="RUNNING"){let qt=10+T*2;if((Ln=C==null?void 0:C.data)!=null&&Ln.progress){const tn=String(C.data.progress);tn.includes("%")?qt=parseInt(tn.replace("%",""),10)||qt:typeof C.data.progress=="number"&&(qt=C.data.progress)}else if(C!=null&&C.progress){const tn=String(C.progress);tn.includes("%")?qt=parseInt(tn.replace("%",""),10)||qt:typeof C.progress=="number"&&(qt=C.progress)}return qt=Math.min(95,Math.max(10,qt)),{...dt,status:"generating",progress:qt,errorMsg:null}}else{const qt=Math.min(90,10+T*1.5);return{...dt,status:"generating",progress:qt,errorMsg:null}}}return dt}),_t=ot.find(dt=>dt.id===s);return _t!=null&&_t.progress,ot});const ne=(((pt=C==null?void 0:C.data)==null?void 0:pt.status)||(C==null?void 0:C.status)||"").toUpperCase();!(ne==="COMPLETED"||ne==="SUCCESS"||ne==="FINISHED"||ne==="DONE")&&!(ne==="FAILED"||ne==="ERROR"||ne==="CANCELLED"||ne==="FAILURE")&&ye(Ke=>{const ot=Ke.find(Mt=>Mt.id===s),_t=(ot==null?void 0:ot.progress)||10;let dt=$;return _t>=90?dt=1e3:_t>=70?dt=2e3:_t>=50?dt=3e3:T>50&&!I&&(dt=1e4),setTimeout(()=>{tc(s,c,f,h,p,m,N,T+1,I)},dt),Ke})}).catch(W=>{console.error("[Async Image] Poll error:",W),setTimeout(()=>tc(s,c,f,h,p,m,N,T+1,I),$)})},nc=(s,c,f,h,p="fast",m,N,T=0)=>{if(T>120){ye($=>$.map(D=>D.id===c?{...D,status:"failed",errorMsg:"Midjourney "}:D));return}fetch(`${f}/${p}/mj/task/${s}/fetch`,{method:"GET",headers:{Authorization:`Bearer ${h}`,"Content-Type":"application/json"}}).then($=>$.text()).then($=>{let D;try{D=JSON.parse($)}catch(ne){console.error("Midjourney: Failed to parse response:",ne),setTimeout(()=>nc(s,c,f,h,p,m,N,T+1),5e3);return}console.log("[Tapnow] Midjourney Poll:",D);const P=(D==null?void 0:D.status)||"",W=(D==null?void 0:D.progress)||"0%",C=(D==null?void 0:D.imageUrl)||"",Y=(D==null?void 0:D.failReason)||"",Z=(D==null?void 0:D.buttons)||[];let te=0;typeof W=="string"&&W.includes("%")?te=parseInt(W.replace("%",""),10)||0:typeof W=="number"&&(te=W),ye(ne=>ne.map(re=>{var ke,Ce,He,qe,G,de,Fe,gt;if(re.id===c){let tt=re.status,pt=re.errorMsg,Ke=te;if(P==="SUCCESS"||P==="FINISHED"){if(tt="completed",Ke=100,pt=null,C&&((Ce=(ke=re.apiConfig)==null?void 0:ke.modelId)!=null&&Ce.includes("mj"))&&((He=re.apiConfig)==null?void 0:He.modelId)!=="mj-zoom"){let _t="1:1";if(re.prompt&&re.prompt.includes("--ar ")){const St=re.prompt.match(/--ar\s+([\d:]+)/);St&&St[1]&&(_t=St[1])}ye(St=>St.map(Pt=>Pt.id===c?{...Pt,url:C,mjRatio:_t,mjOriginalUrl:C,mjNeedsSplit:!0}:Pt));const dt=re.sourceNodeId;dt?setTimeout(()=>{console.log("[Tapnow] Midjourney: ",{taskId:c,imageUrl:C,sourceNodeId:dt}),Cs(c,C,"image",dt)},0):console.warn("[Tapnow] Midjourney:  sourceNodeId",{taskId:c,hItem:re}),setTimeout(()=>{_h(C,_t).then(St=>{const Pt=St.map(Jt=>typeof Jt=="string"?Jt:Jt.url),$t=St[0],Ct=typeof $t=="string"?$t:$t.url;ye(Jt=>Jt.map(dn=>dn.id===c?{...dn,mjImages:Pt,url:Ct,selectedMjImageIndex:0,mjRatio:_t,mjOriginalUrl:C,mjNeedsSplit:!1,mjImageInfo:St.map(fn=>typeof fn=="string"?null:{width:fn.width,height:fn.height,ratio:fn.ratio})}:dn))}).catch(St=>{console.error("Midjourney: Failed to split image:",St),ye(Pt=>Pt.map($t=>$t.id===c?{...$t,url:C,mjRatio:_t,mjOriginalUrl:C,mjNeedsSplit:!0}:$t))})},300);const Mt=Date.now(),Rt=Mt-(re.startTime||Mt);return{...re,status:tt,progress:Ke,errorMsg:pt,url:C,width:m,height:N,mjButtons:Z,mjOriginalUrl:C,durationMs:Rt}}}else P==="FAILURE"||P==="ERROR"||P==="CANCELLED"?(tt="failed",pt=Y||`: ${P}`):P==="NOT_START"||P==="SUBMITTED"||P==="IN_PROGRESS"||P==="MODAL"?(tt="generating",pt=null,Ke===0&&(Ke=5)):(tt="generating",pt=null,Ke=Math.min(95,(re.progress||5)+2));console.log(`[Tapnow] Midjourney Poll Status Update: Task ${c}, Status: ${tt}, Progress: ${Ke}%, ImageUrl: ${C?"Yes":"No"}`);const ot={...re,status:tt,progress:Ke,errorMsg:pt,url:C||re.url,width:m,height:N,mjButtons:Z};if((P==="SUCCESS"||P==="FINISHED")&&C&&(!((G=(qe=re.apiConfig)==null?void 0:qe.modelId)!=null&&G.includes("mj"))||((de=re.apiConfig)==null?void 0:de.modelId)==="mj-zoom")){re.sourceNodeId?(console.log("[Tapnow] : ",{taskId:c,imageUrl:C,sourceNodeId:re.sourceNodeId,modelId:(Fe=re.apiConfig)==null?void 0:Fe.modelId}),((gt=re.apiConfig)==null?void 0:gt.modelId)==="mj-zoom"?r(Mt=>Mt.map(Rt=>Rt.id===re.sourceNodeId&&Rt.type==="expand-image"?{...Rt,content:C}:Rt)):Cs(c,C,"image",re.sourceNodeId)):console.warn("[Tapnow] :  sourceNodeId",{taskId:c,hItem:re});const _t=Date.now(),dt=_t-(re.startTime||_t);ot.durationMs=dt}return ot}return re})),!(P==="SUCCESS"||P==="FINISHED")&&(P==="FAILURE"||P==="ERROR"||P==="CANCELLED"||setTimeout(()=>nc(s,c,f,h,p,m,N,T+1),5e3))}).catch($=>{console.error(`[Tapnow] Midjourney Poll Fetch Error for task ${c}:`,$),ye(D=>D.map(P=>P.id===c?{...P,status:"failed",errorMsg:`: ${$.message}`}:P)),T<3&&setTimeout(()=>nc(s,c,f,h,p,m,N,T+1),5e3)})},Hy=async s=>{if(!s)return null;try{const c=new Image;c.crossOrigin="anonymous",await new Promise((p,m)=>{c.onload=p,c.onerror=m,c.src=s});const f=document.createElement("canvas");f.width=c.width,f.height=c.height;const h=f.getContext("2d");return h.fillStyle="#000000",h.fillRect(0,0,f.width,f.height),h.globalCompositeOperation="destination-out",h.drawImage(c,0,0),new Promise((p,m)=>{f.toBlob(N=>{N?p(N):m(new Error(""))},"image/png")})}catch(c){return console.error("[Inpainting] :",c),null}},Ea=async(s,c,f,h,p={})=>{var tt,pt,Ke,ot,_t,dt,Mt,Rt,St,Pt,$t,Ct,Jt,dn,fn,Jr,gn,Ln,qt,tn,nn,Ft,pn,Tn,Xn,U,Ne,ht,wn;let m=[];const N=Array.isArray(f)?f:f?[f]:[];if(N.length>0)try{m=await Promise.all(N.map(async be=>{if(ti.isImageId(be)){console.log(`[startGeneration] Resolving IDB image: ${be}`);const et=await ti.getImage(be);return et||(console.warn(`[startGeneration] Failed to resolve IDB image: ${be}`),be)}return be}))}catch(be){console.error("[startGeneration] Error resolving images:",be),m=N}const T=m,I=T.length>0?T[0]:void 0;if(console.log("[startGeneration] Images prepared:",T),!s&&!I){alert("");return}let M=null;h&&h.startsWith("storyboard-")&&h.includes("-shot-")?M=null:M=n.find(be=>be.id===h);let $=null,D=M==null?void 0:M.maskContent;if(D)console.log("[Inpainting] :",h);else{let be=i.find(et=>et.to===h&&(!et.inputType||et.inputType==="default"));if(be||(be=i.find(et=>et.to===h)),be){const et=Ut.get(be.from);et&&et.maskContent&&(D=et.maskContent,console.log("[Inpainting] :",et.id))}}D&&($=await Hy(D),$?console.log("[Inpainting] "):console.warn("[Inpainting] "));const P=p.model||((tt=M==null?void 0:M.settings)==null?void 0:tt.model)||(c==="image"?"nano-banana":"sora-2"),W=wi(P);let C=W.key,Y=C;if(C&&C.includes(",")){const be=C.split(",").map(We=>We.trim()).filter(We=>We),et=Zt.current||{};console.log("[V3.5.1 Debug] Multi-account rotation check:"),console.log("  - Total keys:",be.length),console.log("  - Blacklist:",JSON.stringify(et));const xt=be.filter(We=>!et[We]);console.log("  - Available keys:",xt.length),xt.length>0?(Y=xt[Math.floor(Math.random()*xt.length)],console.log(`[Load Balancing] Selected API Key from ${xt.length}/${be.length} available options`)):be.length>0&&(Y=be[Math.floor(Math.random()*be.length)],console.warn(` [Load Balancing] All ${be.length} keys are blacklisted, using random selection`))}let Z=W.url,te=Z;if(Z.includes(",")){const be=Z.split(",").map(et=>et.trim()).filter(et=>et);be.length>0&&(te=be[Math.floor(Math.random()*be.length)],console.log(`[Load Balancing] Selected API URL from ${be.length} options: ${te}`))}if(!Y){alert(" API Key"),yi(!0);return}s&&(P.includes("sora")||P==="sora-2"||P==="sora-2-pro")&&(s=s.replace(/@([a-zA-Z0-9_\.]+)(?![a-zA-Z0-9_\.])/g,(be,et)=>`@{${et}}`),s=s.replace(/@\{([^\}]+)\}/g,(be,et)=>` @{${et}} `).replace(/\s{2,}/g," ").trim(),console.log("[Sora 2] Normalized prompt:",s));let ne=p.ratio||((pt=M==null?void 0:M.settings)==null?void 0:pt.ratio)||(P.includes("grok")?"3:2":"1:1"),re=((Ke=M==null?void 0:M.settings)==null?void 0:Ke.resolution)||(P.includes("grok")?"1080P":"Auto"),{sizeStr:ke,w:Ce,h:He}=Y2(P,ne,re);if(re==="Auto"&&ne==="Auto"&&I)try{const be=await Tr(I),et=Math.round(be.w/64)*64,xt=Math.round(be.h/64)*64;Ce=et,He=xt,ke=`${et}x${xt}`,console.log(`[Auto Res] Using Source Dimensions: ${ke}`)}catch(be){console.error("Auto Res Error",be)}else if(!Ce||!He){const be=uy(ne,re);Ce=be.w,He=be.h,ke=be.str}if(I&&ne==="Auto"&&["1K","2K","4K"].includes(re))try{const be=await Tr(I),et=re==="4K"?4096:re==="2K"?2048:1024,xt=Math.max(be.w,be.h)||1,We=et/xt;let mt=Math.round(be.w*We/16)*16,zt=Math.round(be.h*We/16)*16;mt=Math.max(16,mt),zt=Math.max(16,zt),Ce=mt,He=zt,ke=`${mt}x${zt}`,console.log(`[Auto+${re}] Upscale from ${be.w}x${be.h} -> ${ke}`)}catch(be){console.error("Auto+K Upscale Error",be)}let qe=p.duration?String(p.duration).replace("s",""):((_t=(ot=M==null?void 0:M.settings)==null?void 0:ot.duration)==null?void 0:_t.replace("s",""))||"5";console.log("[V3.5.2 Debug] Duration processing: options.duration=",p.duration,"final duration=",qe),P.includes("veo")&&(qe="8"),p.resolution?re=p.resolution:(dt=M==null?void 0:M.settings)!=null&&dt.resolution&&(re=M.settings.resolution);const G=p._existingTaskId||Date.now().toString(),de=()=>{const be=en.get(P);return P.includes("jimeng")?P:(be==null?void 0:be.displayName)||W.provider||P},Fe=Date.now(),gt=(M==null?void 0:M.id)||h||null;if(p._isRetry||ye(be=>[{id:G,type:c,url:"",prompt:s||(I?`Img2${c==="image"?"Img":"Vid"}`:"Untitled"),time:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),status:"generating",progress:5,modelName:de(),width:Ce,height:He,remoteTaskId:null,apiConfig:{modelId:P,baseUrl:te,apiKey:Y},provider:W.provider,sourceNodeId:gt,startTime:Fe,durationMs:null,ratio:ne},...be]),gt&&gt.startsWith("storyboard-")&&gt.includes("-shot-")){const be=gt.split("-shot-");if(be.length===2){const et=be[1],xt=be[0].startsWith("storyboard-img-"),We=xt?be[0].replace("storyboard-img-",""):be[0].replace("storyboard-","");rr.current.set(G,{nodeId:We,shotId:et,isImageMode:xt}),console.log("[] :",{taskId:G,nodeId:We,shotId:et,isImageMode:xt})}}p._isRetry||requestAnimationFrame(()=>{setTimeout(()=>{Uu(!0)},0)});try{if(c==="image"){let be=`${te}/v1/images/generations`,et,xt=!1;const We=en.get(P),mt=(P.includes("banana")||P.includes("edit")||P.includes("qwen"))&&!(P.includes("nano-banana-2")||((We==null?void 0:We.modelName)??"").includes("nano-banana-2")),zt=P.includes("gpt")||((We==null?void 0:We.modelName)??"").includes("gpt-image")||((We==null?void 0:We.provider)??"").toLowerCase().includes("gpt-4o image"),Wt=P.includes("flux")||((We==null?void 0:We.modelName)??"").includes("flux-kontext"),Ze=((We==null?void 0:We.modelName)??"").includes("nano-banana-2")||P.includes("nano-banana-2"),jn=P.includes("mj")||((We==null?void 0:We.provider)??"").toLowerCase().includes("midjourney"),Mn=P.includes("jimeng")||((We==null?void 0:We.modelName)??"").includes("jimeng")||(We==null?void 0:We.provider)==="jimeng",Bn=()=>{var le;return P.includes("jimeng-4.5")?"jimeng-4.5":P.includes("jimeng-4.1")?"jimeng-4.1":P.includes("jimeng-4.0")?"jimeng-4.0":P.includes("jimeng-3.1")?"jimeng-3.1":P.includes("jimeng-3.0")?"jimeng-3.0":(le=We==null?void 0:We.modelName)!=null&&le.includes("jimeng")?We.modelName:"jimeng-4.5"},ur=(()=>{if(Ze)return re==="4K"?"4K":re==="2K"?"2K":"1K"})(),kn=ne==="Auto"?void 0:ne;if(T.length>0&&mt){be=`${te}/v1/images/edits`,xt=!0;const le=new FormData;le.append("model",(We==null?void 0:We.modelName)||"nano-banana"),le.append("prompt",s||"enhance"),le.append("n","1"),le.append("size",ke),kn&&le.append("aspect_ratio",kn),ur&&le.append("image_size",ur);const Pe=T.map(bt=>Zs(bt));(await Promise.all(Pe)).forEach((bt,st)=>{le.append("image",bt,`input_${st}.png`)}),$&&le.append("mask",$,"mask.png"),et=le}else if(Wt){be=`${te}/v1/images/edits`,xt=!0;const le=new FormData;le.append("model",(We==null?void 0:We.modelName)||"flux-kontext-pro"),le.append("prompt",s||""),kn&&le.append("aspect_ratio",kn),ke&&le.append("size",ke);const Pe=T.length>0?T:I?[I]:[];if(Pe.length>0){const _e=Pe.map(st=>Zs(st));(await Promise.all(_e)).forEach((st,ut)=>le.append("image",st,`flux_ref_${ut}.png`))}$&&le.append("mask",$,"mask.png"),et=le}else if(zt){let le=s||"";const Pe={model:(We==null?void 0:We.modelName)||"gpt-4o-image",prompt:le,n:1,size:ke,aspect_ratio:ne,response_format:"url"};if(T.length>0){const _e=T.map(st=>Gn(st)),bt=await Promise.all(_e);Pe.image=bt.map(st=>`data:image/png;base64,${st}`)}et=Pe}else if(Ze)if(T.length>0){be=`${te}/v1/images/edits?async=true`,xt=!0;const Pe=new FormData;Pe.append("model",(We==null?void 0:We.modelName)||"nano-banana-2"),Pe.append("prompt",s||""),Pe.append("response_format","url"),kn&&Pe.append("aspect_ratio",kn),ur&&Pe.append("image_size",ur);const _e=T.map(st=>Zs(st));(await Promise.all(_e)).forEach((st,ut)=>{Pe.append("image",st,`input_${ut}.png`)}),$&&Pe.append("mask",$,"mask.png"),et=Pe}else{be=`${te}/v1/images/generations?async=true`;const Pe={model:(We==null?void 0:We.modelName)||"nano-banana-2",prompt:s||"",response_format:"url",...kn?{aspect_ratio:kn}:{},...ur?{image_size:ur}:{}};if(I){const _e=I.trim();if(_e.startsWith("http"))Pe.image=[_e];else if(_e.startsWith("data:"))Pe.image=[_e];else{const bt=await Gn(_e);Pe.image=[`data:image/png;base64,${bt}`]}}et=Pe}else if(jn){const le=((Mt=M==null?void 0:M.settings)==null?void 0:Mt.mjMode)||"fast",Pe=((Rt=M==null?void 0:M.settings)==null?void 0:Rt.mjVersion)||"--v 7";let _e=s||"";ne&&ne!=="Auto"&&(_e.includes("--ar ")||(_e=`${_e} --ar ${ne}`.trim()));const bt=ec(h,"oref"),st=ec(h,"sref"),ut=[],wt=new Map;let kt=null,Vt=null,Tt=[];const Qt=bt||((St=M==null?void 0:M.settings)==null?void 0:St.mjOref)&&M.settings.mjOref.trim();if(Qt&&Qt.trim()){let on=Qt.trim();on.startsWith("http")?kt=on:on.startsWith("data:")?(ut.push(on),wt.set("oref",ut.length-1)):kt=on}const xr=st||((Pt=M==null?void 0:M.settings)==null?void 0:Pt.mjSref)&&M.settings.mjSref.trim();if(xr&&xr.trim()){let on=xr.trim();on.startsWith("http")?Vt=on:on.startsWith("data:")?(ut.push(on),wt.set("sref",ut.length-1)):Vt=on}if(T.length>0)for(const on of T)!(bt&&on===bt)&&!(st&&on===st)&&(on.startsWith("http")?Tt.push(on):on.startsWith("data:")?(ut.push(on),wt.set(`default_${Tt.length}`,ut.length-1),Tt.push(null)):Tt.push(on));if(ut.length>0)try{const on=await Fy(ut,te,Y);wt.has("oref")&&(kt=on[wt.get("oref")]),wt.has("sref")&&(Vt=on[wt.get("sref")]);for(let qr=0;qr<Tt.length;qr++)if(Tt[qr]===null){const Xi=`default_${qr}`;wt.has(Xi)&&(Tt[qr]=on[wt.get(Xi)])}}catch(on){ye(qr=>qr.map(Xi=>Xi.id===G?{...Xi,status:"failed",progress:0,errorMsg:`: ${on.message}`}:Xi));return}Tt=Tt.filter(on=>on!==null);let sn="";Tt.length>0&&(sn=Tt.join(" ")+" "),sn+=_e.trim(),!sn.includes("--v ")&&!sn.includes("--niji ")&&(sn=`${sn} ${Pe}`.trim()),ne&&ne!=="Auto"&&!sn.includes("--ar ")&&(sn=`${sn} --ar ${ne}`.trim()),kt&&!sn.includes("--oref ")&&(sn=`${sn} --oref ${kt}`.trim()),($t=M==null?void 0:M.settings)!=null&&$t.mjOw&&M.settings.mjOw>0&&!sn.includes("--ow ")&&(sn=`${sn} --ow ${Math.min(1e3,Math.max(1,M.settings.mjOw))}`.trim()),Vt&&!sn.includes("--sref ")&&(sn=`${sn} --sref ${Vt}`.trim()),be=`${te}/${le}/mj/submit/imagine`,et={prompt:sn,base64Array:[]};const rd=await fetch(be,{method:"POST",headers:{Authorization:`Bearer ${Y}`,"Content-Type":"application/json"},body:JSON.stringify(et)}),Lh=await rd.text();if(!rd.ok)throw new Error(Lh||`Midjourney API error: ${rd.status}`);let Ta=JSON.parse(Lh);if(Ta.code!==1&&Ta.code!==22)throw new Error(Ta.description||`Midjourney: code ${Ta.code}`);const sd=Ta.result;if(!sd)throw new Error("ID");ye(on=>on.map(qr=>qr.id===G?{...qr,remoteTaskId:sd,status:"generating",progress:5}:qr)),nc(sd,G,te,Y,le,Ce,He);return}else if(Mn)if(T.length>0){if(be=`${te}/v1/images/compositions`,!s||s.trim()==="")throw new Error("");let le=ne,Pe="2k";if(ne==="Auto"&&I)try{const ut=await Tr(I),wt=[{name:"1:1",value:1},{name:"4:3",value:4/3},{name:"3:4",value:3/4},{name:"16:9",value:16/9},{name:"9:16",value:9/16},{name:"3:2",value:3/2},{name:"2:3",value:2/3},{name:"21:9",value:21/9}],kt=ut.w/ut.h;let Vt=wt[0],Tt=Math.abs(kt-Vt.value);for(const Qt of wt){const xr=Math.abs(kt-Qt.value);xr<Tt&&(Tt=xr,Vt=Qt)}if(le=Vt.name,console.log(`[Jimeng] Auto ratio: ${ut.w}x${ut.h} -> ${kt.toFixed(2)} -> ${le}`),re==="Auto"){const Qt=Math.max(ut.w,ut.h);Pe=Qt<=1024?"1k":Qt<=2048?"2k":"4k"}}catch{le="1:1"}else le=ne==="Auto"?"1:1":ne;re!=="Auto"&&(Pe=re==="1K"?"1k":re==="2K"?"2k":"4k");const _e=T.map(async ut=>{if(ut.startsWith("blob:"))try{console.log("  Blob URL...");const wt=await fetch(ut);if(wt.ok){const kt=await wt.blob();return await new Promise(Vt=>{const Tt=new FileReader;Tt.onloadend=()=>{console.log(" Blob URL "),Vt(Tt.result)},Tt.readAsDataURL(kt)})}else throw new Error("Blob ")}catch(wt){throw console.error(" Blob URL :",wt),new Error("Blob URL")}if(ut.startsWith("http"))try{const wt=await fetch(ut);if(!wt.ok)throw new Error(`HTTP ${wt.status}: URL`);const kt=await wt.blob();return await new Promise(Vt=>{const Tt=new FileReader;Tt.onloadend=()=>Vt(Tt.result),Tt.readAsDataURL(kt)})}catch(wt){throw new Error(`: ${wt.message}`)}return ut}),bt=await Promise.all(_e);et={model:Bn(),prompt:s.trim(),images:bt,ratio:le,resolution:Pe,response_format:"url"}}else{be=`${te}/v1/images/generations`;const le=ne==="Auto"?"1:1":ne;let Pe="2k";if(re==="1K"?Pe="1k":re==="2K"?Pe="2k":re==="4K"&&(Pe="4k"),!s||s.trim()==="")throw new Error("");et={model:Bn(),prompt:s.trim(),ratio:le,resolution:Pe,response_format:"url"}}else et={model:(We==null?void 0:We.modelName)||P,prompt:s,n:1,size:ke,response_format:"url"};const fe=async(le,Pe)=>{const _e=xt?{Authorization:`Bearer ${le} `}:{Authorization:`Bearer ${le} `,"Content-Type":"application/json"};let bt;be.startsWith("http")?Pe!==te&&be.includes(te)?bt=be.replace(te,Pe):bt=be:bt=`${Pe.replace(/\/+$/,"")}${be.startsWith("/")?be:"/"+be} `;const st=xt?et:JSON.stringify(et);return console.log(`[API Request] Attempting with Key: ...${le.slice(-4)} | URL: ${bt} `),await fetch(bt,{method:"POST",headers:_e,body:st})},R=C&&C.includes(",")?C.split(",").map(le=>le.trim()).filter(le=>le):[C||Ve],ve=Z.includes(",")?Z.split(",").map(le=>le.trim()).filter(le=>le):[(Z||vr).replace(/\/+$/,"")],Le=le=>{for(let Pe=le.length-1;Pe>0;Pe--){const _e=Math.floor(Math.random()*(Pe+1));[le[Pe],le[_e]]=[le[_e],le[Pe]]}return le};R.length>1&&Le(R),ve.length>1&&Le(ve);let se,q,Ie,Me,$e=!1;const at=Zt.current||{},ct=[];for(const le of R){if(at[le]){console.log(` [Blacklist] Skipping Key "...${le.slice(-4)}" - Reason: ${at[le].reason}`);continue}for(const Pe of ve)ct.push({key:le,url:Pe})}if(ct.length===0&&R.length>0){console.warn("[Blacklist] All specified keys are blacklisted. Trying anyway with all available keys to avoid total failure.");for(const le of R)for(const Pe of ve)ct.push({key:le,url:Pe})}ct.length>1&&Le(ct);for(const le of ct)try{if(se=await fe(le.key,le.url),se.status===401||se.status===402||se.status===403){const _e=se.status===402?" (402)":se.status===401?" (401)":" (403)";console.warn(`[API Failover] Key ending in ...${le.key.slice(-4)} failed with status ${se.status}. Trying next...`),Et(le.key,_e),Me=new Error(`API returned ${se.status}: ${_e}`);continue}Ie=await se.text();try{q=JSON.parse(Ie)}catch{}Mn&&q&&console.log(`[DEBUG] Jimeng Response: code=${q.code} (type: ${typeof q.code}), message=${q.message}`);let Pe=q==null?void 0:q.code;if(q!=null&&q.message&&typeof q.message=="string"){const _e=q.message.match(/:\s*(\d+)/);_e&&(Pe=parseInt(_e[1],10),console.log(`[DEBUG] Extracted real error code from message: ${Pe}`))}if(Mn&&Pe==1006){const _e=" (1006)";console.warn(` [API Failover] Key ending in ...${le.key.slice(-4)} failed with Jimeng Code 1006. Adding to blacklist and trying next...`),Et(le.key,_e),Me=new Error(`Jimeng Error: ${q.message||"Not enough credits"}`);continue}$e=!0;break}catch(Pe){console.warn(`[API Failover] Network/Parse request failed for ...${le.key.slice(-4)}. Error: ${Pe.message}`),Me=Pe}if(!$e||!se&&!Ie){const le=Me?Me.message:"All API combinations failed.";throw new Error(le)}if(!q&&Ie)try{q=JSON.parse(Ie)}catch{throw new Error(`: ${Ie.substring(0,100)}`)}if(!se.ok){let le=(q==null?void 0:q.message)||((Ct=q==null?void 0:q.error)==null?void 0:Ct.message)||Ie;throw zt&&se.status===500&&(le=`GPT - 4o (500): ${((Jt=q==null?void 0:q.error)==null?void 0:Jt.message)||(q==null?void 0:q.error)||(q==null?void 0:q.message)||Ie} 


1.API Key 
2.(${(We==null?void 0:We.modelName)||"gpt-4o-image"}) 
3.
4.`,ye(_e=>_e.map(bt=>bt.id===G?{...bt,status:"failed",progress:0,errorMsg:le}:bt))),new Error(le)}if(Mn&&(q==null?void 0:q.code)!==void 0&&q.code!==0&&q.code!==1&&q.code!==200)throw new Error(q.message||`API: ${q.code} `);if(Ze&&(q!=null&&q.task_id||typeof(q==null?void 0:q.data)=="string"&&q.data.startsWith("task-"))){const le=q.task_id||q.data;ye(Pe=>Pe.map(_e=>_e.id===G?{..._e,status:"generating",progress:10,remoteTaskId:le}:_e)),tc(G,le,te,Y,Ce,He,gt,0,!0);return}let yt=[];if(q!=null&&q.data&&Array.isArray(q.data)?yt=q.data.map(le=>le.url||le.image_url||le).filter(le=>typeof le=="string"):(dn=q==null?void 0:q.data)!=null&&dn.data&&Array.isArray(q.data.data)&&(yt=q.data.data.map(le=>le.url).filter(Boolean)),yt.length===0)throw new Error("URL");const pe=yt[0],Je=Date.now()-Fe,nt=rr.current.get(G);nt&&nt.isImageMode&&(console.log("[] :",{taskId:G,nodeId:nt.nodeId,shotId:nt.shotId,imageCount:yt.length}),Kt(nt.nodeId,nt.shotId,{output_images:yt,output_url:yt[0],selectedImageIndex:0,outputEnabled:!0,status:"done"}),rr.current.delete(G)),ye(le=>le.map(_e=>{if(_e.id===G){const bt={..._e,status:"completed",progress:100,url:pe,width:Ce,height:He,durationMs:Je,mjImages:yt.length>1?yt:null,selectedMjImageIndex:0};return bt.sourceNodeId&&!nt&&setTimeout(()=>{Cs(G,pe,"image",bt.sourceNodeId,bt.mjImages)},0),bt}return _e}));return}if(c==="video"){const be=en.get(P);if(P.includes("veo")){const R=`${te} /v2/videos / generations`;let ve=[];if(T&&T.length>0)ve=await Promise.all(T.filter(Ie=>Ie&&typeof Ie=="string"&&Ie.trim().length>0).map(async Ie=>{const Me=Ie.trim();if(Me.startsWith("http://")||Me.startsWith("https://")){console.log("Veo: Processing HTTP URL for image");try{const $e=await Tr(Me);return $e.w>1920||$e.h>1920?(console.log(`Veo:  ${$e.w}x${$e.h} `),await qu(Me,1920,1920)):Me}catch($e){return console.warn("Veo: URL",$e),Me}}console.log("Veo: Processing image (data/blob/other format)");try{const $e=await Tr(Me);return $e.w>1920||$e.h>1920?(console.log(`Veo:  ${$e.w}x${$e.h} `),await qu(Me,1920,1920)):Me.startsWith("data:")?Me:Me.startsWith("blob:")?`data: image / png; base64, ${await Gn(Me)} `:Me.length>100&&!Me.includes("://")&&!Me.startsWith("data:")?`data: image / png; base64, ${Me} `:`data: image / png; base64, ${await Gn(Me)} `}catch($e){throw console.error("Veo: Failed to process image:",$e),new Error(`: ${Me.substring(0,50)}...`)}}));else if(I){const Ie=I.trim();try{const Me=await Tr(Ie);console.log(`Veo:  ${Me.w}x${Me.h} `),Me.w>1920||Me.h>1920?(console.log(`Veo:  ${Me.w}x${Me.h} ...`),ve=[await qu(Ie,1920,1920)]):Ie.startsWith("http://")||Ie.startsWith("https://")?(console.log("Veo: Using HTTP URL for source image ()"),ve=[Ie]):Ie.startsWith("data:")?(console.log("Veo: Using data URL for source image ()"),ve=[Ie]):Ie.startsWith("blob:")?(console.log("Veo: Converting blob URL to base64 for source image"),ve=[`data: image / png; base64, ${await Gn(Ie)} `]):Ie.length>100&&!Ie.includes("://")&&!Ie.startsWith("data:")?ve=[`data: image / png; base64, ${Ie} `]:ve=[`data: image / png; base64, ${await Gn(Ie)} `]}catch(Me){throw console.error("Veo: Failed to process source image:",Me),new Error(`: ${Me.message} `)}}if(ve.length===0&&((T==null?void 0:T.length)>0||I))throw console.error("Veo: images ",{connectedImages:T,sourceImage:I}),new Error("");const Le=ve.filter((Ie,Me)=>!Ie||typeof Ie!="string"?(console.warn(`Veo:  ${Me}: `),!1):Ie==="base64_data"||Ie.trim()==="base64_data"?(console.warn(`Veo:  ${Me}: base64_data`),!1):!0);if(Le.length===0&&((T==null?void 0:T.length)>0||I))throw console.error("Veo: ",{images:ve,connectedImages:T,sourceImage:I}),new Error("");let se=null;if(ne&&ne!=="Auto")if(ne==="16:9"||ne==="9:16")se=ne;else{const Ie=Ce/He;Math.abs(Ie-16/9)<Math.abs(Ie-9/16)?se="16:9":se="9:16"}const q={model:(be==null?void 0:be.modelName)||"veo3.1",prompt:s,enhance_prompt:!1,images:Le.length>0?Le:[],...se?{aspect_ratio:se}:{}};console.log("Veo: ",{endpoint:R,model:q.model,prompt:((fn=q.prompt)==null?void 0:fn.substring(0,50))+"...",imagesCount:q.images.length,firstImageType:q.images[0]?q.images[0].startsWith("http")?"HTTP URL":q.images[0].startsWith("data:")?"Data URL":"Unknown":"empty",firstImagePreview:q.images[0]?q.images[0].startsWith("http")?q.images[0].substring(0,80):q.images[0].substring(0,100):"empty",aspect_ratio:q.aspect_ratio,payloadSize:JSON.stringify(q).length});try{console.log("Veo: ",R);const Ie=await fetch(R,{method:"POST",headers:{Authorization:`Bearer ${Y} `,"Content-Type":"application/json"},body:JSON.stringify(q)});console.log("Veo: ",{status:Ie.status,statusText:Ie.statusText});const Me=await Ie.text();if(console.log("Veo: ",Me.substring(0,500)),!Ie.ok)throw console.error("Veo: ",{status:Ie.status,text:Me}),new Error(Me||`Veo error: ${Ie.status} `);const $e=JSON.parse(Me);console.log("Veo: ",$e);const at=((Jr=$e==null?void 0:$e.data)==null?void 0:Jr.id)||($e==null?void 0:$e.id)||($e==null?void 0:$e.task_id)||((gn=$e==null?void 0:$e.data)==null?void 0:gn.task_id);if(!at)throw console.error("Veo:  JobId",$e),new Error("Veo No JobId");console.log("Veo:  JobId",at),ye(ct=>ct.map(yt=>yt.id===G?{...yt,status:"generating",progress:10}:yt)),zi(at,G,te,Y,Ce,He);return}catch(Ie){throw console.error("Veo: ",Ie),ye(Me=>Me.map($e=>$e.id===G?{...$e,status:"failed",errorMsg:Ie.message||""}:$e)),Ie}}let et="",xt;const We={Authorization:`Bearer ${Y} `},mt=(()=>{if(qe==null)return 8;const R=String(qe).trim().replace(/[^\d]/g,""),ve=parseInt(R,10);return Number.isFinite(ve)&&ve>0?ve:8})();if(P.includes("grok")){const R=`${te} /v2/videos / generations`,ve=parseInt(qe,10),Le=ne&&ne!=="Auto"?ne:"3:2",se=re&&re!=="Auto"?re:"1080P";console.log(`[Grok] Starting generation(JSON Mode).Duration: ${ve||"N/A"} (type: ${typeof ve}), ratio: ${Le}, resolution: ${se} `);const q={model:(be==null?void 0:be.modelName)||"grok-video-3",prompt:s,ratio:Le,resolution:se};if(Number.isFinite(ve)&&ve>0&&(q.duration=ve),I)try{console.log("[Grok] Converting image to Base64...");let ct="";if(I.startsWith("data:"))ct=I;else{const yt=await Zs(I);ct=await new Promise((pe,Xe)=>{const Je=new FileReader;Je.onloadend=()=>pe(Je.result),Je.onerror=Xe,Je.readAsDataURL(yt)})}q.images=[ct]}catch(ct){console.error("Grok Image Conversion Failed:",ct),alert("");return}const Ie=await fetch(R,{method:"POST",headers:{Authorization:`Bearer ${Y} `,"Content-Type":"application/json"},body:JSON.stringify(q)}),Me=await Ie.text();if(!Ie.ok)throw console.error("[Grok API Error]",Me),new Error(Me||`Grok API error: ${Ie.status} `);let $e;try{$e=JSON.parse(Me)}catch{throw new Error("API  JSON ")}const at=((Ln=$e==null?void 0:$e.data)==null?void 0:Ln.id)||($e==null?void 0:$e.id)||($e==null?void 0:$e.task_id);if(!at)throw console.error("Grok No Task ID:",$e),new Error("API  Task ID");ye(ct=>ct.map(yt=>yt.id===G?{...yt,status:"generating",progress:10,remoteTaskId:at}:yt)),Gi(at,G,te,Y,Ce,He,P);return}if(I){const R=new FormData,ve=await Zs(I);if(P.includes("sora")){et=`${te} /v1/videos`;let Le=s.replace(/@\{([^\}]+)\}/g,(se,q)=>`@${q} `);console.log("[Sora 2] Sending prompt with character references:",Le),R.append("model",(be==null?void 0:be.modelName)||"sora-2"),R.append("prompt",Le),R.append("seconds",qe),R.append("size",ke),P==="sora-2"&&(p.isHD||(qt=M==null?void 0:M.settings)!=null&&qt.isHD)&&R.append("quality","hd"),R.append("input_reference",ve,"ref.png"),R.append("image",ve,"ref.png")}else P.includes("jimeng")?(et=`${te}/v1/videos/generations`,R.append("model",(be==null?void 0:be.modelName)||"jimeng-video-3.0"),R.append("prompt",s),R.append("duration",parseInt(qe)),R.append("ratio",ne),R.append("image",ve,"input.png"),re&&re!=="Auto"&&R.append("resolution",re)):P.includes("grok")?(et=`${te} /v1/videos`,R.append("model",(be==null?void 0:be.modelName)||"grok-video-3"),R.append("prompt",s),R.append("aspect_ratio",ne),R.append("duration",mt),R.append("image",ve,"input.png")):(et=`${te} /v1/videos`,R.append("model",be==null?void 0:be.modelName),R.append("prompt",s),R.append("image",ve,"input.png"),R.append("size",ke));xt=R}else if(We["Content-Type"]="application/json",P.includes("sora")){delete We["Content-Type"],et=`${te} /v1/videos`;const R=new FormData;let ve=s.replace(/@\{([^\}]+)\}/g,(Le,se)=>`@${se} `);console.log("[Sora 2] Sending prompt with character references:",ve),R.append("model",(be==null?void 0:be.modelName)||"sora-2"),R.append("prompt",ve),R.append("seconds",qe),R.append("size",ke),P==="sora-2"&&(p.isHD||(tn=M==null?void 0:M.settings)!=null&&tn.isHD)&&R.append("quality","hd"),xt=R}else P.includes("jimeng")?(et=`${te}/v1/videos/generations`,xt=JSON.stringify({model:(be==null?void 0:be.modelName)||"jimeng-video-3.0",prompt:s,duration:parseInt(qe),ratio:ne,resolution:re==="Auto"?void 0:re})):P.includes("grok")?(et=`${te} /v1/videos`,xt=JSON.stringify({model:(be==null?void 0:be.modelName)||"grok-video-3",prompt:s,aspect_ratio:ne,duration:mt})):(et=`${te} /minimax/v1 / video_generation`,xt=JSON.stringify({model:be==null?void 0:be.modelName,prompt:s,resolution:ke}));const zt=await fetch(et,{method:"POST",headers:xt instanceof FormData?{Authorization:We.Authorization}:We,body:xt}),Wt=await zt.text();if(!zt.ok)throw new Error(Wt||`Video API error: ${zt.status} `);const Ze=JSON.parse(Wt),jn=(Ze==null?void 0:Ze.code)||((nn=Ze==null?void 0:Ze.data)==null?void 0:nn.code),Mn=(Ze==null?void 0:Ze.message)||((Ft=Ze==null?void 0:Ze.data)==null?void 0:Ft.message)||"",Bn=jn===-2001&&Mn.includes("1006"),hs=jn===-2001&&Mn.includes("34010105");if(jn===-2008||Mn.includes("2060")){let R=" ";throw Mn.includes(": 30")&&(R+="\\n\\n \\n \\n \\n \\n "),Mn.includes("2060")&&(R+="\\n\\n: 2060 ()"),new Error(R)}if(Bn||hs){const R=Bn?" (1006)":" (34010105)";console.warn(` [Video API] Key ending in ...${Y.slice(-4)} failed: ${R}. Adding to blacklist.`),Et(Y,R);const ve=new Error(`RETRY_WITH_NEW_KEY: ${Mn}`);throw ve.shouldRetry=!0,ve}const kn=(Ze==null?void 0:Ze.video_url)||(Ze==null?void 0:Ze.url)||((pn=Ze==null?void 0:Ze.data)==null?void 0:pn.video_url)||((Tn=Ze==null?void 0:Ze.data)==null?void 0:Tn.url)||Array.isArray(Ze==null?void 0:Ze.data)&&((Xn=Ze.data[0])==null?void 0:Xn.url);if(kn){const R=Date.now(),ve=ja.get(G),Le=ve==null?void 0:ve.sourceNodeId,se=R-((ve==null?void 0:ve.startTime)||R);ye(q=>{const Ie=q.map($e=>$e.id===G?{...$e,status:"completed",progress:100,url:kn,width:Ce,height:He,durationMs:se}:$e),Me=rr.current.get(G);if(Me)console.log("[] :",{taskId:G,nodeId:Me.nodeId,shotId:Me.shotId,immediateUrl:kn}),Kt(Me.nodeId,Me.shotId,{video_url:kn,status:"done"}),rr.current.delete(G);else{const $e=Ie.find(at=>at.id===G);$e!=null&&$e.sourceNodeId?setTimeout(()=>{console.log("[Tapnow] : ",{taskId:G,immediateUrl:kn,sourceNodeId:$e.sourceNodeId}),Cs(G,kn,"video",$e.sourceNodeId)},0):console.warn("[Tapnow] :  sourceNodeId",{taskId:G,updatedItem:$e})}return Ie});return}const fe=((U=Ze==null?void 0:Ze.data)==null?void 0:U.id)||(Ze==null?void 0:Ze.id)||(Ze==null?void 0:Ze.task_id)||((Ne=Ze==null?void 0:Ze.data)==null?void 0:Ne.task_id)||(Ze==null?void 0:Ze.job_id)||((ht=Ze==null?void 0:Ze.data)==null?void 0:ht.job_id);if(!fe)throw new Error(`No Task/Job ID returned. Response: ${JSON.stringify(Ze).substring(0,200)}`);ye(R=>R.map(ve=>ve.id===G?{...ve,status:"generating",progress:10,remoteTaskId:fe}:ve)),P.includes("veo")?zi(fe,G,te,Y,Ce,He):Gi(fe,G,te,Y,Ce,He,P)}}catch(be){if(be.shouldRetry)return console.log("[Video API] Retrying with new key after blacklist..."),Ea(s,c,f,h,{...p,_isRetry:!0,_existingTaskId:G});console.error("[CONSOLE_ERROR]",be);const et=Date.now(),xt=Q.find(zt=>zt.id===G),We=xt!=null&&xt.startTime?et-xt.startTime:0;let mt=(be==null?void 0:be.message)||"";try{if(typeof mt=="string"&&mt.trim().startsWith("{")){const zt=JSON.parse(mt);(wn=zt==null?void 0:zt.error)!=null&&wn.message?mt=zt.error.message:zt!=null&&zt.error?mt=typeof zt.error=="string"?zt.error:JSON.stringify(zt.error):zt!=null&&zt.message&&(mt=zt.message)}(mt.includes("Cannot find module")||mt.includes("octetstream")||mt.includes("MODULE_NOT_FOUND"))&&(!mt.includes("API")&&!mt.includes("")?mt=` API

${mt.replace(/[:].*?[:]/g,"").trim()} 

 
1.jimeng - api.exe
2.Dockerdocker pull ghcr.io / iptag / jimeng - api: latest`:mt.includes("")||(mt=mt+`

 
1. jimeng-api.exe
2. Dockerdocker pull ghcr.io/iptag/jimeng-api:latest`))}catch{(mt.includes("Cannot find module")||mt.includes("octetstream")||mt.includes("MODULE_NOT_FOUND"))&&!mt.includes("API")&&!mt.includes("")&&(mt=` API

 
1.jimeng - api.exe
2.Dockerdocker pull ghcr.io / iptag / jimeng - api: latest`)}ye(zt=>zt.map(Wt=>Wt.id===G?{...Wt,status:"failed",errorMsg:mt,durationMs:We}:Wt))}},Wy=()=>{t(s=>s==="dark"?"light":"dark")},Vy=async()=>{const s=Xr.current,c=vi.current,f=_s.current,h=s.filter(p=>(c===p.id||f&&f.has(p.id))&&(p.type==="input-image"||p.type==="video-input"||p.type==="preview")&&p.content);if(h.length===0){alert("");return}for(const p of h)try{const m=p.content;if(!m||typeof m!="string"&&!m.startsWith("data:")){console.warn(` ${p.id} URL: `,m);continue}const N=await fetch(m);if(!N.ok)throw new Error(`HTTP ${N.status}: ${N.statusText} `);const T=await N.blob(),I=URL.createObjectURL(T),M=document.createElement("a");M.href=I;let $=".png";p.type==="preview"?p.previewType==="video"?$=".mp4":$=Zn(m)?".mp4":".png":p.type==="video-input"?$=".mp4":$=Zn(m)?".mp4":".png";const D=`${p.id}${$} `;M.download=D,document.body.appendChild(M),M.click(),document.body.removeChild(M),URL.revokeObjectURL(I),await new Promise(P=>setTimeout(P,100))}catch(m){console.error(` ${p.id} : `,m)}},Nh=()=>{const s=new Date;return new Date(s.getTime()+8*60*60*1e3).toISOString()},Sh=()=>{const s=new Date,c=new Date(s.getTime()+8*60*60*1e3),f=c.getUTCFullYear(),h=String(c.getUTCMonth()+1).padStart(2,"0"),p=String(c.getUTCDate()).padStart(2,"0"),m=String(c.getUTCHours()).padStart(2,"0"),N=String(c.getUTCMinutes()).padStart(2,"0"),T=String(c.getUTCSeconds()).padStart(2,"0");return`${f} -${h} -${p}T${m} -${N} -${T} `},Ky=async()=>{try{if(!window.showSaveFilePicker){if(!confirm(`

/>500MB Chrome  Edge 

`))return;const I=(Ce,He)=>He===void 0?null:He,M=JSON.parse(JSON.stringify(n,I)),$=async Ce=>{if(Ce==null)return Ce;if(typeof Ce=="string"&&Ce.startsWith("blob:"))try{const He=await Zs(Ce);return await wh(He)}catch(He){return console.error(" Blob URL :",He),Ce}if(Array.isArray(Ce))return await Promise.all(Ce.map(He=>$(He)));if(typeof Ce=="object"){const He={};for(const qe in Ce)Ce.hasOwnProperty(qe)&&(He[qe]=await $(Ce[qe]));return He}return Ce},D=await $(M),P=JSON.parse(JSON.stringify(In,I)),W=await $(P),C={version:"2.5.7",projectName:Yt,nodes:D,connections:i,view:v,history:Q,chatSessions:At,characterLibrary:W,timestamp:Nh()},Y=JSON.stringify(C,I,2),Z=new Blob([Y],{type:"application/json"}),te=URL.createObjectURL(Z),ne=document.createElement("a");ne.href=te;const re=Sh(),ke=`${Yt||""}_${re}.json`;ne.download=ke,document.body.appendChild(ne),ne.click(),document.body.removeChild(ne),URL.revokeObjectURL(te),alert("");return}const s=Sh(),f=await(await window.showSaveFilePicker({suggestedName:`${Yt||""}_${s}.json`,types:[{description:"JSON File",accept:{"application/json":[".json"]}}]})).createWritable(),h=(T,I)=>I===void 0?null:I,p=async T=>{const I={...T};if(I.content&&typeof I.content=="string"&&I.content.startsWith("blob:"))try{const M=await Gn(I.content),$=Zn(I.content)?"video/mp4":"image/png";I.content=`data:${$}; base64, ${M} `}catch(M){console.error(" content :",M)}if(I.maskContent&&typeof I.maskContent=="string"&&I.maskContent.startsWith("blob:"))try{const M=await Gn(I.maskContent);I.maskContent=`data: image / png; base64, ${M} `}catch(M){console.error(" maskContent :",M)}if(Array.isArray(I.selectedKeyframes))for(let M=0;M<I.selectedKeyframes.length;M++){const $=I.selectedKeyframes[M];if($&&$.url&&typeof $.url=="string"&&$.url.startsWith("blob:"))try{const D=await Gn($.url);$.url=`data: image / png; base64, ${D} `}catch(D){console.error(":",D)}}if(Array.isArray(I.frames))for(let M=0;M<I.frames.length;M++){const $=I.frames[M];if($&&$.url&&typeof $.url=="string"&&$.url.startsWith("blob:"))try{const D=await Gn($.url);$.url=`data: image / png; base64, ${D} `}catch(D){console.error(":",D)}}if(Array.isArray(I.previewMjImages))for(let M=0;M<I.previewMjImages.length;M++){const $=I.previewMjImages[M];if($&&typeof $=="string"&&$.startsWith("blob:"))try{const D=await Gn($);I.previewMjImages[M]=`data:image/png;base64,${D}`}catch(D){console.error(" previewMjImages :",D)}}return I},m=async T=>{const I={...T};if(I.url&&typeof I.url=="string"&&I.url.startsWith("blob:"))try{const M=await Gn(I.url),$=I.type==="video"?"video/mp4":"image/png";I.url=`data:${$}; base64, ${M} `}catch(M){console.error(" url :",M)}if(I.mjOriginalUrl&&typeof I.mjOriginalUrl=="string"&&I.mjOriginalUrl.startsWith("blob:"))try{const M=await Gn(I.mjOriginalUrl);I.mjOriginalUrl=`data: image / png; base64, ${M} `}catch(M){console.error(" mjOriginalUrl :",M)}if(Array.isArray(I.mjImages))for(let M=0;M<I.mjImages.length;M++){const $=I.mjImages[M];if($&&typeof $=="string"&&$.startsWith("blob:"))try{const D=await Gn($);I.mjImages[M]=`data: image / png; base64, ${D} `}catch(D){console.error(" mjImages :",D)}}return I},N=async T=>{const I={...T};if(I.avatar&&typeof I.avatar=="string"&&I.avatar.startsWith("blob:"))try{const M=await Gn(I.avatar);I.avatar=`data: image / png; base64, ${M} `}catch(M){console.error(" avatar :",M)}if(I.profile_picture_url&&typeof I.profile_picture_url=="string"&&I.profile_picture_url.startsWith("blob:"))try{const M=await Gn(I.profile_picture_url);I.profile_picture_url=`data: image / png; base64, ${M} `}catch(M){console.error(" profile_picture_url :",M)}return I};await f.write(`{
    
  "version": "2.5.7", 
  "projectName": ${JSON.stringify(Yt||"")}, 
  "nodes": [
`);for(let T=0;T<n.length;T++){const I=n[T],M=await p(I),$=JSON.stringify(M,h,2),D=T===0?$.split(`
`).join(`
    `):"    "+$.split(`
`).join(`
    `);await f.write(D),T<n.length-1?await f.write(`,
`):await f.write(`
`)}await f.write(`  ], 
  "connections": ${JSON.stringify(i,h,2)}, 
  "view": ${JSON.stringify(v,h,2)}, 
  "history": [
`);for(let T=0;T<Q.length;T++){const I=Q[T],M=await m(I),$=JSON.stringify(M,h,2),D=T===0?$.split(`
`).join(`
    `):"    "+$.split(`
`).join(`
    `);await f.write(D),T<Q.length-1?await f.write(`,
`):await f.write(`
`)}await f.write(`  ], 
  "chatSessions": ${JSON.stringify(At,h,2)}, 
  "characterLibrary": [
`);for(let T=0;T<In.length;T++){const I=In[T],M=await N(I),$=JSON.stringify(M,h,2),D=T===0?$.split(`
`).join(`
    `):"    "+$.split(`
`).join(`
    `);await f.write(D),T<In.length-1?await f.write(`,
`):await f.write(`
`)}await f.write(`  ], 
  "timestamp": ${JSON.stringify(Nh())} 

} `),await f.close(),alert("")}catch(s){if(console.error(":",s),s.name==="AbortError")return;alert(": "+(s.message||""))}},Yy=()=>{const s=document.createElement("input");s.type="file",s.accept=".json",s.onchange=async c=>{const f=c.target.files[0];if(!f)return;F({visible:!0,progress:0,status:"INITIALIZING...",type:"import"});const h={nodes:[],history:[],connections:[],chatSessions:[],characterLibrary:[],projectName:"",view:null};let p=null,m="",N="",T=0,I=!1,M=0;const $=f.size,D=async P=>{const W=[P];for(;W.length>0;){const C=W.pop();if(!(!C||typeof C!="object"))for(const Y in C){const Z=C[Y];if(typeof Z=="string"&&Z.startsWith("data:image/"))try{const ne=await(await fetch(Z)).blob();C[Y]=URL.createObjectURL(ne)}catch{}else typeof Z=="object"&&Z!==null&&W.push(Z)}}return P};try{const W=f.stream().pipeThrough(new TextDecoderStream).getReader();for(;;){const{value:C,done:Y}=await W.read();if(Y)break;if(M+=C.length,Math.random()>.95){const Z=Math.min(99,M/$*100);F(te=>({...te,progress:Z,status:`PROCESSING ${(M/1024/1024).toFixed(0)} MB`}))}for(m+=C;;){const Z=m.indexOf(`
`);if(Z===-1)break;const te=m.substring(0,Z);m=m.substring(Z+1);const ne=te.trim();if(ne){if(ne.includes('"nodes": [')){p="nodes";continue}if(ne.includes('"history": [')){p="history";continue}if(ne.includes('"connections": [')){p="connections";continue}if(ne.includes('"chatSessions": [')){p="chatSessions";continue}if(ne.includes('"characterLibrary": [')){p="characterLibrary";continue}if((ne==="],"||ne==="]")&&T===0){p=null,N="",I=!1;continue}if(!p){if(ne.startsWith('"projectName":'))try{const re=ne.match(/"projectName":\s*(.+)/);re&&(h.projectName=JSON.parse(re[1].replace(/,$/,"")))}catch{}if(ne.startsWith('"view":'))try{const re=ne.match(/"view":\s*(.+)/);re&&re[1].endsWith("}")&&(h.view=JSON.parse(re[1].replace(/,$/,"")))}catch{}continue}if(p){for(let re of te)re==="{"&&(T++,I=!0),re==="}"&&T--;if(N+=te+`
`,I&&T===0){let re=N.trim();re.endsWith(",")&&(re=re.slice(0,-1));try{const ke=JSON.parse(re);(p==="nodes"||p==="history"||p==="characterLibrary")&&await D(ke),p==="nodes"&&ke.id?(ke.settings||(ke.settings={}),h.nodes.push(ke)):p==="history"?h.history.push(ke):p==="connections"?h.connections.push(ke):p==="chatSessions"?h.chatSessions.push(ke):p==="characterLibrary"&&h.characterLibrary.push(ke)}catch{}N="",I=!1}}}}}F(C=>({...C,progress:100,status:"FINALIZING..."})),setTimeout(()=>{Qn(h.projectName||""),h.view&&ge(h.view),h.connections.length>0&&a(h.connections),h.chatSessions.length>0&&er(h.chatSessions),h.characterLibrary.length>0&&Fu(h.characterLibrary),h.nodes.length>0&&r(h.nodes),h.history.length>0&&ye(h.history),F(C=>({...C,visible:!1})),alert(`
${h.nodes.length} `)},200)}catch(P){console.error(":",P),F(W=>({...W,visible:!1})),alert(`: ${P.message} `)}},s.click()},ps=(s,c,f,h,p=void 0,m=void 0,N=void 0,T=void 0)=>{me();const I=s==="gen-video"?{w:380,h:420}:s==="gen-image"?{w:440,h:340}:s==="video-input"?{w:580,h:460}:s==="video-analyze"?{w:480,h:500}:s==="storyboard-node"?{w:720,h:500}:s==="image-compare"?{w:400,h:300}:s==="preview"?{w:320,h:260}:s==="text-node"?{w:280,h:200}:{w:260,h:260},M={id:`node - ${Date.now()} `,type:s,x:c-I.w/2,y:f-I.h/2,width:I.w,height:I.h,content:p,...m?{dimensions:m}:{},settings:s==="gen-image"?{model:vy,ratio:oh,resolution:wy,prompt:""}:s==="gen-video"?{model:sh,duration:"5s",ratio:oh,resolution:zy,videoPrompt:""}:s==="video-analyze"?{model:Sy,segmentDuration:parseInt(_y),analysisMode:"manual",voiceoverResults:[],analysisResults:[]}:s==="storyboard-node"?{projectTitle:"",shots:[]}:s==="text-node"?{text:p||""}:{}};r($=>[...$,M]),h&&a($=>[...$,{id:`conn - ${Date.now()} `,from:h,to:M.id}]),N&&a($=>T&&T!=="default"?[...$.filter(P=>!(P.to===N&&(P.inputType||"default")===T)),{id:`conn - ${Date.now()} `,from:M.id,to:N,inputType:T!=="default"?T:void 0}]:[...$,{id:`conn - ${Date.now()} `,from:M.id,to:N}]),xo($=>({...$,visible:!1})),Ae(null),Ot(null),Gt(null)},Gy=H.useCallback(s=>{const c=[];for(const f of i)if(f.from===s){const h=Ut.get(f.to);h&&(h.type==="gen-image"||h.type==="gen-video")&&c.push(h)}return c},[i,Ut]),Eo=s=>s?s==="sora-2-pro"||s.includes("sora-2")||s==="sora-2"?"15s":s.includes("veo")||s==="google-veo3"||s.includes("grok")||s==="grok-3"?"8s":"5s":"5s",ed=s=>s?s==="sora-2-pro"?["15s","25s"]:s.includes("sora-2")||s==="sora-2"?["5s","10s","15s"]:s.includes("veo")||s==="google-veo3"?["8s"]:s.includes("grok")||s==="grok-3"?["8s","5s"]:s.includes("jimeng")?["5s","10s"]:["5s","10s"]:["5s","10s"],Xy=s=>{var T,I,M,$,D,P;const c=Ut.get(s);if(!c||c.type!=="storyboard-node")return;const f=((T=c.settings)==null?void 0:T.mode)||"video";let h,p,m;f==="image"?(h=localStorage.getItem("tapnow_last_image_model")||((I=ae.find(W=>W.type==="Image"))==null?void 0:I.id)||"",p="1:1",m=void 0):(h=sh||localStorage.getItem("tapnow_last_video_model")||((M=ae.find(W=>W.type==="Video"))==null?void 0:M.id)||"",p="16:9",m=Eo(h));const N={id:`shot-${Date.now()}`,scene_index:(((D=($=c.settings)==null?void 0:$.shots)==null?void 0:D.length)||0)+1,time_range:"",image_url:"",description:"",prompt:"",camera:"",tags:[],status:"draft",model:h,ratio:p,duration:m,outputEnabled:!0,selectedImageIndex:0};Nt(s,{shots:[...((P=c.settings)==null?void 0:P.shots)||[],N]})},Zy=(s,c)=>{var p;const f=Ut.get(s);if(!f||f.type!=="storyboard-node")return;const h=(((p=f.settings)==null?void 0:p.shots)||[]).filter(m=>m.id!==c);h.forEach((m,N)=>{m.scene_index=N+1}),Nt(s,{shots:h})},Kt=(s,c,f)=>{var m;const h=Ut.get(s);if(!h||h.type!=="storyboard-node")return;const p=(((m=h.settings)==null?void 0:m.shots)||[]).map(N=>N.id===c?{...N,...f}:N);if(Nt(s,{shots:p}),f.video_url||f.output_url||f.image_url||f.lastFrame){const N=f.video_url||f.output_url||f.image_url||f.lastFrame,T=f.video_url?"video":"image",I=p.find($=>$.id===c),M=f.image_filename||(I?I.image_filename:"");console.log(`[] : nodeId=${s}, type=${T}, filename=${M}`),setTimeout(()=>{Cs(`temp-${Date.now()}`,N,T,s,null,M)},50)}},Jy=(s,c)=>{const f=Ut.get(s);if(!f||!c||c.length===0){console.warn("[] ");return}const h=c.map((I,M)=>{var Z,te,ne,re,ke,Ce,He,qe,G,de;const $=((Z=I.keyframes)==null?void 0:Z.find(Fe=>Fe.type==="current"))||((te=I.keyframes)==null?void 0:te[0]),D=($==null?void 0:$.mj_prompt)||"",P=($==null?void 0:$.jimeng_prompt)||"",W=($==null?void 0:$.description)||((re=(ne=I.keyframes)==null?void 0:ne[0])==null?void 0:re.description)||"",C=[];(Ce=(ke=I.global_tags)==null?void 0:ke.style)!=null&&Ce[0]&&C.push(I.global_tags.style[0]),(qe=(He=I.global_tags)==null?void 0:He.camera)!=null&&qe[0]&&C.push(I.global_tags.camera[0]),$!=null&&$.description&&["","","","","","","","Dolly","Pan","Tilt","Zoom"].forEach(gt=>{W.includes(gt)&&C.push(gt)});const Y=((de=(G=I.global_tags)==null?void 0:G.camera)==null?void 0:de[0])||C.find(Fe=>["","","","","","Dolly","Pan","Tilt","Zoom"].some(gt=>Fe.includes(gt)))||"";return{id:`shot - ${Date.now()} -${M} `,scene_index:M+1,time_range:I.time_range||"",image_url:"",description:W,prompt:D||P,camera:Y,tags:C,status:"draft"}}),p=f.x+f.width+100,m=f.y,N=`node - storyboard - ${Date.now()} `,T={id:N,type:"storyboard-node",x:p,y:m,width:600,height:500,settings:{projectTitle:"AI ",shots:h}};r(I=>[...I,T]),a(I=>[...I,{id:`conn - ${Date.now()} `,from:s,to:N}]),console.log("[] ",h.length,"")},rr=H.useRef(new Map);H.useRef(null);const Ch=async(s,c,f,h=null,p=null)=>{var m;try{const N=ae.find(C=>C.type==="Video"&&(C.id==="sora-2"||C.id==="sora-2-pro"));if(!N){alert(" Sora 2  Sora 2  Sora 2 Pro"),jo(!1);return}const I=wi(N.id).key;if(!I){alert(" API Key"),jo(!1);return}if(f-c<1||f-c>3){alert(" 1-3 "),jo(!1);return}const M=`${c},${f} `;let $;p&&p.trim()?$=p.trim():$=`${(N.url||vr).replace(/\/+$/,"")} /sora/v1 / characters`;const D=h?{from_task:h,timestamps:M}:{url:s,timestamps:M};console.log("[Create Character] Request Details:",{endpoint:$,apiKey:I?`${I.substring(0,8)}...${I.substring(I.length-4)} `:"EMPTY",payload:D,fromTaskId:h,videoUrl:h?"N/A (using from_task)":s,customEndpoint:p||"N/A (using default)"});const P=await fetch($,{method:"POST",headers:{Authorization:`Bearer ${I} `,"Content-Type":"application/json"},body:JSON.stringify(D)});if(!P.ok){const C=await P.text();console.error("[Create Character] API Error:",{status:P.status,statusText:P.statusText,errorText:C,endpoint:$});let Y=null;try{Y=JSON.parse(C)}catch{}throw P.status===500||Y&&(Y.code==="get_origin_task_failed"||(m=Y.message)!=null&&m.includes("get_origin_task_failed"))?new Error("TASK_NOT_FOUND"):new Error(`API(${P.status}): ${C||P.statusText} `)}const W=await P.json();if(console.log("[Create Character] Success:",W),W.id&&W.username){const C={id:W.id,username:W.username,profile_picture_url:W.profile_picture_url||"",permalink:W.permalink||""},Y=[...In,C];Fu(Y),alert(` "${W.username}" `),ha(!1),Ul("url"),Fl(""),Bl(""),Zp(1),Jp(3),ma("")}else throw new Error(" id  username")}catch(N){console.error("[Create Character] Failed:",N);let T=N.message;if(T==="TASK_NOT_FOUND"){alert(`

" URL"`);return}(T.includes("Failed to fetch")||N.name==="TypeError"||N.message.includes("NetworkError"))&&(T=`

1. API 
   -  API  "/sora" 
   -  Sora 

2.  (CORS)
   -  Allow CORS 

3. 
   - `),alert(`: ${T} `)}finally{jo(!1)}},Eh=(s,c)=>{var D,P;let f=c.prompt||"";if(!f&&c.description&&(f=c.description),c.tags&&c.tags.length>0){const W=c.tags.join(", ");f+=`, ${W} `}if(c.camera&&(f+=`, ${c.camera} camera movement`),!f){alert("");return}const h=c.model||((D=ae.find(W=>W.type==="Video"&&W.id==="sora-2"))==null?void 0:D.id)||((P=ae.find(W=>W.type==="Video"))==null?void 0:P.id)||"",p=en.get(h);if(!p||p.type!=="Video"){alert("");return}const m=[];c.image_url&&m.push(c.image_url),c.lastFrame&&m.push(c.lastFrame),Kt(s,c.id,{status:"generating"});let N=c.duration||Eo(h);const T=ed(h);T.includes(N)||(console.warn(`[V3.5.5] Duration "${N}" not valid for model "${h}", using "${T[0]}"`),N=T[0]);const I=String(N).endsWith("s")?N:`${N}s`,M={model:h,ratio:c.ratio||"16:9",duration:I,resolution:c.resolution||"720p"};console.log("[V3.5.5 Debug] generateSingleShot overrideOptions:",M);const $=`storyboard-${s}-shot-${c.id}`;Ea(f,"video",m,$,M)},Ih=(s,c)=>{var I;let f=c.prompt||"";if(!f&&c.description&&(f=c.description),c.tags&&c.tags.length>0){const M=c.tags.join(", ");f+=`, ${M} `}if(!f){alert("");return}const h=c.model||localStorage.getItem("tapnow_last_image_model")||((I=ae.find(M=>M.type==="Image"))==null?void 0:I.id)||"",p=en.get(h);if(!p||p.type!=="Image"){alert("");return}const m=[];c.image_url&&m.push(c.image_url),c.referenceImages&&c.referenceImages.length>0&&m.push(...c.referenceImages),Kt(s,c.id,{status:"generating"});const N={model:h,ratio:c.ratio||"1:1",resolution:c.resolution||"Auto"};console.log("[V3.6.1] generateSingleImage overrideOptions:",N);const T=`storyboard-img-${s}-shot-${c.id}`;Ea(f,"image",m,T,N)},qy=async s=>{var I,M,$,D,P,W;const c=Ut.get(s);if(!c)return;let f=((I=c.settings)==null?void 0:I.content)||"";if(!f){const C=i.find(Y=>Y.to===s);if(C){const Y=Ut.get(C.from);Y&&(Y.type==="novel-input"||Y.type==="text-node")&&(f=((M=Y.settings)==null?void 0:M.content)||Y.content||"")}}if(!f||f.trim().length===0){alert("");return}const h=($=c.settings)==null?void 0:$.model;if(!h){alert("");return}const p=en.get(h);if(!p){alert("");return}const N=wi(h).key;if(!N){alert(" API Key"),yi(!0);return}Nt(s,{isAnalyzing:!0});const T=`


${f.substring(0,15e3)} ... ()

 JSON 
{
    "characters": [
        { "name": "", "description": "", "appearance": "" }
    ],
    "scenes": [
        { "location": "", "description": "", "mood": "" }
    ]
}
 JSONmarkdown`;try{const C=((p==null?void 0:p.url)||vr).replace(/\/+$/,""),Y=await fetch(`${C}/v1/chat/completions`,{method:"POST",headers:{Authorization:`Bearer ${N}`,"Content-Type":"application/json"},body:JSON.stringify({model:p.modelName||"gemini-1.5-pro-latest",messages:[{role:"system",content:"You are a helpful assistant that analyzes novels."},{role:"user",content:T}],temperature:.7})});if(!Y.ok)throw new Error(`API Error: ${Y.status}`);const Z=await Y.json(),te=((W=(P=(D=Z.choices)==null?void 0:D[0])==null?void 0:P.message)==null?void 0:W.content)||Z.content||"";let ne=null;try{const Ce=te.replace(/```json/g,"").replace(/```/g,"").trim();ne=JSON.parse(Ce)}catch(Ce){console.warn("JSON Parse Error, using raw text",Ce)}const re=c.x+c.width+50;let ke=c.y;if(ne){if(ne.characters&&ne.characters.length>0){const Ce=ne.characters.map(He=>`**${He.name}**
${He.description}
Appearance: ${He.appearance}`).join(`

`);ps("text-node",re,ke,null,Ce),ke+=200}if(ne.scenes&&ne.scenes.length>0){const Ce=ne.scenes.map(He=>`**${He.location}**
${He.description}
Mood: ${He.mood}`).join(`

`);ps("text-node",re,ke,null,Ce)}}else ps("text-node",re,ke,null,te)}catch(C){console.error("Extraction Failed",C),alert(`: ${C.message}`)}finally{Nt(s,{isAnalyzing:!1})}},Th=(s,c)=>{var h;const f=(h=c.target.files)==null?void 0:h[0];if(f){const p=new FileReader;p.onload=async m=>{const N=m.target.result;let T={w:0,h:0};try{T=await Tr(N)}catch{}me(),r(I=>I.map(M=>M.id===s?{...M,content:N,dimensions:T}:M))},p.readAsDataURL(f)}},Qy=(s,c)=>{if(!s||s.length===0)return[];const f=[...s].sort((N,T)=>N.time-T.time),h=[];let p=[],m=f[0].time;return f.forEach((N,T)=>{N.time-m>=c&&p.length>0?(h.push([...p]),p=[N],m=N.time):p.push(N)}),p.length>0&&h.push(p),h},e1=async s=>{var W,C,Y,Z,te,ne,re,ke,Ce,He,qe,G,de,Fe,gt;const c=Ut.get(s);if(!c||c.type!=="video-analyze")return;const f=Sa(s);if(!f){alert("");return}const h=f.selectedKeyframes||[];if(h.length===0){alert("");return}const p=((W=c.settings)==null?void 0:W.model)||"gemini-3-pro",{key:m,url:N}=wi(p),T=ae.find(tt=>tt.id===p);if(!m){alert(" API  Key"),yi(!0);return}const I=((C=c.settings)==null?void 0:C.segmentDuration)||3,M=Qy(h,I);if(M.length===0){alert("");return}r(tt=>tt.map(pt=>pt.id===s?{...pt,isGenerating:!0,analysisResults:[]}:pt));const $=[],D=f.videoFileName||"video.mp4";(Y=f.videoMeta)!=null&&Y.duration;const P=((Z=c.settings)==null?void 0:Z.analysisMode)||"manual";try{for(let tt=0;tt<M.length;tt++){const pt=M[tt],Ke=`${pt[0].time.toFixed(1)}s-${pt[pt.length-1].time.toFixed(1)}s`,ot=`AI

 JSON 
{
  "video_id": "${D}",
  "scene_index": ${tt+1},
  "time_range": "${Ke}",
  "keyframes": [
    {
      "type": "prev",
      "time": 5.2,
      "description": "",
      "mj_prompt": "Midjourney ",
      "jimeng_prompt": ""
    },
    {
      "type": "current",
      "time": 6.8,
      "description": "",
      "mj_prompt": "Midjourney ",
      "jimeng_prompt": ""
    },
    {
      "type": "next",
      "time": 8.7,
      "description": "",
      "mj_prompt": "Midjourney ",
      "jimeng_prompt": ""
    }
  ],
  "global_tags": {
    "style": ["", ""],
    "camera": ["", ""],
    "color": [""]
  }
}


1.  prev/current/next 
2. mj_prompt  Midjourney
3. jimeng_prompt AI
4. global_tags `,_t=[{type:"text",text:` ${tt+1}${Ke}`}],dt=15,Mt=pt.length>dt?pt.slice(0,dt):pt;Mt.forEach((gn,Ln)=>{_t.push({type:"image_url",image_url:{url:gn.url}}),Ln<Mt.length-1&&_t.push({type:"text",text:` ${Ln+1}${gn.time.toFixed(2)}s`})}),pt.length>dt&&_t.push({type:"text",text:` ${pt.length} API ${dt} `});const Rt=[{role:"system",content:ot},{role:"user",content:_t}],St=new AbortController,Pt=setTimeout(()=>St.abort(),6e4);let $t;try{$t=await fetch(`${N}/v1/chat/completions`,{method:"POST",headers:{Authorization:`Bearer ${m}`,"Content-Type":"application/json"},body:JSON.stringify({model:(T==null?void 0:T.modelName)||"gemini-3-pro-preview",messages:Rt,stream:!1}),signal:St.signal})}catch(gn){throw clearTimeout(Pt),gn.name==="AbortError"?new Error(""):gn.message&&gn.message.includes("Failed to fetch")?new Error(` API  (${N})
1. API 
2. 
3. API `):new Error(`: ${gn.message}`)}finally{clearTimeout(Pt)}if(!$t.ok){let gn="";try{gn=await $t.text()}catch{gn=`HTTP ${$t.status}: ${$t.statusText}`}throw new Error(gn||`API Error: ${$t.status}`)}const Ct=await $t.json();console.log("[] API :",{hasData:!!Ct,hasChoices:!!Ct.choices,choicesLength:(te=Ct.choices)==null?void 0:te.length,dataKeys:Object.keys(Ct||{}),model:(T==null?void 0:T.modelName)||(T==null?void 0:T.id)});let Jt=null;if(Ct.choices&&Ct.choices.length>0?Jt=(re=(ne=Ct.choices[0])==null?void 0:ne.message)==null?void 0:re.content:(ke=Ct.data)!=null&&ke.choices&&Ct.data.choices.length>0?Jt=(He=(Ce=Ct.data.choices[0])==null?void 0:Ce.message)==null?void 0:He.content:Ct.content?Jt=Ct.content:(qe=Ct.data)!=null&&qe.content?Jt=Ct.data.content:Ct.text?Jt=Ct.text:(G=Ct.data)!=null&&G.text?Jt=Ct.data.text:Ct.message?Jt=typeof Ct.message=="string"?Ct.message:Ct.message.content:(de=Ct.data)!=null&&de.message?Jt=typeof Ct.data.message=="string"?Ct.data.message:Ct.data.message.content:Ct.result?Jt=typeof Ct.result=="string"?Ct.result:Ct.result.content:(Fe=Ct.data)!=null&&Fe.result&&(Jt=typeof Ct.data.result=="string"?Ct.data.result:Ct.data.result.content),!Jt||Jt.trim()===""||Jt==="{}")throw console.error("[] API :",Ct),new Error(`API : ${JSON.stringify(Ct).substring(0,200)}`);console.log("[] :",Jt.length,"100:",Jt.substring(0,100));let dn=Jt.trim();dn.startsWith("```")&&(dn=dn.replace(/^```(?:json)?\n?/,"").replace(/\n?```$/,""));let fn;try{fn=JSON.parse(dn),console.log("[] JSON :",fn.scene_index||tt+1)}catch(gn){console.error("[]  JSON :",gn,"500:",dn.substring(0,500));try{dn=dn.replace(/\/\*[\s\S]*?\*\//g,"").replace(/\/\/.*/g,""),dn=dn.replace(/,(\s*[}\]])/g,"$1"),fn=JSON.parse(dn),console.log("[] JSON ")}catch(Ln){console.error("[] JSON:",Ln,":",dn),fn={video_id:D,scene_index:tt+1,time_range:Ke,keyframes:pt.map((qt,tn)=>({type:tn===0?"prev":tn===1?"current":"next",time:qt.time,description:` ${qt.time.toFixed(1)}s`,mj_prompt:"A detailed scene from the video",jimeng_prompt:""})),global_tags:{style:[],camera:[],color:[]}},console.warn("[] :",dn.substring(0,200))}}if($.push(fn),console.log("[] :",$.length),r(gn=>gn.map(Ln=>{if(Ln.id===s){const tn=[...Ln.analysisResults||[],fn];return console.log("[] :",tn.length),{...Ln,analysisResults:tn}}return Ln})),!(P==="manual")){const Ln={id:`analyze-${s}-${tt}-${Date.now()}`,type:"analyze",prompt:` -  ${tt+1}`,url:((gt=pt[0])==null?void 0:gt.url)||"",status:"completed",progress:100,modelName:(T==null?void 0:T.provider)||"Gemini 3 Pro",time:new Date().toLocaleString("zh-CN"),sourceNodeId:s,analysisResult:fn,videoFileName:D,sceneIndex:tt+1,timeRange:Ke};ye(qt=>[Ln,...qt])}}console.log("[] :",$.length),r(tt=>tt.map(pt=>{if(pt.id===s){const Ke=$.length>0?$:pt.analysisResults||[];return console.log("[] :",Ke.length),{...pt,isGenerating:!1,analysisResults:Ke}}return pt}))}catch(tt){console.error(":",tt);const pt=tt.message||"";r(Ke=>Ke.map(ot=>ot.id===s?{...ot,isGenerating:!1,errorMsg:pt}:ot))}},t1=async s=>{var T,I,M,$,D,P,W,C,Y,Z,te;const c=Ut.get(s);if(!c||c.type!=="video-analyze")return;const f=Sa(s);if(!f||!f.content){alert("");return}let h=f.content;if(h.startsWith("blob:"))try{console.log("Converting Blob URL to Base64 for API...");const ne=await fetch(h).then(re=>re.blob());h=await new Promise((re,ke)=>{const Ce=new FileReader;Ce.onerror=()=>ke(new Error("FileReader failed")),Ce.onloadend=()=>re(Ce.result),Ce.readAsDataURL(ne)})}catch(ne){console.error("Blob conversion failed",ne),alert(" AI");return}let p=ae.find(ne=>ne.id==="gemini-3-pro"&&ne.type==="Chat");p||(p=ae.find(ne=>{var ke;return(((ke=ne.id)==null?void 0:ke.toLowerCase())||"").includes("gemini")&&ne.type==="Chat"})),p||(p=ae.find(ne=>ne.type==="Chat"));const{key:m,url:N}=wi((p==null?void 0:p.id)||"gemini-3-pro");if(!m){alert(" API  Key"),yi(!0);return}r(ne=>ne.map(re=>re.id===s?{...re,isGenerating:!0,settings:{...re.settings,voiceoverResults:[],analysisResults:[]}}:re));try{const ke=[{role:"system",content:`******AI**

1. ****

2. ****Voiceover

 **JSON **Markdown

{
  "voiceover_script": [
    { "time_range": "0s-3s", "text": "..." }
  ],
  "scenes": [
    {
      "scene_id": 1,
      "time_range": "0s-2.5s",
      "visual_analysis": {
        "camera_movement": "(Dolly Zoom Out) (Orbit)",
        "subject_dynamics": "",
        "atmosphere": ""
      },
      "prompts": {
        "jimeng_prompt": "()+++()...",
        "mj_prompt": "Midjourney Prompt: English description, include camera directives like 'dynamic angle', 'fast zoom out', 'cinematic lighting'..."
      }
    }
  ]
}

****
- ****
- ****""
- ****`},{role:"user",content:[{type:"text",text:"JSON"},{type:"image_url",image_url:{url:h}}]}],Ce=new AbortController,He=setTimeout(()=>Ce.abort(),12e4);let qe;try{qe=await fetch(`${N}/v1/chat/completions`,{method:"POST",headers:{Authorization:`Bearer ${m}`,"Content-Type":"application/json"},body:JSON.stringify({model:(p==null?void 0:p.modelName)||"gemini-3-pro-preview",messages:ke,stream:!1}),signal:Ce.signal})}catch(Ke){throw clearTimeout(He),Ke.name==="AbortError"?new Error("120"):Ke.message&&Ke.message.includes("Failed to fetch")?new Error(` API  (${N})
1. API 
2. 
3. API 
4.  API Key`):new Error(`: ${Ke.message}`)}finally{clearTimeout(He)}if(!qe.ok){let Ke="";try{Ke=await qe.text()}catch{Ke=`HTTP ${qe.status}: ${qe.statusText}`}throw new Error(Ke||`API Error: ${qe.status}`)}const G=await qe.json();console.log("[AI] API :",{hasData:!!G,hasChoices:!!G.choices,choicesLength:(T=G.choices)==null?void 0:T.length,dataKeys:Object.keys(G||{}),model:(p==null?void 0:p.modelName)||(p==null?void 0:p.id)});let de=null;if(G.choices&&G.choices.length>0?de=(M=(I=G.choices[0])==null?void 0:I.message)==null?void 0:M.content:($=G.data)!=null&&$.choices&&G.data.choices.length>0?de=(P=(D=G.data.choices[0])==null?void 0:D.message)==null?void 0:P.content:G.content?de=G.content:(W=G.data)!=null&&W.content?de=G.data.content:G.text?de=G.text:(C=G.data)!=null&&C.text?de=G.data.text:G.message?de=typeof G.message=="string"?G.message:G.message.content:(Y=G.data)!=null&&Y.message?de=typeof G.data.message=="string"?G.data.message:G.data.message.content:G.result?de=typeof G.result=="string"?G.result:G.result.content:(Z=G.data)!=null&&Z.result&&(de=typeof G.data.result=="string"?G.data.result:G.data.result.content),!de||de.trim()===""||de==="{}")throw console.error("[AI] API :",G),new Error(`API : ${JSON.stringify(G).substring(0,200)}`);console.log("[AI] :",de.length,"100:",de.substring(0,100));let Fe=de.trim();Fe.startsWith("```")&&(Fe=Fe.replace(/^```(?:json)?\n?/,"").replace(/\n?```$/,""));let gt;try{gt=JSON.parse(Fe),console.log("[AI] JSON :",((te=gt.scenes)==null?void 0:te.length)||0)}catch(Ke){console.error("[AI]  JSON :",Ke,"500:",Fe.substring(0,500));try{Fe=Fe.replace(/\/\*[\s\S]*?\*\//g,"").replace(/\/\/.*/g,""),Fe=Fe.replace(/,(\s*[}\]])/g,"$1"),gt=JSON.parse(Fe),console.log("[AI] JSON ")}catch(ot){throw console.error("[AI] JSON:",ot,":",Fe.substring(0,500)),new Error(` JSON : ${Fe.substring(0,200)}`)}}const tt=(gt.voiceover_script||[]).map((Ke,ot)=>({time:ot,text:Ke.text||""}));console.log("[AI] :",tt.length);const pt=(gt.scenes||[]).map((Ke,ot)=>{var _t,dt,Mt,Rt,St,Pt;return{scene_index:Ke.scene_id||ot+1,time_range:Ke.time_range||"",keyframes:[{type:"current",time:0,description:`${((_t=Ke.visual_analysis)==null?void 0:_t.camera_movement)||""} ${((dt=Ke.visual_analysis)==null?void 0:dt.subject_dynamics)||""}`.trim(),mj_prompt:((Mt=Ke.prompts)==null?void 0:Mt.mj_prompt)||"",jimeng_prompt:((Rt=Ke.prompts)==null?void 0:Rt.jimeng_prompt)||""}],global_tags:{style:(St=Ke.visual_analysis)!=null&&St.atmosphere?[Ke.visual_analysis.atmosphere]:[],camera:(Pt=Ke.visual_analysis)!=null&&Pt.camera_movement?[Ke.visual_analysis.camera_movement]:[],color:[]}}});console.log("[AI] :",pt.length),r(Ke=>Ke.map(ot=>ot.id===s?(console.log("[AI] :",pt.length,":",tt.length),{...ot,isGenerating:!1,settings:{...ot.settings,voiceoverResults:tt,analysisResults:pt}}):ot)),pt.length>0&&setTimeout(()=>{Jy(s,pt)},100)}catch(ne){console.error("AI:",ne);const re=ne.message||"AI";r(ke=>ke.map(Ce=>Ce.id===s?{...Ce,isGenerating:!1,errorMsg:re}:Ce))}},n1=()=>{const s=ho.name.trim(),c=ho.prompt.trim();if(!s||!c){alert("");return}ca(f=>[{id:`custom-${Date.now()}`,name:s,prompt:c},...f]),Cr({name:"",prompt:""})},r1=s=>{ca(c=>c.filter(f=>f.id!==s))},s1=(s,c)=>{!s||!c||Nt(s,{prompt:c})},i1=async s=>new Promise((c,f)=>{const h=new Image;h.crossOrigin="anonymous";const p=setTimeout(()=>{f(new Error(""))},3e4);h.onload=()=>{clearTimeout(p);try{const N=document.createElement("canvas").getContext("2d"),T=Math.floor(h.width/3),I=Math.floor(h.height/3),M=[],$=[];for(let D=0;D<3;D++)for(let P=0;P<3;P++){const W=Math.max(0,Math.min(P*T,h.width-T)),C=Math.max(0,Math.min(D*I,h.height-I)),Y=Math.min(T,h.width-W),Z=Math.min(I,h.height-C),te=document.createElement("canvas");te.width=Y,te.height=Z;const ne=te.getContext("2d");ne.fillStyle="#ffffff",ne.fillRect(0,0,Y,Z),ne.drawImage(h,W,C,Y,Z,0,0,Y,Z);try{const re=te.toDataURL("image/png");$.push(Promise.resolve({url:re,width:Y,height:Z}))}catch(re){console.error("Canvas toDataURL :",re)}}Promise.all($).then(D=>{c(D)}).catch(D=>{f(D)})}catch(m){f(m)}},h.onerror=()=>{clearTimeout(p),f(new Error(""))},h.src=s}),Ia=async(s,c={})=>{if(!s)return;const{originX:f,originY:h,cols:p=3,spacing:m=20,nodeWidth:N=260,nodeHeight:T=260,replaceSelected:I=!1}=c;try{const M=await i1(s);if(M.length!==9){alert("9");return}const $=_s.current;if(I&&$&&$.size===9){const Y=Array.from($);r(Z=>Z.map(te=>{const ne=Y.indexOf(te.id);return ne!==-1&&ne<M.length?{...te,content:M[ne].url,dimensions:{w:M[ne].width,h:M[ne].height}}:te}));return}const D=un(window.innerWidth/2,window.innerHeight/2),P=f!==void 0?f:D.x,W=h!==void 0?h:D.y,C=[];for(let Y=0;Y<M.length;Y++){const Z=Math.floor(Y/p),te=Y%p,ne=P+te*(N+m),re=W+Z*(T+m);C.push({id:`node-${Date.now()}-${Y}`,type:"input-image",x:ne,y:re,width:N,height:T,content:M[Y].url,dimensions:{w:M[Y].width,h:M[Y].height}})}r(Y=>[...Y,...C])}catch(M){alert(": "+M.message)}},o1=()=>{const s=vi.current,c=_s.current;let f=[];if(s){const Z=Xr.current.find(te=>te.id===s);Z&&(f=[Z])}else c&&c.size>0&&(f=Xr.current.filter(Z=>c.has(Z.id)));if(f.length<2){alert("");return}const h=new Set(f.map(Z=>Z.id)),p={};f.forEach(Z=>{p[Z.id]={id:Z.id,node:Z,parents:[],children:[],level:0,rank:0}}),ba.current.forEach(Z=>{h.has(Z.from)&&h.has(Z.to)&&(p[Z.from].children.push(Z.to),p[Z.to].parents.push(Z.from))});let m=Object.values(p).filter(Z=>Z.parents.length===0);m.length===0&&f.length>0&&(m=[Object.values(p)[0]]),(()=>{const Z=m.map(te=>({node:te,lvl:0}));for(;Z.length>0;){const{node:te,lvl:ne}=Z.shift();ne>=te.level&&(te.level=ne,te.children.forEach(re=>{const ke=p[re];ke&&ne<20&&Z.push({node:ke,lvl:ne+1})}))}})();const T=Math.max(...Object.values(p).map(Z=>Z.level)),I=Array.from({length:T+1},()=>[]);Object.values(p).forEach(Z=>{I[Z.level].push(Z)}),I.forEach(Z=>{Z.sort((te,ne)=>te.node.y-ne.node.y)});const M=3;for(let Z=0;Z<M;Z++){for(let te=1;te<I.length;te++){const ne=I[te];ne.forEach(re=>{if(re.parents.length>0){let ke=0;re.parents.forEach(Ce=>{const He=p[Ce],qe=I[te-1].indexOf(He);qe!==-1&&(ke+=qe)}),re.barycenter=ke/re.parents.length}else re.barycenter=I[te].indexOf(re)}),ne.sort((re,ke)=>(re.barycenter||0)-(ke.barycenter||0))}for(let te=I.length-2;te>=0;te--){const ne=I[te];ne.forEach(re=>{if(re.children.length>0){let ke=0;re.children.forEach(Ce=>{const He=p[Ce],qe=I[te+1].indexOf(He);qe!==-1&&(ke+=qe)}),re.barycenter=ke/re.children.length}else re.barycenter=I[te].indexOf(re)}),ne.sort((re,ke)=>(re.barycenter||0)-(ke.barycenter||0))}}const $=Math.min(...f.map(Z=>Z.x)),D=Math.min(...f.map(Z=>Z.y)),P=150,W=40;let C=$;const Y=new Map;I.forEach((Z,te)=>{if(Z.length===0)return;const ne=Math.max(...Z.map(ke=>ke.node.width||260));Z.reduce((ke,Ce)=>ke+(Ce.node.height||200),0)+(Z.length-1)*W;let re=D;Z.forEach(ke=>{Y.set(ke.id,{...ke.node,x:C,y:re}),re+=(ke.node.height||200)+W}),C+=ne+P}),r(Z=>Z.map(te=>Y.has(te.id)?Y.get(te.id):te))},Mh=(s,c)=>{c.preventDefault(),c.stopPropagation(),c.currentTarget.classList.remove("drag-over");const f=Array.from(c.dataTransfer.files),h=f.find(m=>m.type.startsWith("video/"));if(h){ka(s,h);return}const p=f.filter(m=>m.type.startsWith("image/"));if(p.sort((m,N)=>m.name.localeCompare(N.name,void 0,{numeric:!0,sensitivity:"base"})),p.length>0){console.log(`[KeyframeOrganizer] Adding ${p.length} images as keyframes`);const m=Ut.get(s),N=(m==null?void 0:m.frames)||[],T=(m==null?void 0:m.selectedKeyframes)||[];let I=0;const M=[];p.forEach(($,D)=>{const P=new FileReader;P.onload=async W=>{const C=W.target.result,Y=await ti.saveImage(C);if(console.log(`[KeyframeOrganizer] Saved image to IndexedDB: ${Y}`),M[D]={time:N.length+D,url:Y,filename:$.name},I++,I===p.length){const Z=M.filter(Boolean);r(te=>te.map(ne=>ne.id===s?{...ne,frames:[...N,...Z],selectedKeyframes:[...T,...Z]}:ne)),console.log(`[KeyframeOrganizer] Added ${Z.length} keyframes to node (stored in IndexedDB)`)}},P.readAsDataURL($)})}},a1=(s,c,f)=>{s.preventDefault(),s.stopPropagation();const h=s.currentTarget.getBoundingClientRect(),m=s.clientX-h.left>h.width/2?f+1:f;(z!==m||b!==c)&&(A(m),E(c))},l1=(s,c,f)=>{s.preventDefault(),s.stopPropagation(),s.target===s.currentTarget&&(z!==f||b!==c)&&(A(f),E(c))},c1=(s,c)=>{var M;c.preventDefault(),c.stopPropagation();const f=Array.from(c.dataTransfer.files).filter($=>$.type.startsWith("image/"));if(f.length===0)return;let h=b===s&&z!==null?z:(((M=Ut.get(s))==null?void 0:M.frames)||[]).length;E(null),A(null),f.sort(($,D)=>$.name.localeCompare(D.name,void 0,{numeric:!0,sensitivity:"base"})),console.log(`[KeyframeOrganizer] Inserting ${f.length} images at index ${h}`);const p=Ut.get(s),m=(p==null?void 0:p.frames)||[],N=(p==null?void 0:p.selectedKeyframes)||[];let T=0;const I=[];f.forEach(($,D)=>{const P=new FileReader;P.onload=async W=>{const C=W.target.result,Y=await ti.saveImage(C);let Z=C;try{const te=await ti.getImage(Y);te&&(Z=URL.createObjectURL(te))}catch(te){console.warn("[KeyframeOrganizer] Failed to create blob URL, using base64:",te)}if(I[D]={time:Date.now()+D,url:Z,imgId:Y,filename:$.name},T++,T===f.length){const te=I.filter(Boolean),ne=[...m.slice(0,h),...te,...m.slice(h)],re=new Set([...N,...te]),ke=ne.map((He,qe)=>({...He,time:qe})),Ce=ke.filter((He,qe)=>re.has(ne[qe]));r(He=>He.map(qe=>qe.id===s?{...qe,frames:ke,selectedKeyframes:Ce}:qe))}},P.readAsDataURL($)})},u1=async(s,c=30)=>new Promise((f,h)=>{const p=document.createElement("video");p.crossOrigin="anonymous",p.src=s,p.muted=!0;const m=document.createElement("canvas"),N=m.getContext("2d",{willReadFrequently:!0}),T=[];let I=null;p.onloadeddata=async()=>{m.width=320,m.height=Math.floor(320*(p.videoHeight/p.videoWidth));const M=p.duration,$=2;p.currentTime=0;const D=async()=>{const P=p.currentTime;if(P>=M||Math.abs(P-M)<.01){if(T.length===0||parseFloat(T[T.length-1].time)<M-.5){const Y=document.createElement("canvas");Y.width=p.videoWidth,Y.height=p.videoHeight;const Z=Y.getContext("2d");p.currentTime=Math.max(0,M-.1),await new Promise(te=>{const ne=setTimeout(()=>te(),200);p.onseeked=()=>{clearTimeout(ne),Z.drawImage(p,0,0);const re=Math.max(0,M-.1);T.push({time:re.toFixed(2),image:Y.toDataURL("image/jpeg",.8)}),te()}})}f(T.map(Y=>({time:parseFloat(Y.time),url:Y.image})));return}N.drawImage(p,0,0,m.width,m.height);const W=N.getImageData(0,0,m.width,m.height).data;if(I){let Y=0;for(let te=0;te<W.length;te+=4)Y+=Math.abs(W[te]-I[te])+Math.abs(W[te+1]-I[te+1])+Math.abs(W[te+2]-I[te+2]);if(Y/(W.length/4*3)>c){const te=document.createElement("canvas");te.width=p.videoWidth,te.height=p.videoHeight,te.getContext("2d").drawImage(p,0,0);const ne=te.toDataURL("image/jpeg",.8),re=p.currentTime;T.push({time:re.toFixed(2),image:ne}),I=null}else I=W}else{I=W;const Y=p.currentTime,Z=document.createElement("canvas");Z.width=p.videoWidth,Z.height=p.videoHeight,Z.getContext("2d").drawImage(p,0,0),T.push({time:Y.toFixed(2),image:Z.toDataURL("image/jpeg",.8)})}const C=p.currentTime+1/$;if(C>=M){if(T.length===0||parseFloat(T[T.length-1].time)<M-.5){const Y=document.createElement("canvas");Y.width=p.videoWidth,Y.height=p.videoHeight;const Z=Y.getContext("2d");p.currentTime=Math.max(0,M-.1),await new Promise(te=>{const ne=setTimeout(()=>te(),200);p.onseeked=()=>{clearTimeout(ne),Z.drawImage(p,0,0);const re=Math.max(0,M-.1);T.push({time:re.toFixed(2),image:Y.toDataURL("image/jpeg",.8)}),te()}})}f(T.map(Y=>({time:parseFloat(Y.time),url:Y.image})));return}p.currentTime=C,await new Promise(Y=>{const Z=setTimeout(()=>Y(),200);p.onseeked=()=>{clearTimeout(Z),Y()}}),D()};D()},p.onerror=M=>h(new Error(""))}),d1=async(s,c=2)=>{const f=Ut.get(s);if(f!=null&&f.content){r(h=>h.map(p=>p.id===s?{...p,extractingFrames:!0}:p));try{const h=await G2(f.content,{fps:c});r(p=>p.map(m=>m.id===s?{...m,frames:h,selectedKeyframes:[],extractingFrames:!1}:m))}catch(h){console.error("",h),r(p=>p.map(m=>m.id===s?{...m,extractingFrames:!1}:m))}}},f1=async(s,c=30)=>{const f=Ut.get(s);if(f!=null&&f.content){r(h=>h.map(p=>p.id===s?{...p,extractingFrames:!0}:p));try{const h=await u1(f.content,c);r(p=>p.map(m=>m.id===s?{...m,frames:h,selectedKeyframes:[],extractingFrames:!1}:m))}catch(h){console.error("",h),alert(`: ${h.message}`),r(p=>p.map(m=>m.id===s?{...m,extractingFrames:!1}:m))}}},p1=(s,c,f=0,h=null)=>{const p=!!(h!=null&&h.shiftKey);r(m=>m.map(N=>{if(N.id!==s)return N;const T=N.frames||[],I=P=>`${P.time}-${P.url}`,M=new Map(T.map(P=>[I(P),P]));let D=[...N.selectedKeyframes||[]];if(p&&Kl.current[s]!==void 0&&Kl.current[s]!==null&&T.length>0){const P=Kl.current[s],W=Math.min(P,f),C=Math.max(P,f),Y=T.slice(W,C+1),Z=new Set(D.map(I));Y.forEach(te=>Z.add(I(te))),D=Array.from(Z).map(te=>M.get(te)).filter(Boolean)}else D=D.some(W=>I(W)===I(c))?D.filter(W=>I(W)!==I(c)):[...D,c];return Kl.current[s]=f,{...N,selectedKeyframes:D}}))},h1=(s,c,f)=>{s.preventDefault(),s.stopPropagation(),Ou({visible:!0,x:s.clientX,y:s.clientY,nodeId:c,frame:f})},rc=()=>{Ou({visible:!1,x:0,y:0,nodeId:null,frame:null})},m1=()=>{const{frame:s}=xi;if(!(s!=null&&s.url))return;const c={name:`Frame-${(s.time??0).toFixed(2)}s.png`,type:"image/png",content:s.url,isImage:!0,isVideo:!1,isAudio:!1,fromHistory:!0,fileExt:"png"};zs(f=>[...f,c]),Nr(!0),rc()},g1=async()=>{const{frame:s}=xi;if(!(s!=null&&s.url))return;let c=s.url;if(c.startsWith("blob:"))try{c=`data:image/png;base64,${await Gn(c)}`,console.log("  Blob URL  Data URL")}catch($){console.error(" Blob URL  URL:",$)}let f;try{const $=await Tr(c);$!=null&&$.w&&($!=null&&$.h)&&(f={w:$.w,h:$.h})}catch{}const h=n.filter($=>$.type==="input-image");let p,m;if(h.length>0){const $=h[h.length-1];p=$.x-40,m=$.y+35}else{const $=un(window.innerWidth/2,window.innerHeight/2);p=$.x+50,m=$.y+50}let N=p,T=m;const I=($,D)=>n.some(P=>Math.abs(P.x-$)<80&&Math.abs(P.y-D)<80);let M=0;for(;I(N,T)&&M<50;)N-=40,T+=35,M++;ps("input-image",N,T,null,c,f),rc()},x1=()=>{const{frame:s}=xi;s!=null&&s.url&&(r(c=>{const f=vi.current,h=_s.current,p=c.filter(N=>N.type==="preview");if(!p.length)return c;let m=null;if(f){const N=p.find(T=>T.id===f);N&&(m=N.id)}if(!m&&h&&h.size>0){const N=p.find(T=>h.has(T.id));N&&(m=N.id)}return m||(m=p[p.length-1].id),c.map(N=>N.id===m?{...N,content:s.url,previewType:"image"}:N)}),rc())},y1=()=>{const{frame:s}=xi;if(!(s!=null&&s.url))return;const c=ze,f=Ut.get(c);f&&f.type==="input-image"?r(h=>h.map(p=>p.id===c?{...p,content:s.url}:p)):alert('""'),rc()},sc=(s,c,f=null,h=null)=>{s.preventDefault(),s.stopPropagation();const p=f||c.url,m=h!==null?h:c.selectedMjImageIndex!==void 0?c.selectedMjImageIndex:null,N={...c,url:p,selectedMjImageIndex:m},T=un(s.clientX,s.clientY);ds({visible:!0,x:s.clientX,y:s.clientY,worldX:T.x,worldY:T.y,item:N})},v1=()=>{const s=lr.item,c=ze,f=Ut.get(c);f&&f.type==="input-image"&&s.url?r(h=>h.map(p=>p.id===c?{...p,content:s.url}:p)):alert('""'),ds({visible:!1,x:0,y:0,item:null})},b1=async()=>{const s=lr.item;if(!(s!=null&&s.url))return;let c=s.url;s.type==="video"&&!Zn(c)&&(c+=(c.includes("?")?"&":"?")+"force_video_display=true");let f;if(s.type==="image")try{const $=await Tr(c);$!=null&&$.w&&($!=null&&$.h)&&(f={w:$.w,h:$.h})}catch($){console.error("SendHistoryToCanvas getImageDimensions error",$)}const h=n.filter($=>$.type==="input-image");let p,m;if(h.length>0){const $=h[h.length-1];p=$.x-40,m=$.y+35}else{const $=un(window.innerWidth/2,window.innerHeight/2);p=$.x+50,m=$.y+50}let N=p,T=m;const I=($,D)=>n.some(P=>Math.abs(P.x-$)<80&&Math.abs(P.y-D)<80);let M=0;for(;I(N,T)&&M<50;)N-=40,T+=35,M++;ps("input-image",N,T,null,c,f),ds({visible:!1,x:0,y:0,item:null})},w1=()=>{const s=lr.item;if(!s||!s.url)return;const c=s.type==="image",f=s.type==="video",h=c?"png":f?"mp4":"file",p=c?"image/png":f?"video/mp4":"application/octet-stream",m={name:`Generated-${s.id}.${h}`,type:p,content:s.url,isImage:c,isVideo:f,isAudio:!1,fromHistory:!0,fileExt:h};zs(N=>[...N,m]),Nr(!0),ds({visible:!1,x:0,y:0,item:null})},td=async s=>{if(console.log("[V3.5.1 Debug] handleHistoryBatchDownload called with",s==null?void 0:s.length,"items"),!s||s.length===0){console.warn("[V3.5.1 Debug] No items to download");return}if(s.length===1){const p=s[0];if(!(p!=null&&p.mjImages)&&(p==null?void 0:p.url)){it({active:!0,current:0,total:1});try{const N=p.url;let T="mp4";if(N.startsWith("data:image"))T="png";else if(N.startsWith("data:video"))T="mp4";else if(p.type==="video"||N.includes("/video/")||N.includes("video_mp4"))T="mp4";else if(p.type==="image")T="png";else{const D=N.split("?")[0].split("/").pop();if(D&&D.includes(".")){const P=D.split(".").pop();P&&P.length<=5&&/^[a-z0-9]+$/i.test(P)&&(T=P)}}const M=`${(p.prompt||"download").replace(/[\\/:*?"<>|]/g,"_").slice(0,50)}.${T}`;if(N.startsWith("data:")){const $=document.createElement("a");$.href=N,$.download=M,$.click(),console.log("  (data URL):",M)}else{console.log(" ...",M);const D=await(await fetch(N)).blob(),P=document.createElement("a");P.href=URL.createObjectURL(D),P.download=M,P.click(),console.log(" :",M)}it({active:!1,current:1,total:1})}catch(N){console.error(":",N),it({active:!1,current:0,total:0}),alert(": "+N.message)}return}}const c=new P2;let f=0;const h=s.length;console.log(`  ${h} ...`),it({active:!0,current:0,total:h});try{for(const T of s){if(!T)continue;const I=[];T.mjImages&&T.mjImages.length>0?T.mjImages.forEach((M,$)=>{I.push({url:M,suffix:`_${$+1}`})}):T.url&&I.push({url:T.url,suffix:""});for(const M of I)try{let $;if(M.url.startsWith("data:")){const Y=M.url.split(","),Z=Y[0].match(/:(.*?);/)[1],te=atob(Y[1]);let ne=te.length;const re=new Uint8Array(ne);for(;ne--;)re[ne]=te.charCodeAt(ne);$=new Blob([re],{type:Z})}else $=await(await fetch(M.url)).blob();let D=$.type.split("/")[1]||"png";if(T.url&&!T.url.startsWith("data:")){const Y=T.url.split(".").pop().split("?")[0];Y&&Y.length<5&&(D=Y)}const P=(T.prompt||"untitled").replace(/[\\/:*?"<>|]/g,"_").slice(0,40),W=T.id?`_${T.id.slice(-4)}`:"",C=`${P}${W}${M.suffix}.${D}`;c.file(C,$),f++}catch($){console.error(` [${T.id}]:`,$)}it(M=>({...M,current:M.current+1}))}if(f===0){it({active:!1,current:0,total:0}),alert("");return}const p=await c.generateAsync({type:"blob"}),m=new Date,N=`${m.getFullYear().toString().slice(2)}${(m.getMonth()+1).toString().padStart(2,"0")}${m.getDate().toString().padStart(2,"0")}-${m.getHours().toString().padStart(2,"0")}${m.getMinutes().toString().padStart(2,"0")}`;R2.saveAs(p,`tapnow-assets-${N}.zip`),console.log(`  ${f} `),it({active:!1,current:0,total:0})}catch(p){console.error(":",p),it({active:!1,current:0,total:0}),alert(": "+p.message)}},k1=(s,c)=>{c!=null&&c.url&&(s.preventDefault(),s.stopPropagation(),Kp({visible:!0,x:s.clientX,y:s.clientY,item:c}))},ic=()=>Kp({visible:!1,x:0,y:0,item:null}),z1=()=>{const s=yo.item;if(!(s!=null&&s.url))return;const c=s.type!=="video",f=s.type==="video",h=c?"png":"mp4",p=c?"image/png":"video/mp4",m={name:`Preview-${Date.now()}.${h}`,type:p,content:s.url,isImage:c,isVideo:f,isAudio:!1,fileExt:h};zs(N=>[...N,m]),Nr(!0),ic()},j1=async()=>{const s=yo.item;if(!(s!=null&&s.url))return;const c=un(window.innerWidth/2,window.innerHeight/2);let f={w:512,h:512};try{f=await Tr(s.url)}catch(h){console.warn("Preview dims fail",h)}ps("input-image",c.x+50,c.y+50,null,s.url,f),ic()},_1=(s,c)=>{s.preventDefault(),s.stopPropagation();const f=Ut.get(c);!f||!f.content||Yp({visible:!0,x:s.clientX,y:s.clientY,nodeId:c})},nd=()=>{Yp({visible:!1,x:0,y:0,nodeId:null})},N1=()=>{const s=pa.nodeId,c=Ut.get(s);if(!c||!c.content)return;const f=!Zn(c.content),h=Zn(c.content),p=f?"png":"mp4",m=f?"image/png":"video/mp4",N={name:`InputImage-${Date.now()}.${p}`,type:m,content:c.content,isImage:f,isVideo:h,isAudio:!1,fileExt:p};zs(T=>[...T,N]),Nr(!0),nd()},$h=H.memo(({connections:s,nodesMap:c,connectionsByNode:f,connectingSource:h,connectingTarget:p,connectingInputType:m,mousePos:N,apiConfigsMap:T,selectedNodeId:I,onDisconnectConnection:M,visibleNodes:$})=>{const D=H.useMemo(()=>new Set($.map(W=>W.id)),[$]),P=H.useMemo(()=>s.filter(W=>D.has(W.from)||D.has(W.to)),[s,D]);return o.jsx("div",{className:"absolute inset-0 pointer-events-none overflow-visible w-full h-full",children:o.jsxs("svg",{className:"absolute inset-0 overflow-visible w-full h-full pointer-events-none",children:[P.map(W=>{var gt;const C=c.get(W.from),Y=c.get(W.to);if(!C||!Y)return null;const Z=I&&(C.id===I||Y.id===I),te=Z?1:.35,ne=C.x+C.width-4,re=C.y+C.height/2,ke=Y.x+4;let Ce=Y.y+Y.height/2;if(Y.type==="image-compare"){const pt=(f.to.get(Y.id)||[]).findIndex(Ke=>Ke.id===W.id);pt===0?Ce=Y.y+Y.height*.33:pt>=1&&(Ce=Y.y+Y.height*.66)}if(Y.type==="gen-image"&&(W.inputType==="oref"||W.inputType==="sref")){const tt=T.get((gt=Y.settings)==null?void 0:gt.model);if(tt&&(tt.id.includes("mj")||tt.provider.toLowerCase().includes("midjourney"))){const dn=(f.to.get(Y.id)||[]).some(Jr=>!Jr.inputType||Jr.inputType==="default");let fn=12;fn+=24,dn&&(fn+=68),fn+=108,W.inputType==="oref"?Ce=Y.y+fn+16*.5:W.inputType==="sref"&&(Ce=Y.y+fn+16+6+28+6+16*.5)}}const He=Math.abs(ke-ne),qe=ne+He*.5,G=ke-He*.5,de=(ne+ke)/2,Fe=(re+Ce)/2;return o.jsxs("g",{className:"connection-group",style:{opacity:te},children:[o.jsx("path",{d:`M ${ne} ${re} C ${qe} ${re}, ${G} ${Ce}, ${ke} ${Ce}`,stroke:"transparent",strokeWidth:"20",fill:"none",style:{pointerEvents:"stroke"}}),o.jsx("path",{d:`M ${ne} ${re} C ${qe} ${re}, ${G} ${Ce}, ${ke} ${Ce}`,stroke:"#18181b",strokeWidth:"4",fill:"none"}),o.jsx("path",{d:`M ${ne} ${re} C ${qe} ${re}, ${G} ${Ce}, ${ke} ${Ce}`,stroke:"#71717a",strokeWidth:"2",fill:"none"}),o.jsx("circle",{cx:ne,cy:re,r:"2",fill:"#71717a"}),o.jsx("circle",{cx:ke,cy:Ce,r:"2",fill:"#71717a"}),o.jsxs("g",{className:"connection-delete cursor-pointer",style:{opacity:Z?1:.35,pointerEvents:"auto",cursor:"pointer"},onClick:tt=>{tt.stopPropagation(),tt.preventDefault(),M(W.id)},onMouseDown:tt=>{tt.stopPropagation(),tt.preventDefault(),M(W.id)},children:[o.jsx("circle",{cx:de,cy:Fe,r:"25",fill:"transparent",style:{pointerEvents:"auto",cursor:"pointer"},onClick:tt=>{tt.stopPropagation(),tt.preventDefault(),M(W.id)},onMouseDown:tt=>{tt.stopPropagation(),tt.preventDefault(),M(W.id)}}),o.jsx("circle",{cx:de,cy:Fe,r:"12",fill:"#ef4444",opacity:"0.8",style:{pointerEvents:"none"}}),o.jsx("circle",{cx:de,cy:Fe,r:"8",fill:"#ef4444",style:{pointerEvents:"none"}}),o.jsx(T2,{size:10,className:"text-white",x:de-5,y:Fe-5,style:{pointerEvents:"none"}})]})]},W.id)}),h&&(()=>{const W=c.get(h);return W?o.jsx("path",{d:`M ${W.x+W.width-4} ${W.y+W.height/2} C ${W.x+W.width+100} ${W.y+W.height/2}, ${N.x-100} ${N.y}, ${N.x} ${N.y}`,stroke:"#60a5fa",strokeWidth:"2",fill:"none",strokeDasharray:"4,4"}):null})(),p&&(()=>{var Z;const W=c.get(p);if(!W)return null;const C=W.x+4;let Y=W.y+W.height/2;if(W.type==="gen-image"&&m){const te=T.get((Z=W.settings)==null?void 0:Z.model);if(te&&(te.id.includes("mj")||te.provider.toLowerCase().includes("midjourney"))){const Ke=(f.to.get(W.id)||[]).some(_t=>!_t.inputType||_t.inputType==="default");let ot=12;ot+=24,Ke&&(ot+=68),ot+=108,m==="oref"?Y=W.y+ot+16*.5:m==="sref"&&(Y=W.y+ot+16+6+28+6+16*.5)}}else W.type==="image-compare"&&(Y=W.y+W.height/2);return o.jsx("path",{d:`M ${C} ${Y} C ${C-100} ${Y}, ${N.x+100} ${N.y}, ${N.x} ${N.y}`,stroke:"#60a5fa",strokeWidth:"2",fill:"none",strokeDasharray:"4,4"})})()]})})},(s,c)=>s.connections===c.connections&&s.visibleNodes===c.visibleNodes&&s.selectedNodeId===c.selectedNodeId&&s.connectingSource===c.connectingSource&&s.connectingTarget===c.connectingTarget&&s.connectingInputType===c.connectingInputType&&s.mousePos.x===c.mousePos.x&&s.mousePos.y===c.mousePos.y);H.useCallback(()=>o.jsx($h,{connections:i,nodesMap:Ut,connectionsByNode:So,connectingSource:V,connectingTarget:Ue,connectingInputType:rn,mousePos:Kn,apiConfigsMap:en,selectedNodeId:ze,onDisconnectConnection:Qu,visibleNodes:Yl}),[i,Ut,So,V,Ue,rn,Kn,en,ze,Qu,Yl]);const Ah=H.useMemo(()=>{const s=new Map;return i.forEach(c=>{(!c.inputType||c.inputType==="default")&&s.set(c.to,!0)}),s},[i]),Ph=H.useCallback(s=>{const c=new Set,f=So.from.get(s)||[],h=So.to.get(s)||[];return f.forEach(p=>c.add(p.to)),h.forEach(p=>c.add(p.from)),c},[So]),Rh=H.useMemo(()=>{const s=new Map;if(ze||Dn.size>0){const c=ze||(Dn.size===1?Array.from(Dn)[0]:null);c&&s.set(c,Ph(c))}return s},[ze,Dn,Ph]),S1=H.useCallback(s=>{var W,C,Y,Z,te,ne,re,ke,Ce,He,qe,G,de,Fe,gt,tt,pt,Ke,ot,_t,dt,Mt,Rt,St,Pt,$t,Ct,Jt,dn,fn,Jr,gn,Ln,qt,tn,nn,Ft,pn,Tn,Xn;const f=v.zoom<.4,h=ze===s.id||Dn.has(s.id),p=Ju(s.id),m=Lr===s.id,N=Ah.get(s.id)||!1,T=nr===s.id||nr&&Dn.has(s.id),I=ze||(Dn.size===1?Array.from(Dn)[0]:null),M=I?Rh.get(I):null,$=I&&I!==s.id&&M&&M.has(s.id),D=en.get((W=s.settings)==null?void 0:W.model),P=D?(D.modelName||D.id||"").includes("nano-banana-2"):(((C=s.settings)==null?void 0:C.model)||"").includes("nano-banana-2");return f?o.jsxs("div",{"data-node-id":s.id,className:`absolute node-wrapper flex flex-col ${h?"ring-1 ring-blue-500":e==="dark"?"border border-zinc-800":"border border-zinc-200"} ${e==="dark"?"bg-[#18181b]":"bg-white"}`,style:{left:s.x,top:s.y,width:s.width,height:s.height,cursor:nr===s.id||nr&&Dn.has(s.id)?"grabbing":"default",zIndex:T?50:10,border:`1px solid ${e==="dark"?"#3f3f46":"#e4e4e7"}`,background:e==="dark"?"#18181b":"#fff",boxShadow:"none",borderRadius:"0",transform:"translateZ(0)",backfaceVisibility:"hidden"},onMouseDown:U=>{U.button===0&&(U.stopPropagation(),U.ctrlKey||U.metaKey?Er(Ne=>{const ht=new Set(Ne);return ht.has(s.id)?ht.delete(s.id):ht.add(s.id),ht.size===1?we(Array.from(ht)[0]):we(null),ht}):Dn.has(s.id)&&Dn.size>1?we(s.id):(we(s.id),Er(new Set([s.id]))),hi(s.id))},onMouseEnter:()=>{(V||Ue)&&Yr(s.id)},onMouseLeave:()=>{(V||Ue)&&Lr===s.id&&Yr(null)},onMouseUp:U=>fs(s.id,U),children:[s.type==="input-image"&&s.content&&o.jsx("div",{className:"w-full h-full relative",children:Zn(s.content)?o.jsx("video",{src:s.content,className:"w-full h-full object-cover opacity-80",muted:!0,playsInline:!0}):o.jsx(Hn,{src:s.content,className:"w-full h-full object-cover opacity-80",alt:""})}),s.type==="video-input"&&s.content&&o.jsx("video",{src:s.content,className:"w-full h-full object-cover opacity-80",muted:!0,playsInline:!0}),!s.content&&o.jsx("div",{className:`p-2 font-bold text-sm truncate ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:s.type==="input-image"?"":s.type==="video-input"?"":s.type==="gen-image"||s.type==="gen-image"?"":s.type==="gen-video"?"":s.type==="text-node"?"":s.type==="preview"?"":s.type==="novel-input"?"":s.type==="extract-characters-scenes"?"":s.type==="save-to-local"||s.type==="local-save"?"":s.type||""}),s.type!=="input-image"&&s.type!=="video-input"&&s.type!=="video-analyze"&&s.type!=="preview"&&(s.type==="image-compare"?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"input-point",style:{top:"33%",left:"-0.25rem",width:"0.5rem",height:"0.5rem",backgroundColor:N?"#60a5fa":"#52525b",borderRadius:"50%",position:"absolute",zIndex:20,pointerEvents:"auto"},onMouseDown:U=>{U.stopPropagation(),U.preventDefault();const Ne=un(U.clientX,U.clientY);Rn(Ne),Ot(s.id),Gt("default")},onMouseUp:U=>fs(s.id,U,"default")}),o.jsx("div",{className:"input-point",style:{top:"66%",left:"-0.25rem",width:"0.5rem",height:"0.5rem",backgroundColor:N?"#60a5fa":"#52525b",borderRadius:"50%",position:"absolute",zIndex:20,pointerEvents:"auto"},onMouseDown:U=>{U.stopPropagation(),U.preventDefault();const Ne=un(U.clientX,U.clientY);Rn(Ne),Ot(s.id),Gt("default")},onMouseUp:U=>fs(s.id,U,"default")})]}):o.jsx("div",{className:"input-point",style:{top:"50%",left:"-0.25rem",width:"0.5rem",height:"0.5rem",backgroundColor:N?"#60a5fa":"#52525b",borderRadius:"50%",position:"absolute",zIndex:20,pointerEvents:"auto"},onMouseDown:U=>{U.stopPropagation(),U.preventDefault();const Ne=un(U.clientX,U.clientY);Rn(Ne),Ot(s.id),Gt("default")},onMouseUp:U=>fs(s.id,U,"default")})),s.type!=="preview"&&o.jsx("div",{className:"connector connector-right",style:{position:"absolute",top:"50%",right:"-0.45rem",width:"0.9rem",height:"0.9rem",backgroundColor:V===s.id?"#d4d4d8":"#27272a",border:"1px solid #71717a",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",cursor:"crosshair",zIndex:30,opacity:V===s.id?1:.5,pointerEvents:"auto"},onMouseDown:U=>{U.stopPropagation(),U.preventDefault();const Ne=un(U.clientX,U.clientY);Rn(Ne),Ae(s.id)},children:o.jsx(Ni,{size:10})})]},s.id):o.jsxs("div",{"data-node-id":s.id,className:`absolute rounded-xl shadow-xl transition-shadow duration-150 group flex flex-col node-wrapper ${h?"ring-1 ring-blue-500 shadow-blue-500/20":$?"ring-2 ring-blue-300/60 shadow-blue-300/30":e==="dark"?"border border-zinc-800 shadow-black/40":"border border-zinc-200 shadow-black/10"} ${m&&(V&&V!==s.id||Ue&&Ue!==s.id)?"ring-2 ring-green-500/50":""} ${e==="dark"?"bg-[#18181b]":"bg-white"}`,style:{left:s.x,top:s.y,width:s.width,height:s.height,cursor:nr===s.id||nr&&Dn.has(s.id)?"grabbing":"default",zIndex:T?50:10,WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",textRendering:"optimizeLegibility",transform:"translateZ(0)",backfaceVisibility:"hidden"},onMouseDown:U=>{U.button===0&&(U.stopPropagation(),U.ctrlKey||U.metaKey?Er(Ne=>{const ht=new Set(Ne);return ht.has(s.id)?ht.delete(s.id):ht.add(s.id),ht.size===1?we(Array.from(ht)[0]):we(null),ht}):Dn.has(s.id)&&Dn.size>1?we(s.id):(we(s.id),Er(new Set([s.id]))),hi(s.id),mn(null))},onMouseEnter:()=>{(V||Ue)&&Yr(s.id)},onMouseLeave:()=>{(V||Ue)&&Lr===s.id&&Yr(null)},onMouseUp:U=>fs(s.id,U),onDoubleClick:U=>{U.stopPropagation(),(s.type==="input-image"||s.type==="video-input")&&s.content&&Pn({url:s.content,type:Zn(s.content)?"video":"image"})},children:[o.jsx("button",{onClick:U=>{U.stopPropagation(),Gu(s.id)},className:`absolute -top-2.5 -right-2.5 z-50 p-1 rounded-full shadow border opacity-0 group-hover:opacity-100 transition-opacity scale-90 hover:scale-100 ${e==="dark"?"bg-zinc-800 text-zinc-400 hover:text-red-500 hover:bg-zinc-700 border-zinc-700":"bg-zinc-100 text-zinc-500 hover:text-red-500 hover:bg-zinc-200 border-zinc-300"}`,onMouseDown:U=>U.stopPropagation(),children:o.jsx(es,{size:12})}),o.jsx("div",{className:"absolute bottom-1 right-1 w-4 h-4 z-[100] resize-handle flex items-end justify-end p-0.5",onMouseDown:U=>{U.stopPropagation(),U.preventDefault(),vt(s.id)},children:o.jsx("svg",{width:"6",height:"6",viewBox:"0 0 8 8",fill:"none",className:"text-zinc-600",children:o.jsx("path",{d:"M8 0L8 8L0 8",stroke:"currentColor",strokeWidth:"2"})})}),s.type!=="input-image"&&s.type!=="video-input"&&s.type!=="video-analyze"&&s.type!=="preview"&&(s.type==="image-compare"?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:`input-point ${Ue===s.id&&!rn?"active":""}`,style:{top:"33%"},title:" 1 ",onMouseDown:U=>{U.stopPropagation(),U.preventDefault();const Ne=un(U.clientX,U.clientY);Rn(Ne),Ot(s.id),Gt("default")},onMouseUp:U=>fs(s.id,U,"default")}),o.jsx("div",{className:`input-point ${Ue===s.id&&!rn?"active":""}`,style:{top:"66%"},title:" 2 ",onMouseDown:U=>{U.stopPropagation(),U.preventDefault();const Ne=un(U.clientX,U.clientY);Rn(Ne),Ot(s.id),Gt("default")},onMouseUp:U=>fs(s.id,U,"default")})]}):o.jsx("div",{className:`input-point ${N?"connected":""} ${Ue===s.id&&!rn?"active":""}`,title:"",onMouseDown:U=>{U.stopPropagation(),U.preventDefault();const Ne=un(U.clientX,U.clientY);Rn(Ne),Ot(s.id),Gt("default")},onMouseUp:U=>fs(s.id,U,"default")})),s.type!=="preview"&&o.jsx("div",{className:`connector connector-right ${V===s.id?"active":""} ${Ue&&Lr===s.id?"ring-2 ring-green-500/50":""}`,title:"",onMouseDown:U=>{U.stopPropagation(),U.preventDefault();const Ne=un(U.clientX,U.clientY);Rn(Ne),Ae(s.id)},onMouseEnter:()=>{Ue&&Yr(s.id)},onMouseLeave:()=>{Ue&&Lr===s.id&&Yr(null)},children:o.jsx(Ni,{size:10})}),o.jsxs("div",{className:`overflow-hidden rounded-xl flex-1 flex flex-col pointer-events-none h-full w-full relative ${e==="dark"?"bg-[#18181b]":"bg-white"}`,children:[s.type==="novel-input"&&o.jsxs("div",{className:`relative w-full h-full flex flex-col transition-colors pointer-events-auto ${e==="dark"?"bg-zinc-900/80":"bg-zinc-100"}`,children:[o.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-2 border-b text-xs font-semibold shrink-0",children:[o.jsx(Qr,{size:12,className:"text-blue-500"}),o.jsx("span",{children:""})]}),o.jsxs("div",{className:"flex-1 flex flex-col gap-2 p-3 overflow-hidden min-h-0",children:[o.jsx("textarea",{value:((Y=s.settings)==null?void 0:Y.content)||"",onChange:U=>{const Ne=U.target.value;Ne.length<=1e4&&Nt(s.id,{content:Ne})},placeholder:"10,000...",maxLength:1e4,className:`w-full h-full resize-none outline-none text-sm p-2 rounded border ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200 placeholder-zinc-500":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`,onMouseDown:U=>U.stopPropagation()}),o.jsxs("div",{className:"text-right text-[10px] text-zinc-500 shrink-0",children:[(((Z=s.settings)==null?void 0:Z.content)||"").length,"/10,000"]})]})]}),s.type==="extract-characters-scenes"&&o.jsxs("div",{className:`relative w-full h-full flex flex-col transition-colors pointer-events-auto ${e==="dark"?"bg-zinc-900/80":"bg-zinc-100"}`,children:[o.jsx("div",{className:"flex items-center justify-between px-3 py-2 border-b shrink-0",children:o.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-semibold",children:[o.jsx(Xa,{size:12,className:"text-purple-500"}),o.jsx("span",{children:""})]})}),o.jsx("div",{className:"flex-1 overflow-y-auto p-3 custom-scrollbar",children:o.jsxs("div",{className:"flex flex-col gap-3",children:[o.jsxs("div",{className:"flex flex-col gap-1.5",children:[o.jsx("label",{className:"text-[10px] font-medium opacity-70",children:""}),o.jsxs("div",{className:"relative",children:[o.jsxs("button",{onClick:U=>{U.stopPropagation(),mn((Ge==null?void 0:Ge.nodeId)===s.id&&Ge.type==="extract-model"?null:{nodeId:s.id,type:"extract-model"})},className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-xs border transition-colors ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300 hover:border-zinc-600":"bg-white border-zinc-300 text-zinc-800 hover:border-zinc-400"}`,onMouseDown:U=>U.stopPropagation(),children:[o.jsx("span",{className:"truncate font-mono",children:((ne=en.get((te=s.settings)==null?void 0:te.model))==null?void 0:ne.modelName)||""}),o.jsx(_i,{size:12,className:"opacity-50 shrink-0"})]}),(Ge==null?void 0:Ge.nodeId)===s.id&&Ge.type==="extract-model"&&o.jsxs("div",{className:`absolute top-full left-0 mt-1 w-64 rounded-lg shadow-xl p-1 z-[60] border flex ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseDown:U=>U.stopPropagation(),onMouseLeave:()=>Gr(null),children:[o.jsx("div",{className:`w-24 border-r pr-1 max-h-80 overflow-y-auto custom-scrollbar flex flex-col justify-end ${e==="dark"?"border-zinc-700":"border-zinc-200"}`,children:Object.entries(Ss).filter(([,U])=>U.models.some(Ne=>Ne.type==="Chat")).map(([U,Ne])=>o.jsx("button",{onMouseEnter:()=>Gr(U),className:`w-full text-left px-2 py-1.5 text-[10px] rounded transition-colors ${cr===U?e==="dark"?"bg-zinc-800 text-white":"bg-zinc-100 text-zinc-900":e==="dark"?"text-zinc-400 hover:text-zinc-300":"text-zinc-600 hover:text-zinc-800"}`,children:Ne.name||U},U))}),o.jsxs("div",{className:"flex-1 pl-1 max-h-80 overflow-y-auto custom-scrollbar",children:[cr&&((re=Ss[cr])==null?void 0:re.models.filter(U=>U.type==="Chat").map(U=>{var Ne;return o.jsxs("button",{onClick:()=>{Nt(s.id,{model:U.id}),mn(null),Gr(null)},className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-left transition-colors ${((Ne=s.settings)==null?void 0:Ne.model)===U.id?e==="dark"?"bg-blue-600/30 text-blue-300":"bg-blue-100 text-blue-700":e==="dark"?"hover:bg-zinc-800 text-zinc-300":"hover:bg-zinc-100 text-zinc-700"}`,children:[o.jsx("span",{className:"text-[10px] font-medium truncate font-mono",children:U.id}),o.jsx("div",{className:`w-1.5 h-1.5 rounded-full shrink-0 ${Yi(U.id)}`})]},U.id)})),!cr&&o.jsx("div",{className:`text-[10px] px-2 py-3 text-center ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:"  Provider"})]})]})]})]}),o.jsx("button",{className:`w-full py-2 rounded text-xs font-medium transition-colors flex items-center justify-center gap-1.5 ${(ke=s.settings)!=null&&ke.isAnalyzing?"bg-zinc-700 text-zinc-400 cursor-not-allowed":"bg-purple-600 hover:bg-purple-500 text-white"}`,onMouseDown:U=>U.stopPropagation(),onClick:U=>{U.stopPropagation(),qy(s.id)},children:(Ce=s.settings)!=null&&Ce.isAnalyzing?o.jsxs(o.Fragment,{children:[o.jsx(Js,{size:12,className:"animate-spin"}),"..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Ec,{size:12}),""]})})]})})]}),s.type==="local-save"&&o.jsxs("div",{className:`relative w-full h-full flex flex-col transition-colors pointer-events-auto ${e==="dark"?"bg-zinc-900/80":"bg-zinc-100"}`,children:[o.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b shrink-0",children:[o.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-semibold",children:[o.jsx(mm,{size:12,className:"text-green-500"}),o.jsx("span",{children:""})]}),o.jsx("div",{className:`w-2 h-2 rounded-full ${((He=s.settings)==null?void 0:He.serverStatus)==="connected"||Se?"bg-green-500 shadow-[0_0_8px_rgba(34,197,94,0.6)]":"bg-red-500"}`,title:Se?"":""})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-3 custom-scrollbar flex flex-col gap-3",children:[o.jsxs("div",{className:"flex flex-col gap-1.5",children:[o.jsx("label",{className:"text-[10px] font-medium opacity-70",children:" ()"}),o.jsx("input",{type:"text",value:((qe=s.settings)==null?void 0:qe.savePath)||"",onChange:U=>Nt(s.id,{savePath:U.target.value}),placeholder:"C:/Downloads/Tapnow",className:`w-full text-xs border rounded px-2 py-1.5 outline-none focus:border-blue-500 ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300 placeholder-zinc-600":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`,onMouseDown:U=>U.stopPropagation()})]}),o.jsxs("div",{className:"flex flex-col gap-1.5",children:[o.jsx("label",{className:"text-[10px] font-medium opacity-70",children:""}),o.jsx("input",{type:"text",value:((G=s.settings)==null?void 0:G.subfolder)||"",onChange:U=>Nt(s.id,{subfolder:U.target.value}),placeholder:"v1_characters",className:`w-full text-xs border rounded px-2 py-1.5 outline-none focus:border-blue-500 ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300 placeholder-zinc-600":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`,onMouseDown:U=>U.stopPropagation()})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("label",{className:"text-[10px] font-medium opacity-70",children:" ()"}),o.jsx("button",{className:`w-10 h-5 rounded-full relative transition-colors ${(de=s.settings)!=null&&de.autoSave?"bg-green-600":"bg-zinc-600"}`,onClick:()=>{var U;return Nt(s.id,{autoSave:!((U=s.settings)!=null&&U.autoSave)})},onMouseDown:U=>U.stopPropagation(),children:o.jsx("div",{className:`absolute top-1 w-3 h-3 rounded-full bg-white transition-all ${(Fe=s.settings)!=null&&Fe.autoSave?"left-6":"left-1"}`})})]}),o.jsxs("div",{className:"mt-auto border-t pt-2 border-zinc-700/50",children:[o.jsxs("div",{className:"text-[10px] text-zinc-500 flex justify-between",children:[o.jsx("span",{children:":"}),o.jsx("span",{children:(gt=s.settings)!=null&&gt.lastSaved?s.settings.lastSaved.split(" ")[1]:""})]}),o.jsxs("div",{className:"text-[10px] text-zinc-500 flex justify-between mt-1",children:[o.jsx("span",{children:":"}),o.jsxs("span",{children:[((pt=(tt=s.settings)==null?void 0:tt.savedFiles)==null?void 0:pt.length)||0," "]})]})]})]})]}),s.type==="novel-input"&&o.jsxs("div",{className:`relative w-full h-full flex flex-col transition-colors pointer-events-auto ${e==="dark"?"bg-zinc-900/80":"bg-zinc-100"}`,children:[o.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-2 border-b text-xs font-semibold shrink-0",children:[o.jsx(Qr,{size:12,className:"text-blue-500"}),o.jsx("span",{children:""})]}),o.jsxs("div",{className:"flex-1 flex flex-col gap-2 p-3 overflow-hidden min-h-0",children:[o.jsx("textarea",{value:((Ke=s.settings)==null?void 0:Ke.content)||"",onChange:U=>{const Ne=U.target.value;Ne.length<=1e4&&Nt(s.id,{content:Ne})},placeholder:"10,000...",maxLength:1e4,className:`w-full h-full resize-none outline-none text-sm p-2 rounded border ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200 placeholder-zinc-500":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`,onMouseDown:U=>U.stopPropagation()}),o.jsxs("div",{className:"text-right text-[10px] text-zinc-500 shrink-0",children:[(((ot=s.settings)==null?void 0:ot.content)||"").length,"/10,000"]})]})]}),s.type==="extract-characters-scenes"&&o.jsxs("div",{className:`relative w-full h-full flex flex-col transition-colors pointer-events-auto ${e==="dark"?"bg-zinc-900/80":"bg-zinc-100"}`,children:[o.jsx("div",{className:"flex items-center justify-between px-3 py-2 border-b shrink-0",children:o.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-semibold",children:[o.jsx(Xa,{size:12,className:"text-purple-500"}),o.jsx("span",{children:""})]})}),o.jsx("div",{className:"flex-1 overflow-y-auto p-3 custom-scrollbar",children:o.jsxs("div",{className:"flex flex-col gap-3",children:[o.jsxs("div",{className:"flex flex-col gap-1.5",children:[o.jsx("label",{className:"text-[10px] font-medium opacity-70",children:""}),o.jsxs("div",{className:"relative",children:[o.jsxs("select",{value:((_t=s.settings)==null?void 0:_t.model)||"",onChange:U=>Nt(s.id,{model:U.target.value}),className:`w-full text-xs border rounded px-2 py-1.5 appearance-none outline-none focus:border-blue-500 cursor-pointer ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300":"bg-white border-zinc-300 text-zinc-800"}`,onMouseDown:U=>U.stopPropagation(),children:[o.jsx("option",{value:"",disabled:!0,children:""}),ae.filter(U=>U.type==="Chat").map(U=>o.jsx("option",{value:U.id,children:U.modelName||U.id},U.id))]}),o.jsx(_i,{size:12,className:"absolute right-2 top-1/2 -translate-y-1/2 opacity-50 pointer-events-none"})]})]}),o.jsx("button",{className:`w-full py-2 rounded text-xs font-medium transition-colors flex items-center justify-center gap-1.5 ${(dt=s.settings)!=null&&dt.isAnalyzing?"bg-zinc-700 text-zinc-400 cursor-not-allowed":"bg-purple-600 hover:bg-purple-500 text-white"}`,onMouseDown:U=>U.stopPropagation(),onClick:async()=>{alert("V3.4.4: APIUI")},children:(Mt=s.settings)!=null&&Mt.isAnalyzing?o.jsxs(o.Fragment,{children:[o.jsx(Js,{size:12,className:"animate-spin"}),"..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Ec,{size:12}),""]})})]})})]}),s.type==="local-save"&&o.jsxs("div",{className:`relative w-full h-full flex flex-col transition-colors pointer-events-auto ${e==="dark"?"bg-zinc-900/80":"bg-zinc-100"}`,children:[o.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b shrink-0",children:[o.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-semibold",children:[o.jsx(mm,{size:12,className:"text-green-500"}),o.jsx("span",{children:""})]}),o.jsx("div",{className:`w-2 h-2 rounded-full ${((Rt=s.settings)==null?void 0:Rt.serverStatus)==="connected"||Se?"bg-green-500 shadow-[0_0_8px_rgba(34,197,94,0.6)]":"bg-red-500"}`,title:Se?"":""})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-3 custom-scrollbar flex flex-col gap-3",children:[o.jsxs("div",{className:"flex flex-col gap-1.5",children:[o.jsx("label",{className:"text-[10px] font-medium opacity-70",children:" ()"}),o.jsx("input",{type:"text",value:((St=s.settings)==null?void 0:St.savePath)||"",onChange:U=>Nt(s.id,{savePath:U.target.value}),placeholder:"C:/Downloads/Tapnow",className:`w-full text-xs border rounded px-2 py-1.5 outline-none focus:border-blue-500 ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300 placeholder-zinc-600":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`,onMouseDown:U=>U.stopPropagation()})]}),o.jsxs("div",{className:"flex flex-col gap-1.5",children:[o.jsx("label",{className:"text-[10px] font-medium opacity-70",children:""}),o.jsx("input",{type:"text",value:((Pt=s.settings)==null?void 0:Pt.subfolder)||"",onChange:U=>Nt(s.id,{subfolder:U.target.value}),placeholder:"v1_characters",className:`w-full text-xs border rounded px-2 py-1.5 outline-none focus:border-blue-500 ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300 placeholder-zinc-600":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`,onMouseDown:U=>U.stopPropagation()})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("label",{className:"text-[10px] font-medium opacity-70",children:" ()"}),o.jsx("button",{className:`w-10 h-5 rounded-full relative transition-colors ${($t=s.settings)!=null&&$t.autoSave?"bg-green-600":"bg-zinc-600"}`,onClick:()=>{var U;return Nt(s.id,{autoSave:!((U=s.settings)!=null&&U.autoSave)})},onMouseDown:U=>U.stopPropagation(),children:o.jsx("div",{className:`absolute top-1 w-3 h-3 rounded-full bg-white transition-all ${(Ct=s.settings)!=null&&Ct.autoSave?"left-6":"left-1"}`})})]}),o.jsxs("div",{className:"mt-auto border-t pt-2 border-zinc-700/50",children:[o.jsxs("div",{className:"text-[10px] text-zinc-500 flex justify-between",children:[o.jsx("span",{children:":"}),o.jsx("span",{children:(Jt=s.settings)!=null&&Jt.lastSaved?s.settings.lastSaved.split(" ")[1]:""})]}),o.jsxs("div",{className:"text-[10px] text-zinc-500 flex justify-between mt-1",children:[o.jsx("span",{children:":"}),o.jsxs("span",{children:[((fn=(dn=s.settings)==null?void 0:dn.savedFiles)==null?void 0:fn.length)||0," "]})]})]})]})]}),s.type==="input-image"&&o.jsx("div",{className:`relative w-full h-full flex flex-col items-center justify-center transition-colors pointer-events-auto drop-zone ${e==="dark"?"bg-zinc-900 group-hover:bg-zinc-800":"bg-zinc-100 group-hover:bg-zinc-200"}`,onDrop:U=>By(s.id,U),onDragOver:zh,onDragLeave:jh,onContextMenu:U=>_1(U,s.id),children:s.content?o.jsxs("div",{className:"relative w-full h-full",children:[Zn(s.content)?o.jsx("video",{src:s.content,controls:!0,className:"w-full h-full object-contain bg-black/50",draggable:!1,style:{imageRendering:v.zoom>=1?"auto":"crisp-edges",WebkitFontSmoothing:"antialiased",transform:"translateZ(0)",backfaceVisibility:"hidden",WebkitBackfaceVisibility:"hidden"}}):o.jsx("img",{src:s.content,className:"w-full h-full object-contain bg-black/50",draggable:!1,loading:"lazy",style:{imageRendering:v.zoom>=1?"auto":"crisp-edges",WebkitFontSmoothing:"antialiased",transform:"translateZ(0)",backfaceVisibility:"hidden",WebkitBackfaceVisibility:"hidden"}}),s.dimensions&&o.jsxs("div",{className:`absolute bottom-2 right-2 text-[10px] px-1.5 py-0.5 rounded backdrop-blur-sm border ${e==="dark"?"bg-black/70 text-white border-white/10":"bg-white/80 text-zinc-800 border-zinc-200"}`,children:[s.dimensions.w,"x",s.dimensions.h]}),!s.isMasking&&o.jsxs("div",{className:"absolute inset-0 bg-black/40 transition-opacity gap-2 opacity-0 group-hover:opacity-100 flex flex-col items-center justify-center",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("label",{className:`cursor-pointer px-3 py-1.5 rounded-lg text-xs backdrop-blur-sm border transition-colors ${e==="dark"?"bg-white/10 hover:bg-white/20 text-white border-white/10":"bg-white hover:bg-zinc-100 text-zinc-800 border-zinc-300"}`,onMouseDown:U=>U.stopPropagation(),children:[" ",o.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:U=>Th(s.id,U)})]}),!Zn(s.content)&&o.jsxs("button",{onClick:U=>{U.stopPropagation(),r(Ne=>Ne.map(ht=>ht.id===s.id?{...ht,isMasking:!ht.isMasking}:ht))},className:`px-3 py-1.5 rounded-lg text-xs backdrop-blur-sm border transition-colors flex items-center gap-1 ${e==="dark"?s.isMasking?"bg-red-500/80 hover:bg-red-500 text-white border-red-400":"bg-white/10 hover:bg-white/20 text-white border-white/10":s.isMasking?"bg-red-500 hover:bg-red-600 text-white border-red-400":"bg-white hover:bg-zinc-100 text-zinc-800 border-zinc-300"}`,onMouseDown:U=>U.stopPropagation(),children:[o.jsx(u2,{size:12}),""]})]}),o.jsxs("div",{className:`text-[10px] text-center px-2 ${e==="dark"?"text-zinc-300":"text-zinc-500"}`,children:["",o.jsx("br",{})," Ctrl+V "]})]}),!s.isMasking&&s.maskContent&&o.jsx("div",{className:"absolute inset-0 z-20 pointer-events-none",style:{background:"rgba(255, 0, 0, 0.3)",mixBlendMode:"multiply",WebkitMaskImage:`url(${s.maskContent})`,maskImage:`url(${s.maskContent})`,WebkitMaskSize:"100% 100%",maskSize:"100% 100%",WebkitMaskRepeat:"no-repeat",maskRepeat:"no-repeat"}}),s.isMasking&&!Zn(s.content)&&s.dimensions&&o.jsx(O2,{nodeId:s.id,imageUrl:s.content,imageDimensions:s.dimensions,isActive:s.isMasking,onClose:()=>{r(U=>U.map(Ne=>Ne.id===s.id?{...Ne,isMasking:!1}:Ne))},onSave:U=>{console.log(":",U)},onUpdateNode:(U,Ne)=>{r(ht=>ht.map(wn=>wn.id===U?{...wn,...Ne}:wn))},theme:e,view:v,maskContent:s.maskContent})]}):o.jsxs("div",{className:"flex flex-col items-center justify-center h-full w-full",children:[o.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center mb-3 border ${e==="dark"?"bg-zinc-800 border-zinc-700/50":"bg-zinc-100 border-zinc-300"}`,children:o.jsx($o,{className:`w-6 h-6 ${e==="dark"?"text-zinc-500":"text-zinc-400"}`})}),o.jsxs("label",{className:"bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-lg text-xs font-medium transition-colors cursor-pointer pointer-events-auto",onMouseDown:U=>U.stopPropagation(),children:["",o.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:U=>Th(s.id,U)})]}),o.jsxs("div",{className:"text-[10px] text-center mt-2 pointer-events-none text-zinc-500",children:["",o.jsx("br",{})," Ctrl+V "]})]})}),s.type==="video-input"&&o.jsxs("div",{className:`relative w-full h-full flex flex-col transition-colors pointer-events-auto drop-zone video-input-container ${e==="dark"?"bg-zinc-900/80":"bg-zinc-100"}`,onDragOver:zh,onDragLeave:jh,children:[o.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b text-xs font-semibold",children:[o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx(Od,{size:13,className:"text-blue-500"}),o.jsx("span",{children:" / "}),o.jsx("button",{onClick:U=>{var jn;U.stopPropagation();const Ne=((jn=s.settings)==null?void 0:jn.videoExpanded)===!1,ht=(s.frames||[]).length,wn=Ne?Math.max(1,Math.floor(s.width/290)):1,be=Math.max(1,Math.ceil(ht/wn)),et=72,xt=Ne?s.content?230:190:0,We=s.content&&Ne?48:0,mt=36,zt=30,Wt=Ne?158:106,Ze=et+xt+We+mt+be*Wt+zt;r(Mn=>Mn.map(Bn=>Bn.id===s.id?{...Bn,height:Math.max(Ne?500:220,Ze),settings:{...Bn.settings,videoExpanded:Ne}}:Bn))},className:`p-1 hover:bg-zinc-200 dark:hover:bg-zinc-700 rounded transition-colors ml-1 ${((Jr=s.settings)==null?void 0:Jr.videoExpanded)===!1?"bg-zinc-200 dark:bg-zinc-700":""}`,title:((gn=s.settings)==null?void 0:gn.videoExpanded)===!1?"":"",children:((Ln=s.settings)==null?void 0:Ln.videoExpanded)===!1?o.jsx(_i,{size:12}):o.jsx(Dd,{size:12})})]}),o.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-zinc-500",children:[(qt=s.videoMeta)!=null&&qt.duration?o.jsxs("span",{children:[" ",s.videoMeta.duration.toFixed(1),"s"]}):null,(tn=s.videoMeta)!=null&&tn.w?o.jsxs("span",{children:[s.videoMeta.w,"x",s.videoMeta.h]}):null,(nn=s.selectedKeyframes)!=null&&nn.length?o.jsxs("span",{className:"text-blue-500",children:[" ",s.selectedKeyframes.length," "]}):null]})]}),o.jsxs("div",{className:"flex-1 flex flex-col gap-3 p-3 overflow-hidden min-h-0",children:[s.content?o.jsxs("div",{className:"space-y-2",children:[((Ft=s.settings)==null?void 0:Ft.videoExpanded)!==!1&&o.jsx("div",{className:"relative w-full max-w-[360px] aspect-video bg-black rounded-lg overflow-hidden flex items-center justify-center mx-auto",onDrop:U=>Mh(s.id,U),children:o.jsx("video",{src:s.content,controls:!0,className:"w-full h-full object-contain",draggable:!1})}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("label",{className:"bg-blue-600 hover:bg-blue-500 text-white px-3 py-1.5 rounded text-xs font-medium transition-colors cursor-pointer",onMouseDown:U=>U.stopPropagation(),children:["",o.jsx("input",{type:"file",className:"hidden",accept:"video/*",onChange:U=>{var Ne;return ka(s.id,(Ne=U.target.files)==null?void 0:Ne[0])}})]}),o.jsx("button",{className:`px-3 py-1.5 rounded text-xs border transition-colors ${e==="dark"?"border-zinc-700 bg-zinc-800 text-zinc-300 hover:border-blue-500 hover:text-blue-400":"border-zinc-300 hover:border-blue-500 hover:text-blue-600"}`,onMouseDown:U=>U.stopPropagation(),onClick:()=>d1(s.id,2),children:o.jsx("span",{className:"whitespace-nowrap",children:"2fps"})}),o.jsx("button",{className:`px-3 py-1.5 rounded text-xs border transition-colors ${e==="dark"?"bg-green-600/40 border-green-500 text-green-200 hover:bg-green-600/60 hover:border-green-400":"bg-green-50 border-green-300 hover:border-green-500 hover:text-green-600"}`,onMouseDown:U=>U.stopPropagation(),onClick:()=>f1(s.id,30),children:o.jsx("span",{className:"whitespace-nowrap",children:""})}),s.extractingFrames&&o.jsx("span",{className:"text-[11px] text-blue-500",children:"..."})]})]}):((pn=s.settings)==null?void 0:pn.videoExpanded)!==!1&&o.jsx("div",{className:"flex flex-col items-center justify-center gap-3 w-full px-4 mx-auto shrink-0 transition-colors border-2 border-transparent hover:border-blue-500/30 rounded-lg p-4",onDrop:U=>Mh(s.id,U),children:o.jsxs("div",{className:"flex flex-col gap-2 items-center justify-center shrink-0 w-full",children:[o.jsx("div",{className:`relative w-full h-64 flex flex-col items-center justify-center border-2 border-dashed rounded-lg transition-colors ${x===s.id&&!b?"border-blue-500 bg-blue-500/10":e==="dark"?"border-zinc-700 hover:border-zinc-500":"border-zinc-300 hover:border-zinc-400"}`,children:o.jsxs("label",{className:"cursor-pointer flex flex-col items-center justify-center w-full h-full",children:[o.jsx(M2,{size:48,className:`mb-2 ${e==="dark"?"text-zinc-500":"text-zinc-400"}`}),o.jsx("span",{className:`text-xs ${e==="dark"?"text-zinc-400":"text-zinc-500"}`,children:""}),o.jsx("input",{type:"file",className:"hidden",accept:"video/*",onChange:U=>{var Ne;return ka(s.id,(Ne=U.target.files)==null?void 0:Ne[0])}})]})}),o.jsx("div",{className:"text-[10px] text-center text-zinc-500 pointer-events-none",children:" MP4/WEBM Ctrl+V "})]})}),o.jsxs("div",{className:"flex items-center justify-between text-[11px] text-zinc-500",children:[o.jsx("span",{children:""}),o.jsxs("div",{className:"flex items-center gap-2 flex-nowrap shrink-0 whitespace-nowrap",children:[o.jsxs("span",{children:[(s.frames||[]).length," "]}),(s.frames||[]).length>0&&o.jsxs(o.Fragment,{children:[o.jsxs("button",{onClick:()=>{const U=s.frames||[],Ne=s.selectedKeyframes||[];let ht=[];Ne.length===0?ht=U.map(wn=>({url:wn.url,time:wn.time,filename:wn.filename})):ht=[],r(wn=>wn.map(be=>be.id===s.id?{...be,selectedKeyframes:ht}:be))},className:`text-[10px] px-1.5 py-0.5 rounded transition-colors flex items-center gap-1 ${e==="dark"?"bg-blue-600/30 text-blue-300 hover:bg-blue-600/50":"bg-blue-100 text-blue-600 hover:bg-blue-200"}`,onMouseDown:U=>U.stopPropagation(),title:(s.selectedKeyframes||[]).length>0?"":"",children:[(s.selectedKeyframes||[]).length>0?o.jsx(vm,{size:10}):o.jsx(d2,{size:10}),(s.selectedKeyframes||[]).length>0?"":""]}),o.jsxs("button",{onClick:()=>{confirm("")&&r(U=>U.map(Ne=>Ne.id===s.id?{...Ne,frames:[],selectedKeyframes:[]}:Ne))},className:`text-[10px] px-1.5 py-0.5 rounded transition-colors flex items-center gap-1 flex-nowrap ${e==="dark"?"bg-red-600/30 text-red-300 hover:bg-red-600/50":"bg-red-100 text-red-600 hover:bg-red-200"}`,onMouseDown:U=>U.stopPropagation(),title:"",children:[o.jsx(Ms,{size:10}),""]})]})]})]}),o.jsx("div",{className:"grid gap-3 w-full overflow-y-auto custom-scrollbar flex-1 min-h-0 relative p-1 content-start items-start",style:{gridTemplateColumns:((Tn=s.settings)==null?void 0:Tn.videoExpanded)===!1?"1fr":"repeat(auto-fill, minmax(260px, 1fr))",gridAutoRows:"auto"},onDrop:U=>c1(s.id,U),onDragOver:U=>l1(U,s.id,(s.frames||[]).length),onDragLeave:U=>{U.currentTarget.contains(U.relatedTarget)||(E(null),A(null))},children:(s.frames||[]).length===0?o.jsxs("div",{className:`col-span-full text-[11px] text-zinc-500 text-center py-4 border rounded ${e==="dark"?"bg-zinc-800/40 border-zinc-700":"bg-white/40 border-zinc-300"}`,children:["",o.jsx("div",{className:"mt-1 opacity-50 text-[9px]",children:""})]}):(s.frames||[]).map((U,Ne)=>{var et;const ht=(s.selectedKeyframes||[]).some(xt=>xt.url===U.url&&xt.time===U.time),wn=b===s.id&&z===Ne,be=b===s.id&&z===(s.frames||[]).length&&Ne===(s.frames||[]).length-1;return o.jsxs("div",{className:"relative",children:[wn&&o.jsx("div",{className:"absolute -top-1.5 left-0 right-0 h-1 bg-red-500 rounded-full shadow-[0_0_8px_rgba(239,68,68,0.8)] z-50"}),o.jsxs("button",{className:`relative w-full rounded overflow-hidden group transition-all ${ht?"ring-2 ring-blue-500 border-2 border-blue-500 bg-blue-900/30":e==="dark"?"border border-zinc-700 hover:border-zinc-500":"border border-zinc-300 hover:border-zinc-400"}`,onMouseDown:xt=>xt.stopPropagation(),onClick:xt=>p1(s.id,U,Ne,xt),onContextMenu:xt=>h1(xt,s.id,U),onDragOver:xt=>a1(xt,s.id,Ne),children:[o.jsx(Hn,{src:U.url,className:`w-full bg-black ${((et=s.settings)==null?void 0:et.videoExpanded)===!1?"h-[90px] object-cover":"aspect-video object-contain max-h-[140px]"}`,alt:`frame-${Ne}`}),o.jsxs("div",{className:"absolute left-1 top-1 text-[10px] px-1 py-0.5 rounded bg-black/60 text-white",children:[typeof U.time=="number"?U.time.toFixed(2):U.time,"s"]}),U.filename&&o.jsx("div",{className:"absolute left-0 bottom-0 right-0 bg-black/80 text-white text-[9px] px-1 py-0.5 opacity-0 group-hover:opacity-100 transition-opacity truncate",title:U.filename,children:U.filename}),o.jsxs("div",{className:"absolute top-1 bottom-1 right-1 flex flex-col justify-between items-center z-20 pointer-events-none",children:[o.jsx("div",{className:"pointer-events-auto w-5 h-5 rounded-full border border-white/80 bg-black/40 flex items-center justify-center shrink-0 mb-auto",children:ht?o.jsx(el,{size:12,className:"text-white"}):null}),o.jsx("button",{onClick:xt=>{xt.stopPropagation(),r(We=>We.map(mt=>{if(mt.id!==s.id)return mt;const zt=(mt.frames||[]).filter((Ze,jn)=>jn!==Ne),Wt=(mt.selectedKeyframes||[]).filter(Ze=>Ze.url!==U.url);return{...mt,frames:zt,selectedKeyframes:Wt}}))},className:"pointer-events-auto w-5 h-5 rounded bg-red-600/80 text-white flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-500 my-1 shrink-0",title:"",children:o.jsx(es,{size:12})}),o.jsxs("div",{className:"pointer-events-auto flex flex-col gap-0.5 opacity-0 group-hover:opacity-100 transition-opacity shrink-0 mt-auto",children:[Ne>0&&o.jsx("button",{onClick:xt=>{xt.stopPropagation(),r(We=>We.map(mt=>{if(mt.id!==s.id)return mt;const zt=[...mt.frames||[]];[zt[Ne-1],zt[Ne]]=[zt[Ne],zt[Ne-1]];const Wt=[...mt.selectedKeyframes||[]],Ze=Wt.findIndex(jn=>jn.url===U.url);return Ze>0&&([Wt[Ze-1],Wt[Ze]]=[Wt[Ze],Wt[Ze-1]]),{...mt,frames:zt,selectedKeyframes:Wt}}))},className:"w-5 h-5 rounded bg-black/70 text-white flex items-center justify-center hover:bg-blue-600",title:"",children:o.jsx(Dd,{size:12})}),Ne<(s.frames||[]).length-1&&o.jsx("button",{onClick:xt=>{xt.stopPropagation(),r(We=>We.map(mt=>{if(mt.id!==s.id)return mt;const zt=[...mt.frames||[]];[zt[Ne],zt[Ne+1]]=[zt[Ne+1],zt[Ne]];const Wt=[...mt.selectedKeyframes||[]],Ze=Wt.findIndex(jn=>jn.url===U.url);return Ze>=0&&Ze<Wt.length-1&&([Wt[Ze],Wt[Ze+1]]=[Wt[Ze+1],Wt[Ze]]),{...mt,frames:zt,selectedKeyframes:Wt}}))},className:"w-5 h-5 rounded bg-black/70 text-white flex items-center justify-center hover:bg-blue-600",title:"",children:o.jsx(_i,{size:12})})]})]})]}),be&&o.jsx("div",{className:"absolute -bottom-1.5 left-0 right-0 h-1 bg-red-500 rounded-full shadow-[0_0_8px_rgba(239,68,68,0.8)] z-50"})]},`${U.url}-${Ne}`)})})]})]}),s.type==="text-node"&&o.jsxs("div",{className:`relative w-full h-full flex flex-col transition-colors pointer-events-auto ${e==="dark"?"bg-zinc-900/80":"bg-zinc-100"}`,children:[o.jsx("div",{className:"flex items-center justify-between px-3 py-2 border-b text-xs font-semibold",children:o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx(Qr,{size:13,className:"text-blue-500"}),o.jsx("span",{children:""})]})}),o.jsx("div",{className:"flex-1 p-3",children:o.jsx("textarea",{"data-node-type":"text-node","data-node-id":s.id,value:((Xn=s.settings)==null?void 0:Xn.text)||"",onChange:U=>{Nt(s.id,{text:U.target.value})},placeholder:"...",className:`w-full h-full resize-none outline-none text-sm p-2 rounded border ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200 placeholder-zinc-500":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`,onMouseDown:U=>U.stopPropagation()})})]}),s.type==="video-analyze"&&o.jsxs("div",{className:`relative w-full h-full flex flex-col transition-colors pointer-events-auto video-analyze-container ${e==="dark"?"bg-zinc-900/80":"bg-zinc-100"}`,onClick:U=>{const Ne=window.getSelection();if(Ne&&Ne.toString().length>0)return;const ht=U.target;ht&&(ht.tagName==="INPUT"||ht.tagName==="TEXTAREA"||ht.tagName==="SELECT"||ht.tagName==="BUTTON"||ht.isContentEditable||ht.closest('input, textarea, select, button, [contenteditable="true"]'))||U.stopPropagation()},children:[o.jsx("div",{className:"flex items-center justify-between px-3 py-2 border-b text-xs font-semibold",children:o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx(g2,{size:13,className:"text-blue-500"}),o.jsx("span",{children:" / "})]})}),o.jsx("div",{className:"flex-1 flex flex-col gap-3 p-3 overflow-hidden min-h-0",children:(()=>{var be,et,xt,We,mt,zt,Wt,Ze,jn,Mn,Bn,hs,ur,kn,fe,R,ve,Le;const U=Sa(s.id);if(!U)return o.jsxs("div",{className:"flex flex-col items-center justify-center flex-1 gap-2 text-[11px] text-zinc-500",children:[o.jsx(Ga,{size:24,className:"text-zinc-400"}),o.jsx("span",{children:""})]});const Ne=U.videoFileName||"",ht=((be=U.videoMeta)==null?void 0:be.duration)||0,wn=U.selectedKeyframes||[];return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:`text-[11px] px-2 py-1.5 rounded border ${e==="dark"?"bg-zinc-800 border-zinc-700":"bg-zinc-50 border-zinc-300"}`,children:[o.jsx("div",{className:"flex items-center justify-between mb-1",children:o.jsx("span",{className:"text-zinc-500",children:U.isImageInput?"":""})}),o.jsxs("div",{className:"text-zinc-700 dark:text-zinc-300",children:[o.jsxs("div",{children:[": ",U.isImageInput?"":Ne]}),!U.isImageInput&&o.jsxs("div",{children:[": ",ht.toFixed(1),"s"]}),o.jsxs("div",{children:[": ",wn.length," "]})]})]}),o.jsxs("div",{className:`flex items-center gap-2 p-1 rounded-lg border shadow-inner ${e==="dark"?"bg-zinc-800 border-zinc-700":"bg-zinc-100 border-zinc-200"}`,children:[o.jsxs("button",{onClick:()=>Nt(s.id,{analysisMode:"manual"}),className:`flex-1 py-1 px-2 text-[11px] rounded transition-all flex justify-center items-center gap-1 ${(((et=s.settings)==null?void 0:et.analysisMode)||"manual")==="manual"?e==="dark"?"bg-zinc-600 shadow-md text-blue-300 font-bold":"bg-white shadow-md text-blue-600 font-bold":e==="dark"?"text-zinc-500 hover:text-zinc-300":"text-zinc-500 hover:text-zinc-700"}`,onMouseDown:se=>se.stopPropagation(),children:[o.jsx(um,{size:12})," "]}),o.jsxs("button",{onClick:()=>Nt(s.id,{analysisMode:"auto"}),className:`flex-1 py-1 px-2 text-[11px] rounded transition-all flex justify-center items-center gap-1 ${((xt=s.settings)==null?void 0:xt.analysisMode)==="auto"?e==="dark"?"bg-zinc-600 shadow-md text-purple-300 font-bold":"bg-white shadow-md text-purple-600 font-bold":e==="dark"?"text-zinc-500 hover:text-zinc-300":"text-zinc-500 hover:text-zinc-700"}`,onMouseDown:se=>se.stopPropagation(),children:[o.jsx(Ec,{size:12})," AI "]})]}),(((We=s.settings)==null?void 0:We.analysisMode)||"manual")==="manual"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("label",{className:"text-[11px] text-zinc-500",children:":"}),o.jsx("input",{type:"number",min:"1",max:"30",value:((mt=s.settings)==null?void 0:mt.segmentDuration)||3,onChange:se=>{const q=parseInt(se.target.value)||3;Nt(s.id,{segmentDuration:q}),Ny(q.toString());try{localStorage.setItem("tapnow_last_segment_duration",q.toString())}catch{}},className:`w-16 px-2 py-1 text-[11px] rounded border ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300":"bg-white border-zinc-300 text-zinc-800"}`,onMouseDown:se=>se.stopPropagation()}),o.jsx("span",{className:"text-[11px] text-zinc-500",children:""})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("label",{className:"text-[11px] text-zinc-500",children:":"}),o.jsxs("div",{className:"relative flex-1",children:[o.jsxs("button",{onClick:se=>{se.stopPropagation(),mn((Ge==null?void 0:Ge.nodeId)===s.id&&Ge.type==="analyze-model"?null:{nodeId:s.id,type:"analyze-model"})},className:`w-full flex items-center justify-between px-2 py-1 rounded text-[11px] border transition-colors ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300 hover:border-zinc-600":"bg-zinc-50 border-zinc-300 text-zinc-800 hover:border-zinc-400"}`,onMouseDown:se=>se.stopPropagation(),children:[o.jsx("span",{className:"truncate font-mono",children:((Wt=en.get((zt=s.settings)==null?void 0:zt.model))==null?void 0:Wt.id)||((Ze=s.settings)==null?void 0:Ze.model)||"gemini-3-pro"}),o.jsx(_i,{size:10,className:"opacity-50 shrink-0 ml-1"})]}),(Ge==null?void 0:Ge.nodeId)===s.id&&Ge.type==="analyze-model"&&o.jsxs("div",{className:`absolute top-full left-0 mt-1 w-64 rounded-lg shadow-xl p-1 z-[60] border flex ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseDown:se=>se.stopPropagation(),onMouseLeave:()=>Gr(null),children:[o.jsx("div",{className:`w-24 border-r pr-1 max-h-80 overflow-y-auto custom-scrollbar ${e==="dark"?"border-zinc-700":"border-zinc-200"}`,children:Object.entries(Ss).filter(([,se])=>se.models.some(q=>q.type==="Chat")).map(([se,q])=>o.jsx("button",{onMouseEnter:()=>Gr(se),className:`w-full text-left px-2 py-1.5 text-[10px] rounded transition-colors ${cr===se?e==="dark"?"bg-zinc-800 text-white":"bg-zinc-100 text-zinc-900":e==="dark"?"text-zinc-400 hover:text-zinc-300":"text-zinc-600 hover:text-zinc-800"}`,children:q.name||se},se))}),o.jsxs("div",{className:"flex-1 pl-1 max-h-80 overflow-y-auto custom-scrollbar",children:[cr&&((jn=Ss[cr])==null?void 0:jn.models.filter(se=>se.type==="Chat").map(se=>{var q;return o.jsxs("button",{onClick:()=>{Nt(s.id,{model:se.id}),Cy(se.id);try{localStorage.setItem("tapnow_last_analyze_model",se.id)}catch{}mn(null),Gr(null)},className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-left transition-colors ${((q=s.settings)==null?void 0:q.model)===se.id?e==="dark"?"bg-blue-600/30 text-blue-300":"bg-blue-100 text-blue-700":e==="dark"?"hover:bg-zinc-800 text-zinc-300":"hover:bg-zinc-100 text-zinc-700"}`,children:[o.jsx("span",{className:"text-[10px] font-medium truncate font-mono",children:se.id}),o.jsx("div",{className:`w-1.5 h-1.5 rounded-full shrink-0 ${Yi(se.id)}`})]},se.id)})),!cr&&o.jsx("div",{className:`text-[10px] px-2 py-3 text-center ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:"  Provider"})]})]})]})]})]}),o.jsx("button",{onClick:()=>{var se;return((se=s.settings)==null?void 0:se.analysisMode)==="auto"?t1(s.id):e1(s.id)},disabled:s.isGenerating||(((Mn=s.settings)==null?void 0:Mn.analysisMode)||"manual")==="manual"&&wn.length===0,className:`w-full px-3 py-2 rounded text-xs font-medium transition-colors flex items-center justify-center gap-2 ${s.isGenerating?"bg-zinc-600 text-zinc-400 cursor-not-allowed":((Bn=s.settings)==null?void 0:Bn.analysisMode)==="auto"?"bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-500 hover:to-indigo-500 text-white shadow-lg":"bg-blue-600 hover:bg-blue-500 text-white"}`,onMouseDown:se=>se.stopPropagation(),children:s.isGenerating?o.jsxs(o.Fragment,{children:[o.jsx(Js,{size:14,className:"animate-spin"}),o.jsx("span",{children:((hs=s.settings)==null?void 0:hs.analysisMode)==="auto"?"AI ...":"..."})]}):o.jsxs(o.Fragment,{children:[o.jsx(Ec,{size:14}),o.jsx("span",{children:((ur=s.settings)==null?void 0:ur.analysisMode)==="auto"?"":""})]})}),s.errorMsg&&o.jsx("div",{className:"text-[10px] text-red-500 px-2 py-1 rounded bg-red-500/10",children:s.errorMsg})]}),((kn=s.settings)==null?void 0:kn.analysisMode)==="auto"&&((R=(fe=s.settings)==null?void 0:fe.analysisResults)==null?void 0:R.length)>0&&o.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar pt-2",children:[((ve=s.settings.voiceoverResults)==null?void 0:ve.length)>0&&o.jsxs("div",{className:`p-2 rounded-lg mb-4 ${e==="dark"?"bg-zinc-700/50 border border-zinc-700":"bg-zinc-50 border border-blue-200"}`,children:[o.jsxs("h4",{className:`text-xs font-semibold mb-2 flex items-center gap-1 ${e==="dark"?"text-white":"text-blue-700"}`,children:[o.jsx(y2,{size:12})," "]}),o.jsx("div",{className:"space-y-1",children:s.settings.voiceoverResults.map((se,q)=>o.jsxs("p",{className:`text-[10px] select-text cursor-text ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,onMouseDown:Ie=>Ie.stopPropagation(),children:[o.jsxs("span",{className:"font-mono text-xs mr-2 opacity-70",children:["[",se.time_range||`${se.time}s`,"]"]}),se.text||o.jsx("span",{className:"text-zinc-400 italic",children:""})]},q))})]}),o.jsxs("h4",{className:`text-xs font-semibold mb-3 flex items-center gap-1 ${e==="dark"?"text-white":"text-zinc-800"}`,children:[o.jsx(um,{size:12}),"  (",s.settings.analysisResults.length," )"]}),o.jsx("div",{className:"space-y-4",children:s.settings.analysisResults.map((se,q)=>{var Ie,Me,$e,at,ct,yt,pe,Xe;return o.jsxs("div",{className:`p-3 rounded-lg ${e==="dark"?"bg-zinc-800 border border-zinc-700":"bg-zinc-50 border border-zinc-200"}`,children:[o.jsxs("h5",{className:`text-sm font-bold mb-2 ${e==="dark"?"text-purple-400":"text-purple-700"}`,children:[" ",se.scene_index||se.scene_id||q+1," ",o.jsxs("span",{className:"text-xs font-normal opacity-70 ml-2",children:["(",se.time_range,")"]})]}),o.jsxs("div",{className:"text-[11px] space-y-1 mb-3",children:[((Me=(Ie=se.keyframes)==null?void 0:Ie[0])==null?void 0:Me.description)&&o.jsxs("p",{className:`select-text cursor-text ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,onMouseDown:Je=>Je.stopPropagation(),children:[o.jsx("span",{className:"font-semibold mr-1",children:"/:"})," ",se.keyframes[0].description]}),((at=($e=se.global_tags)==null?void 0:$e.style)==null?void 0:at[0])&&o.jsxs("p",{className:`select-text cursor-text ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,onMouseDown:Je=>Je.stopPropagation(),children:[o.jsx("span",{className:"font-semibold mr-1",children:"/:"})," ",se.global_tags.style[0]]})]}),o.jsxs("div",{className:"space-y-2",children:[((yt=(ct=se.keyframes)==null?void 0:ct[0])==null?void 0:yt.jimeng_prompt)&&o.jsxs("div",{className:`p-2 rounded ${e==="dark"?"bg-zinc-700 border border-zinc-600":"bg-zinc-50 border border-gray-300"}`,children:[o.jsxs("h6",{className:`text-[10px] font-semibold mb-1 flex items-center gap-1 ${e==="dark"?"text-yellow-300":"text-yellow-700"}`,children:[o.jsx(fm,{size:10}),"  Prompt"]}),o.jsx("p",{className:`text-[10px] whitespace-pre-wrap select-text cursor-text ${e==="dark"?"text-zinc-200":"text-zinc-800"}`,onMouseDown:Je=>Je.stopPropagation(),children:se.keyframes[0].jimeng_prompt}),o.jsxs("button",{onClick:()=>navigator.clipboard.writeText(se.keyframes[0].jimeng_prompt),className:"mt-1 flex items-center text-[9px] text-blue-400 hover:text-blue-300",onMouseDown:Je=>Je.stopPropagation(),children:[o.jsx(dm,{size:10,className:"mr-1"})," "]})]}),((Xe=(pe=se.keyframes)==null?void 0:pe[0])==null?void 0:Xe.mj_prompt)&&o.jsxs("div",{className:`p-2 rounded ${e==="dark"?"bg-zinc-700 border border-zinc-600":"bg-zinc-50 border border-gray-300"}`,children:[o.jsxs("h6",{className:`text-[10px] font-semibold mb-1 flex items-center gap-1 ${e==="dark"?"text-green-300":"text-green-700"}`,children:[o.jsx(fm,{size:10})," MJ Prompt"]}),o.jsx("p",{className:`text-[10px] whitespace-pre-wrap select-text cursor-text ${e==="dark"?"text-zinc-200":"text-zinc-800"}`,onMouseDown:Je=>Je.stopPropagation(),children:se.keyframes[0].mj_prompt}),o.jsxs("button",{onClick:()=>navigator.clipboard.writeText(se.keyframes[0].mj_prompt),className:"mt-1 flex items-center text-[9px] text-blue-400 hover:text-blue-300",onMouseDown:Je=>Je.stopPropagation(),children:[o.jsx(dm,{size:10,className:"mr-1"})," "]})]})]})]},q)})})]}),(((Le=s.settings)==null?void 0:Le.analysisMode)||"manual")==="manual"&&s.analysisResults&&s.analysisResults.length>0?o.jsxs("div",{className:"space-y-3 flex-1 flex flex-col min-h-0",children:[o.jsxs("div",{className:"text-[11px] font-medium text-zinc-700 dark:text-zinc-300 shrink-0",children:[" (",s.analysisResults.length," )"]}),o.jsx("div",{className:"space-y-3 flex-1 overflow-y-auto custom-scrollbar min-h-0",children:s.analysisResults.map((se,q)=>{var yt,pe,Xe,Je,nt,le,Pe;const Ie=_e=>{var ut,wt;const bt=(ut=U.selectedKeyframes)==null?void 0:ut.find(kt=>Math.abs(kt.time-_e)<.1);if(bt)return bt.url;const st=(wt=U.frames)==null?void 0:wt.find(kt=>Math.abs(kt.time-_e)<.1);return(st==null?void 0:st.url)||null},Me=((yt=se.keyframes)==null?void 0:yt.find(_e=>_e.type==="current"))||((pe=se.keyframes)==null?void 0:pe[0]),$e=(Xe=se.keyframes)==null?void 0:Xe.find(_e=>_e.type==="prev"),at=(Je=se.keyframes)==null?void 0:Je.find(_e=>_e.type==="next"),ct=(Me==null?void 0:Me.description)||((le=(nt=se.keyframes)==null?void 0:nt[0])==null?void 0:le.description)||"";return o.jsxs("div",{className:`p-3 rounded-lg border ${e==="dark"?"bg-zinc-800 border-zinc-700":"bg-white border-zinc-300"}`,children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{className:"font-medium text-[11px] text-zinc-800 dark:text-zinc-200",children:[" ",se.scene_index||q+1]}),o.jsx("div",{className:"text-[10px] text-zinc-500",children:se.time_range})]}),o.jsx("div",{className:"text-[10px] text-zinc-600 dark:text-zinc-400 mb-3 line-clamp-2 select-text cursor-text",onMouseDown:_e=>_e.stopPropagation(),children:ct}),o.jsx("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[$e,Me,at].map((_e,bt)=>{if(!_e)return o.jsx("div",{className:"aspect-video bg-zinc-200 dark:bg-zinc-700 rounded"},bt);const st=Ie(_e.time);return o.jsxs("div",{className:"relative aspect-video bg-black rounded overflow-hidden",children:[st?o.jsx("img",{src:st,className:"w-full h-full object-cover",alt:` ${bt+1}`,loading:"lazy"}):o.jsx("div",{className:"w-full h-full flex items-center justify-center text-[8px] text-zinc-500",children:_e.type==="prev"?"":_e.type==="current"?"":""}),o.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-[8px] px-1 py-0.5 text-center",children:[_e.time.toFixed(1),"s"]})]},bt)})}),o.jsx("div",{className:"space-y-2",children:(Pe=se.keyframes)==null?void 0:Pe.map((_e,bt)=>o.jsxs("div",{className:"space-y-1.5",children:[o.jsxs("div",{className:"text-[9px] text-zinc-500",children:[_e.type==="prev"?"":_e.type==="current"?"":""," (",_e.time.toFixed(1),"s)"]}),_e.mj_prompt&&o.jsx("div",{className:`p-2 rounded border ${e==="dark"?"bg-zinc-900 border-zinc-600":"bg-zinc-50 border-zinc-200"}`,children:o.jsxs("div",{className:"flex items-start justify-between gap-2",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"text-[9px] text-zinc-500 mb-1",children:"Midjourney "}),o.jsx("div",{className:"text-[10px] text-zinc-700 dark:text-zinc-300 break-words select-text cursor-text",onMouseDown:st=>st.stopPropagation(),children:_e.mj_prompt})]}),o.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[o.jsx("button",{onClick:async()=>{try{await navigator.clipboard.writeText(_e.mj_prompt),alert("")}catch{alert("")}},className:`p-1 rounded hover:bg-zinc-200 dark:hover:bg-zinc-700 transition-colors ${e==="dark"?"text-zinc-400 hover:text-zinc-300":"text-zinc-500 hover:text-zinc-700"}`,onMouseDown:st=>st.stopPropagation(),title:"",children:o.jsx(To,{size:12})}),o.jsx("button",{onClick:()=>{const st=un(s.x+s.width+100,s.y+s.height/2),ut=`node-${Date.now()}`,wt={id:ut,type:"gen-image",x:st.x-180,y:st.y-170,width:360,height:340,settings:{model:"mj-v6",prompt:_e.mj_prompt,ratio:"Auto",resolution:"Auto"}};r(kt=>[...kt,wt]),setTimeout(()=>{const kt=un(s.x+s.width+200,s.y+s.height/2),Vt=`node-${Date.now()+1}`,Tt={id:Vt,type:"preview",x:kt.x-160,y:kt.y-130,width:320,height:260};r(Qt=>[...Qt,Tt]),a(Qt=>[...Qt,{id:`conn-${Date.now()}`,from:ut,to:Vt}])},50)},className:"p-1 rounded hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors text-blue-600 dark:text-blue-400",onMouseDown:st=>st.stopPropagation(),title:"",children:o.jsx(xm,{size:12})})]})]})}),_e.jimeng_prompt&&o.jsx("div",{className:`p-2 rounded border ${e==="dark"?"bg-zinc-900 border-zinc-600":"bg-zinc-50 border-zinc-200"}`,children:o.jsxs("div",{className:"flex items-start justify-between gap-2",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"text-[9px] text-zinc-500 mb-1",children:""}),o.jsx("div",{className:"text-[10px] text-zinc-700 dark:text-zinc-300 break-words select-text cursor-text",onMouseDown:st=>st.stopPropagation(),children:_e.jimeng_prompt})]}),o.jsx("button",{onClick:async()=>{try{await navigator.clipboard.writeText(_e.jimeng_prompt),alert("")}catch{alert("")}},className:`p-1 rounded hover:bg-zinc-200 dark:hover:bg-zinc-700 transition-colors ${e==="dark"?"text-zinc-400 hover:text-zinc-300":"text-zinc-500 hover:text-zinc-700"}`,onMouseDown:st=>st.stopPropagation(),title:"",children:o.jsx(To,{size:12})})]})})]},bt))}),se.global_tags&&o.jsxs("div",{className:"mt-2 pt-2 border-t border-zinc-300 dark:border-zinc-700",children:[o.jsx("div",{className:"text-[9px] text-zinc-500 mb-1",children:""}),o.jsx("div",{className:"flex flex-wrap gap-1",children:Object.entries(se.global_tags).map(([_e,bt])=>Array.isArray(bt)&&bt.map((st,ut)=>o.jsx("span",{className:"text-[8px] px-1.5 py-0.5 rounded bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300",children:st},`${_e}-${ut}`)))})]})]},q)})})]}):null]})})()})]}),s.type==="storyboard-node"&&(()=>{var Ne,ht,wn,be,et,xt,We,mt,zt,Wt,Ze,jn,Mn,Bn,hs,ur,kn,fe;const U=(R,ve)=>{const Le=R.clipboardData.items;for(let se=0;se<Le.length;se++)if(Le[se].type.indexOf("image")!==-1){R.preventDefault(),R.stopPropagation();const q=Le[se].getAsFile(),Ie=new FileReader;Ie.onload=Me=>Kt(s.id,ve,{image_url:Me.target.result}),Ie.readAsDataURL(q);return}};return o.jsx("div",{className:"flex h-full",children:o.jsxs("div",{className:`flex flex-col h-full rounded-xl overflow-hidden pointer-events-auto transition-colors flex-1 ${e==="dark"?"bg-zinc-950 border border-zinc-800":"bg-white border border-zinc-300 shadow-sm"}`,onMouseEnter:()=>da(!0),onMouseLeave:()=>da(!1),children:[o.jsxs("div",{className:`px-4 py-3 border-b flex justify-between items-center shrink-0 flex-nowrap overflow-x-auto no-scrollbar ${e==="dark"?"bg-zinc-900 border-zinc-800":"bg-zinc-50 border-zinc-200"}`,children:[o.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[o.jsx(Ya,{size:16,className:"text-purple-500"}),o.jsx("span",{className:`font-bold text-xs ${e==="dark"?"text-zinc-200":"text-zinc-800"}`,children:""}),o.jsx("span",{className:`text-xs ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:"/"}),o.jsx("input",{type:"text",value:((Ne=s.settings)==null?void 0:Ne.projectTitle)||"",onChange:R=>Nt(s.id,{projectTitle:R.target.value}),placeholder:"",className:`font-bold text-xs bg-transparent border-b border-transparent hover:border-zinc-500 focus:border-blue-500 outline-none w-32 transition-colors ${e==="dark"?"text-zinc-200 placeholder-zinc-500":"text-zinc-800 placeholder-zinc-400"}`,onMouseDown:R=>R.stopPropagation(),onClick:R=>R.stopPropagation(),onKeyDown:R=>R.stopPropagation()}),o.jsxs("div",{className:`flex items-center ml-2 p-0.5 rounded-full ${e==="dark"?"bg-zinc-800":"bg-zinc-200"}`,children:[o.jsx("button",{onClick:R=>{var Ie,Me;R.stopPropagation();const ve="image",Le=localStorage.getItem("tapnow_last_image_model")||((Ie=ae.find($e=>$e.type==="Image"))==null?void 0:Ie.id)||"",q=(((Me=s.settings)==null?void 0:Me.shots)||[]).map($e=>{const at=ae.find(ct=>ct.id===$e.model);return!at||at.type==="Video"?{...$e,model:Le,duration:void 0}:$e});Nt(s.id,{mode:ve,shots:q})},className:`text-[10px] px-2 py-0.5 rounded-full transition-all ${(((ht=s.settings)==null?void 0:ht.mode)||"video")==="image"?"bg-blue-500 text-white shadow-sm":e==="dark"?"text-zinc-400 hover:text-zinc-200":"text-zinc-500 hover:text-zinc-700"}`,onMouseDown:R=>R.stopPropagation(),title:"",children:""}),o.jsx("button",{onClick:R=>{var Ie,Me;R.stopPropagation();const ve="video",Le=localStorage.getItem("tapnow_last_video_model")||((Ie=ae.find($e=>$e.type==="Video"))==null?void 0:Ie.id)||"",q=(((Me=s.settings)==null?void 0:Me.shots)||[]).map($e=>{const at=ae.find(ct=>ct.id===$e.model);return!at||at.type==="Image"?{...$e,model:Le,duration:Eo(Le)}:$e});Nt(s.id,{mode:ve,shots:q})},className:`text-[10px] px-2 py-0.5 rounded-full transition-all ${(((wn=s.settings)==null?void 0:wn.mode)||"video")==="video"?"bg-green-500 text-white shadow-sm":e==="dark"?"text-zinc-400 hover:text-zinc-200":"text-zinc-500 hover:text-zinc-700"}`,onMouseDown:R=>R.stopPropagation(),title:"",children:""})]})]}),o.jsxs("div",{className:"flex items-center gap-2 relative z-10 shrink-0",children:[o.jsx("button",{onClick:R=>{R.stopPropagation(),confirm("")&&Nt(s.id,{shots:[]})},className:"p-1 hover:bg-red-100 hover:text-red-500 rounded text-zinc-400 transition-colors",title:"",children:o.jsx(Ms,{size:14})}),o.jsxs("button",{onClick:()=>{var ve,Le;const R=Ca(s.id);if(R.length>0){const se=R.join(`
`),q=/#\s*(\d+)\s*([^#]*)|\s*(\d+)\s*\s*([^#]*)/g,Ie=[];let Me;for(;(Me=q.exec(se))!==null;){const $e=parseInt(Me[1]||Me[3]),at=(Me[2]||Me[4]||"").trim();at&&Ie.push({num:$e,text:at})}if(Ie.length===0&&se.split(`
`).filter(at=>at.trim()).forEach((at,ct)=>{const yt=at.match(/^(\d+)[.\s]+(.*)/);yt?Ie.push({num:parseInt(yt[1]),text:yt[2].trim()}):Ie.push({num:ct+1,text:at.trim()})}),Ie.length>0){const $e=((ve=s.settings)==null?void 0:ve.shots)||[],at=[...$e];Ie.forEach((ct,yt)=>{yt<$e.length?at[yt]={...at[yt],prompt:ct.text,description:ct.text}:at.push({id:Date.now()+Math.random()+yt,prompt:ct.text,description:ct.text,model:localStorage.getItem("tapnow_last_video_model")||"",duration:5,status:"draft",outputEnabled:!0,selectedImageIndex:0})}),Nt(s.id,{shots:at})}else alert(" (: #1 )")}else Nt(s.id,{scriptExpanded:!((Le=s.settings)!=null&&Le.scriptExpanded)})},className:`text-xs px-2 py-1 rounded transition-colors flex items-center gap-1 ${e==="dark"?"bg-purple-600 hover:bg-purple-500 text-white":"bg-purple-500 hover:bg-purple-400 text-white"}`,onMouseDown:R=>R.stopPropagation(),title:Ca(s.id).length>0?"":"",children:[o.jsx(Qr,{size:12}),o.jsx("span",{className:"whitespace-nowrap",children:""})]}),(()=>{var Le;const R=Sa(s.id),ve=((Le=R==null?void 0:R.selectedKeyframes)==null?void 0:Le.length)||0;return o.jsxs("button",{onClick:async()=>{var $e;if(!R||ve===0){alert("");return}const se=R.selectedKeyframes,q=(($e=s.settings)==null?void 0:$e.shots)||[],Ie=Math.max(q.length,se.length),Me=Array.from({length:Ie},(at,ct)=>{var yt,pe,Xe,Je,nt,le,Pe,_e,bt;return{id:((yt=q[ct])==null?void 0:yt.id)||`shot-${Date.now()}-${ct}`,...q[ct],prompt:((pe=q[ct])==null?void 0:pe.prompt)??"",description:((Xe=q[ct])==null?void 0:Xe.description)??"",model:((Je=q[ct])==null?void 0:Je.model)||localStorage.getItem("tapnow_last_video_model")||"",image_url:((nt=se[ct])==null?void 0:nt.url)??((le=q[ct])==null?void 0:le.image_url)??"",image_filename:((Pe=se[ct])==null?void 0:Pe.filename)||((_e=q[ct])==null?void 0:_e.image_filename)||"",status:((bt=q[ct])==null?void 0:bt.status)||"draft"}});if(me(),window.LocalImageManager){for(let at of Me)if(at.image_url&&(at.image_url.startsWith("file://")||at.image_url.startsWith("img_"))){const yt=at.image_url.startsWith("img_")?at.image_url:at.imgId||at.image_filename;if(yt)try{const pe=await window.LocalImageManager.getImage(yt);pe&&(at.image_url=URL.createObjectURL(pe))}catch(pe){console.error("[KeyframeImport] Failed to load local image:",yt,pe)}}}Nt(s.id,{shots:Me}),console.log(`[KeyframeImport] Imported ${se.length} images, merged to ${Me.length} shots`)},className:`text-xs px-2 py-1 rounded transition-colors flex items-center gap-1 ${ve>0?"bg-blue-600 hover:bg-blue-500 text-white":e==="dark"?"bg-zinc-700 text-zinc-400 cursor-not-allowed":"bg-zinc-200 text-zinc-500 cursor-not-allowed"}`,onMouseDown:se=>se.stopPropagation(),disabled:ve===0,title:ve>0?` ${ve} `:"",children:[o.jsx($o,{size:12}),o.jsxs("span",{className:"whitespace-nowrap",children:["",ve>0?` (${ve})`:""]})]})})(),o.jsxs("div",{className:`flex items-center gap-1 border-l pl-2 ml-1 ${e==="dark"?"border-zinc-700":"border-zinc-300"}`,children:[o.jsx("input",{type:"number",min:"0",max:"20",value:J,onChange:R=>ue(Math.max(0,parseInt(R.target.value)||0)),className:`w-8 text-center text-xs rounded border outline-none py-0.5 ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300":"bg-white border-zinc-300"}`,title:" (0=)"}),o.jsx("button",{onClick:()=>{var se,q;const R=((se=s.settings)==null?void 0:se.mode)||"video",ve=(((q=s.settings)==null?void 0:q.shots)||[]).filter(Ie=>Ie.status!=="done"&&Ie.status!=="generating");if(ve.length===0){alert("");return}const Le=ve.map(Ie=>({nodeId:s.id,shotId:Ie.id,retryCount:0,mode:R}));L(Ie=>[...Ie,...Le]),console.log(`[Batch ${R}]  ${Le.length} : ${J}`)},className:`p-1 rounded transition-colors ${(((be=s.settings)==null?void 0:be.mode)||"video")==="image"?e==="dark"?"bg-blue-600 hover:bg-blue-500 text-white":"bg-blue-500 hover:bg-blue-400 text-white":e==="dark"?"bg-yellow-600 hover:bg-yellow-500 text-white":"bg-yellow-500 hover:bg-yellow-400 text-white"}`,title:`${(((et=s.settings)==null?void 0:et.mode)||"video")==="image"?"":""}`,children:o.jsxs("div",{className:"flex items-center gap-1",children:[(((xt=s.settings)==null?void 0:xt.mode)||"video")==="image"?o.jsx($o,{size:12}):o.jsx(wm,{size:12,fill:"currentColor"}),o.jsx("span",{className:"text-[10px] font-medium whitespace-nowrap",children:""})]})}),o.jsx("button",{onClick:async()=>{var se,q,Ie;const R=((se=s.settings)==null?void 0:se.mode)||"video",ve=(((q=s.settings)==null?void 0:q.shots)||[]).filter(Me=>R==="image"?Me.output_url:Me.video_url);if(ve.length===0){alert(`${R==="image"?"":""}`);return}const Le=((Ie=s.settings)==null?void 0:Ie.projectTitle)||"";for(let Me=0;Me<ve.length;Me++){const $e=ve[Me],at=R==="image"?$e.output_url:$e.video_url,ct=R==="image"?"png":"mp4",yt=`${Le}_${Me+1}.${ct}`;try{const Xe=await(await fetch(at)).blob(),Je=document.createElement("a");Je.href=URL.createObjectURL(Xe),Je.download=yt,Je.click(),URL.revokeObjectURL(Je.href)}catch(pe){console.error("Download failed:",pe)}await new Promise(pe=>setTimeout(pe,300))}},className:`p-1 rounded transition-colors ${e==="dark"?"bg-zinc-700 hover:bg-zinc-600 text-zinc-300":"bg-zinc-200 hover:bg-zinc-300 text-zinc-600"}`,title:"",onMouseDown:R=>R.stopPropagation(),children:o.jsx(Ka,{size:12})}),o.jsx("button",{onClick:R=>{R.stopPropagation(),r(ve=>ve.map(Le=>{var se;if(Le.id===s.id){const q=(se=Le.settings)==null?void 0:se.showOutputPreview,Ie=q?Math.max(380,Le.width-160):Le.width+160;return{...Le,width:Ie,settings:{...Le.settings,showOutputPreview:!q}}}return Le}))},className:`p-1 rounded transition-colors ${(We=s.settings)!=null&&We.showOutputPreview?"bg-blue-500 text-white":e==="dark"?"bg-zinc-700 hover:bg-zinc-600 text-zinc-400":"bg-zinc-200 hover:bg-zinc-300 text-zinc-500"}`,title:(mt=s.settings)!=null&&mt.showOutputPreview?"":"",onMouseDown:R=>R.stopPropagation(),children:o.jsx(nl,{size:12,className:`transition-transform ${(zt=s.settings)!=null&&zt.showOutputPreview?"rotate-90":""}`})})]})]}),((Wt=s.settings)==null?void 0:Wt.showOutputPreview)&&o.jsx("div",{className:"w-[160px] shrink-0 flex items-center justify-center gap-2 ml-1 ",children:(((Ze=s.settings)==null?void 0:Ze.mode)||"video")==="image"?o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:R=>{var se;R.stopPropagation();const ve=((se=s.settings)==null?void 0:se.shots)||[],Le=ve.length>0&&ve.every(q=>q.outputEnabled);Nt(s.id,{shots:ve.map(q=>({...q,outputEnabled:!Le}))})},className:`text-[10px] px-2 py-1 rounded transition-colors whitespace-nowrap ${e==="dark"?"bg-zinc-700 hover:bg-zinc-600 text-zinc-300":"bg-zinc-200 hover:bg-zinc-300 text-zinc-600"}`,onMouseDown:R=>R.stopPropagation(),title:"",children:(((jn=s.settings)==null?void 0:jn.shots)||[]).every(R=>R.outputEnabled)?"":""}),o.jsxs("button",{onClick:R=>{var se;R.stopPropagation();const ve=((se=s.settings)==null?void 0:se.shots)||[],Le=ve.some(q=>q.selectedImageIndex>=0);Nt(s.id,{shots:ve.map(q=>({...q,selectedImageIndex:q.outputEnabled?q.selectedImageIndex:Le?-1:0}))})},className:`text-[10px] px-2 py-1 rounded transition-colors flex items-center gap-1 whitespace-nowrap ${e==="dark"?"bg-blue-600 hover:bg-blue-500 text-white":"bg-blue-500 hover:bg-blue-400 text-white"}`,onMouseDown:R=>R.stopPropagation(),title:"/",children:[o.jsx($o,{size:10}),o.jsx("span",{children:(((Mn=s.settings)==null?void 0:Mn.shots)||[]).some(R=>R.selectedImageIndex>=0)?"":""})]})]}):o.jsx("button",{onClick:R=>{var se;R.stopPropagation();const ve=((se=s.settings)==null?void 0:se.shots)||[],Le=ve.length>0&&ve.every(q=>q.outputEnabled);Nt(s.id,{shots:ve.map(q=>({...q,outputEnabled:!Le}))})},className:`text-[10px] px-2 py-1 rounded transition-colors whitespace-nowrap ${e==="dark"?"bg-zinc-700 hover:bg-zinc-600 text-zinc-300":"bg-zinc-200 hover:bg-zinc-300 text-zinc-600"}`,onMouseDown:R=>R.stopPropagation(),title:"",children:(((Bn=s.settings)==null?void 0:Bn.shots)||[]).every(R=>R.outputEnabled)?"":""})})]}),((hs=s.settings)==null?void 0:hs.scriptExpanded)&&o.jsxs("div",{className:`border-b shrink-0 p-3 space-y-2 ${e==="dark"?"bg-zinc-900/30 border-zinc-800":"bg-zinc-50/50 border-zinc-200"}`,children:[o.jsx("textarea",{value:((ur=s.settings)==null?void 0:ur.scriptText)||"",onChange:R=>Nt(s.id,{scriptText:R.target.value}),placeholder:": #1  #2  ...",className:`w-full h-24 p-2 text-xs rounded border resize-none ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200 placeholder-zinc-500":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`,onMouseDown:R=>R.stopPropagation()}),o.jsxs("div",{className:"flex gap-2 flex-wrap",children:[o.jsx("button",{onClick:()=>{var ct,yt;const ve=Ca(s.id).join(`
`),Le=((ct=s.settings)==null?void 0:ct.scriptText)||"",se=ve||Le;console.log("[ScriptSplitter] Text source:",ve?"connected node":"internal","length:",se.length);const q=[],Ie=/#\s*(\d+)\s*([^#]*)|\s*(\d+)\s*\s*([^#]*)/g;let Me;for(;(Me=Ie.exec(se))!==null;){const pe=parseInt(Me[1]||Me[3]),Xe=(Me[2]||Me[4]||"").trim();Xe&&q.push({num:pe,text:Xe})}if(q.length===0&&se.split(`
`).filter(Xe=>Xe.trim()).forEach((Xe,Je)=>{const nt=Xe.match(/^(\d+)[.\s]+(.*)/);nt?q.push({num:parseInt(nt[1]),text:nt[2].trim()}):q.push({num:Je+1,text:Xe.trim()})}),q.length===0){alert(": #1  #2 ");return}q.sort((pe,Xe)=>pe.num-Xe.num);const $e=((yt=s.settings)==null?void 0:yt.shots)||[],at=[...$e];q.forEach((pe,Xe)=>{Xe<$e.length?at[Xe]={...at[Xe],prompt:pe.text,description:pe.text}:at.push({id:Date.now()+Math.random()+Xe,prompt:pe.text,description:pe.text,model:localStorage.getItem("tapnow_last_video_model")||"",duration:5,status:"draft",outputEnabled:!0,selectedImageIndex:0})}),Nt(s.id,{shots:at,scriptExpanded:!1}),console.log("[ScriptSplitter] Merged/Generated shots from text")},className:"px-3 py-1.5 text-xs bg-purple-600 text-white rounded hover:bg-purple-500 transition-colors",onMouseDown:R=>R.stopPropagation(),children:""}),o.jsx("span",{className:`text-[10px] self-center ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:" #1 #2 "})]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-3 space-y-3 min-h-0 bg-opacity-50",onWheel:R=>{R.stopPropagation()},children:((fe=(kn=s.settings)==null?void 0:kn.shots)==null?void 0:fe.length)>0?s.settings.shots.map((R,ve)=>{var se,q,Ie,Me,$e,at,ct,yt;const Le=(Or==null?void 0:Or.nodeId)===s.id&&(Or==null?void 0:Or.shotId)===R.id;return o.jsxs(bu.Fragment,{children:[o.jsxs("div",{className:"relative h-2 -mt-1 -mb-1 z-10 group/insert flex items-center justify-center cursor-pointer hover:h-6 transition-all",onClick:pe=>{pe.stopPropagation();const Xe=[...s.settings.shots||[]];Xe.splice(ve,0,{id:Date.now()+Math.random(),prompt:"",description:"",model:localStorage.getItem("tapnow_last_video_model")||"",duration:5,status:"draft",outputEnabled:!0,selectedImageIndex:0}),Nt(s.id,{shots:Xe})},title:"",children:[o.jsx("div",{className:"w-full h-[2px] bg-blue-500 opacity-0 group-hover/insert:opacity-100 transition-opacity"}),o.jsx("div",{className:"absolute w-5 h-5 rounded-full bg-blue-600 text-white flex items-center justify-center opacity-0 group-hover/insert:opacity-100 transition-opacity shadow-sm scale-75 group-hover/insert:scale-100",children:o.jsx(Ni,{size:12})})]}),o.jsxs("div",{className:"flex items-stretch gap-2 w-full",children:[o.jsxs("div",{tabIndex:0,onClick:pe=>{pe.stopPropagation(),fa({nodeId:s.id,shotId:R.id}),pe.currentTarget.focus()},onPaste:pe=>U(pe,R.id),className:`flex-1 flex gap-3 p-3 rounded-lg border transition-all group/shot cursor-pointer outline-none focus:ring-2 focus:ring-blue-500/50 ${Le?"border-blue-500 ring-1 ring-blue-500 bg-blue-500/5 z-10":e==="dark"?"bg-zinc-900/50 border-zinc-800 hover:border-zinc-600":"bg-white border-zinc-200 hover:border-blue-300 hover:shadow-md"}`,children:[o.jsx("div",{className:`font-mono text-sm w-6 shrink-0 flex items-start pt-1 font-bold ${e==="dark"?"text-zinc-600":"text-zinc-400"}`,children:ve+1}),o.jsx("div",{className:"flex flex-col gap-2 shrink-0 mr-2 h-full min-h-[14rem] w-52",children:(()=>{var st;const Xe=(((st=s.settings)==null?void 0:st.mode)||"video")==="video",Je=R.useFirstLastFrame,nt=R.activeInput||"first",le=R.useMultiRef,Pe=e==="dark"?"border-zinc-800":"border-zinc-300",_e=e==="dark"?"bg-black":"bg-zinc-50",bt=(ut,wt)=>{var Tt;const kt=(Tt=ut.target.files)==null?void 0:Tt[0];if(!kt)return;const Vt=new FileReader;Vt.onload=Qt=>{Kt(s.id,R.id,{[wt]:Qt.target.result})},Vt.readAsDataURL(kt),ut.target.value=""};if(Xe){const ut=(wt,kt)=>{const Vt=wt==="first"?"image_url":"lastFrame",Tt=R[Vt],Qt=wt==="first"?"":"",xr=kt?"flex-1 h-full":"w-14 h-full shrink-0";return o.jsxs("div",{className:`relative rounded-lg border overflow-hidden group ${xr} ${_e} ${Pe} flex flex-col items-center justify-center cursor-pointer hover:border-blue-500 transition-all`,onClick:sn=>{sn.stopPropagation(),kt||Kt(s.id,R.id,{activeInput:wt})},children:[Tt?o.jsx(Hn,{src:Tt,className:`w-full h-full object-cover ${kt?"":"opacity-60 hover:opacity-100"}`}):o.jsxs("div",{className:"flex flex-col items-center gap-1 text-zinc-500",children:[o.jsx(Mo,{size:kt?20:14}),kt&&o.jsxs("span",{className:"text-[10px]",children:["",Qt]})]}),o.jsx("div",{className:"absolute top-0 left-0 bg-black/60 text-white text-[9px] px-1.5 py-0.5 rounded-br z-20 backdrop-blur-md pointer-events-none",children:Qt}),Tt&&o.jsx("button",{onClick:sn=>{sn.stopPropagation(),Pn({url:Tt,type:"image"})},className:"absolute bottom-1 left-1 p-1 rounded-full bg-black/60 text-white hover:bg-blue-500 opacity-0 group-hover:opacity-100 transition-opacity z-30",title:"",children:o.jsx(Is,{size:10})}),kt&&o.jsxs(o.Fragment,{children:[Tt&&o.jsx("button",{onClick:sn=>{sn.stopPropagation(),Kt(s.id,R.id,{[Vt]:""})},className:"absolute top-1 right-1 p-1 rounded-full bg-black/60 text-white hover:bg-red-500 opacity-0 group-hover:opacity-100 transition-opacity z-30",children:o.jsx(es,{size:12})}),o.jsxs("label",{className:"absolute inset-0 z-10 flex items-center justify-center cursor-pointer opacity-0 hover:opacity-100",children:[o.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:sn=>bt(sn,Vt)}),o.jsx("div",{className:"p-2 rounded-full bg-black/50 text-white",children:o.jsx(Mo,{size:16})})]}),o.jsx("div",{className:"absolute bottom-1 right-1 p-1 rounded bg-black/40 hover:bg-blue-500 text-white transition-colors cursor-pointer z-30",onClick:sn=>{sn.stopPropagation(),Kt(s.id,R.id,{useFirstLastFrame:!Je,activeInput:Je?"first":"last"})},title:"",children:o.jsx(Hf,{size:12})}),Tt&&R.image_filename&&o.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-[9px] pl-8 pr-8 py-0.5 truncate opacity-0 group-hover:opacity-100 transition-opacity z-20",title:R.image_filename,children:R.image_filename})]})]},wt)};return Je?o.jsxs("div",{className:"flex flex-row gap-2 h-full w-full",children:[ut("first",nt==="first"),ut("last",nt==="last")]}):ut("first",!0)}else{const ut=R.referenceImages&&R.referenceImages.length>0?R.referenceImages:R.image_url?[R.image_url]:[],wt=ut[0]||"";return o.jsxs("div",{className:"flex flex-col gap-2 h-full w-full",children:[o.jsxs("div",{className:`relative flex-1 rounded-lg border overflow-hidden group ${_e} ${Pe} flex flex-col items-center justify-center`,children:[wt?o.jsxs(o.Fragment,{children:[o.jsx(Hn,{src:wt,className:"w-full h-full object-cover"}),o.jsx("button",{onClick:kt=>{kt.stopPropagation(),Pn({url:wt,type:"image"})},className:"absolute bottom-1 left-1 p-1 rounded-full bg-black/60 text-white hover:bg-blue-500 opacity-0 group-hover:opacity-100 transition-opacity z-30",title:"",children:o.jsx(Is,{size:12})}),R.image_filename&&o.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-[9px] px-8 py-0.5 truncate opacity-0 group-hover:opacity-100 transition-opacity z-20",title:R.image_filename,children:R.image_filename}),o.jsx("button",{onClick:kt=>{kt.stopPropagation(),Kt(s.id,R.id,{image_url:"",image_filename:"",referenceImages:[]})},className:"absolute top-1 right-1 p-1 rounded-full bg-black/60 text-white hover:bg-red-500 opacity-0 group-hover:opacity-100 transition-opacity z-30",title:"",children:o.jsx(es,{size:12})})]}):o.jsxs("div",{className:"flex flex-col items-center gap-1 text-zinc-500",children:[o.jsx(Mo,{size:20}),o.jsx("span",{className:"text-[10px]",children:""})]}),o.jsxs("label",{className:`absolute inset-0 z-10 flex items-center justify-center cursor-pointer ${wt?"opacity-0 hover:opacity-100":"opacity-100"}`,children:[o.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:kt=>{var Tt;const Vt=(Tt=kt.target.files)==null?void 0:Tt[0];if(Vt){const Qt=new FileReader;Qt.onload=xr=>{Kt(s.id,R.id,{image_url:xr.target.result,image_filename:Vt.name})},Qt.readAsDataURL(Vt)}}}),wt&&o.jsx("div",{className:"p-2 rounded-full bg-black/50 text-white",children:o.jsx(Mo,{size:16})})]}),o.jsx("div",{className:`absolute bottom-1 right-1 p-1 rounded bg-black/40 hover:bg-blue-500 text-white transition-colors cursor-pointer z-30 ${le?"text-blue-400 bg-blue-500/30":"text-zinc-400"}`,onClick:kt=>{kt.stopPropagation(),Kt(s.id,R.id,{useMultiRef:!le})},title:"",children:o.jsx(Ya,{size:12})})]}),le&&o.jsxs("div",{className:"flex gap-2 h-14 shrink-0 overflow-x-auto no-scrollbar items-center",children:[ut.slice(1).map((kt,Vt)=>o.jsxs("div",{className:`relative w-12 h-14 shrink-0 rounded border overflow-hidden cursor-pointer hover:border-blue-500 transition-all ${Pe} ${_e}`,onClick:Tt=>{Tt.stopPropagation();const Qt=[...ut],xr=Vt+1;[Qt[0],Qt[xr]]=[Qt[xr],Qt[0]],Kt(s.id,R.id,{referenceImages:Qt,image_url:Qt[0]})},children:[o.jsx(Hn,{src:kt,className:"w-full h-full object-cover"}),o.jsx("div",{className:"absolute top-0 left-0 bg-black/50 text-white text-[8px] px-1 backdrop-blur-sm",children:Vt+2})]},Vt+1)),ut.length<4&&o.jsxs("label",{className:`w-12 h-14 shrink-0 rounded border border-dashed flex items-center justify-center cursor-pointer hover:bg-zinc-100 dark:hover:bg-zinc-800 ${Pe} text-zinc-400 hover:text-blue-500 hover:border-blue-500 transition-colors`,children:[o.jsx(Ni,{size:16}),o.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:kt=>{var Tt;const Vt=(Tt=kt.target.files)==null?void 0:Tt[0];if(Vt){const Qt=new FileReader;Qt.onload=xr=>{Kt(s.id,R.id,{referenceImages:[...ut,xr.target.result]})},Qt.readAsDataURL(Vt)}}})]})]})]})}})()}),o.jsxs("div",{className:"flex-1 min-w-0 flex flex-col gap-2",children:[o.jsxs("div",{className:"flex gap-2 items-center flex-wrap",children:[o.jsxs("div",{className:"relative",children:[o.jsxs("button",{onClick:pe=>{pe.stopPropagation(),mn((Ge==null?void 0:Ge.nodeId)===s.id&&Ge.type==="shot-model"&&Ge.shotId===R.id?null:{nodeId:s.id,type:"shot-model",shotId:R.id})},onMouseDown:pe=>pe.stopPropagation(),className:`flex items-center justify-between gap-1 px-2 py-1 rounded border text-xs transition-colors min-w-[100px] ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200 hover:border-zinc-600":"bg-white border-zinc-300 text-zinc-800 hover:border-zinc-400"}`,children:[o.jsx("span",{className:"truncate font-mono text-[10px]",children:(()=>{var Je,nt,le;const Xe=(((Je=s.settings)==null?void 0:Je.mode)||"video")==="image"?"tapnow_last_image_model":"tapnow_last_video_model";return((nt=en.get(R.model))==null?void 0:nt.id)||R.model||((le=en.get(localStorage.getItem(Xe)))==null?void 0:le.id)||""})()}),o.jsx(_i,{size:10,className:"opacity-50 shrink-0"})]}),(Ge==null?void 0:Ge.nodeId)===s.id&&Ge.type==="shot-model"&&Ge.shotId===R.id&&o.jsxs("div",{className:`absolute top-full left-0 mt-1 w-64 rounded-lg shadow-xl p-1 z-[60] border flex ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseDown:pe=>pe.stopPropagation(),onMouseLeave:()=>Gr(null),children:[o.jsx("div",{className:`w-24 border-r pr-1 max-h-80 overflow-y-auto custom-scrollbar ${e==="dark"?"border-zinc-700":"border-zinc-200"}`,children:(()=>{var Je;const Xe=(((Je=s.settings)==null?void 0:Je.mode)||"video")==="image"?"Image":"Video";return Object.entries(Ss).filter(([,nt])=>nt.models.some(le=>le.type===Xe)).map(([nt,le])=>o.jsx("button",{onMouseEnter:()=>Gr(nt),className:`w-full text-left px-2 py-1.5 text-[10px] rounded transition-colors ${cr===nt?e==="dark"?"bg-zinc-800 text-white":"bg-zinc-100 text-zinc-900":e==="dark"?"text-zinc-400 hover:text-zinc-300":"text-zinc-600 hover:text-zinc-800"}`,children:le.name||nt},nt))})()}),o.jsxs("div",{className:"flex-1 pl-1 max-h-80 overflow-y-auto custom-scrollbar",children:[(()=>{var Je,nt;const Xe=(((Je=s.settings)==null?void 0:Je.mode)||"video")==="image"?"Image":"Video";return cr&&((nt=Ss[cr])==null?void 0:nt.models.filter(le=>le.type===Xe).map(le=>o.jsxs("button",{onClick:()=>{var st;const Pe=((st=s.settings)==null?void 0:st.mode)||"video",_e=Eo(le.id);Kt(s.id,R.id,{model:le.id,duration:R.duration||_e});const bt=Pe==="image"?"tapnow_last_image_model":"tapnow_last_video_model";localStorage.setItem(bt,le.id),Pe==="image"?rh(le.id):ih(le.id),mn(null),Gr(null)},className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-left transition-colors ${R.model===le.id?e==="dark"?"bg-blue-600/30 text-blue-300":"bg-blue-100 text-blue-700":e==="dark"?"hover:bg-zinc-800 text-zinc-300":"hover:bg-zinc-100 text-zinc-700"}`,children:[o.jsx("span",{className:"text-[10px] font-medium truncate font-mono",children:le.id}),o.jsx("div",{className:`w-1.5 h-1.5 rounded-full shrink-0 ${Yi(le.id)}`})]},le.id)))})(),!cr&&o.jsx("div",{className:`text-[10px] px-2 py-3 text-center ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:"  Provider"})]})]})]}),(()=>{var Je;const pe=((Je=s.settings)==null?void 0:Je.mode)||"video",Xe=pe==="video"?Im(R.model):Wf;return o.jsx("select",{value:R.ratio||(pe==="video"?"16:9":"1:1"),onChange:nt=>Kt(s.id,R.id,{ratio:nt.target.value}),onClick:nt=>nt.stopPropagation(),onMouseDown:nt=>nt.stopPropagation(),className:`text-xs px-2 py-1 rounded border outline-none transition-colors ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200 hover:border-zinc-600":"bg-white border-zinc-300 text-zinc-800 hover:border-zinc-400"}`,children:Xe.map(nt=>o.jsx("option",{value:nt,children:nt},nt))})})(),(()=>{var Xe,Je,nt,le;if((((Xe=s.settings)==null?void 0:Xe.mode)||"video")==="video")return(Je=R.model)!=null&&Je.includes("jimeng")||(le=(nt=en.get(R.model))==null?void 0:nt.modelName)!=null&&le.includes("jimeng")?o.jsxs("select",{value:R.resolution||"720p",onChange:Pe=>Kt(s.id,R.id,{resolution:Pe.target.value}),onClick:Pe=>Pe.stopPropagation(),onMouseDown:Pe=>Pe.stopPropagation(),className:`text-xs px-2 py-1 rounded border outline-none transition-colors ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200 hover:border-zinc-600":"bg-white border-zinc-300 text-zinc-800 hover:border-zinc-400"}`,title:"",children:[o.jsx("option",{value:"720p",children:"720p"}),o.jsx("option",{value:"1080p",children:"1080p"})]}):null;{const Pe=Fd(R.model);return o.jsx("select",{value:R.resolution||"Auto",onChange:_e=>Kt(s.id,R.id,{resolution:_e.target.value}),onClick:_e=>_e.stopPropagation(),onMouseDown:_e=>_e.stopPropagation(),className:`text-xs px-2 py-1 rounded border outline-none transition-colors ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200 hover:border-zinc-600":"bg-white border-zinc-300 text-zinc-800 hover:border-zinc-400"}`,title:"",children:Pe.map(_e=>o.jsx("option",{value:_e,children:_e},_e))})}})(),(((se=s.settings)==null?void 0:se.mode)||"video")==="video"&&(()=>{var le,Pe;const pe=R.model||((le=ae.find(_e=>_e.type==="Video"&&_e.id==="sora-2"))==null?void 0:le.id)||((Pe=ae.find(_e=>_e.type==="Video"))==null?void 0:Pe.id)||"",Xe=ae.find(_e=>_e.id===pe),Je=(Xe==null?void 0:Xe.durations)||ed(pe),nt=Eo(pe);return o.jsx("select",{value:R.duration||nt,onChange:_e=>Kt(s.id,R.id,{duration:_e.target.value}),onClick:_e=>_e.stopPropagation(),onMouseDown:_e=>_e.stopPropagation(),className:`text-xs px-2 py-1 rounded border outline-none transition-colors ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200 hover:border-zinc-600":"bg-white border-zinc-300 text-zinc-800 hover:border-zinc-400"}`,children:Je.map(_e=>o.jsx("option",{value:_e,children:_e},_e))})})()]}),o.jsx("textarea",{className:`text-sm outline-none resize-none bg-transparent transition-all ${e==="dark"?"text-zinc-200 placeholder:text-zinc-700":"text-zinc-800 placeholder:text-zinc-400"}`,value:R.description||"",placeholder:"...",title:R.description||"",onChange:pe=>Kt(s.id,R.id,{description:pe.target.value}),onClick:pe=>{pe.stopPropagation(),Le||fa({nodeId:s.id,shotId:R.id})},onMouseDown:pe=>pe.stopPropagation(),onFocus:pe=>{pe.stopPropagation(),Le||fa({nodeId:s.id,shotId:R.id})},onInput:pe=>{Le&&(pe.currentTarget.style.height="auto",pe.currentTarget.style.height=pe.currentTarget.scrollHeight+"px")},ref:pe=>{pe&&Le&&(pe.style.height="auto",pe.style.height=pe.scrollHeight+"px")},style:{minHeight:Le?"8rem":"2.5rem",height:Le?"auto":"2.5rem",transition:"all 0.2s ease-in-out"}}),o.jsxs("div",{className:`p-2 rounded text-xs font-mono border transition-all relative ${e==="dark"?"bg-zinc-950 border-zinc-800 text-zinc-400":"bg-zinc-50 border-zinc-200 text-zinc-600"}`,style:{minHeight:Le?"8rem":"2rem",transition:"all 0.2s ease-in-out"},children:[o.jsx("textarea",{className:"w-full bg-transparent outline-none resize-none placeholder:text-opacity-50 transition-all pr-8",value:R.prompt||"",placeholder:"...",onChange:pe=>Kt(s.id,R.id,{prompt:pe.target.value}),onClick:pe=>{pe.stopPropagation(),Le||fa({nodeId:s.id,shotId:R.id})},onMouseDown:pe=>pe.stopPropagation(),onFocus:pe=>{pe.stopPropagation(),Le||fa({nodeId:s.id,shotId:R.id})},onInput:pe=>{Le&&(pe.currentTarget.style.height="auto",pe.currentTarget.style.height=pe.currentTarget.scrollHeight+"px")},ref:pe=>{pe&&Le&&(pe.style.height="auto",pe.style.height=pe.scrollHeight+"px")},style:{minHeight:Le?"8rem":"2rem",height:Le?"auto":"2rem",transition:"all 0.2s ease-in-out"}}),(R.model==="sora-2"||R.model==="sora-2-pro")&&In.length>0&&o.jsx("button",{onClick:pe=>{pe.stopPropagation(),vo(!0)},className:`absolute top-2 right-2 p-1 rounded transition-colors ${e==="dark"?"text-zinc-500 hover:text-zinc-200 hover:bg-zinc-800":"text-zinc-400 hover:text-zinc-700 hover:bg-zinc-200"}`,title:"",children:o.jsx(Xa,{size:12})})]}),(()=>{const pe=R.model||"";if(!(pe&&(pe.includes("sora")||pe==="sora-2"||pe==="sora-2-pro"))||In.length===0)return null;const Je=R.prompt||"",nt=`${s.id}-${R.id}`,le=eh[nt]||!1,Pe=5,_e=In.length>Pe;return o.jsx("div",{className:"border-t border-dashed mt-1",style:{borderColor:e==="dark"?"rgba(63, 63, 70, 0.5)":"rgba(161, 161, 170, 0.5)"},children:o.jsxs("div",{className:"flex items-center justify-between py-1 px-1",children:[o.jsx("div",{className:"flex gap-2 overflow-x-auto py-2 flex-1 custom-scrollbar",children:(le?In:In.slice(0,Pe)).map(bt=>{const st=`@${bt.username}`,ut=Je.includes(st);return o.jsxs("button",{onClick:wt=>{wt.stopPropagation();let kt=Je||"";ut?kt=kt.replace(st,"").replace(/\s{2,}/g," ").trim():(kt=kt.trim(),kt=kt?`${kt} ${st} `:`${st} `),Kt(s.id,R.id,{prompt:kt})},className:`relative shrink-0 transition-all ${ut?"scale-110":"opacity-70 hover:opacity-100"}`,title:bt.username,children:[o.jsx("img",{src:bt.profile_picture_url||"",alt:bt.username,className:`w-8 h-8 rounded-full object-cover border-2 ${ut?"border-blue-500 ring-2 ring-blue-500":"border-transparent"}`,onError:wt=>{wt.target.style.display="none"}}),o.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 bg-black/50 rounded-full p-0.5",children:o.jsx(Ga,{size:8,className:"text-green-400"})})]},bt.id)})}),_e&&o.jsx("button",{onClick:bt=>{bt.stopPropagation(),le?Hl(st=>{const ut={...st};return delete ut[nt],ut}):(vo(!0),Hl(st=>({...st,[nt]:!0})))},className:`shrink-0 px-2 py-1 text-[10px] rounded transition-colors ml-2 ${e==="dark"?"bg-zinc-800 text-zinc-300 hover:bg-zinc-700":"bg-zinc-100 text-zinc-600 hover:bg-zinc-200"}`,title:le?"":"",children:le?"":`+${In.length-Pe}`})]})})})(),o.jsxs("div",{className:"flex gap-1 flex-wrap items-center mt-1",children:[(q=R.tags)==null?void 0:q.map((pe,Xe)=>o.jsx("span",{className:`px-1.5 py-0.5 text-[10px] rounded border ${e==="dark"?"bg-blue-900/30 text-blue-300 border-blue-800":"bg-blue-50 text-blue-600 border-blue-200"}`,children:pe},Xe)),R.camera&&o.jsxs("span",{className:`px-1.5 py-0.5 text-[10px] rounded border flex items-center gap-1 ${e==="dark"?"bg-purple-900/30 text-purple-300 border-purple-800":"bg-purple-50 text-purple-600 border-purple-200"}`,children:[o.jsx(Od,{size:8})," ",R.camera]}),R.time_range&&o.jsx("span",{className:`text-[10px] ml-auto font-mono ${e==="dark"?"text-zinc-600":"text-zinc-400"}`,children:R.time_range})]})]}),o.jsxs("div",{className:`flex flex-col gap-2 justify-center border-l pl-2 shrink-0 ${e==="dark"?"border-zinc-800":"border-zinc-200"}`,children:[(()=>{var nt;const pe=((nt=s.settings)==null?void 0:nt.mode)||"video",Xe=pe==="image"?R.output_url:R.video_url,Je=R.status==="done"&&Xe;return o.jsx("button",{onClick:le=>{le.stopPropagation(),R.status==="generating"?Kt(s.id,R.id,{status:"draft",errorMsg:null}):pe==="image"?Ih(s.id,R):Eh(s.id,R)},className:`p-1.5 rounded text-white shadow-sm transition-all active:scale-95 ${R.status==="generating"?"bg-zinc-500 hover:bg-red-500":Je?"bg-blue-500 hover:bg-green-600":pe==="image"?"bg-blue-600 hover:bg-blue-500":"bg-green-600 hover:bg-green-500"}`,title:R.status==="generating"?"":Je?"":`${pe==="image"?"":""}`,onMouseDown:le=>le.stopPropagation(),children:R.status==="generating"?o.jsxs("div",{className:"relative w-3.5 h-3.5 flex items-center justify-center",children:[o.jsx(Js,{size:14,className:"animate-spin absolute"}),o.jsx(vm,{size:10,fill:"currentColor",className:"opacity-0 hover:opacity-100 absolute z-10 transition-opacity"})]}):Je?o.jsx(el,{size:14}):pe==="image"?o.jsx($o,{size:14}):o.jsx(ym,{size:14,fill:"currentColor"})})})(),o.jsx("button",{onClick:()=>Zy(s.id,R.id),className:`p-1.5 transition-colors ${e==="dark"?"text-zinc-600 hover:text-red-500":"text-zinc-400 hover:text-red-600"}`,title:"",onMouseDown:pe=>pe.stopPropagation(),children:o.jsx(Ms,{size:14})}),o.jsxs("div",{className:"flex flex-col gap-0.5 ml-1",children:[o.jsx("button",{onClick:()=>{var Je;const pe=[...((Je=s.settings)==null?void 0:Je.shots)||[]],Xe=pe.findIndex(nt=>nt.id===R.id);Xe>0&&([pe[Xe-1],pe[Xe]]=[pe[Xe],pe[Xe-1]],Nt(s.id,{shots:pe}))},disabled:ve===0,className:`p-0.5 rounded transition-colors ${ve===0?"opacity-30 cursor-not-allowed":""} ${e==="dark"?"text-zinc-500 hover:text-blue-400 hover:bg-zinc-800":"text-zinc-400 hover:text-blue-500 hover:bg-zinc-100"}`,title:"",onMouseDown:pe=>pe.stopPropagation(),children:o.jsx(Dd,{size:12})}),o.jsx("button",{onClick:()=>{var Je;const pe=[...((Je=s.settings)==null?void 0:Je.shots)||[]],Xe=pe.findIndex(nt=>nt.id===R.id);Xe<pe.length-1&&([pe[Xe],pe[Xe+1]]=[pe[Xe+1],pe[Xe]],Nt(s.id,{shots:pe}))},disabled:ve===(((Me=(Ie=s.settings)==null?void 0:Ie.shots)==null?void 0:Me.length)||0)-1,className:`p-0.5 rounded transition-colors ${ve===(((at=($e=s.settings)==null?void 0:$e.shots)==null?void 0:at.length)||0)-1?"opacity-30 cursor-not-allowed":""} ${e==="dark"?"text-zinc-500 hover:text-blue-400 hover:bg-zinc-800":"text-zinc-400 hover:text-blue-500 hover:bg-zinc-100"}`,title:"",onMouseDown:pe=>pe.stopPropagation(),children:o.jsx(_i,{size:12})})]})]})]}),((ct=s.settings)==null?void 0:ct.showOutputPreview)&&o.jsxs("div",{className:`w-[160px] shrink-0 p-2 ml-1 flex flex-col gap-2 rounded-lg border transition-all ${e==="dark"?"bg-zinc-900/50 border-zinc-800":"bg-white border-zinc-200"} ${R.outputEnabled?e==="dark"?"bg-blue-900/20 border-blue-800":"bg-blue-50 border-blue-300":""}`,children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("div",{className:`w-4 h-4 rounded border cursor-pointer flex items-center justify-center transition-colors ${R.outputEnabled?"bg-blue-500 border-blue-500 text-white":e==="dark"?"border-zinc-600 hover:border-blue-400":"border-zinc-400 hover:border-blue-400"}`,onClick:pe=>{pe.stopPropagation(),Kt(s.id,R.id,{outputEnabled:!R.outputEnabled})},title:R.outputEnabled?"":"",children:R.outputEnabled&&o.jsx(tl,{size:10})}),o.jsx("span",{className:`text-[10px] ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:((yt=R.output_images)==null?void 0:yt.length)>0?"":""})]}),(()=>{var bt;const pe=R.output_images||[],Xe=R.selectedImageIndex??0;if((((bt=s.settings)==null?void 0:bt.mode)||"video")==="video")return o.jsxs("div",{className:`flex-1 min-h-[80px] rounded overflow-hidden relative group/preview cursor-pointer border ${e==="dark"?"border-zinc-800 bg-black":"border-zinc-200 bg-zinc-50"}`,onClick:st=>{st.stopPropagation(),R.video_url&&Pn({url:R.video_url,type:"video",prompt:R.prompt})},children:[R.video_url?o.jsx("video",{src:R.video_url,className:"w-full h-full object-cover",muted:!0}):o.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-30",children:o.jsx(pm,{size:16})}),R.video_url&&o.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover/preview:opacity-100 flex items-center justify-center transition-opacity",children:o.jsx(Is,{size:16,className:"text-white drop-shadow-md"})}),R.video_filename&&o.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-[8px] px-1 py-0.5 truncate opacity-0 group-hover/preview:opacity-100 transition-opacity",title:R.video_filename,children:R.video_filename})]});const nt=R.outputEnabled,le=Xe>=0,Pe=le?Xe:0;if(pe.length>=2)if(Le){const st=pe[Pe]||pe[0],ut=pe.slice(0,4).map((wt,kt)=>({img:wt,idx:kt})).filter(wt=>wt.idx!==Pe);return o.jsxs("div",{className:"flex flex-col gap-1 flex-1 min-h-[100px]",children:[o.jsxs("div",{className:`relative flex-1 rounded border overflow-hidden transition-all group/main ${le?"border-blue-500 ring-1 ring-blue-500/50":e==="dark"?"border-zinc-700":"border-zinc-300"} ${nt?"cursor-not-allowed opacity-80":"cursor-pointer"}`,onClick:wt=>{wt.stopPropagation(),nt||Kt(s.id,R.id,{selectedImageIndex:le?-1:Pe})},children:[o.jsx(Hn,{src:st,className:"w-full h-full object-cover"}),o.jsx("div",{className:`absolute top-0 left-0 text-[8px] px-1 py-0.5 rounded-br ${le?"bg-blue-500 text-white":"bg-black/50 text-white"}`,children:Pe+1}),le&&o.jsx("div",{className:"absolute top-0 right-0 bg-blue-500 text-white p-0.5 rounded-bl",children:o.jsx(tl,{size:10})}),nt&&o.jsx("div",{className:"absolute top-1 right-1 bg-yellow-500 text-black p-0.5 rounded text-[8px]",children:""}),o.jsx("button",{onClick:wt=>{wt.stopPropagation(),Pn({url:st,type:"image"})},className:"absolute bottom-0 left-0 p-0.5 rounded-tr bg-black/60 text-white hover:bg-blue-500 opacity-0 group-hover/main:opacity-100 transition-opacity z-10",title:"",children:o.jsx(Is,{size:10})})]}),o.jsx("div",{className:"flex gap-1 h-10 shrink-0",children:ut.map(({img:wt,idx:kt})=>o.jsxs("div",{className:`relative flex-1 rounded border overflow-hidden transition-all group/thumb ${e==="dark"?"border-zinc-700":"border-zinc-300"} ${nt?"cursor-not-allowed opacity-60":"cursor-pointer hover:border-blue-400"}`,onClick:Vt=>{Vt.stopPropagation(),nt||Kt(s.id,R.id,{selectedImageIndex:kt})},children:[o.jsx(Hn,{src:wt,className:"w-full h-full object-cover"}),o.jsx("div",{className:"absolute top-0 left-0 bg-black/50 text-white text-[7px] px-0.5",children:kt+1})]},kt))})]})}else return o.jsx("div",{className:"grid grid-cols-2 gap-1 flex-1 min-h-[100px]",children:pe.slice(0,4).map((st,ut)=>o.jsxs("div",{className:`relative rounded border overflow-hidden transition-all group/cell ${Xe===ut?"border-blue-500 ring-1 ring-blue-500/50":e==="dark"?"border-zinc-700":"border-zinc-300"} ${nt?"cursor-not-allowed opacity-80":"cursor-pointer hover:border-blue-400"}`,onClick:wt=>{wt.stopPropagation(),nt||Kt(s.id,R.id,{selectedImageIndex:Xe===ut?-1:ut})},children:[o.jsx(Hn,{src:st,className:"w-full h-full object-cover"}),o.jsx("div",{className:`absolute top-0 left-0 text-[7px] px-0.5 rounded-br ${Xe===ut?"bg-blue-500 text-white":"bg-black/50 text-white"}`,children:ut+1}),Xe===ut&&o.jsx("div",{className:"absolute top-0 right-0 bg-blue-500 text-white p-0.5 rounded-bl",children:o.jsx(tl,{size:8})}),o.jsx("button",{onClick:wt=>{wt.stopPropagation(),Pn({url:st,type:"image"})},className:"absolute bottom-0 left-0 p-0.5 rounded-tr bg-black/60 text-white hover:bg-blue-500 opacity-0 group-hover/cell:opacity-100 transition-opacity z-10",title:"",children:o.jsx(Is,{size:8})})]},ut))});const _e=pe[0]||R.output_url;return o.jsxs("div",{className:`flex-1 min-h-[80px] rounded overflow-hidden relative group/preview cursor-pointer border ${e==="dark"?"border-zinc-800 bg-black":"border-zinc-200 bg-zinc-50"}`,onClick:st=>{st.stopPropagation(),_e&&Pn({url:_e,type:"image",prompt:R.prompt})},children:[_e?o.jsx(Hn,{src:_e,className:"w-full h-full object-cover"}):o.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-30",children:o.jsx(pm,{size:16})}),_e&&o.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover/preview:opacity-100 flex items-center justify-center transition-opacity",children:o.jsx(Is,{size:16,className:"text-white drop-shadow-md"})}),R.image_filename&&o.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-[8px] px-1 py-0.5 truncate opacity-0 group-hover/preview:opacity-100 transition-opacity",title:R.image_filename,children:R.image_filename})]})})()]})]})]},R.id)}):o.jsxs("div",{className:`flex flex-col items-center justify-center h-40 gap-3 rounded-lg border-2 border-dashed ${e==="dark"?"border-zinc-800 text-zinc-600":"border-zinc-300 text-zinc-400"}`,children:[o.jsx(Ya,{size:32,className:"opacity-50"}),o.jsx("span",{className:"text-xs",children:""})]})}),o.jsx("div",{className:`p-3 border-t shrink-0 ${e==="dark"?"bg-zinc-900 border-zinc-800":"bg-zinc-50 border-zinc-200"}`,children:o.jsxs("button",{onClick:()=>Xy(s.id),className:`w-full py-2 border border-dashed text-xs rounded transition-colors flex items-center justify-center gap-2 ${e==="dark"?"border-zinc-700 text-zinc-400 hover:bg-zinc-800 hover:text-zinc-200":"border-zinc-300 text-zinc-500 hover:bg-white hover:text-blue-600 hover:border-blue-400"}`,onMouseDown:R=>R.stopPropagation(),children:[o.jsx(Ni,{size:14})," "]})})]})})})(),s.type==="image-compare"&&o.jsx("div",{className:"w-full h-full pointer-events-auto",children:o.jsx(X2,{img1:p[0],img2:p[1]})}),s.type==="preview"&&o.jsxs("div",{className:"flex flex-col h-full pointer-events-auto",children:[o.jsxs("div",{className:`flex items-center justify-between px-3 py-2 border-b text-xs font-semibold ${e==="dark"?"border-zinc-800 text-zinc-200":"border-zinc-200 text-zinc-700"}`,children:[o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx(Is,{size:13,className:"text-blue-500"}),o.jsx("span",{children:""})]}),o.jsx("span",{className:"text-[10px] text-zinc-500",children:s.previewType==="video"?"":""})]}),o.jsxs("div",{className:"flex-1 flex flex-col p-2 gap-2 min-h-0",children:[o.jsx("div",{className:`relative flex-1 rounded-lg overflow-hidden flex items-center justify-center min-h-0 ${e==="dark"?"bg-zinc-900":"bg-zinc-100"}`,onContextMenu:U=>{const Ne=s.content||s.previewMjImages&&s.previewMjImages[0];Ne&&k1(U,{url:Ne,type:s.previewType||(Zn(Ne)?"video":"image"),sourceNode:s})},onDoubleClick:U=>{U.stopPropagation(),U.preventDefault();const Ne=s.content||s.previewMjImages&&s.previewMjImages[0];Ne&&Pn({url:Ne,type:s.previewType||(Zn(Ne)?"video":"image")})},children:s.content||s.previewMjImages&&s.previewMjImages.length>0?Zn(s.content)||s.previewType==="video"?o.jsx("video",{src:s.content,className:"w-full h-full object-contain bg-black",controls:!0,draggable:!1}):s.previewMjImages&&(s.previewMjImages.length===4||s.previewMjImages.length>1)?o.jsx("div",{className:`w-full h-full grid gap-0.5 p-0.5 ${s.previewMjImages.length===4?"grid-cols-2 grid-rows-2":"grid-cols-2"}`,children:s.previewMjImages.map((U,Ne)=>o.jsx("div",{className:"relative w-full h-full overflow-hidden bg-black flex items-center justify-center group",children:o.jsx("img",{src:U,className:"max-w-full max-h-full w-auto h-auto object-contain",alt:` ${Ne+1}`,draggable:!1,onError:ht=>{console.error(` ${Ne+1} `),ht.target.style.display="none"}})},Ne))}):o.jsxs("div",{className:"w-full h-full relative group/preview",children:[o.jsx(Hn,{src:s.content||s.previewMjImages&&s.previewMjImages[0],className:"w-full h-full object-contain bg-black",draggable:!1,onError:U=>{console.warn("[Preview] Image load error")}}),s.previewFilename&&o.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-[10px] px-2 py-1 truncate opacity-0 group-hover/preview:opacity-100 transition-opacity backdrop-blur-sm",title:s.previewFilename,children:s.previewFilename})]}):o.jsxs("div",{className:"flex flex-col items-center justify-center text-[11px] text-zinc-500",children:[o.jsx($o,{className:"w-6 h-6 mb-1 text-zinc-400"}),o.jsx("span",{children:" AI  / AI  "}),o.jsx("span",{children:""})]})}),o.jsxs("div",{className:"flex items-center justify-between gap-2 text-[11px]",children:[o.jsxs("button",{className:`flex-1 inline-flex items-center justify-center gap-1 px-2 py-1 rounded border ${e==="dark"?"border-zinc-700 text-zinc-200 hover:bg-zinc-800":"border-zinc-300 text-zinc-700 hover:bg-zinc-100"}`,onMouseDown:U=>U.stopPropagation(),onClick:async()=>{if(s.content)try{await navigator.clipboard.writeText(s.content)}catch{}},children:[o.jsx(To,{size:13}),""]}),o.jsxs("button",{className:`flex-1 inline-flex items-center justify-center gap-1 px-2 py-1 rounded border ${e==="dark"?"border-zinc-700 text-zinc-200 hover:bg-zinc-800":"border-zinc-300 text-zinc-700 hover:bg-zinc-100"}`,onMouseDown:U=>U.stopPropagation(),onClick:async()=>{if(!s.content)return;const U=un(s.x+s.width+100,s.y+s.height/2);let Ne;if(!Zn(s.content))try{const ht=await Tr(s.content);ht!=null&&ht.w&&(ht!=null&&ht.h)&&(Ne={w:ht.w,h:ht.h})}catch{}ps("input-image",U.x,U.y,null,s.content,Ne)},children:[o.jsx(Cc,{size:13}),""]}),o.jsxs("button",{className:`flex-1 inline-flex items-center justify-center gap-1 px-2 py-1 rounded border ${e==="dark"?"border-zinc-700 text-zinc-200 hover:bg-zinc-800":"border-zinc-300 text-zinc-700 hover:bg-zinc-100"}`,onMouseDown:U=>U.stopPropagation(),onClick:()=>{if(!s.content)return;const U={name:s.previewType==="video"?"Preview.mp4":"Preview.png",type:s.previewType==="video"?"video/mp4":"image/png",content:s.content,isImage:s.previewType!=="video",isVideo:s.previewType==="video",isAudio:!1,fromPreview:!0};zs(Ne=>[...Ne,U]),Nr(!0)},children:[o.jsx(Ao,{size:13}),""]})]})]})]}),(s.type==="gen-image"||s.type==="gen-video")&&(()=>{var be,et,xt,We,mt,zt,Wt,Ze,jn,Mn,Bn,hs,ur,kn;const U=Q.find(fe=>fe.sourceNodeId===s.id&&(fe.status==="generating"||fe.status==="completed")),Ne=U&&U.status==="generating",ht=U!=null&&U.durationMs?(U.durationMs/1e3).toFixed(1):null,wn=xy[s.id]||0;return o.jsxs("div",{className:"p-3 flex flex-col h-full pointer-events-auto",children:[(Ne||ht)&&o.jsx("div",{className:`mb-2 px-2 py-1 rounded text-[10px] font-mono text-center ${e==="dark"?"bg-blue-500/20 text-blue-400 border border-blue-500/30":"bg-blue-50 text-blue-600 border border-blue-200"}`,children:Ne?o.jsxs("span",{children:[" ",wn.toFixed(1),"s"]}):o.jsxs("span",{children:["  ",ht,"s"]})}),o.jsxs("div",{className:`flex items-center gap-1.5 mb-2 text-xs font-semibold shrink-0 ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:[s.type==="gen-image"?o.jsx($2,{size:12,className:"text-blue-400"}):o.jsx(Od,{size:12,className:"text-purple-400"}),o.jsx("span",{children:s.type==="gen-image"?"AI ":"AI "})]}),p.length>0&&o.jsxs("div",{className:`mb-2 rounded-lg border p-2 relative group/ref ${e==="dark"?"bg-zinc-900/50 border-purple-500/20":"bg-violet-50 border-violet-200"}`,children:[o.jsxs("div",{className:"flex justify-between items-center mb-1.5",children:[o.jsxs("span",{className:`text-[10px] font-medium flex items-center gap-1 ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:[o.jsx(xm,{size:10}),""]}),o.jsxs("span",{className:"text-[9px] font-mono text-zinc-500",children:[p.length,"/10"]})]}),o.jsx("div",{className:"flex -space-x-2 overflow-visible pb-1 items-center custom-scrollbar pl-1",children:p.map((fe,R)=>o.jsx("div",{className:"relative shrink-0 flex flex-col items-center gap-0 ",children:o.jsxs("div",{className:"relative",children:[o.jsx("span",{className:"absolute -top-1 -left-1 w-4 h-4 text-[9px] font-semibold rounded-full bg-zinc-700 text-white select-none flex items-center justify-center border border-white/70 shadow-sm leading-none pointer-events-none",style:{zIndex:30},children:R+1}),o.jsx("div",{className:`relative w-8 h-8 rounded-full border-2 thumb-stack-item cursor-pointer overflow-hidden ${e==="dark"?"border-[#18181b] bg-zinc-800":"border-white bg-zinc-200"}`,style:{zIndex:10-R},children:o.jsx(Hn,{src:fe,className:"w-full h-full object-cover"})})]})},R))})]}),o.jsxs("div",{className:`rounded-lg p-3 mb-2 border focus-within:border-blue-500/30 transition-colors flex-1 flex flex-col ${e==="dark"?"bg-zinc-950/50 border-zinc-800":"bg-zinc-50 border-zinc-200"}`,children:[s.type==="gen-image"&&(()=>{const fe=s==null?void 0:s.maskContent;let R=i.find(q=>q.to===s.id&&(!q.inputType||q.inputType==="default"));R||(R=i.find(q=>q.to===s.id));const ve=R?Ut.get(R.from):null,Le=ve&&ve.maskContent;return fe||Le?o.jsxs("div",{className:`flex items-center gap-1.5 mb-2 px-2 py-1 rounded text-[10px] font-medium ${e==="dark"?"bg-purple-900/30 text-purple-300 border border-purple-800":"bg-purple-50 text-purple-600 border border-purple-200"}`,children:[o.jsx(ay,{size:12}),o.jsx("span",{children:Le?"":""})]}):null})(),o.jsxs("div",{className:"flex items-start gap-2 mb-1 flex-1 h-full min-h-0",children:[o.jsx("textarea",{className:`flex-1 h-full bg-transparent text-xs outline-none resize-none custom-scrollbar ${e==="dark"?"text-zinc-300 placeholder-zinc-600":"text-zinc-800 placeholder-zinc-400"}`,placeholder:"...",value:s.type==="gen-image"?((be=s.settings)==null?void 0:be.prompt)||"":((et=s.settings)==null?void 0:et.videoPrompt)||"",onChange:fe=>Nt(s.id,s.type==="gen-image"?{prompt:fe.target.value}:{videoPrompt:fe.target.value}),onMouseDown:fe=>fe.stopPropagation()}),s.type==="gen-video"&&(((xt=s.settings)==null?void 0:xt.model)==="sora-2"||((We=s.settings)==null?void 0:We.model)==="sora-2-pro")&&In.length>0&&o.jsx("div",{className:"relative shrink-0",children:o.jsx("button",{onClick:fe=>{fe.stopPropagation(),vo(!0)},className:`p-1.5 rounded transition-colors ${e==="dark"?"text-zinc-400 hover:text-zinc-200 hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-700 hover:bg-zinc-200"}`,title:"",children:o.jsx(Xa,{size:14})})})]})]}),s.type==="gen-video"&&(()=>{var $e,at;const fe=(($e=s.settings)==null?void 0:$e.model)||"",R=en.get(fe),ve=(R==null?void 0:R.modelName)||(R==null?void 0:R.id)||fe;if(!(ve&&(ve.includes("sora")||fe.includes("sora")))||In.length===0)return null;const se=((at=s.settings)==null?void 0:at.videoPrompt)||"",q=eh[s.id]||!1,Ie=5,Me=In.length>Ie;return o.jsx("div",{className:"border-t border-dashed mt-1",style:{borderColor:e==="dark"?"rgba(63, 63, 70, 0.5)":"rgba(161, 161, 170, 0.5)"},children:o.jsxs("div",{className:"flex items-center justify-between py-1 px-1",children:[o.jsx("div",{className:"flex gap-2 overflow-x-auto py-2 flex-1 custom-scrollbar",children:(q?In:In.slice(0,Ie)).map(ct=>{const yt=`@${ct.username}`,pe=se.includes(yt);return o.jsxs("button",{onClick:Xe=>{Xe.stopPropagation();let Je=se||"";pe?Je=Je.replace(yt,"").replace(/\s{2,}/g," ").trim():(Je=Je.trim(),Je=Je?`${Je} ${yt} `:`${yt} `),Nt(s.id,{videoPrompt:Je})},className:`relative shrink-0 transition-all ${pe?"scale-110":"opacity-70 hover:opacity-100"}`,title:ct.username,children:[o.jsx(Hn,{src:ct.profile_picture_url||"",alt:ct.username,className:`w-8 h-8 rounded-full object-cover border-2 ${pe?"border-blue-500 ring-2 ring-blue-500":"border-transparent"}`,onError:Xe=>{Xe.target.style.display="none"}}),o.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 bg-black/50 rounded-full p-0.5",children:o.jsx(Ga,{size:8,className:"text-green-400"})})]},ct.id)})}),Me&&o.jsx("button",{onClick:ct=>{ct.stopPropagation(),q?Hl(yt=>{const pe={...yt};return delete pe[s.id],pe}):(vo(!0),Hl(yt=>({...yt,[s.id]:!0})))},className:`shrink-0 px-2 py-1 text-[10px] rounded transition-colors ml-2 ${e==="dark"?"bg-zinc-800 text-zinc-300 hover:bg-zinc-700":"bg-zinc-100 text-zinc-600 hover:bg-zinc-200"}`,title:q?"":"",children:q?"":`+${In.length-Ie}`})]})})})(),s.type==="gen-image"&&(()=>{var ve;const fe=en.get((ve=s.settings)==null?void 0:ve.model);return fe&&(fe.id.includes("mj")||fe.provider.toLowerCase().includes("midjourney"))})()&&(()=>{var ve,Le;const fe=ec(s.id,"oref"),R=ec(s.id,"sref");return o.jsxs("div",{className:"flex flex-col gap-1.5 mb-2 relative","data-mj-instructions":"true",children:[o.jsxs("div",{className:"relative flex items-center gap-1.5","data-mj-oref":"true",children:[o.jsx("div",{className:`input-point ${fe?"connected":""} ${Ue===s.id&&rn==="oref"?"active":""}`,title:"oref",onMouseDown:se=>{se.stopPropagation(),se.preventDefault();const q=un(se.clientX,se.clientY);Rn(q),Ot(s.id),Gt("oref")},onMouseUp:se=>fs(s.id,se,"oref"),"data-input-type":"oref",style:{position:"absolute",top:"50%",left:"-0.25rem",transform:"translateY(-50%)",width:"0.5rem",height:"0.5rem",marginRight:"0.25rem",zIndex:20,cursor:"crosshair"}}),o.jsxs("div",{className:"flex items-center gap-1.5 flex-1 ml-2",children:[o.jsx("span",{className:`text-[10px] font-medium ${e==="dark"?"text-zinc-400":"text-zinc-600"}`,children:"oref"}),fe&&o.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-green-500"})]})]}),o.jsxs("div",{className:"relative flex items-center gap-1.5",children:[o.jsx("div",{className:"w-0.5rem h-0.5rem mr-0.25rem ml-2"}),o.jsxs("div",{className:"flex items-center gap-1.5 flex-1",children:[o.jsx("span",{className:`text-[10px] font-medium ${e==="dark"?"text-zinc-400":"text-zinc-600"}`,children:"ow"}),((ve=s.settings)==null?void 0:ve.mjOw)&&s.settings.mjOw>0&&o.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-green-500"})]}),o.jsx("input",{type:"number",min:"1",max:"1000",placeholder:"1-1000",value:((Le=s.settings)==null?void 0:Le.mjOw)||"",onChange:se=>{const q=parseInt(se.target.value,10);isNaN(q)||q<1?Nt(s.id,{mjOw:""}):q>1e3?Nt(s.id,{mjOw:1e3}):Nt(s.id,{mjOw:q})},onMouseDown:se=>se.stopPropagation(),className:`flex-1 px-2 py-1 rounded text-[10px] border outline-none focus:border-blue-500/50 ${e==="dark"?"bg-zinc-900/50 border-zinc-700 text-zinc-300 placeholder-zinc-600":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`})]}),o.jsxs("div",{className:"relative flex items-center gap-1.5","data-mj-sref":"true",children:[o.jsx("div",{className:`input-point ${R?"connected":""} ${Ue===s.id&&rn==="sref"?"active":""}`,title:"sref",onMouseDown:se=>{se.stopPropagation(),se.preventDefault();const q=un(se.clientX,se.clientY);Rn(q),Ot(s.id),Gt("sref")},onMouseUp:se=>fs(s.id,se,"sref"),"data-input-type":"sref",style:{position:"absolute",top:"50%",left:"-0.25rem",transform:"translateY(-50%)",width:"0.5rem",height:"0.5rem",marginRight:"0.25rem",zIndex:20,cursor:"crosshair"}}),o.jsxs("div",{className:"flex items-center gap-1.5 flex-1 ml-2",children:[o.jsx("span",{className:`text-[10px] font-medium ${e==="dark"?"text-zinc-400":"text-zinc-600"}`,children:"sref"}),R&&o.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-green-500"})]})]})]})})(),s.type==="gen-image"&&P&&o.jsxs("div",{className:`mb-2 rounded-lg border p-3 space-y-2 ${e==="dark"?"bg-zinc-900/50 border-zinc-800":"bg-white border-zinc-200"}`,children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("button",{className:"flex items-center gap-1 text-[11px] font-semibold",onClick:()=>Ol(fe=>!fe),onMouseDown:fe=>fe.stopPropagation(),children:[o.jsx("span",{className:e==="dark"?"text-zinc-200":"text-zinc-700",children:""}),o.jsx(nl,{size:12,className:`transition-transform ${js?"":"rotate-90"} ${e==="dark"?"text-zinc-400":"text-zinc-500"}`})]}),o.jsxs("div",{className:"flex items-center gap-2 text-[10px]",children:[o.jsxs("span",{className:"text-zinc-500",children:[fi.length," "]}),o.jsx("button",{className:`px-2 py-0.5 rounded text-[10px] border ${e==="dark"?"border-zinc-700 text-zinc-300 hover:bg-zinc-800":"border-zinc-300 text-zinc-700 hover:bg-zinc-100"}`,onClick:()=>ua(fe=>!fe),onMouseDown:fe=>fe.stopPropagation(),children:mo?"":""})]})]}),!js&&o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"max-h-36 overflow-y-auto custom-scrollbar flex flex-wrap gap-2",children:[fi.map(fe=>o.jsxs("div",{className:`border rounded-lg px-2 py-1.5 flex items-center gap-2 text-[11px] ${e==="dark"?"border-zinc-700 bg-zinc-950/50 text-zinc-200":"border-zinc-200 bg-zinc-50 text-zinc-700"}`,children:[o.jsx("span",{className:"font-medium whitespace-nowrap",children:fe.name}),o.jsx("button",{onClick:()=>s1(s.id,fe.prompt),className:"px-2 py-0.5 rounded text-[10px] bg-blue-600 text-white hover:bg-blue-500 transition-colors",onMouseDown:R=>R.stopPropagation(),children:""}),mo&&o.jsx("button",{onClick:()=>r1(fe.id),className:`px-2 py-0.5 rounded text-[10px] border ${e==="dark"?"border-red-500/50 text-red-400 hover:bg-red-500/10":"border-red-200 text-red-600 hover:bg-red-50"}`,onMouseDown:R=>R.stopPropagation(),children:""})]},fe.id)),fi.length===0&&o.jsx("div",{className:`text-[11px] ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:""})]}),mo&&o.jsxs("div",{className:"grid grid-cols-1 gap-1.5",children:[o.jsx("input",{type:"text",value:ho.name,onChange:fe=>Cr(R=>({...R,name:fe.target.value})),placeholder:"",className:`w-full px-2 py-1 text-[11px] rounded border ${e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200 placeholder:text-zinc-600":"bg-white border-zinc-300 text-zinc-800 placeholder:text-zinc-400"}`,onMouseDown:fe=>fe.stopPropagation()}),o.jsx("textarea",{value:ho.prompt,onChange:fe=>Cr(R=>({...R,prompt:fe.target.value})),placeholder:"...",className:`w-full min-h-[70px] px-2 py-1 text-[11px] rounded border resize-none custom-scrollbar ${e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200 placeholder:text-zinc-600":"bg-white border-zinc-300 text-zinc-800 placeholder:text-zinc-400"}`,onMouseDown:fe=>fe.stopPropagation()}),o.jsx("button",{onClick:n1,className:"w-full py-1.5 rounded text-[11px] font-medium bg-blue-600 hover:bg-blue-500 text-white transition-colors",onMouseDown:fe=>fe.stopPropagation(),children:""})]})]})]}),o.jsxs("div",{className:`mt-auto pt-2 flex items-center justify-between shrink-0 relative gap-2 border-t ${e==="dark"?"border-zinc-800/50":"border-zinc-200"}`,children:[o.jsxs("div",{className:"relative flex-1 min-w-0",children:[o.jsxs("button",{title:(zt=en.get((mt=s.settings)==null?void 0:mt.model))==null?void 0:zt.provider,onClick:fe=>{fe.stopPropagation(),mn((Ge==null?void 0:Ge.type)==="model"?null:{nodeId:s.id,type:"model"})},className:`flex items-center gap-2 pl-1 pr-2 py-1 rounded text-[10px] transition-colors border w-full ${e==="dark"?"bg-zinc-800/50 hover:bg-zinc-800 text-zinc-300 border-zinc-700/50":"bg-zinc-100 hover:bg-zinc-200 text-zinc-700 border-zinc-300"}`,children:[o.jsx("span",{className:`w-2 h-2 rounded-full ${Yi((Wt=s.settings)==null?void 0:Wt.model)}`}),o.jsx("span",{className:"truncate font-mono",children:((jn=en.get((Ze=s.settings)==null?void 0:Ze.model))==null?void 0:jn.id)||"Model"})]}),(Ge==null?void 0:Ge.nodeId)===s.id&&Ge.type==="model"&&o.jsxs("div",{className:`absolute bottom-full left-0 mb-1 w-96 rounded-lg shadow-xl p-1 z-[60] border flex ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseDown:fe=>fe.stopPropagation(),onMouseLeave:()=>Gr(null),children:[o.jsx("div",{className:`w-36 border-r pr-1 max-h-64 overflow-y-auto custom-scrollbar flex flex-col justify-end ${e==="dark"?"border-zinc-700":"border-zinc-200"}`,children:Object.entries(Ss).filter(([,fe])=>fe.models.some(R=>R.type===(s.type==="gen-image"?"Image":"Video"))).map(([fe,R])=>o.jsxs("button",{onMouseEnter:()=>Gr(fe),className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-left text-[10px] transition-colors ${cr===fe?e==="dark"?"bg-zinc-700 text-zinc-100":"bg-zinc-200 text-zinc-900":e==="dark"?"hover:bg-zinc-800 text-zinc-400":"hover:bg-zinc-100 text-zinc-600"}`,children:[o.jsx("span",{className:"truncate font-medium",children:R.name}),o.jsx(nl,{size:10,className:"opacity-50"})]},fe))}),o.jsxs("div",{className:"flex-1 pl-1 max-h-64 overflow-y-auto custom-scrollbar",children:[cr&&((Mn=Ss[cr])==null?void 0:Mn.models.filter(fe=>fe.type===(s.type==="gen-image"?"Image":"Video")).map(fe=>{var R;return o.jsxs("button",{onClick:()=>{const ve={model:fe.id};if(fe.id==="grok-3"&&(ve.ratio="3:2",ve.duration="8s",ve.resolution="1080P"),Nt(s.id,ve),s.type==="gen-image"){rh(fe.id);try{localStorage.setItem("tapnow_last_image_model",fe.id)}catch{}}else if(s.type==="gen-video"){ih(fe.id);try{localStorage.setItem("tapnow_last_video_model",fe.id)}catch{}}mn(null),Gr(null)},className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-left transition-colors ${((R=s.settings)==null?void 0:R.model)===fe.id?e==="dark"?"bg-blue-600/30 text-blue-300":"bg-blue-100 text-blue-700":e==="dark"?"hover:bg-zinc-800 text-zinc-300":"hover:bg-zinc-100 text-zinc-700"}`,children:[o.jsx("span",{className:"text-[10px] font-medium truncate font-mono",children:fe.id}),o.jsx("div",{className:`w-1.5 h-1.5 rounded-full shrink-0 ${Yi(fe.id)}`})]},fe.id)})),!cr&&o.jsx("div",{className:`text-[10px] px-2 py-3 text-center ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:"  Provider"})]})]})]}),s.type==="gen-image"&&(()=>{var R;const fe=en.get((R=s.settings)==null?void 0:R.model);return fe&&(fe.id.includes("mj")||fe.provider.toLowerCase().includes("midjourney"))})()&&o.jsxs("div",{className:"relative flex-1 min-w-0",children:[o.jsx("button",{title:((Bn=Bd.find(fe=>{var R;return fe.value===((R=s.settings)==null?void 0:R.mjVersion)}))==null?void 0:Bn.label)||"MJ V7",onClick:fe=>{fe.stopPropagation(),mn((Ge==null?void 0:Ge.type)==="mjVersion"&&Ge.nodeId===s.id?null:{nodeId:s.id,type:"mjVersion"})},className:`flex items-center gap-2 pl-1 pr-2 py-1 rounded text-[10px] transition-colors border w-full ${e==="dark"?"bg-zinc-800/50 hover:bg-zinc-800 text-zinc-300 border-zinc-700/50":"bg-zinc-100 hover:bg-zinc-200 text-zinc-700 border-zinc-300"}`,children:o.jsx("span",{className:"truncate",children:((hs=Bd.find(fe=>{var R;return fe.value===((R=s.settings)==null?void 0:R.mjVersion)}))==null?void 0:hs.label)||"MJ V7"})}),(Ge==null?void 0:Ge.nodeId)===s.id&&Ge.type==="mjVersion"&&o.jsx("div",{className:`absolute bottom-full left-0 mb-1 w-32 rounded-lg shadow-xl p-1 z-[60] border max-h-64 overflow-y-auto custom-scrollbar ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseDown:fe=>fe.stopPropagation(),children:Bd.map(fe=>{var R,ve;return o.jsxs("button",{onClick:()=>{Nt(s.id,{mjVersion:fe.value}),mn(null)},className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-left transition-colors ${e==="dark"?"hover:bg-zinc-800 text-zinc-300":"hover:bg-zinc-100 text-zinc-700"} ${((R=s.settings)==null?void 0:R.mjVersion)===fe.value?e==="dark"?"bg-zinc-800":"bg-zinc-100":""}`,children:[o.jsx("span",{className:"text-xs font-medium",children:fe.label}),((ve=s.settings)==null?void 0:ve.mjVersion)===fe.value&&o.jsx("svg",{className:"w-3 h-3 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},fe.value)})})]}),o.jsxs("div",{className:"flex gap-1 shrink-0",children:[o.jsxs("div",{className:"relative",children:[o.jsx("button",{onClick:fe=>{fe.stopPropagation(),mn((Ge==null?void 0:Ge.type)==="ratio"&&Ge.nodeId===s.id?null:{nodeId:s.id,type:"ratio"})},className:`flex items-center gap-1 px-2 py-1 rounded text-[10px] border ${e==="dark"?"bg-zinc-800/50 hover:bg-zinc-800 text-zinc-400 border-zinc-700/50":"bg-zinc-100 hover:bg-zinc-200 text-zinc-600 border-zinc-300"}`,children:((ur=s.settings)==null?void 0:ur.ratio)||"Auto"}),(Ge==null?void 0:Ge.nodeId)===s.id&&Ge.type==="ratio"&&o.jsx("div",{className:`absolute bottom-full left-1/2 -translate-x-1/2 mb-1 w-20 rounded-lg shadow-xl p-1 z-[60] border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseDown:fe=>fe.stopPropagation(),children:Im((kn=s.settings)==null?void 0:kn.model).map(fe=>o.jsx("button",{onClick:()=>{Nt(s.id,{ratio:fe}),by(fe);try{localStorage.setItem("tapnow_last_ratio",fe)}catch{}mn(null)},className:`w-full text-center py-1 text-[10px] rounded ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,children:fe},fe))})]}),s.type==="gen-video"&&(()=>{var Le,se;const fe=en.get((Le=s.settings)==null?void 0:Le.model);return((fe==null?void 0:fe.id)||(fe==null?void 0:fe.modelName)||"").includes("grok")?o.jsxs("div",{className:"relative",children:[o.jsx("button",{onClick:q=>{q.stopPropagation(),mn((Ge==null?void 0:Ge.type)==="vres"&&Ge.nodeId===s.id?null:{nodeId:s.id,type:"vres"})},className:`flex items-center gap-1 px-2 py-1 rounded text-[10px] border ${e==="dark"?"bg-zinc-800/50 hover:bg-zinc-800 text-zinc-400 border-zinc-700/50":"bg-zinc-100 hover:bg-zinc-200 text-zinc-600 border-zinc-300"}`,children:((se=s.settings)==null?void 0:se.resolution)||"1080P"}),(Ge==null?void 0:Ge.nodeId)===s.id&&Ge.type==="vres"&&o.jsx("div",{className:`absolute bottom-full left-1/2 -translate-x-1/2 mb-1 w-24 rounded-lg shadow-xl p-1 z-[60] border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseDown:q=>q.stopPropagation(),children:K2.map(q=>o.jsx("button",{onClick:()=>{Nt(s.id,{resolution:q}),jy(q);try{localStorage.setItem("tapnow_last_video_res",q)}catch{}mn(null)},className:`w-full text-center py-1 text-[10px] rounded ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,children:q},q))})]}):null})(),s.type==="gen-image"&&(()=>{var ve;const fe=en.get((ve=s.settings)==null?void 0:ve.model);return!(fe&&(fe.id.includes("mj")||fe.provider.toLowerCase().includes("midjourney")))})()?o.jsxs("div",{className:"relative",children:[o.jsx("button",{onClick:fe=>{fe.stopPropagation(),mn((Ge==null?void 0:Ge.type)==="res"&&Ge.nodeId===s.id?null:{nodeId:s.id,type:"res"})},className:`flex items-center gap-1 px-2 py-1 rounded text-[10px] border ${e==="dark"?"bg-zinc-800/50 hover:bg-zinc-800 text-zinc-400 border-zinc-700/50":"bg-zinc-100 hover:bg-zinc-200 text-zinc-600 border-zinc-300"}`,children:(()=>{var q,Ie;const fe=en.get((q=s.settings)==null?void 0:q.model),R=(fe==null?void 0:fe.id)||(fe==null?void 0:fe.modelName)||"",ve=Fd(R),Le=((Ie=s.settings)==null?void 0:Ie.resolution)||"Auto",se=ve.includes(Le)?Le:ve[0]||"Auto";return!ve.includes(Le)&&ve.length>0&&setTimeout(()=>{Nt(s.id,{resolution:ve[0]})},0),se})()}),(Ge==null?void 0:Ge.nodeId)===s.id&&Ge.type==="res"&&(()=>{var Le;const fe=en.get((Le=s.settings)==null?void 0:Le.model),R=(fe==null?void 0:fe.id)||(fe==null?void 0:fe.modelName)||"",ve=Fd(R);return o.jsx("div",{className:`absolute bottom-full right-0 mb-1 w-24 rounded-lg shadow-xl p-1 z-[60] border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseDown:se=>se.stopPropagation(),children:ve.map(se=>o.jsx("button",{onClick:()=>{Nt(s.id,{resolution:se}),ky(se);try{localStorage.setItem("tapnow_last_image_res",se)}catch{}mn(null)},className:`w-full text-center py-1 text-[10px] rounded ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,children:se},se))})})()]}):(()=>{var ve,Le,se,q,Ie,Me,$e,at,ct,yt,pe,Xe,Je,nt;const fe=en.get((ve=s.settings)==null?void 0:ve.model);return fe&&(fe.id.includes("mj")||fe.provider.toLowerCase().includes("midjourney"))?null:o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"relative",children:[o.jsx("button",{onClick:le=>{le.stopPropagation(),mn((Ge==null?void 0:Ge.type)==="duration"&&Ge.nodeId===s.id?null:{nodeId:s.id,type:"duration"})},className:`flex items-center gap-1 px-2 py-1 rounded text-[10px] border ${e==="dark"?"bg-zinc-800/50 hover:bg-zinc-800 text-zinc-400 border-zinc-700/50":"bg-zinc-100 hover:bg-zinc-200 text-zinc-600 border-zinc-300"}`,children:((Le=s.settings)==null?void 0:Le.duration)||"5s"}),(Ge==null?void 0:Ge.nodeId)===s.id&&Ge.type==="duration"&&o.jsx("div",{className:`absolute bottom-full left-1/2 -translate-x-1/2 mb-1 w-20 rounded-lg shadow-xl p-1 z-[60] border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseDown:le=>le.stopPropagation(),children:(((se=ae.find(le=>{var Pe;return le.id===((Pe=s.settings)==null?void 0:Pe.model)}))==null?void 0:se.durations)||["5s","10s"]).map(le=>o.jsx("button",{onClick:()=>{Nt(s.id,{duration:le}),mn(null)},className:`w-full text-center py-1 text-[10px] rounded ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,children:le},le))})]}),(((Ie=(q=s.settings)==null?void 0:q.model)==null?void 0:Ie.includes("jimeng"))||((at=($e=en.get((Me=s.settings)==null?void 0:Me.model))==null?void 0:$e.modelName)==null?void 0:at.includes("jimeng"))||((yt=(ct=s.settings)==null?void 0:ct.model)==null?void 0:yt.includes("grok")))&&o.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[o.jsx("span",{className:"text-[10px] opacity-70",children:""}),o.jsx("div",{className:"flex bg-zinc-100 dark:bg-zinc-800 rounded p-0.5 border dark:border-zinc-700",children:["720p","1080p"].map(le=>{var Pe;return o.jsx("button",{onClick:_e=>{_e.stopPropagation(),Nt(s.id,{resolution:le})},onMouseDown:_e=>_e.stopPropagation(),className:`text-[10px] px-2 py-0.5 rounded transition-all ${(((Pe=s.settings)==null?void 0:Pe.resolution)||"720p")===le?"bg-white dark:bg-zinc-700 shadow-sm text-blue-600 dark:text-blue-400 font-medium":"text-zinc-500 hover:text-zinc-700 dark:hover:text-zinc-300"}`,children:le},le)})})]}),s.type==="gen-video"&&((pe=s.settings)==null?void 0:pe.model)==="sora-2"&&o.jsxs("label",{className:`flex items-center gap-1 px-2 py-1 rounded text-[10px] border cursor-pointer transition-colors ${e==="dark"?(Xe=s.settings)!=null&&Xe.isHD?"bg-blue-600/30 border-blue-500 text-blue-300":"bg-zinc-800/50 hover:bg-zinc-800 text-zinc-400 border-zinc-700/50":(Je=s.settings)!=null&&Je.isHD?"bg-blue-500/30 border-blue-400 text-blue-700":"bg-zinc-100 hover:bg-zinc-200 text-zinc-600 border-zinc-300"}`,onClick:le=>le.stopPropagation(),children:[o.jsx("input",{type:"checkbox",checked:((nt=s.settings)==null?void 0:nt.isHD)||!1,onChange:le=>{le.stopPropagation(),Nt(s.id,{isHD:le.target.checked})},className:"w-3 h-3 cursor-pointer",onMouseDown:le=>le.stopPropagation()}),o.jsx("span",{children:"HD"})]})]})})()]}),o.jsx("button",{onClick:()=>{var Le,se;const fe=s.type==="gen-image"?((Le=s.settings)==null?void 0:Le.prompt)||"":((se=s.settings)==null?void 0:se.videoPrompt)||"",R=Ca(s.id),ve=R.length>0?R.join(" ")+(fe?" "+fe:""):fe;Ea(ve,s.type==="gen-image"?"image":"video",p,s.id)},className:"bg-blue-600 hover:bg-blue-500 text-white p-1.5 rounded-md shadow-lg active:scale-95 transition-transform shrink-0",title:"",children:o.jsx(ym,{size:12,fill:"currentColor"})})]})]})})()]})]},s.id)},[ze,Dn,Lr,Ah,Rh,en,Ju,e,v,nr,V,Ue,rn,Gu,fs,un,hi,we,Er,mn,Yr,Ae,Ot,Gt,vt,Pn,Zn,Nt,Ca,Ea,Eo,ed,Gy,Sa,$y]),C1=n.length>50,E1=go||Ws;return o.jsxs(o.Fragment,{children:[o.jsx(L2,{visible:he.visible,progress:he.progress,status:he.status,type:he.type}),o.jsxs("div",{className:`w-full h-screen font-sans overflow-hidden select-none flex flex-col transition-colors duration-300 ${e==="dark"?"bg-[#09090b] text-white":"bg-zinc-100 text-zinc-900"} ${C1?"perf-mode":""} ${E1?"interacting":""}`,onClick:()=>{lr.visible&&ds(s=>({...s,visible:!1})),xi.visible&&Ou(s=>({...s,visible:!1}))},children:[o.jsxs("div",{className:`h-12 flex items-center justify-between px-4 z-50 shrink-0 border-b transition-colors duration-300 ${e==="dark"?"bg-[#09090b] border-zinc-800":"bg-white border-zinc-200"}`,children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-md flex items-center justify-center",children:o.jsx(x2,{size:16,className:"text-white"})}),o.jsx("span",{className:`font-bold text-sm tracking-wide ${e==="dark"?"text-zinc-200":"text-zinc-800"}`,children:"Tapnow Studio"}),Un?o.jsx("input",{ref:je,type:"text",value:Yt,onChange:s=>Qn(s.target.value),onBlur:()=>{w(!1);try{localStorage.setItem("tapnow_project_name",Yt)}catch{}},onKeyDown:s=>{if(s.key==="Enter"){w(!1);try{localStorage.setItem("tapnow_project_name",Yt)}catch{}}},className:`ml-2 px-2 py-0.5 text-xs border rounded outline-none ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200":"bg-white border-zinc-300 text-zinc-800"}`,style:{minWidth:"100px",maxWidth:"200px"}}):o.jsx("span",{onClick:()=>{w(!0),setTimeout(()=>{var s;return(s=je.current)==null?void 0:s.focus()},0)},className:`ml-2 text-xs cursor-pointer hover:underline ${e==="dark"?"text-zinc-400":"text-zinc-500"}`,title:"",children:Yt})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("button",{onClick:()=>{const s=["off","normal","ultra"],f=(s.indexOf(O)+1)%s.length,h=s[f];ee(h),localStorage.setItem("tapnow_performance_mode",h)},className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors border ${O!=="off"?e==="dark"?"bg-blue-600 border-blue-500 text-white hover:bg-blue-500":"bg-blue-500 border-blue-400 text-white hover:bg-blue-600":e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200 hover:bg-zinc-800":"bg-zinc-100 border-zinc-300 text-zinc-700 hover:bg-zinc-200"}`,title:O==="ultra"?"":O==="normal"?"":"",children:[o.jsx(wm,{size:14,className:O!=="off"?"fill-current":""}),o.jsx("span",{children:O==="ultra"?"":""})]}),o.jsxs("button",{onClick:Vy,className:`flex items-center gap-1 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors border ${e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200 hover:bg-zinc-800":"bg-zinc-100 border-zinc-300 text-zinc-700 hover:bg-zinc-200"}`,title:"/",children:[o.jsx(Ka,{size:14}),o.jsx("span",{children:""})]}),o.jsx("button",{onClick:Wy,className:`flex items-center gap-1 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors border ${e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200 hover:bg-zinc-800":"bg-zinc-100 border-zinc-300 text-zinc-700 hover:bg-zinc-200"}`,title:"",children:e==="dark"?o.jsxs(o.Fragment,{children:[o.jsx(E2,{size:14,className:"text-amber-400"}),o.jsx("span",{children:""})]}):o.jsxs(o.Fragment,{children:[o.jsx(v2,{size:14,className:"text-blue-500"}),o.jsx("span",{children:""})]})}),o.jsx("button",{onClick:K,disabled:d.length===0,className:`flex items-center gap-1 px-2 py-1.5 rounded-lg text-xs font-medium transition-colors border ${d.length===0?e==="dark"?"bg-zinc-900/50 border-zinc-800 text-zinc-600 cursor-not-allowed":"bg-zinc-50 border-zinc-200 text-zinc-400 cursor-not-allowed":e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200 hover:bg-zinc-800":"bg-zinc-100 border-zinc-300 text-zinc-700 hover:bg-zinc-200"}`,title:" (Ctrl+Z)",children:o.jsx(j2,{size:14})}),o.jsx("button",{onClick:xe,disabled:j.length===0,className:`flex items-center gap-1 px-2 py-1.5 rounded-lg text-xs font-medium transition-colors border ${j.length===0?e==="dark"?"bg-zinc-900/50 border-zinc-800 text-zinc-600 cursor-not-allowed":"bg-zinc-50 border-zinc-200 text-zinc-400 cursor-not-allowed":e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200 hover:bg-zinc-800":"bg-zinc-100 border-zinc-300 text-zinc-700 hover:bg-zinc-200"}`,title:" (Ctrl+Shift+Z)",children:o.jsx(_2,{size:14})}),o.jsx(Tc,{variant:"ghost",onClick:()=>{me(),r([]),a([]),Qn(""),localStorage.removeItem("tapnow_project_name")},children:""}),o.jsx(Tc,{variant:"secondary",icon:C2,onClick:()=>yi(!0),children:"API "})]})]}),o.jsxs("div",{className:`flex-1 relative overflow-hidden flex transition-colors duration-300 ${e==="dark"?"bg-[#09090b]":"bg-zinc-100"}`,children:[o.jsxs("div",{className:`w-14 border-r flex flex-col items-center py-3 gap-3 z-40 shrink-0 transition-colors duration-300 ${e==="dark"?"bg-[#09090b] border-zinc-800":"bg-white border-zinc-200"}`,children:[o.jsx("button",{onClick:o1,className:`p-2.5 rounded-lg transition-all mb-2 ${e==="dark"?"text-zinc-500 hover:text-zinc-300 hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-800 hover:bg-zinc-200"}`,title:"",children:o.jsx(w2,{size:18})}),[{id:"select",icon:b2},{id:"history",icon:gm},{id:"characters",icon:Xa}].map(s=>o.jsx("button",{onClick:()=>{my(s.id),s.id==="history"&&Uu(!Gp),s.id==="characters"&&vo(!Xp)},className:`p-2.5 rounded-lg transition-all ${hy===s.id?e==="dark"?"bg-zinc-800 text-white":"bg-zinc-200 text-zinc-900":e==="dark"?"text-zinc-500 hover:text-zinc-300":"text-zinc-500 hover:text-zinc-800"}`,children:o.jsx(s.icon,{size:18})},s.id)),o.jsx("div",{className:"flex-1"}),o.jsx("button",{onClick:()=>Nr(!Fs),className:`p-2.5 rounded-lg transition-all mb-2 ${Fs?"bg-blue-600 text-white":e==="dark"?"text-zinc-500 hover:text-zinc-300":"text-zinc-500 hover:text-zinc-800"}`,title:"AI ",children:o.jsx(Ao,{size:18})}),o.jsx("button",{onClick:Ky,className:`p-2.5 rounded-lg transition-all ${e==="dark"?"text-zinc-500 hover:text-zinc-300 hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-800 hover:bg-zinc-200"}`,title:"",children:o.jsx(N2,{size:18})}),o.jsx("button",{onClick:Yy,className:`p-2.5 rounded-lg transition-all mb-2 ${e==="dark"?"text-zinc-500 hover:text-zinc-300 hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-800 hover:bg-zinc-200"}`,title:"",children:o.jsx(Mo,{size:18})})]}),Gp&&o.jsxs("div",{className:`w-72 z-30 flex flex-col animate-in slide-in-from-left border-r transition-colors duration-300 ${e==="dark"?"bg-[#121214] border-zinc-800":"bg-zinc-50 border-zinc-200"}`,children:[o.jsxs("div",{className:`p-3 border-b flex justify-between items-center ${e==="dark"?"border-zinc-800":"border-zinc-200"}`,children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("h3",{className:`font-bold text-xs ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:""}),De.active&&o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx("div",{className:"w-16 h-1.5 bg-zinc-700 rounded-full overflow-hidden",children:o.jsx("div",{className:"h-full bg-blue-500 transition-all duration-200",style:{width:`${De.current/De.total*100}%`}})}),o.jsxs("span",{className:"text-[9px] text-zinc-500 font-mono",children:[De.current,"/",De.total]})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("button",{onClick:()=>{const c=Q.filter(f=>f.status==="completed");jt.size>0?It(new Set):It(new Set(c.map(f=>f.id)))},className:`p-1.5 rounded transition-colors flex items-center gap-1 ${jt.size>0?e==="dark"?"text-blue-400 bg-blue-500/20 hover:bg-blue-500/30":"text-blue-600 bg-blue-100 hover:bg-blue-200":e==="dark"?"text-zinc-500 hover:text-zinc-300 hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-700 hover:bg-zinc-200"}`,title:jt.size>0?` (${jt.size})`:"",children:[jt.size>0?o.jsx(el,{size:14}):o.jsx(h2,{size:14}),jt.size>0&&o.jsx("span",{className:"text-[9px] font-bold",children:jt.size})]}),o.jsx("button",{onClick:()=>Wl(!0),className:`p-1.5 rounded transition-colors ${e==="dark"?"text-zinc-400 hover:text-zinc-200 hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-700 hover:bg-zinc-200"}`,title:"",children:o.jsx(Ya,{size:14})}),o.jsxs("div",{className:"relative",children:[o.jsx("button",{onClick:()=>{if(console.log("[V3.5.1 Debug] Download button clicked, historySelection.size =",jt.size),jt.size>0){const s=[...jt].map(c=>Q.find(f=>f.id===c)).filter(Boolean);console.log("[V3.5.1 Debug] Downloading selected items:",s.length),td(s)}else console.log("[V3.5.1 Debug] Opening dropdown menu"),mn((Ge==null?void 0:Ge.type)==="batch-download"?null:{type:"batch-download"})},className:`p-1.5 rounded transition-colors ${jt.size>0?"text-blue-400 bg-blue-500/20":e==="dark"?"text-zinc-400 hover:text-zinc-200 hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-700 hover:bg-zinc-200"}`,title:jt.size>0?` (${jt.size})`:"",children:o.jsx(Ka,{size:14})}),(Ge==null?void 0:Ge.type)==="batch-download"&&jt.size===0&&o.jsxs("div",{className:`absolute right-0 top-full mt-1 w-40 rounded-lg shadow-xl py-1 z-50 border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseLeave:()=>mn(null),children:[o.jsxs("button",{onClick:()=>{mn(null);const s=Q.filter(c=>(c.startTime||0)>=Qe);td(s)},className:`w-full text-left px-3 py-2 text-xs transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,children:[" (",Q.filter(s=>(s.startTime||0)>=Qe).length,")"]}),o.jsxs("button",{onClick:()=>{mn(null),td(Q)},className:`w-full text-left px-3 py-2 text-xs transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,children:[" (",Q.length,")"]})]})]}),o.jsx("button",{onClick:()=>Uu(!1),children:o.jsx(es,{size:12,className:e==="dark"?"text-zinc-500":"text-zinc-400"})})]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-3 space-y-3",children:(()=>{const s=Q.filter(f=>(f.startTime||0)>=Qe),c=Q.filter(f=>(f.startTime||0)<Qe);return o.jsxs(o.Fragment,{children:[s.length>0&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:`flex items-center gap-2 text-[10px] ${e==="dark"?"text-blue-400":"text-blue-600"}`,children:[o.jsx("div",{className:"flex-1 h-px bg-blue-500/30"}),o.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-blue-500/10 font-medium",children:[" (",s.length,")"]}),o.jsx("div",{className:"flex-1 h-px bg-blue-500/30"})]}),s.map(f=>o.jsx(km,{item:f,theme:e,lightboxItem:Sr,providers:X,defaultProviders:Ud,onDelete:yh,isSelected:jt.has(f.id),onSelect:h=>{console.log("[V3.5.2 Debug] onSelect called, id:",h,"current Set size:",jt.size),It(p=>{const m=new Set(p);return m.has(h)?m.delete(h):m.add(h),console.log("[V3.5.2 Debug] Updated Set size:",m.size),m})},onClick:()=>{if(f.url){const h=f.mjImages&&f.mjImages.length>1&&f.selectedMjImageIndex!==void 0?f.selectedMjImageIndex:0;Pn({...f,url:f.mjImages&&f.mjImages.length>1?f.mjImages[h]:f.url,selectedMjImageIndex:h})}},onContextMenu:h=>sc(h,f),onImageClick:(h,p,m,N)=>{h.stopPropagation(),ye(I=>I.map(M=>M.id===p.id?{...M,url:m,selectedMjImageIndex:N}:M));const T={...p,url:m,selectedMjImageIndex:N};Pn(T)},onImageContextMenu:(h,p,m,N)=>sc(h,p,m,N),onRefresh:h=>{h.apiConfig&&(ye(p=>p.map(m=>m.id===h.id?{...m,status:"generating",errorMsg:null,progress:5}:m)),h.modelName.includes("veo")?zi(h.remoteTaskId,h.id,h.apiConfig.baseUrl,h.apiConfig.apiKey,h.width,h.height):Gi(h.remoteTaskId,h.id,h.apiConfig.baseUrl,h.apiConfig.apiKey,h.width,h.height,h.apiConfig.modelId||""))},Loader2:Js,Trash2:Ms,RefreshCw:Bf},f.id))]}),c.length>0&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:`flex items-center gap-2 text-[10px] ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:[o.jsx("div",{className:`flex-1 h-px ${e==="dark"?"bg-zinc-700":"bg-zinc-300"}`}),o.jsxs("span",{className:"px-2 py-0.5 font-medium",children:[" (",c.length,")"]}),o.jsx("div",{className:`flex-1 h-px ${e==="dark"?"bg-zinc-700":"bg-zinc-300"}`})]}),c.map(f=>o.jsx(km,{item:f,theme:e,lightboxItem:Sr,providers:X,defaultProviders:Ud,onDelete:yh,isSelected:jt.has(f.id),onSelect:h=>{console.log("[V3.5.2 Debug] onSelect called (prev), id:",h,"current Set size:",jt.size),It(p=>{const m=new Set(p);return m.has(h)?m.delete(h):m.add(h),console.log("[V3.5.2 Debug] Updated Set size:",m.size),m})},onClick:()=>{if(f.url){const h=f.mjImages&&f.mjImages.length>1&&f.selectedMjImageIndex!==void 0?f.selectedMjImageIndex:0;Pn({...f,url:f.mjImages&&f.mjImages.length>1?f.mjImages[h]:f.url,selectedMjImageIndex:h})}},onContextMenu:h=>sc(h,f),onImageClick:(h,p,m,N)=>{h.stopPropagation(),ye(I=>I.map(M=>M.id===p.id?{...M,url:m,selectedMjImageIndex:N}:M));const T={...p,url:m,selectedMjImageIndex:N};Pn(T)},onImageContextMenu:(h,p,m,N)=>sc(h,p,m,N),onRefresh:h=>{h.apiConfig&&(ye(p=>p.map(m=>m.id===h.id?{...m,status:"generating",errorMsg:null,progress:5}:m)),h.modelName.includes("veo")?zi(h.remoteTaskId,h.id,h.apiConfig.baseUrl,h.apiConfig.apiKey,h.width,h.height):Gi(h.remoteTaskId,h.id,h.apiConfig.baseUrl,h.apiConfig.apiKey,h.width,h.height,h.apiConfig.modelId||""))},Loader2:Js,Trash2:Ms,RefreshCw:Bf},f.id))]})]})})()})]}),Xp&&o.jsxs("div",{className:`w-72 z-30 flex flex-col animate-in slide-in-from-left border-r transition-colors duration-300 ${e==="dark"?"bg-[#121214] border-zinc-800":"bg-zinc-50 border-zinc-200"}`,children:[o.jsxs("div",{className:`p-3 border-b flex justify-between items-center ${e==="dark"?"border-zinc-800":"border-zinc-200"}`,children:[o.jsx("h3",{className:`font-bold text-xs ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:"Sora "}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:()=>{const s=ae.find(c=>c.type==="Video"&&(c.id==="sora-2"||c.id==="sora-2-pro"));if(s){const c=(s.url||vr).replace(/\/+$/,"");ma(`${c}/sora/v1/characters`)}else{const c=vr.replace(/\/+$/,"");ma(`${c}/sora/v1/characters`)}ha(!0)},className:`px-2 py-1 text-[10px] rounded transition-colors ${e==="dark"?"bg-blue-600 hover:bg-blue-500 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,children:""}),o.jsx("button",{onClick:()=>vo(!1),children:o.jsx(es,{size:12,className:e==="dark"?"text-zinc-500":"text-zinc-400"})})]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-3",children:In.length===0?o.jsx("div",{className:`text-center py-8 text-sm ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:'""'}):o.jsx("div",{className:"grid grid-cols-2 gap-3",children:In.map(s=>o.jsxs("div",{className:`group rounded-lg overflow-hidden border cursor-pointer hover:border-blue-500/50 transition-colors ${e==="dark"?"bg-zinc-900 border-zinc-800":"bg-white border-zinc-200"}`,onClick:()=>{const c=` @${s.username} `,f=document.activeElement;if(f&&(f.tagName==="TEXTAREA"||f.tagName==="INPUT")){const h=f,p=h.selectionStart||0,m=h.selectionEnd||0,N=h.value,T=N.slice(0,p)+c+N.slice(m);h.value=T;const I=p+c.length;h.setSelectionRange(I,I),h.dispatchEvent(new Event("input",{bubbles:!0})),h.focus()}else navigator.clipboard.writeText(c.trim()).then(()=>{alert(`: ${c.trim()}`)})},children:[o.jsxs("div",{className:"aspect-square bg-zinc-800 relative group/char",children:[s.profile_picture_url?o.jsx(Hn,{src:s.profile_picture_url,alt:s.username,className:"w-full h-full object-cover",onError:c=>{c.target.style.display="none"}}):o.jsx("div",{className:"w-full h-full flex items-center justify-center text-zinc-500",children:o.jsx(bm,{size:24})}),o.jsx("button",{onClick:c=>{if(c.stopPropagation(),confirm(` "${s.username}" `)){const f=In.filter(h=>h.id!==s.id);Fu(f);try{localStorage.setItem("tapnow_characters",JSON.stringify(f))}catch(h){console.error(":",h)}}},className:"absolute top-1 right-1 p-1.5 rounded-full bg-black/50 text-white opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600 z-10",title:"",children:o.jsx(Ms,{size:12})})]}),o.jsx("div",{className:"p-2 relative",children:o.jsxs("p",{className:`text-xs truncate flex items-center gap-1 ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:[s.username,o.jsx(Ga,{size:12,className:"text-green-500 shrink-0",title:"Sora 2 "})]})})]},s.id))})})]}),fy&&o.jsx("div",{className:"fixed inset-0 bg-black/50 z-[100] flex items-center justify-center",onClick:()=>ha(!1),children:o.jsxs("div",{className:`w-[500px] max-h-[90vh] overflow-y-auto rounded-lg shadow-2xl flex flex-col ${e==="dark"?"bg-[#121214] border-zinc-800":"bg-white border-zinc-200"} border`,onClick:s=>s.stopPropagation(),children:[o.jsxs("div",{className:`p-4 border-b flex justify-between items-center ${e==="dark"?"border-zinc-800":"border-zinc-200"}`,children:[o.jsx("h3",{className:`font-bold text-sm ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:""}),o.jsx("button",{onClick:()=>ha(!1),children:o.jsx(es,{size:16,className:e==="dark"?"text-zinc-500":"text-zinc-400"})})]}),o.jsxs("div",{className:"p-4 space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:`block text-xs mb-2 ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:""}),o.jsxs("div",{className:"flex gap-2 mb-2",children:[o.jsx("button",{onClick:()=>{Ul("url"),Bl("")},className:`px-3 py-1.5 text-xs rounded transition-colors ${Ks==="url"?e==="dark"?"bg-blue-600 text-white":"bg-blue-500 text-white":e==="dark"?"bg-zinc-800 text-zinc-400 hover:bg-zinc-700":"bg-zinc-100 text-zinc-600 hover:bg-zinc-200"}`,children:" URL"}),o.jsx("button",{onClick:()=>{Ul("history"),Fl(""),ga(null)},className:`px-3 py-1.5 text-xs rounded transition-colors ${Ks==="history"?e==="dark"?"bg-blue-600 text-white":"bg-blue-500 text-white":e==="dark"?"bg-zinc-800 text-zinc-400 hover:bg-zinc-700":"bg-zinc-100 text-zinc-600 hover:bg-zinc-200"}`,children:""})]}),Ks==="url"?o.jsx("input",{type:"text",value:bo,onChange:s=>Fl(s.target.value),placeholder:" URL...",className:`w-full px-3 py-2 text-xs rounded border outline-none ${e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200 placeholder-zinc-600":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`}):o.jsxs("select",{value:wo,onChange:s=>{const c=s.target.value;if(Bl(c),c){const f=ja.get(c);f&&f.url&&(Ul("url"),Fl(f.url),Bl(""))}},className:`w-full px-3 py-2 text-xs rounded border outline-none ${e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200":"bg-white border-zinc-300 text-zinc-800"}`,children:[o.jsx("option",{value:"",children:"..."}),Q.filter(s=>s.type==="video"&&s.status==="completed"&&s.url).map(s=>{var c;return o.jsxs("option",{value:s.id,children:[((c=s.prompt)==null?void 0:c.slice(0,50))||"Untitled"," - ",s.time]},s.id)})]}),(()=>{let s=null;if(Ks==="url"&&bo.trim())s=bo.trim();else if(Ks==="history"&&wo){const c=ja.get(wo);c&&c.url&&(s=c.url)}return s?o.jsxs("div",{className:"mt-2 mb-2",children:[o.jsx("video",{controls:!0,crossOrigin:"anonymous",className:"w-full h-40 object-contain bg-black rounded-lg",src:s,onError:c=>{console.error(":",s,c),ga("")},onLoadStart:()=>{ga(null)},onLoadedData:()=>{ga(null)}},s),Qp&&o.jsx("div",{className:"text-red-500 text-xs mt-1 text-center",children:Qp})]}):null})()]}),o.jsxs("div",{children:[o.jsx("label",{className:`block text-xs mb-2 ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:" 1-3 "}),o.jsxs("div",{className:"flex gap-2 items-center",children:[o.jsx("input",{type:"number",min:"0",step:"0.1",value:ko,onChange:s=>Zp(parseFloat(s.target.value)||0),className:`w-20 px-2 py-1.5 text-xs rounded border outline-none ${e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200":"bg-white border-zinc-300 text-zinc-800"}`}),o.jsx("span",{className:`text-xs ${e==="dark"?"text-zinc-400":"text-zinc-500"}`,children:""}),o.jsx("input",{type:"number",min:"0",step:"0.1",value:zo,onChange:s=>Jp(parseFloat(s.target.value)||0),className:`w-20 px-2 py-1.5 text-xs rounded border outline-none ${e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200":"bg-white border-zinc-300 text-zinc-800"}`}),o.jsxs("span",{className:`text-xs ${e==="dark"?"text-zinc-400":"text-zinc-500"}`,children:[": ",(zo-ko).toFixed(1),"s"]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:`block text-xs mb-2 ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:"API  (API Endpoint)"}),o.jsx("input",{type:"text",value:qp,onChange:s=>ma(s.target.value),placeholder:": https://your-domain.com/sora/v1/characters",className:`w-full px-3 py-2 text-xs rounded border outline-none font-mono ${e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200 placeholder-zinc-600":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`,onFocus:s=>{if(!s.target.value){const c=ae.find(h=>h.type==="Video"&&(h.id==="sora-2"||h.id==="sora-2-pro")),f=c?(c.url||vr).replace(/\/+$/,""):vr.replace(/\/+$/,"");ma(`${f}/sora/v1/characters`)}}}),o.jsx("p",{className:`text-[10px] mt-1 ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:""})]}),o.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[o.jsx("button",{onClick:()=>ha(!1),className:`px-4 py-2 text-xs rounded transition-colors ${e==="dark"?"bg-zinc-800 text-zinc-300 hover:bg-zinc-700":"bg-zinc-100 text-zinc-700 hover:bg-zinc-200"}`,children:""}),o.jsx("button",{onClick:async()=>{if(Ks==="url"&&!bo.trim()){alert(" URL");return}if(Ks==="history"&&!wo){alert("");return}if(zo-ko<1||zo-ko>3){alert(" 1-3 ");return}jo(!0);try{const s=qp.trim()||null;Ks==="url"?await Ch(bo,ko,zo,null,s):await Ch("",ko,zo,wo,s)}finally{jo(!1)}},disabled:Bu,className:`px-4 py-2 text-xs rounded transition-colors ${Bu?"bg-zinc-400 text-zinc-200 cursor-not-allowed":e==="dark"?"bg-blue-600 text-white hover:bg-blue-500":"bg-blue-500 text-white hover:bg-blue-600"}`,children:Bu?"...":""})]})]})]})}),o.jsxs("div",{className:"flex-1 relative overflow-hidden flex",children:[o.jsxs("div",{ref:Ys,id:"canvas-bg",className:"flex-1 h-full cursor-default relative",onMouseDown:Iy,onClick:Ty,onDoubleClick:My,style:{backgroundImage:e==="dark"?"radial-gradient(#27272a 1px, transparent 1px)":"radial-gradient(rgba(0, 0, 0, 0.08) 0.5px, transparent 0.5px)",backgroundSize:`${20*v.zoom}px ${20*v.zoom}px`,backgroundPosition:`${v.x}px ${v.y}px`,WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",textRendering:"optimizeLegibility",transform:"translateZ(0)",backfaceVisibility:"hidden"},children:[o.jsxs("div",{className:"absolute origin-top-left will-change-transform",style:{transform:`translate3d(${v.x}px, ${v.y}px, 0) scale(${v.zoom})`,width:F2,height:B2,WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",textRendering:"optimizeLegibility",transformOrigin:"top left",imageRendering:v.zoom>=1?"auto":"crisp-edges"},children:[o.jsx($h,{connections:i,nodesMap:Ut,connectionsByNode:So,connectingSource:V,connectingTarget:Ue,connectingInputType:rn,mousePos:Kn,apiConfigsMap:en,selectedNodeId:ze,onDisconnectConnection:Qu,visibleNodes:Yl}),Yl.map(s=>S1(s))]}),us&&o.jsx("div",{className:"absolute border-2 border-blue-500 bg-blue-500/10 pointer-events-none z-50",style:{left:Math.min(us.startX,us.endX),top:Math.min(us.startY,us.endY),width:Math.abs(us.endX-us.startX),height:Math.abs(us.endY-us.startY)}})]}),o.jsxs("div",{className:`fixed right-0 top-12 bottom-0 border-l shadow-2xl flex flex-col z-50 transition-transform duration-300 ease-in-out select-text ${e==="dark"?"bg-[#121214] border-zinc-800":"bg-white border-zinc-200"} ${Fs?"translate-x-0":"translate-x-full"}`,style:{width:Bs,pointerEvents:Fs?"auto":"none"},children:[o.jsx("div",{className:`absolute left-0 top-0 bottom-0 w-1.5 cursor-ew-resize transition-colors z-50 flex items-center justify-center group ${e==="dark"?"hover:bg-blue-600/50":"hover:bg-blue-400/30"}`,onMouseDown:Ey,children:o.jsx("div",{className:`h-8 w-1 rounded transition-colors ${e==="dark"?"bg-zinc-700 group-hover:bg-blue-500":"bg-zinc-300 group-hover:bg-blue-500"}`})}),o.jsxs("div",{className:`h-12 flex items-center justify-between px-3 shrink-0 border-b ${e==="dark"?"border-zinc-800":"border-zinc-200"}`,children:[o.jsx("div",{className:"flex items-center gap-2 overflow-hidden",children:o.jsxs("div",{className:"relative",children:[o.jsx("select",{value:di,onChange:s=>An(s.target.value),className:`text-xs border rounded pl-2 pr-6 py-1 appearance-none outline-none focus:border-blue-500 cursor-pointer max-w-[180px] truncate ${e==="dark"?"bg-zinc-800 text-zinc-300 border-zinc-700":"bg-white text-zinc-800 border-zinc-300"}`,children:ae.filter(s=>s.type==="Chat").map(s=>o.jsx("option",{value:s.id,children:s.modelName||s.id},s.id))}),o.jsx("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 pointer-events-none",children:o.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${Yi(di)}`})})]})}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{onClick:Dy,className:`p-1.5 rounded ${e==="dark"?"text-zinc-400 hover:text-white hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-900 hover:bg-zinc-100"}`,title:"",children:o.jsx(Ni,{size:16})}),At.length>1&&o.jsxs("div",{className:"relative",children:[o.jsx("button",{onClick:()=>Hu(!th),className:`p-1.5 rounded ${e==="dark"?"text-zinc-400 hover:text-white hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-900 hover:bg-zinc-100"}`,children:o.jsx(gm,{size:16})}),th&&o.jsx("div",{className:`absolute right-0 top-full mt-1 w-48 rounded-lg shadow-xl py-1 z-50 border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseLeave:()=>Hu(!1),children:At.map(s=>o.jsxs("div",{className:`flex items-center justify-between px-3 py-2 text-xs cursor-pointer ${Cn===s.id?e==="dark"?"bg-zinc-800 text-white":"bg-zinc-100 text-zinc-900":e==="dark"?"text-zinc-400 hover:bg-zinc-800/50":"text-zinc-500 hover:bg-zinc-100"}`,onClick:()=>{En(s.id),Hu(!1)},children:[o.jsx("span",{className:"truncate flex-1",children:s.title}),o.jsx("button",{onClick:c=>{c.stopPropagation(),Ly(c,s.id)},className:`p-1 ${e==="dark"?"text-zinc-600 hover:text-red-500":"text-zinc-400 hover:text-red-500"}`,children:o.jsx(es,{size:10})})]},s.id))})]}),o.jsx("button",{onClick:()=>Nr(!1),className:`p-1.5 rounded ${e==="dark"?"text-zinc-400 hover:text-white hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-900 hover:bg-zinc-100"}`,children:o.jsx(nl,{size:16})})]})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-4 space-y-4 select-text",children:[Co==null?void 0:Co.messages.map(s=>o.jsxs("div",{className:`flex gap-3 select-text ${s.role==="user"?"flex-row-reverse":""}`,children:[o.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center shrink-0 select-none ${s.role==="user"?"bg-blue-600":"bg-green-600"}`,children:s.role==="user"?o.jsx(bm,{size:16,className:"text-white"}):o.jsx(cm,{size:16,className:"text-white"})}),o.jsxs("div",{className:`flex flex-col gap-1 max-w-[85%] select-text ${s.role==="user"?"items-end":"items-start"}`,children:[s.files&&s.files.length>0&&o.jsx("div",{className:`flex flex-wrap gap-2 mb-1 ${s.role==="user"?"justify-end":"justify-start"}`,children:s.files.map((c,f)=>o.jsx("div",{className:`rounded p-1 border flex items-center gap-1 ${e==="dark"?"bg-zinc-800 border-zinc-700":"bg-zinc-100 border-zinc-300"}`,children:c.isImage?o.jsx(Hn,{src:c.content,className:"w-16 h-16 object-cover rounded",alt:c.name}):c.isVideo?o.jsx("video",{src:c.content,controls:!0,className:`max-w-full rounded-lg bg-black max-h-[300px] border ${e==="dark"?"border-zinc-700":"border-zinc-300"}`,playsInline:!0}):c.isAudio?o.jsxs("div",{className:`w-12 h-12 rounded flex flex-col items-center justify-center ${e==="dark"?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-zinc-100 border border-zinc-300 text-zinc-500"}`,children:[o.jsx(hm,{size:16}),o.jsx("span",{className:"text-[8px] mt-1",children:""})]}):c.isPDF?o.jsxs("div",{className:`w-12 h-12 rounded flex flex-col items-center justify-center ${e==="dark"?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-zinc-100 border border-zinc-300 text-zinc-500"}`,children:[o.jsx(Qr,{size:16}),o.jsx("span",{className:"text-[8px] mt-1",children:"PDF"})]}):c.isDoc?o.jsxs("div",{className:`w-12 h-12 rounded flex flex-col items-center justify-center ${e==="dark"?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-zinc-100 border border-zinc-300 text-zinc-500"}`,children:[o.jsx(Qr,{size:16}),o.jsx("span",{className:"text-[8px] mt-1",children:"DOC"})]}):c.isExcel?o.jsxs("div",{className:`w-12 h-12 rounded flex flex-col items-center justify-center ${e==="dark"?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-zinc-100 border border-zinc-300 text-zinc-500"}`,children:[o.jsx(Qr,{size:16}),o.jsx("span",{className:"text-[8px] mt-1",children:"XLS"})]}):o.jsxs("div",{className:`w-12 h-12 rounded flex flex-col items-center justify-center ${e==="dark"?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-zinc-100 border border-zinc-300 text-zinc-500"}`,children:[o.jsx(Qr,{size:16}),o.jsx("span",{className:"text-[8px] mt-1 max-w-full truncate px-1",children:c.fileExt||c.name.split(".").pop()||""})]})},f))}),(s.content||s.files&&s.files.length>0)&&o.jsx("div",{className:`rounded-2xl px-4 py-2 text-sm select-text break-words whitespace-pre-wrap ${s.role==="user"?e==="dark"?"bg-zinc-800 text-white rounded-tr-none":"bg-zinc-300 text-zinc-900 rounded-tr-none":e==="dark"?"bg-zinc-800/50 text-zinc-300 rounded-tl-none border border-zinc-800":"bg-zinc-100 text-zinc-800 rounded-tl-none border border-zinc-200"}`,style:{userSelect:"text",cursor:"text"},children:s.isError?o.jsx("span",{className:"text-red-500 select-text cursor-text",style:{userSelect:"text",cursor:"text"},children:s.content}):s.content?o.jsx("div",{className:"markdown-body",dangerouslySetInnerHTML:{__html:a2.sanitize(an.parse(s.content))},style:{userSelect:"text",cursor:"text"}}):null})]})]},s.id||s.timestamp||`msg-${Math.random()}`)),ls&&o.jsxs("div",{className:"flex gap-3",children:[o.jsx("div",{className:"w-8 h-8 rounded-full bg-green-600 flex items-center justify-center shrink-0",children:o.jsx(cm,{size:16,className:"text-white"})}),o.jsx("div",{className:`rounded-2xl rounded-tl-none px-4 py-2 border flex items-center ${e==="dark"?"bg-zinc-800/50 border-zinc-800":"bg-zinc-100 border-zinc-200"}`,children:o.jsxs("div",{className:"flex gap-1",children:[o.jsx("div",{className:"w-1.5 h-1.5 bg-zinc-500 rounded-full animate-bounce",style:{animationDelay:"0s"}}),o.jsx("div",{className:"w-1.5 h-1.5 bg-zinc-500 rounded-full animate-bounce",style:{animationDelay:"0.2s"}}),o.jsx("div",{className:"w-1.5 h-1.5 bg-zinc-500 rounded-full animate-bounce",style:{animationDelay:"0.4s"}})]})})]}),o.jsx("div",{ref:ah})]}),o.jsxs("div",{className:`p-3 border-t ${e==="dark"?"border-zinc-800 bg-[#121214]":"border-zinc-200 bg-zinc-50"}`,children:[tr.length>0&&o.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 mb-2 custom-scrollbar",children:tr.map((s,c)=>o.jsxs("div",{className:"relative group shrink-0",children:[s.isImage?o.jsx(Hn,{src:s.content,className:`w-12 h-12 object-cover rounded border ${e==="dark"?"border-zinc-700":"border-zinc-300"}`,alt:s.name}):s.isVideo?o.jsx("video",{src:s.content,className:`w-16 h-12 object-cover rounded border bg-black ${e==="dark"?"border-zinc-700":"border-zinc-300"}`,muted:!0,playsInline:!0}):s.isAudio?o.jsxs("div",{className:`w-12 h-12 rounded flex flex-col items-center justify-center ${e==="dark"?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-zinc-100 border border-zinc-300 text-zinc-500"}`,children:[o.jsx(hm,{size:16}),o.jsx("span",{className:"text-[8px] mt-1",children:""})]}):s.isPDF?o.jsxs("div",{className:`w-12 h-12 rounded flex flex-col items-center justify-center ${e==="dark"?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-zinc-100 border border-zinc-300 text-zinc-500"}`,children:[o.jsx(Qr,{size:16}),o.jsx("span",{className:"text-[8px] mt-1",children:"PDF"})]}):s.isDoc?o.jsxs("div",{className:`w-12 h-12 rounded flex flex-col items-center justify-center ${e==="dark"?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-zinc-100 border border-zinc-300 text-zinc-500"}`,children:[o.jsx(Qr,{size:16}),o.jsx("span",{className:"text-[8px] mt-1",children:"DOC"})]}):s.isExcel?o.jsxs("div",{className:`w-12 h-12 rounded flex flex-col items-center justify-center ${e==="dark"?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-zinc-100 border border-zinc-300 text-zinc-500"}`,children:[o.jsx(Qr,{size:16}),o.jsx("span",{className:"text-[8px] mt-1",children:"XLS"})]}):o.jsxs("div",{className:`w-12 h-12 rounded flex flex-col items-center justify-center ${e==="dark"?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-zinc-100 border border-zinc-300 text-zinc-500"}`,children:[o.jsx(Qr,{size:16}),o.jsx("span",{className:"text-[8px] mt-1 max-w-full truncate px-1",children:s.fileExt||s.name.split(".").pop()||""})]}),o.jsx("button",{onClick:()=>Uy(c),className:`absolute -top-1 -right-1 rounded-full p-0.5 border opacity-0 group-hover:opacity-100 transition-opacity ${e==="dark"?"bg-zinc-900 text-zinc-400 hover:text-white border-zinc-700":"bg-white text-zinc-500 hover:text-zinc-900 border-zinc-300"}`,children:o.jsx(es,{size:10})})]},c))}),o.jsxs("div",{className:`relative rounded-xl flex items-end p-2 focus-within:border-blue-500/50 transition-colors border ${e==="dark"?"bg-zinc-800/50 border-zinc-700":"bg-white border-zinc-300"}`,children:[o.jsxs("label",{className:`p-2 cursor-pointer transition-colors ${e==="dark"?"text-zinc-400 hover:text-white":"text-zinc-500 hover:text-zinc-900"}`,title:"",children:[o.jsx(k2,{size:18}),o.jsx("input",{type:"file",multiple:!0,className:"hidden",onChange:Oy,accept:"image/*,video/*,audio/*,.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.md,.js,.py,.html,.css,.json,.csv"})]}),o.jsx("textarea",{value:Dr,onChange:s=>ui(s.target.value),onKeyDown:s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),bh())},placeholder:"...",className:`w-full bg-transparent text-sm resize-none outline-none max-h-32 py-2 px-1 custom-scrollbar ${e==="dark"?"text-white placeholder-zinc-500":"text-zinc-800 placeholder-zinc-400"}`,rows:1,style:{minHeight:"36px"}}),o.jsx("button",{onClick:bh,disabled:!Dr.trim()&&tr.length===0||ls,className:`p-2 rounded-lg transition-all mb-0.5 ${!Dr.trim()&&tr.length===0||ls?"opacity-50 bg-transparent text-zinc-400":"bg-blue-600 text-white hover:bg-blue-500"}`,children:o.jsx(S2,{size:16})})]}),o.jsx("div",{className:`text-[10px] text-center mt-2 ${e==="dark"?"text-zinc-600":"text-zinc-500"}`,children:" MP4/MP3/PDF/Doc/Excel/Code   Enter "})]})]}),gi.visible&&o.jsx("div",{className:`fixed z-50 w-40 rounded-lg shadow-xl border ${e==="dark"?"bg-[#18181b] border-zinc-800":"bg-white border-zinc-200"}`,style:{left:gi.x,top:gi.y,transform:"translate(-50%, -50%)"},onMouseLeave:()=>xo(s=>({...s,visible:!1})),children:o.jsx("div",{className:"p-1",children:[{type:"input-image",label:""},{type:"text-node",label:""},{type:"video-input",label:" / "},{type:"video-analyze",label:" / "},{type:"storyboard-node",label:""},{type:"gen-image",label:"AI "},{type:"gen-video",label:"AI "},{type:"image-compare",label:""},{type:"preview",label:""}].map(s=>o.jsx("button",{className:`w-full text-left px-3 py-2 text-xs rounded transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:()=>ps(s.type,gi.worldX,gi.worldY,gi.sourceNodeId,void 0,void 0,gi.targetNodeId,gi.inputType),children:s.label},s.type))})}),lr.visible&&o.jsxs("div",{className:`fixed z-[100] w-48 rounded-lg shadow-2xl py-1 animate-in fade-in duration-100 border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,style:{left:lr.x,top:lr.y},children:[o.jsx("div",{className:`px-3 py-1.5 text-[10px] font-medium border-b mb-1 ${e==="dark"?"text-zinc-500 border-zinc-800":"text-zinc-500 border-zinc-200"}`,children:""}),o.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:w1,children:[o.jsx(Ao,{size:14,className:"text-purple-500"})," "]}),o.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:b1,children:[o.jsx(To,{size:14,className:"text-blue-500"})," "]}),o.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:()=>{const s=lr.item;s!=null&&s.url&&(r(c=>{const f=c.filter(p=>p.type==="preview");if(!f.length)return c;const h=f[f.length-1].id;return c.map(p=>p.id===h?{...p,content:s.url,previewType:s.type==="video"?"video":"image"}:p)}),ds({visible:!1,x:0,y:0,item:null}))},children:[o.jsx(Is,{size:14,className:"text-emerald-500"})," "]}),o.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:v1,children:[o.jsx(Cc,{size:14,className:ze?"text-green-500":"text-zinc-400"})," "]}),o.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:()=>{const s=lr.item,c=s.mjImages&&s.mjImages.length>0?s.mjImages[s.selectedMjImageIndex||0]||s.mjImages[0]:s.url||s.mjOriginalUrl;c&&(Or.nodeId&&Or.shotId?Kt(Or.nodeId,Or.shotId,{image_url:c}):alert(""),ds({visible:!1,x:0,y:0,worldX:0,worldY:0,item:null}))},children:[o.jsx(Ya,{size:14,className:Or.nodeId&&Or.shotId?"text-orange-500":"text-zinc-400"})," "]}),o.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:()=>{const s=lr.item;if(s!=null&&s.url){const c=(lr.worldX||0)+340,f=lr.worldY||0;Ia(s.url,{originX:c,originY:f})}ds({visible:!1,x:0,y:0,worldX:0,worldY:0,item:null})},children:[o.jsx(Ld,{size:14,className:"text-blue-500"})," "]}),o.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:async()=>{const s=lr.item;if(s!=null&&s.url){try{const f=s.type==="video"||s.url.includes("/video/")||s.url.includes("video_mp4")?"mp4":"png",p=`${(s.prompt||"download").replace(/[\\/:*?"<>|]/g,"_").slice(0,50)}.${f}`,N=await(await fetch(s.url)).blob(),T=window.URL.createObjectURL(N),I=document.createElement("a");I.href=T,I.download=p,I.click(),window.URL.revokeObjectURL(T),console.log(" :",p)}catch(c){console.error(":",c),alert("")}ds({visible:!1,x:0,y:0,worldX:0,worldY:0,item:null})}},children:[o.jsx(Ka,{size:14,className:"text-green-500"})," ",((Dh=lr.item)==null?void 0:Dh.type)==="video"?"":""]})]}),xi.visible&&o.jsxs("div",{className:`fixed z-[110] w-48 rounded-lg shadow-2xl py-1 animate-in fade-in duration-100 border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,style:{left:xi.x,top:xi.y},children:[o.jsx("div",{className:`px-3 py-1.5 text-[10px] font-medium border-b mb-1 ${e==="dark"?"text-zinc-500 border-zinc-800":"text-zinc-500 border-zinc-200"}`,children:""}),o.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:m1,children:[o.jsx(Ao,{size:14,className:"text-purple-500"})," "]}),o.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:g1,children:[o.jsx(To,{size:14,className:"text-blue-500"})," "]}),o.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:x1,children:[o.jsx(Is,{size:14,className:"text-emerald-500"})," "]}),o.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:y1,children:[o.jsx(Cc,{size:14,className:ze?"text-green-500":"text-zinc-400"})," "]})]}),yo.visible&&o.jsxs("div",{className:`fixed z-[110] w-48 rounded-lg shadow-2xl py-1 animate-in fade-in duration-100 border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,style:{left:yo.x,top:yo.y},onMouseLeave:ic,children:[o.jsx("div",{className:`px-3 py-1.5 text-[10px] font-medium border-b mb-1 ${e==="dark"?"text-zinc-500 border-zinc-800":"text-zinc-500 border-zinc-200"}`,children:""}),o.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:z1,children:[o.jsx(Ao,{size:14,className:"text-purple-500"})," "]}),o.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:j1,children:[o.jsx(To,{size:14,className:"text-blue-500"})," "]}),o.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:()=>{const s=yo.item;if(s!=null&&s.url){const c=_s.current;if(c&&c.size===9)Ia(s.url,{replaceSelected:!0});else{const h=s.sourceNode,p=h?h.x+h.width+20:void 0,m=h?h.y:void 0;Ia(s.url,{originX:p,originY:m})}}ic()},children:[o.jsx(Ld,{size:14,className:"text-blue-500"})," "]})]}),pa.visible&&o.jsxs("div",{className:`fixed z-[110] w-48 rounded-lg shadow-2xl py-1 animate-in fade-in duration-100 border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,style:{left:pa.x,top:pa.y},onMouseLeave:nd,children:[o.jsx("div",{className:`px-3 py-1.5 text-[10px] font-medium border-b mb-1 ${e==="dark"?"text-zinc-500 border-zinc-800":"text-zinc-500 border-zinc-200"}`,children:""}),o.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:N1,children:[o.jsx(Ao,{size:14,className:"text-purple-500"})," "]}),o.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:()=>{const s=pa.nodeId,c=Ut.get(s);if(!c||!c.content)return;const f=_s.current;if(f&&f.size===9)Ia(c.content,{replaceSelected:!0});else{const p=c.x+c.width+20,m=c.y;Ia(c.content,{originX:p,originY:m})}nd()},children:[o.jsx(Ld,{size:14,className:"text-blue-500"})," "]})]}),o.jsx(J2,{item:Sr,onClose:()=>Pn(null),onNavigate:s=>{if(Sr&&Sr.mjImages&&Sr.mjImages.length>s&&s>=0){const c=Math.max(0,Math.min(s,Sr.mjImages.length-1));ye(f=>f.map(h=>h.id===Sr.id?{...h,url:Sr.mjImages[c],selectedMjImageIndex:c}:h)),Pn({...Sr,url:Sr.mjImages[c],selectedMjImageIndex:c})}}}),o.jsxs(Z2,{isOpen:dy,onClose:()=>yi(!1),title:"",theme:e,children:[o.jsx("div",{className:"p-4 space-y-3",children:o.jsxs("div",{className:"mb-2",children:[o.jsx("label",{className:`text-[10px] font-medium uppercase tracking-wider ${e==="dark"?"text-zinc-500":"text-zinc-600"}`,children:"Global API Key Key"}),o.jsx("div",{className:"mt-1 flex gap-2",children:o.jsx("input",{type:"password",value:Ve,onChange:s=>Ye(s.target.value),className:`flex-1 rounded px-2 py-1 text-xs outline-none focus:border-blue-600/50 border ${e==="dark"?"bg-zinc-900 border-zinc-800 text-zinc-300":"bg-white border-zinc-300 text-zinc-900"}`,placeholder:" Key Key"})})]})}),o.jsxs("div",{className:"mb-2 border-t pt-2 border-zinc-700/50",children:[o.jsx("label",{className:`text-[10px] font-medium uppercase tracking-wider ${e==="dark"?"text-zinc-500":"text-zinc-600"}`,children:"V2.6.1 "}),o.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-2",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-1",children:[o.jsx("span",{className:`text-xs ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:""}),o.jsxs("select",{value:O,onChange:s=>{const c=s.target.value;ee(c),localStorage.setItem("tapnow_performance_mode",c)},className:`text-xs rounded px-2 py-0.5 border outline-none ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300":"bg-white border-zinc-300"}`,children:[o.jsx("option",{value:"off",children:" ()"}),o.jsx("option",{value:"normal",children:" ()"}),o.jsx("option",{value:"ultra",children:" ()"})]})]}),o.jsx("p",{className:"text-[9px] text-zinc-500",children:""})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex flex-col gap-1",children:[o.jsx("span",{className:`text-xs ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:""}),o.jsx("input",{type:"text",value:Se,onChange:s=>{const c=s.target.value;Te(c),localStorage.setItem("tapnow_local_server_url",c)},placeholder:"http://127.0.0.1:9527",className:`w-full text-xs rounded px-2 py-1 border outline-none ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300":"bg-white border-zinc-300"}`})]}),o.jsx("p",{className:"text-[9px] text-zinc-500 mt-1",children:""})]})]})]}),o.jsxs("div",{className:"mb-2 border-t pt-2 border-zinc-700/50",children:[o.jsx("label",{className:`text-[10px] font-medium uppercase tracking-wider ${e==="dark"?"text-zinc-500":"text-zinc-600"}`,children:"API "}),o.jsxs("div",{className:"flex gap-2 mt-2",children:[o.jsxs("button",{onClick:()=>{const s={version:"3.4.23",exportTime:new Date().toISOString(),globalApiKey:Ve,providers:X,apiConfigs:ae.map(({key:$,url:D,...P})=>P)},c=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),f=URL.createObjectURL(c),h=document.createElement("a");h.href=f;const p=new Date,m=p.getFullYear().toString().slice(2),N=(p.getMonth()+1).toString().padStart(2,"0"),T=p.getDate().toString().padStart(2,"0"),I=p.getHours().toString().padStart(2,"0"),M=p.getMinutes().toString().padStart(2,"0");h.download=`tapnow-api-keys-${m}${N}${T}-${I}${M}.json`,h.click(),URL.revokeObjectURL(f)},className:`flex-1 px-3 py-2 text-xs rounded flex items-center justify-center gap-2 transition-colors ${e==="dark"?"bg-blue-600/20 text-blue-400 hover:bg-blue-600/30 border border-blue-500/30":"bg-blue-50 text-blue-600 hover:bg-blue-100 border border-blue-200"}`,children:[o.jsx(Ka,{size:14})," API Keys"]}),o.jsxs("button",{onClick:()=>{const s=document.createElement("input");s.type="file",s.accept=".json",s.onchange=async c=>{const f=c.target.files[0];if(f)try{const h=await f.text(),p=JSON.parse(h);if(p.globalApiKey&&(Ye(p.globalApiKey),localStorage.setItem("tapnow_global_key",p.globalApiKey)),p.providers&&oe(m=>({...m,...p.providers})),p.apiConfigs&&Array.isArray(p.apiConfigs)){const m=p.apiConfigs.map(N=>{if(N.modelName&&N.modelName!==N.id)return{id:N.modelName,provider:N.provider,type:N.type,...N.durations?{durations:N.durations}:{}};const{displayName:T,modelName:I,isCustom:M,key:$,url:D,...P}=N;return P});Re(m)}alert("API ")}catch(h){alert(": "+h.message)}},s.click()},className:`flex-1 px-3 py-2 text-xs rounded flex items-center justify-center gap-2 transition-colors ${e==="dark"?"bg-zinc-800 text-zinc-300 hover:bg-zinc-700 border border-zinc-700":"bg-zinc-100 text-zinc-700 hover:bg-zinc-200 border border-zinc-300"}`,children:[o.jsx(Mo,{size:14})," API Keys"]})]}),o.jsx("p",{className:"text-[9px] text-zinc-500 mt-1",children:" KeyProvider  Key"})]}),o.jsx("div",{className:"mb-2 border-t pt-2 border-zinc-700/50",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("label",{className:`text-[10px] font-medium uppercase tracking-wider ${e==="dark"?"text-zinc-500":"text-zinc-600"}`,children:"/"}),o.jsx("p",{className:`text-[10px] mt-0.5 ${e==="dark"?"text-zinc-600":"text-zinc-500"}`,children:" ()"})]}),o.jsxs("div",{className:"flex items-center gap-2 ml-3",children:[o.jsx("input",{type:"range",min:"1",max:"30",value:l,onChange:s=>{const c=parseInt(s.target.value)||5;u(c),localStorage.setItem("tapnow_max_undo_steps",String(c))},className:"w-20",onMouseDown:s=>s.stopPropagation()}),o.jsx("span",{className:`text-xs font-mono w-6 text-center ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:l})]})]})}),o.jsx("div",{className:"mb-2",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("label",{className:`text-[10px] font-medium uppercase tracking-wider ${e==="dark"?"text-zinc-500":"text-zinc-600"}`,children:""}),o.jsx("p",{className:`text-[10px] mt-0.5 ${e==="dark"?"text-zinc-600":"text-zinc-500"}`,children:"FormDataURL"})]}),o.jsxs("label",{className:"relative inline-flex items-center cursor-pointer ml-3",children:[o.jsx("input",{type:"checkbox",checked:Ht,onChange:s=>{const c=s.target.checked;bn(c),localStorage.setItem("tapnow_jimeng_use_local_file",String(c))},className:"sr-only peer"}),o.jsx("div",{className:`w-11 h-6 rounded-full peer peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-500/50 ${Ht?"bg-blue-600":e==="dark"?"bg-zinc-700":"bg-zinc-300"} peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all`})]})]})}),o.jsxs("div",{className:"flex justify-between items-center mb-2",children:[o.jsx("span",{className:`text-xs ${e==="dark"?"text-zinc-400":"text-zinc-500"}`,children:""}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:()=>{const s=Object.values(xa).some(f=>f),c={};s||Object.keys(Ss).forEach(f=>c[f]=!0),Wu(c)},className:`p-1 rounded hover:bg-zinc-200 dark:hover:bg-zinc-700 transition-colors ${e==="dark"?"text-zinc-400":"text-zinc-500"}`,title:Object.values(xa).some(s=>s)?"":"",children:o.jsx(p2,{size:14,className:`transition-transform ${Object.values(xa).some(s=>s)?"":"rotate-180"}`})}),o.jsxs(Tc,{className:"h-7 text-xs px-3 bg-blue-600 hover:bg-blue-500",onClick:()=>{const s=`custom-${Date.now()}`,c="New Provider";oe(f=>({...f,[s]:{name:c,key:"",url:"",enabled:!0}})),Wu(f=>({...f,[s]:!0})),Vl({key:s,tempName:c})},children:[o.jsx(Ni,{size:14,className:"mr-1"})," "]})]})]}),o.jsx("div",{className:"space-y-2 max-h-[50vh] overflow-y-auto custom-scrollbar pr-1",children:Object.entries(Ss).map(([s,c])=>{var f,h,p;return o.jsxs("div",{className:`group rounded-lg border ${e==="dark"?"bg-[#18181b] border-zinc-800":"bg-zinc-50 border-zinc-200"}`,children:[o.jsx("button",{onClick:()=>Wu(m=>({...m,[s]:!m[s]})),className:`w-full flex items-center justify-between px-3 py-2.5 text-left transition-colors ${e==="dark"?"hover:bg-zinc-800/50":"hover:bg-zinc-100"}`,children:gy===s?o.jsxs("div",{className:"flex items-center justify-between w-full",children:[o.jsxs("span",{className:`text-sm font-semibold ${e==="dark"?"text-zinc-100":"text-zinc-800"}`,children:[" ",c.name,"?"]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:m=>{m.stopPropagation(),oe(N=>{const T={...N};return delete T[s],T}),Vu(null)},className:"text-xs px-2 py-1 bg-red-600 hover:bg-red-700 text-white rounded",children:""}),o.jsx("button",{onClick:m=>{m.stopPropagation(),Vu(null)},className:`text-xs px-2 py-1 rounded ${e==="dark"?"bg-zinc-700 hover:bg-zinc-600 text-zinc-300":"bg-zinc-200 hover:bg-zinc-300 text-zinc-700"}`,children:""})]})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[o.jsx("div",{className:`w-2 h-2 rounded-full ${((f=X[s])==null?void 0:f.enabled)!==!1?"bg-green-500":"bg-zinc-500"}`}),(_o==null?void 0:_o.key)===s?o.jsx("input",{type:"text",value:_o.tempName,onChange:m=>Vl(N=>({...N,tempName:m.target.value})),onBlur:()=>{const m=_o.tempName.trim(),N=s;m&&m!==N&&(oe(T=>{const{[N]:I,...M}=T;return{...M,[m]:I}}),Re(T=>T.map(I=>I.provider===N?{...I,provider:m}:I))),Vl(null)},onKeyDown:m=>{m.key==="Enter"&&m.target.blur(),m.stopPropagation()},onClick:m=>m.stopPropagation(),autoFocus:!0,className:`text-sm font-semibold bg-transparent border-b border-blue-500 outline-none w-full ${e==="dark"?"text-zinc-100":"text-zinc-800"}`}):o.jsx("span",{className:`text-sm font-semibold ${e==="dark"?"text-zinc-100":"text-zinc-800"}`,children:c.name}),o.jsxs("span",{className:`text-[10px] px-1.5 py-0.5 rounded ${e==="dark"?"bg-zinc-800 text-zinc-500":"bg-zinc-200 text-zinc-500"}`,children:[c.models.length," "]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[!_o&&o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:m=>{m.stopPropagation(),Vl({key:s,tempName:c.name})},className:"p-1 rounded-full hover:bg-zinc-200 dark:hover:bg-zinc-700 transition-colors opacity-0 group-hover:opacity-100",title:"",children:o.jsx(z2,{size:12,className:e==="dark"?"text-zinc-400":"text-zinc-500"})}),o.jsx("button",{onClick:m=>{m.stopPropagation(),Vu(s)},className:"p-1 rounded-full hover:bg-zinc-200 dark:hover:bg-zinc-700 transition-colors opacity-0 group-hover:opacity-100",title:"",children:o.jsx(Ms,{size:12,className:e==="dark"?"text-zinc-400 hover:text-red-400":"text-zinc-500 hover:text-red-500"})})]}),o.jsx(_i,{size:16,className:`transition-transform ${xa[s]?"rotate-180":""} ${e==="dark"?"text-zinc-500":"text-zinc-400"}`})]})]})}),xa[s]&&o.jsxs("div",{className:`px-3 pb-3 border-t ${e==="dark"?"border-zinc-800":"border-zinc-200"}`,children:[o.jsxs("div",{className:"pt-3 pb-2 space-y-2",children:[o.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[o.jsx("label",{className:`text-[10px] font-medium uppercase tracking-wider text-right ${e==="dark"?"text-zinc-500":"text-zinc-600"}`,children:"API Key"}),o.jsx("input",{type:"password",value:((h=X[s])==null?void 0:h.key)||"",onChange:m=>oe(N=>({...N,[s]:{...N[s],key:m.target.value}})),className:`col-span-3 w-full rounded px-2 py-1 text-xs outline-none focus:border-blue-600/50 border ${e==="dark"?"bg-zinc-900 border-zinc-800 text-zinc-300":"bg-white border-zinc-300 text-zinc-900"}`,placeholder:"sk-..."})]}),o.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[o.jsx("label",{className:`text-[10px] font-medium uppercase tracking-wider text-right ${e==="dark"?"text-zinc-500":"text-zinc-600"}`,children:"Base URL"}),o.jsx("input",{type:"text",value:((p=X[s])==null?void 0:p.url)||"",onChange:m=>oe(N=>({...N,[s]:{...N[s],url:m.target.value}})),className:`col-span-3 w-full rounded px-2 py-1 text-xs outline-none focus:border-blue-600/50 border ${e==="dark"?"bg-zinc-900 border-zinc-800 text-zinc-300":"bg-white border-zinc-300 text-zinc-900"}`,placeholder:"https://..."})]})]}),o.jsxs("div",{className:`mt-2 pt-2 border-t ${e==="dark"?"border-zinc-800/50":"border-zinc-200"}`,children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("div",{className:`text-[10px] font-medium uppercase tracking-wider ${e==="dark"?"text-zinc-500":"text-zinc-600"}`,children:""}),o.jsxs("button",{onClick:()=>{const m=`${s}-${Date.now()}`;Re(N=>[...N,{id:m,provider:s,type:"Chat"}])},className:`text-[9px] px-1.5 py-0.5 rounded flex items-center gap-1 ${e==="dark"?"bg-zinc-800 text-zinc-400 hover:bg-zinc-700":"bg-zinc-200 text-zinc-600 hover:bg-zinc-300"}`,children:[o.jsx(Ni,{size:10})," "]})]}),o.jsx("div",{className:"space-y-1.5",children:c.models.map(m=>o.jsxs("div",{className:`flex items-center justify-between px-2 py-1.5 rounded ${e==="dark"?"bg-zinc-900/50 hover:bg-zinc-800/50":"bg-white hover:bg-zinc-100"}`,children:[o.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[o.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${Yi(m.id)}`}),o.jsx("input",{type:"text",value:m.id||"",onChange:N=>vh(m.id,{id:N.target.value},m.id),className:`text-xs bg-transparent border-b border-transparent hover:border-zinc-600 focus:border-blue-500 outline-none flex-1 font-mono ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,placeholder:"model-id",title:` ID: ${m.id}`}),o.jsxs("select",{value:m.type||"Chat",onChange:N=>vh(m.id,{type:N.target.value}),className:`text-[9px] px-1 rounded cursor-pointer outline-none ${e==="dark"?"bg-zinc-800 text-zinc-400 hover:bg-zinc-700":"bg-zinc-200 text-zinc-500 hover:bg-zinc-300"}`,children:[o.jsx("option",{value:"Chat",children:"Chat"}),o.jsx("option",{value:"Image",children:"Image"}),o.jsx("option",{value:"Video",children:"Video"})]})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{onClick:()=>Py(m.id),disabled:nh===m.id,className:`px-1.5 py-0.5 rounded text-[9px] ${Yu[m.id]==="success"?"text-green-500":e==="dark"?"text-zinc-500 hover:text-zinc-300":"text-zinc-400 hover:text-zinc-600"}`,children:nh===m.id?o.jsx(Js,{size:10,className:"animate-spin"}):Yu[m.id]==="success"?o.jsx(el,{size:10}):o.jsx(Ga,{size:10})}),o.jsx("button",{onClick:()=>Ay(m.id),className:`px-1 ${e==="dark"?"text-zinc-600 hover:text-red-500":"text-zinc-400 hover:text-red-500"}`,children:o.jsx(Ms,{size:10})})]})]},m.id))})]})]})]},s)})}),o.jsx("div",{className:`pt-2 flex justify-end gap-2 border-t mt-3 ${e==="dark"?"border-zinc-800":"border-zinc-200"}`,children:o.jsx(Tc,{variant:"secondary",onClick:()=>yi(!1),children:""})})]}),py&&o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>{Wl(!1),Ki(new Set)}}),o.jsxs("div",{className:`relative w-[90vw] h-[85vh] max-w-7xl rounded-lg shadow-2xl flex flex-col ${e==="dark"?"bg-[#121214] border border-zinc-800":"bg-white border border-zinc-200"}`,children:[o.jsxs("div",{className:`p-4 border-b flex items-center justify-between ${e==="dark"?"border-zinc-800":"border-zinc-200"}`,children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("h2",{className:`text-lg font-bold ${e==="dark"?"text-zinc-100":"text-zinc-900"}`,children:""}),o.jsxs("span",{className:`text-sm ${e==="dark"?"text-zinc-400":"text-zinc-600"}`,children:[" ",Ir.size," "]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:()=>{Ir.size===Q.length?Ki(new Set):Ki(new Set(Q.map(s=>s.id)))},className:`px-3 py-1.5 text-xs rounded transition-colors ${e==="dark"?"bg-zinc-800 text-zinc-300 hover:bg-zinc-700":"bg-zinc-100 text-zinc-700 hover:bg-zinc-200"}`,children:Ir.size===Q.length?"":""}),o.jsxs("button",{onClick:()=>{Ir.size!==0&&confirm(` ${Ir.size} `)&&(ye(s=>{const c=s.filter(f=>!Ir.has(f.id));try{localStorage.setItem("tapnow_history",JSON.stringify(c))}catch(f){console.error(":",f)}return c}),Ki(new Set))},disabled:Ir.size===0,className:`px-3 py-1.5 text-xs rounded transition-colors flex items-center gap-1.5 ${Ir.size===0?e==="dark"?"bg-zinc-800/50 text-zinc-600 cursor-not-allowed":"bg-zinc-100 text-zinc-400 cursor-not-allowed":"bg-red-600 text-white hover:bg-red-700"}`,children:[o.jsx(Ms,{size:14}),""]}),o.jsxs("button",{onClick:async()=>{if(Ir.size===0)return;const s=Q.filter(p=>Ir.has(p.id)&&p.url);if(s.length===0){alert("");return}const c=un(window.innerWidth/2,window.innerHeight/2),f=c.x,h=c.y;s.forEach((p,m)=>{const N=m%5*20,T=Math.floor(m/5)*20;let I=p.url;p.type==="video"&&!Zn(I)&&(I+=(I.includes("?")?"&":"?")+"force_video_display=true"),p.type==="image"?(async()=>{try{const M=await Tr(I);ps("input-image",f+N,h+T,null,I,M)}catch{ps("input-image",f+N,h+T,null,I)}})():p.type==="video"&&ps("video-input",f+N,h+T,null,I)}),Wl(!1),Ki(new Set)},disabled:Ir.size===0,className:`px-3 py-1.5 text-xs rounded transition-colors flex items-center gap-1.5 ${Ir.size===0?e==="dark"?"bg-zinc-800/50 text-zinc-600 cursor-not-allowed":"bg-zinc-100 text-zinc-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:[o.jsx(Cc,{size:14}),""]}),o.jsx("button",{onClick:()=>{Wl(!1),Ki(new Set)},className:`p-1.5 rounded transition-colors ${e==="dark"?"text-zinc-400 hover:text-zinc-200 hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-700 hover:bg-zinc-200"}`,children:o.jsx(es,{size:18})})]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-4",children:o.jsx("div",{className:"grid grid-cols-4 gap-4",children:Q.map(s=>{var h,p;const c=Ir.has(s.id),f=s.mjImages&&s.mjImages.length>1?s.mjImages[s.selectedMjImageIndex||0]||s.mjImages[0]:s.url;return o.jsxs("div",{onClick:()=>{const m=new Set(Ir);c?m.delete(s.id):m.add(s.id),Ki(m)},onDoubleClick:m=>{m.stopPropagation();const N={...s,url:f,selectedMjImageIndex:s.mjImages&&s.mjImages.length>1?s.selectedMjImageIndex||0:void 0};Pn(N)},className:`relative rounded-lg overflow-hidden border-2 cursor-pointer transition-all ${c?"border-blue-500 shadow-lg shadow-blue-500/20":e==="dark"?"border-zinc-800 hover:border-zinc-700":"border-zinc-200 hover:border-zinc-300"}`,children:[o.jsxs("div",{className:"absolute top-2 right-2 z-10 flex items-center gap-1.5",children:[c&&o.jsx("div",{className:"bg-blue-500 rounded-full p-1",children:o.jsx(tl,{size:16,className:"text-white"})}),s.status==="completed"&&f&&o.jsx("button",{onClick:m=>{m.stopPropagation();const N={...s,url:f,selectedMjImageIndex:s.mjImages&&s.mjImages.length>1?s.selectedMjImageIndex||0:void 0};Pn(N)},className:`p-1.5 rounded-full transition-colors backdrop-blur-sm ${e==="dark"?"bg-black/60 text-white hover:bg-black/80":"bg-white/80 text-zinc-700 hover:bg-white"}`,title:" ()",children:o.jsx(Is,{size:14})})]}),o.jsx("div",{className:`relative ${s.mjImages&&(s.mjImages.length===4||s.mjImages.length>1)||s.mjNeedsSplit&&((p=(h=s.apiConfig)==null?void 0:h.modelId)!=null&&p.includes("mj"))?(()=>{const m=s.mjRatio||"1:1";return m==="16:9"?"aspect-video":m==="9:16"?"aspect-[9/16]":m==="4:3"?"aspect-[4/3]":m==="3:4"?"aspect-[3/4]":m==="21:9"?"aspect-[21/9]":"aspect-square"})():"aspect-video"} ${e==="dark"?"bg-zinc-900":"bg-zinc-100"}`,children:s.status==="completed"&&f?s.type==="video"||Zn(f)?o.jsx("video",{src:f,className:"w-full h-full object-contain",controls:!0,playsInline:!0,preload:"metadata"}):o.jsx(Hn,{src:f,className:"w-full h-full object-contain",alt:"",onError:m=>{m.target.style.display="none"}}):o.jsx("div",{className:`w-full h-full flex items-center justify-center ${e==="dark"?"text-zinc-600":"text-zinc-400"}`,children:s.status==="generating"?o.jsx(Js,{size:24,className:"animate-spin"}):o.jsx(m2,{size:24})})}),o.jsxs("div",{className:`p-2 text-xs ${e==="dark"?"bg-zinc-900 text-zinc-300":"bg-zinc-50 text-zinc-700"}`,children:[o.jsx("div",{className:"truncate font-medium",children:s.prompt||""}),o.jsxs("div",{className:"text-[10px] opacity-70 mt-0.5",children:[s.id||"","  ",s.time]})]})]},s.id)})})})]})]})]})]})]})]})}Hd.createRoot(document.getElementById("root")).render(o.jsx(bu.StrictMode,{children:o.jsx(q2,{})}));</script>
  <style rel="stylesheet" crossorigin>*,:before,:after{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }*,:before,:after{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}:before,:after{--tw-content: ""}html,:host{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}ol,ul,menu{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{opacity:1;color:#9ca3af}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}button,[role=button]{cursor:pointer}:disabled{cursor:default}img,svg,video,canvas,audio,iframe,embed,object{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.container{width:100%}@media (min-width: 640px){.container{max-width:640px}}@media (min-width: 768px){.container{max-width:768px}}@media (min-width: 1024px){.container{max-width:1024px}}@media (min-width: 1280px){.container{max-width:1280px}}@media (min-width: 1536px){.container{max-width:1536px}}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0}.pointer-events-none{pointer-events:none}.pointer-events-auto{pointer-events:auto}.\!visible{visibility:visible!important}.visible{visibility:visible}.collapse{visibility:collapse}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.inset-0{top:0;right:0;bottom:0;left:0}.-bottom-0\.5{bottom:-.125rem}.-bottom-1\.5{bottom:-.375rem}.-left-1{left:-.25rem}.-right-0\.5{right:-.125rem}.-right-1{right:-.25rem}.-right-2\.5{right:-.625rem}.-top-1{top:-.25rem}.-top-1\.5{top:-.375rem}.-top-10{top:-2.5rem}.-top-2\.5{top:-.625rem}.bottom-0{bottom:0}.bottom-1{bottom:.25rem}.bottom-2{bottom:.5rem}.bottom-4{bottom:1rem}.bottom-8{bottom:2rem}.bottom-full{bottom:100%}.left-0{left:0}.left-1{left:.25rem}.left-1\/2{left:50%}.left-2{left:.5rem}.left-4{left:1rem}.left-6{left:1.5rem}.right-0{right:0}.right-1{right:.25rem}.right-2{right:.5rem}.right-4{right:1rem}.top-0{top:0}.top-1{top:.25rem}.top-1\/2{top:50%}.top-12{top:3rem}.top-2{top:.5rem}.top-4{top:1rem}.top-full{top:100%}.z-10{z-index:10}.z-20{z-index:20}.z-30{z-index:30}.z-40{z-index:40}.z-50{z-index:50}.z-\[100\]{z-index:100}.z-\[110\]{z-index:110}.z-\[200\]{z-index:200}.z-\[60\]{z-index:60}.z-\[9999\]{z-index:9999}.col-span-3{grid-column:span 3 / span 3}.col-span-full{grid-column:1 / -1}.mx-auto{margin-left:auto;margin-right:auto}.my-1{margin-top:.25rem;margin-bottom:.25rem}.-mb-1{margin-bottom:-.25rem}.-mt-1{margin-top:-.25rem}.mb-0\.5{margin-bottom:.125rem}.mb-1{margin-bottom:.25rem}.mb-1\.5{margin-bottom:.375rem}.mb-2{margin-bottom:.5rem}.mb-3{margin-bottom:.75rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mb-auto{margin-bottom:auto}.ml-1{margin-left:.25rem}.ml-2{margin-left:.5rem}.ml-3{margin-left:.75rem}.ml-auto{margin-left:auto}.mr-0{margin-right:0}.mr-1{margin-right:.25rem}.mr-1\.5{margin-right:.375rem}.mr-2{margin-right:.5rem}.mt-0\.5{margin-top:.125rem}.mt-1{margin-top:.25rem}.mt-2{margin-top:.5rem}.mt-3{margin-top:.75rem}.mt-auto{margin-top:auto}.line-clamp-1{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}.line-clamp-2{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2}.block{display:block}.flex{display:flex}.inline-flex{display:inline-flex}.table{display:table}.grid{display:grid}.hidden{display:none}.aspect-\[21\/9\]{aspect-ratio:21/9}.aspect-\[3\/4\]{aspect-ratio:3/4}.aspect-\[4\/3\]{aspect-ratio:4/3}.aspect-\[9\/16\]{aspect-ratio:9/16}.aspect-square{aspect-ratio:1 / 1}.aspect-video{aspect-ratio:16 / 9}.h-0{height:0px}.h-1{height:.25rem}.h-1\.5{height:.375rem}.h-10{height:2.5rem}.h-12{height:3rem}.h-14{height:3.5rem}.h-16{height:4rem}.h-2{height:.5rem}.h-20{height:5rem}.h-24{height:6rem}.h-3{height:.75rem}.h-3\.5{height:.875rem}.h-4{height:1rem}.h-40{height:10rem}.h-5{height:1.25rem}.h-6{height:1.5rem}.h-64{height:16rem}.h-7{height:1.75rem}.h-8{height:2rem}.h-\[2px\]{height:2px}.h-\[85vh\]{height:85vh}.h-\[90px\]{height:90px}.h-auto{height:auto}.h-full{height:100%}.h-px{height:1px}.h-screen{height:100vh}.max-h-32{max-height:8rem}.max-h-36{max-height:9rem}.max-h-64{max-height:16rem}.max-h-80{max-height:20rem}.max-h-\[140px\]{max-height:140px}.max-h-\[300px\]{max-height:300px}.max-h-\[50vh\]{max-height:50vh}.max-h-\[85vh\]{max-height:85vh}.max-h-\[90vh\]{max-height:90vh}.max-h-full{max-height:100%}.min-h-0{min-height:0px}.min-h-\[100px\]{min-height:100px}.min-h-\[14rem\]{min-height:14rem}.min-h-\[70px\]{min-height:70px}.min-h-\[80px\]{min-height:80px}.w-0{width:0px}.w-0\.5{width:.125rem}.w-1{width:.25rem}.w-1\.5{width:.375rem}.w-10{width:2.5rem}.w-11{width:2.75rem}.w-12{width:3rem}.w-14{width:3.5rem}.w-16{width:4rem}.w-2{width:.5rem}.w-20{width:5rem}.w-24{width:6rem}.w-3{width:.75rem}.w-3\.5{width:.875rem}.w-32{width:8rem}.w-36{width:9rem}.w-4{width:1rem}.w-40{width:10rem}.w-48{width:12rem}.w-5{width:1.25rem}.w-52{width:13rem}.w-6{width:1.5rem}.w-64{width:16rem}.w-7{width:1.75rem}.w-72{width:18rem}.w-8{width:2rem}.w-96{width:24rem}.w-\[160px\]{width:160px}.w-\[500px\]{width:500px}.w-\[680px\]{width:680px}.w-\[90vw\]{width:90vw}.w-auto{width:auto}.w-full{width:100%}.min-w-0{min-width:0px}.min-w-\[100px\]{min-width:100px}.min-w-\[300px\]{min-width:300px}.max-w-7xl{max-width:80rem}.max-w-\[180px\]{max-width:180px}.max-w-\[360px\]{max-width:360px}.max-w-\[85\%\]{max-width:85%}.max-w-\[90vw\]{max-width:90vw}.max-w-full{max-width:100%}.max-w-xl{max-width:36rem}.flex-1{flex:1 1 0%}.shrink-0{flex-shrink:0}.border-collapse{border-collapse:collapse}.origin-top-left{transform-origin:top left}.-translate-x-1\/2{--tw-translate-x: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-y-1\/2{--tw-translate-y: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-x-0{--tw-translate-x: 0px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-x-full{--tw-translate-x: 100%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.rotate-180{--tw-rotate: 180deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.rotate-90{--tw-rotate: 90deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-110{--tw-scale-x: 1.1;--tw-scale-y: 1.1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-75{--tw-scale-x: .75;--tw-scale-y: .75;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-90{--tw-scale-x: .9;--tw-scale-y: .9;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-95{--tw-scale-x: .95;--tw-scale-y: .95;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}@keyframes bounce{0%,to{transform:translateY(-25%);animation-timing-function:cubic-bezier(.8,0,1,1)}50%{transform:none;animation-timing-function:cubic-bezier(0,0,.2,1)}}.animate-bounce{animation:bounce 1s infinite}@keyframes pulse{50%{opacity:.5}}.animate-pulse{animation:pulse 2s cubic-bezier(.4,0,.6,1) infinite}@keyframes spin{to{transform:rotate(360deg)}}.cursor-col-resize{cursor:col-resize}.cursor-default{cursor:default}.cursor-ew-resize{cursor:ew-resize}.cursor-not-allowed{cursor:not-allowed}.cursor-pointer{cursor:pointer}.cursor-text{cursor:text}.resize-none{resize:none}.resize{resize:both}.appearance-none{-webkit-appearance:none;-moz-appearance:none;appearance:none}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.grid-rows-2{grid-template-rows:repeat(2,minmax(0,1fr))}.flex-row{flex-direction:row}.flex-row-reverse{flex-direction:row-reverse}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.flex-nowrap{flex-wrap:nowrap}.content-start{align-content:flex-start}.items-start{align-items:flex-start}.items-end{align-items:flex-end}.items-center{align-items:center}.items-stretch{align-items:stretch}.justify-start{justify-content:flex-start}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-0{gap:0px}.gap-0\.5{gap:.125rem}.gap-1{gap:.25rem}.gap-1\.5{gap:.375rem}.gap-2{gap:.5rem}.gap-3{gap:.75rem}.gap-4{gap:1rem}.-space-x-2>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(-.5rem * var(--tw-space-x-reverse));margin-left:calc(-.5rem * calc(1 - var(--tw-space-x-reverse)))}.space-y-1>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.25rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.25rem * var(--tw-space-y-reverse))}.space-y-1\.5>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.375rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.375rem * var(--tw-space-y-reverse))}.space-y-2>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.5rem * var(--tw-space-y-reverse))}.space-y-3>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.75rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.75rem * var(--tw-space-y-reverse))}.space-y-4>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(1rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}.self-center{align-self:center}.overflow-hidden{overflow:hidden}.overflow-visible{overflow:visible}.overflow-x-auto{overflow-x:auto}.overflow-y-auto{overflow-y:auto}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.whitespace-nowrap{white-space:nowrap}.whitespace-pre-wrap{white-space:pre-wrap}.break-words{overflow-wrap:break-word}.rounded{border-radius:.25rem}.rounded-2xl{border-radius:1rem}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:.5rem}.rounded-md{border-radius:.375rem}.rounded-xl{border-radius:.75rem}.rounded-bl{border-bottom-left-radius:.25rem}.rounded-br{border-bottom-right-radius:.25rem}.rounded-tl-none{border-top-left-radius:0}.rounded-tr{border-top-right-radius:.25rem}.rounded-tr-none{border-top-right-radius:0}.border{border-width:1px}.border-2{border-width:2px}.border-b{border-bottom-width:1px}.border-l{border-left-width:1px}.border-r{border-right-width:1px}.border-t{border-top-width:1px}.border-dashed{border-style:dashed}.border-\[\#18181b\]{--tw-border-opacity: 1;border-color:rgb(24 24 27 / var(--tw-border-opacity, 1))}.border-blue-200{--tw-border-opacity: 1;border-color:rgb(191 219 254 / var(--tw-border-opacity, 1))}.border-blue-300{--tw-border-opacity: 1;border-color:rgb(147 197 253 / var(--tw-border-opacity, 1))}.border-blue-400{--tw-border-opacity: 1;border-color:rgb(96 165 250 / var(--tw-border-opacity, 1))}.border-blue-500{--tw-border-opacity: 1;border-color:rgb(59 130 246 / var(--tw-border-opacity, 1))}.border-blue-500\/30{border-color:#3b82f64d}.border-blue-800{--tw-border-opacity: 1;border-color:rgb(30 64 175 / var(--tw-border-opacity, 1))}.border-gray-300{--tw-border-opacity: 1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1))}.border-green-300{--tw-border-opacity: 1;border-color:rgb(134 239 172 / var(--tw-border-opacity, 1))}.border-green-400{--tw-border-opacity: 1;border-color:rgb(74 222 128 / var(--tw-border-opacity, 1))}.border-green-500{--tw-border-opacity: 1;border-color:rgb(34 197 94 / var(--tw-border-opacity, 1))}.border-purple-200{--tw-border-opacity: 1;border-color:rgb(233 213 255 / var(--tw-border-opacity, 1))}.border-purple-500\/20{border-color:#a855f733}.border-purple-800{--tw-border-opacity: 1;border-color:rgb(107 33 168 / var(--tw-border-opacity, 1))}.border-red-200{--tw-border-opacity: 1;border-color:rgb(254 202 202 / var(--tw-border-opacity, 1))}.border-red-400{--tw-border-opacity: 1;border-color:rgb(248 113 113 / var(--tw-border-opacity, 1))}.border-red-500\/50{border-color:#ef444480}.border-red-800{--tw-border-opacity: 1;border-color:rgb(153 27 27 / var(--tw-border-opacity, 1))}.border-transparent{border-color:transparent}.border-violet-200{--tw-border-opacity: 1;border-color:rgb(221 214 254 / var(--tw-border-opacity, 1))}.border-white{--tw-border-opacity: 1;border-color:rgb(255 255 255 / var(--tw-border-opacity, 1))}.border-white\/10{border-color:#ffffff1a}.border-white\/60{border-color:#fff9}.border-white\/70{border-color:#ffffffb3}.border-white\/80{border-color:#fffc}.border-zinc-200{--tw-border-opacity: 1;border-color:rgb(228 228 231 / var(--tw-border-opacity, 1))}.border-zinc-300{--tw-border-opacity: 1;border-color:rgb(212 212 216 / var(--tw-border-opacity, 1))}.border-zinc-400{--tw-border-opacity: 1;border-color:rgb(161 161 170 / var(--tw-border-opacity, 1))}.border-zinc-600{--tw-border-opacity: 1;border-color:rgb(82 82 91 / var(--tw-border-opacity, 1))}.border-zinc-700{--tw-border-opacity: 1;border-color:rgb(63 63 70 / var(--tw-border-opacity, 1))}.border-zinc-700\/50{border-color:#3f3f4680}.border-zinc-800{--tw-border-opacity: 1;border-color:rgb(39 39 42 / var(--tw-border-opacity, 1))}.border-zinc-800\/50{border-color:#27272a80}.bg-\[\#09090b\]{--tw-bg-opacity: 1;background-color:rgb(9 9 11 / var(--tw-bg-opacity, 1))}.bg-\[\#09090b\]\/90{background-color:#09090be6}.bg-\[\#121214\]{--tw-bg-opacity: 1;background-color:rgb(18 18 20 / var(--tw-bg-opacity, 1))}.bg-\[\#18181b\]{--tw-bg-opacity: 1;background-color:rgb(24 24 27 / var(--tw-bg-opacity, 1))}.bg-black{--tw-bg-opacity: 1;background-color:rgb(0 0 0 / var(--tw-bg-opacity, 1))}.bg-black\/40{background-color:#0006}.bg-black\/50{background-color:#00000080}.bg-black\/60{background-color:#0009}.bg-black\/70{background-color:#000000b3}.bg-black\/80{background-color:#000c}.bg-blue-100{--tw-bg-opacity: 1;background-color:rgb(219 234 254 / var(--tw-bg-opacity, 1))}.bg-blue-50{--tw-bg-opacity: 1;background-color:rgb(239 246 255 / var(--tw-bg-opacity, 1))}.bg-blue-500{--tw-bg-opacity: 1;background-color:rgb(59 130 246 / var(--tw-bg-opacity, 1))}.bg-blue-500\/10{background-color:#3b82f61a}.bg-blue-500\/20{background-color:#3b82f633}.bg-blue-500\/30{background-color:#3b82f64d}.bg-blue-500\/5{background-color:#3b82f60d}.bg-blue-600{--tw-bg-opacity: 1;background-color:rgb(37 99 235 / var(--tw-bg-opacity, 1))}.bg-blue-600\/20{background-color:#2563eb33}.bg-blue-600\/30{background-color:#2563eb4d}.bg-blue-600\/80{background-color:#2563ebcc}.bg-blue-900\/20{background-color:#1e3a8a33}.bg-blue-900\/30{background-color:#1e3a8a4d}.bg-green-50{--tw-bg-opacity: 1;background-color:rgb(240 253 244 / var(--tw-bg-opacity, 1))}.bg-green-500{--tw-bg-opacity: 1;background-color:rgb(34 197 94 / var(--tw-bg-opacity, 1))}.bg-green-600{--tw-bg-opacity: 1;background-color:rgb(22 163 74 / var(--tw-bg-opacity, 1))}.bg-green-600\/40{background-color:#16a34a66}.bg-purple-50{--tw-bg-opacity: 1;background-color:rgb(250 245 255 / var(--tw-bg-opacity, 1))}.bg-purple-500{--tw-bg-opacity: 1;background-color:rgb(168 85 247 / var(--tw-bg-opacity, 1))}.bg-purple-600{--tw-bg-opacity: 1;background-color:rgb(147 51 234 / var(--tw-bg-opacity, 1))}.bg-purple-900\/30{background-color:#581c874d}.bg-red-100{--tw-bg-opacity: 1;background-color:rgb(254 226 226 / var(--tw-bg-opacity, 1))}.bg-red-500{--tw-bg-opacity: 1;background-color:rgb(239 68 68 / var(--tw-bg-opacity, 1))}.bg-red-500\/10{background-color:#ef44441a}.bg-red-500\/80{background-color:#ef4444cc}.bg-red-600{--tw-bg-opacity: 1;background-color:rgb(220 38 38 / var(--tw-bg-opacity, 1))}.bg-red-600\/30{background-color:#dc26264d}.bg-red-600\/80{background-color:#dc2626cc}.bg-red-900\/30{background-color:#7f1d1d4d}.bg-transparent{background-color:transparent}.bg-violet-50{--tw-bg-opacity: 1;background-color:rgb(245 243 255 / var(--tw-bg-opacity, 1))}.bg-white{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-white\/10{background-color:#ffffff1a}.bg-white\/40{background-color:#fff6}.bg-white\/80{background-color:#fffc}.bg-white\/90{background-color:#ffffffe6}.bg-yellow-500{--tw-bg-opacity: 1;background-color:rgb(234 179 8 / var(--tw-bg-opacity, 1))}.bg-yellow-600{--tw-bg-opacity: 1;background-color:rgb(202 138 4 / var(--tw-bg-opacity, 1))}.bg-zinc-100{--tw-bg-opacity: 1;background-color:rgb(244 244 245 / var(--tw-bg-opacity, 1))}.bg-zinc-200{--tw-bg-opacity: 1;background-color:rgb(228 228 231 / var(--tw-bg-opacity, 1))}.bg-zinc-300{--tw-bg-opacity: 1;background-color:rgb(212 212 216 / var(--tw-bg-opacity, 1))}.bg-zinc-400{--tw-bg-opacity: 1;background-color:rgb(161 161 170 / var(--tw-bg-opacity, 1))}.bg-zinc-50{--tw-bg-opacity: 1;background-color:rgb(250 250 250 / var(--tw-bg-opacity, 1))}.bg-zinc-50\/50{background-color:#fafafa80}.bg-zinc-500{--tw-bg-opacity: 1;background-color:rgb(113 113 122 / var(--tw-bg-opacity, 1))}.bg-zinc-600{--tw-bg-opacity: 1;background-color:rgb(82 82 91 / var(--tw-bg-opacity, 1))}.bg-zinc-700{--tw-bg-opacity: 1;background-color:rgb(63 63 70 / var(--tw-bg-opacity, 1))}.bg-zinc-700\/50{background-color:#3f3f4680}.bg-zinc-800{--tw-bg-opacity: 1;background-color:rgb(39 39 42 / var(--tw-bg-opacity, 1))}.bg-zinc-800\/40{background-color:#27272a66}.bg-zinc-800\/50{background-color:#27272a80}.bg-zinc-900{--tw-bg-opacity: 1;background-color:rgb(24 24 27 / var(--tw-bg-opacity, 1))}.bg-zinc-900\/30{background-color:#18181b4d}.bg-zinc-900\/50{background-color:#18181b80}.bg-zinc-900\/80{background-color:#18181bcc}.bg-zinc-900\/90{background-color:#18181be6}.bg-zinc-950{--tw-bg-opacity: 1;background-color:rgb(9 9 11 / var(--tw-bg-opacity, 1))}.bg-zinc-950\/50{background-color:#09090b80}.bg-opacity-50{--tw-bg-opacity: .5}.bg-gradient-to-br{background-image:linear-gradient(to bottom right,var(--tw-gradient-stops))}.bg-gradient-to-r{background-image:linear-gradient(to right,var(--tw-gradient-stops))}.from-blue-600{--tw-gradient-from: #2563eb var(--tw-gradient-from-position);--tw-gradient-to: rgb(37 99 235 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-purple-600{--tw-gradient-from: #9333ea var(--tw-gradient-from-position);--tw-gradient-to: rgb(147 51 234 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.to-indigo-600{--tw-gradient-to: #4f46e5 var(--tw-gradient-to-position)}.fill-current{fill:currentColor}.object-contain{-o-object-fit:contain;object-fit:contain}.object-cover{-o-object-fit:cover;object-fit:cover}.p-0{padding:0}.p-0\.5{padding:.125rem}.p-1{padding:.25rem}.p-1\.5{padding:.375rem}.p-2{padding:.5rem}.p-2\.5{padding:.625rem}.p-3{padding:.75rem}.p-4{padding:1rem}.p-5{padding:1.25rem}.p-8{padding:2rem}.px-0\.5{padding-left:.125rem;padding-right:.125rem}.px-1{padding-left:.25rem;padding-right:.25rem}.px-1\.5{padding-left:.375rem;padding-right:.375rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-3{padding-left:.75rem;padding-right:.75rem}.px-4{padding-left:1rem;padding-right:1rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.px-8{padding-left:2rem;padding-right:2rem}.py-0\.5{padding-top:.125rem;padding-bottom:.125rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.py-1\.5{padding-top:.375rem;padding-bottom:.375rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.py-2\.5{padding-top:.625rem;padding-bottom:.625rem}.py-3{padding-top:.75rem;padding-bottom:.75rem}.py-4{padding-top:1rem;padding-bottom:1rem}.py-8{padding-top:2rem;padding-bottom:2rem}.pb-1{padding-bottom:.25rem}.pb-2{padding-bottom:.5rem}.pb-3{padding-bottom:.75rem}.pl-1{padding-left:.25rem}.pl-2{padding-left:.5rem}.pl-8{padding-left:2rem}.pr-1{padding-right:.25rem}.pr-2{padding-right:.5rem}.pr-6{padding-right:1.5rem}.pr-8{padding-right:2rem}.pt-1{padding-top:.25rem}.pt-2{padding-top:.5rem}.pt-3{padding-top:.75rem}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.font-mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}.font-sans{font-family:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji"}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-\[10px\]{font-size:10px}.text-\[11px\]{font-size:11px}.text-\[7px\]{font-size:7px}.text-\[8px\]{font-size:8px}.text-\[9px\]{font-size:9px}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xs{font-size:.75rem;line-height:1rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-normal{font-weight:400}.font-semibold{font-weight:600}.uppercase{text-transform:uppercase}.italic{font-style:italic}.leading-none{line-height:1}.tracking-\[0\.3em\]{letter-spacing:.3em}.tracking-tighter{letter-spacing:-.05em}.tracking-wide{letter-spacing:.025em}.tracking-wider{letter-spacing:.05em}.tracking-widest{letter-spacing:.1em}.text-amber-400{--tw-text-opacity: 1;color:rgb(251 191 36 / var(--tw-text-opacity, 1))}.text-black{--tw-text-opacity: 1;color:rgb(0 0 0 / var(--tw-text-opacity, 1))}.text-blue-300{--tw-text-opacity: 1;color:rgb(147 197 253 / var(--tw-text-opacity, 1))}.text-blue-400{--tw-text-opacity: 1;color:rgb(96 165 250 / var(--tw-text-opacity, 1))}.text-blue-500{--tw-text-opacity: 1;color:rgb(59 130 246 / var(--tw-text-opacity, 1))}.text-blue-600{--tw-text-opacity: 1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.text-blue-700{--tw-text-opacity: 1;color:rgb(29 78 216 / var(--tw-text-opacity, 1))}.text-emerald-500{--tw-text-opacity: 1;color:rgb(16 185 129 / var(--tw-text-opacity, 1))}.text-green-200{--tw-text-opacity: 1;color:rgb(187 247 208 / var(--tw-text-opacity, 1))}.text-green-300{--tw-text-opacity: 1;color:rgb(134 239 172 / var(--tw-text-opacity, 1))}.text-green-400{--tw-text-opacity: 1;color:rgb(74 222 128 / var(--tw-text-opacity, 1))}.text-green-500{--tw-text-opacity: 1;color:rgb(34 197 94 / var(--tw-text-opacity, 1))}.text-green-700{--tw-text-opacity: 1;color:rgb(21 128 61 / var(--tw-text-opacity, 1))}.text-orange-500{--tw-text-opacity: 1;color:rgb(249 115 22 / var(--tw-text-opacity, 1))}.text-purple-300{--tw-text-opacity: 1;color:rgb(216 180 254 / var(--tw-text-opacity, 1))}.text-purple-400{--tw-text-opacity: 1;color:rgb(192 132 252 / var(--tw-text-opacity, 1))}.text-purple-500{--tw-text-opacity: 1;color:rgb(168 85 247 / var(--tw-text-opacity, 1))}.text-purple-600{--tw-text-opacity: 1;color:rgb(147 51 234 / var(--tw-text-opacity, 1))}.text-purple-700{--tw-text-opacity: 1;color:rgb(126 34 206 / var(--tw-text-opacity, 1))}.text-red-200{--tw-text-opacity: 1;color:rgb(254 202 202 / var(--tw-text-opacity, 1))}.text-red-300{--tw-text-opacity: 1;color:rgb(252 165 165 / var(--tw-text-opacity, 1))}.text-red-400{--tw-text-opacity: 1;color:rgb(248 113 113 / var(--tw-text-opacity, 1))}.text-red-500{--tw-text-opacity: 1;color:rgb(239 68 68 / var(--tw-text-opacity, 1))}.text-red-600{--tw-text-opacity: 1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.text-white\/70{color:#ffffffb3}.text-yellow-300{--tw-text-opacity: 1;color:rgb(253 224 71 / var(--tw-text-opacity, 1))}.text-yellow-700{--tw-text-opacity: 1;color:rgb(161 98 7 / var(--tw-text-opacity, 1))}.text-zinc-100{--tw-text-opacity: 1;color:rgb(244 244 245 / var(--tw-text-opacity, 1))}.text-zinc-200{--tw-text-opacity: 1;color:rgb(228 228 231 / var(--tw-text-opacity, 1))}.text-zinc-300{--tw-text-opacity: 1;color:rgb(212 212 216 / var(--tw-text-opacity, 1))}.text-zinc-400{--tw-text-opacity: 1;color:rgb(161 161 170 / var(--tw-text-opacity, 1))}.text-zinc-500{--tw-text-opacity: 1;color:rgb(113 113 122 / var(--tw-text-opacity, 1))}.text-zinc-600{--tw-text-opacity: 1;color:rgb(82 82 91 / var(--tw-text-opacity, 1))}.text-zinc-700{--tw-text-opacity: 1;color:rgb(63 63 70 / var(--tw-text-opacity, 1))}.text-zinc-800{--tw-text-opacity: 1;color:rgb(39 39 42 / var(--tw-text-opacity, 1))}.text-zinc-900{--tw-text-opacity: 1;color:rgb(24 24 27 / var(--tw-text-opacity, 1))}.antialiased{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.placeholder-zinc-400::-moz-placeholder{--tw-placeholder-opacity: 1;color:rgb(161 161 170 / var(--tw-placeholder-opacity, 1))}.placeholder-zinc-400::placeholder{--tw-placeholder-opacity: 1;color:rgb(161 161 170 / var(--tw-placeholder-opacity, 1))}.placeholder-zinc-500::-moz-placeholder{--tw-placeholder-opacity: 1;color:rgb(113 113 122 / var(--tw-placeholder-opacity, 1))}.placeholder-zinc-500::placeholder{--tw-placeholder-opacity: 1;color:rgb(113 113 122 / var(--tw-placeholder-opacity, 1))}.placeholder-zinc-600::-moz-placeholder{--tw-placeholder-opacity: 1;color:rgb(82 82 91 / var(--tw-placeholder-opacity, 1))}.placeholder-zinc-600::placeholder{--tw-placeholder-opacity: 1;color:rgb(82 82 91 / var(--tw-placeholder-opacity, 1))}.opacity-0{opacity:0}.opacity-100{opacity:1}.opacity-20{opacity:.2}.opacity-30{opacity:.3}.opacity-50{opacity:.5}.opacity-60{opacity:.6}.opacity-70{opacity:.7}.opacity-80{opacity:.8}.shadow{--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-2xl{--tw-shadow: 0 25px 50px -12px rgb(0 0 0 / .25);--tw-shadow-colored: 0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_10px_rgba\(0\,0\,0\,0\.5\)\]{--tw-shadow: 0 0 10px rgba(0,0,0,.5);--tw-shadow-colored: 0 0 10px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_10px_rgba\(255\,255\,255\,0\.5\)\]{--tw-shadow: 0 0 10px rgba(255,255,255,.5);--tw-shadow-colored: 0 0 10px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_8px_rgba\(239\,68\,68\,0\.8\)\]{--tw-shadow: 0 0 8px rgba(239,68,68,.8);--tw-shadow-colored: 0 0 8px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_8px_rgba\(34\,197\,94\,0\.6\)\]{--tw-shadow: 0 0 8px rgba(34,197,94,.6);--tw-shadow-colored: 0 0 8px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_8px_rgba\(34\,197\,94\,0\.8\)\]{--tw-shadow: 0 0 8px rgba(34,197,94,.8);--tw-shadow-colored: 0 0 8px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-inner{--tw-shadow: inset 0 2px 4px 0 rgb(0 0 0 / .05);--tw-shadow-colored: inset 0 2px 4px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-lg{--tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-md{--tw-shadow: 0 4px 6px -1px rgb(0 0 0 / .1), 0 2px 4px -2px rgb(0 0 0 / .1);--tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-sm{--tw-shadow: 0 1px 2px 0 rgb(0 0 0 / .05);--tw-shadow-colored: 0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-xl{--tw-shadow: 0 20px 25px -5px rgb(0 0 0 / .1), 0 8px 10px -6px rgb(0 0 0 / .1);--tw-shadow-colored: 0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-black\/10{--tw-shadow-color: rgb(0 0 0 / .1);--tw-shadow: var(--tw-shadow-colored)}.shadow-black\/40{--tw-shadow-color: rgb(0 0 0 / .4);--tw-shadow: var(--tw-shadow-colored)}.shadow-blue-300\/30{--tw-shadow-color: rgb(147 197 253 / .3);--tw-shadow: var(--tw-shadow-colored)}.shadow-blue-500\/20{--tw-shadow-color: rgb(59 130 246 / .2);--tw-shadow: var(--tw-shadow-colored)}.shadow-blue-900\/20{--tw-shadow-color: rgb(30 58 138 / .2);--tw-shadow: var(--tw-shadow-colored)}.outline-none{outline:2px solid transparent;outline-offset:2px}.ring-1{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.ring-2{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.ring-blue-300\/60{--tw-ring-color: rgb(147 197 253 / .6)}.ring-blue-500{--tw-ring-opacity: 1;--tw-ring-color: rgb(59 130 246 / var(--tw-ring-opacity, 1))}.ring-blue-500\/30{--tw-ring-color: rgb(59 130 246 / .3)}.ring-blue-500\/50{--tw-ring-color: rgb(59 130 246 / .5)}.ring-green-500\/50{--tw-ring-color: rgb(34 197 94 / .5)}.blur{--tw-blur: blur(8px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.blur-\[50px\]{--tw-blur: blur(50px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow-md{--tw-drop-shadow: drop-shadow(0 4px 3px rgb(0 0 0 / .07)) drop-shadow(0 2px 2px rgb(0 0 0 / .06));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.grayscale{--tw-grayscale: grayscale(100%);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.backdrop-blur-\[2px\]{--tw-backdrop-blur: blur(2px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-blur-md{--tw-backdrop-blur: blur(12px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-blur-sm{--tw-backdrop-blur: blur(4px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-blur-xl{--tw-backdrop-blur: blur(24px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-filter{-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-all{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-colors{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-opacity{transition-property:opacity;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-shadow{transition-property:box-shadow;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-transform{transition-property:transform;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.duration-100{transition-duration:.1s}.duration-150{transition-duration:.15s}.duration-200{transition-duration:.2s}.duration-300{transition-duration:.3s}.ease-in-out{transition-timing-function:cubic-bezier(.4,0,.2,1)}.ease-linear{transition-timing-function:linear}.will-change-transform{will-change:transform}body{margin:0;padding:0;background-color:#09090b}.select-none{-webkit-user-select:none;-moz-user-select:none;user-select:none}.select-text{-webkit-user-select:text;-moz-user-select:text;user-select:text}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.animate-spin{animation:spin 1s linear infinite}.art-loader-container{position:fixed;top:0;left:0;right:0;bottom:0;background-color:#09090b;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:9999;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;color:#e4e4e7}.art-center-group{display:flex;flex-direction:column;align-items:center;transform:translateY(-20px)}.art-visual{position:relative;width:60px;height:60px;margin-bottom:30px}.art-ring-outer{position:absolute;top:0;right:0;bottom:0;left:0;border:1px solid rgba(255,255,255,.1);border-radius:50%;animation:art-breathe 4s ease-in-out infinite}.art-ring-inner{position:absolute;top:0;right:0;bottom:0;left:0;border-radius:50%;border:1px solid transparent;border-top-color:#fff;border-left-color:#ffffff4d;opacity:.8;animation:art-spin 2s cubic-bezier(.4,0,.2,1) infinite}.art-dot{position:absolute;top:50%;left:50%;width:4px;height:4px;background-color:#fff;border-radius:50%;transform:translate(-50%,-50%);box-shadow:0 0 10px #ffffff80}.art-title{font-size:12px;font-weight:300;text-transform:uppercase;letter-spacing:.3em;opacity:.9;margin-bottom:8px}.art-status{font-family:Courier New,monospace;font-size:10px;color:#71717a;letter-spacing:.1em;animation:art-pulse 2s ease-in-out infinite}.art-footer{position:absolute;bottom:40px;display:flex;flex-direction:column;align-items:center;text-align:center;gap:12px;opacity:0;animation:art-fade-up 1s ease-out .5s forwards}.footer-author{display:flex;flex-direction:column;gap:4px}.footer-author .label{font-size:9px;color:#52525b;text-transform:uppercase;letter-spacing:.2em}.footer-author .name{font-size:14px;font-weight:500;letter-spacing:.5em;color:#fff;text-indent:.5em}.footer-divider{width:20px;height:1px;background-color:#27272a}.footer-thanks{display:flex;flex-direction:column;gap:2px}.footer-thanks .label{font-size:8px;color:#3f3f46;text-transform:uppercase;letter-spacing:.1em}.footer-thanks .content{font-size:10px;color:#71717a;font-family:Courier New,monospace}.footer-thanks .highlight{color:#a1a1aa;font-weight:600}@keyframes art-spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes art-breathe{0%,to{transform:scale(1);opacity:.5}50%{transform:scale(1.1);opacity:.2}}@keyframes art-pulse{0%,to{opacity:.4}50%{opacity:.8}}@keyframes art-fade-up{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.no-scrollbar::-webkit-scrollbar{display:none}.no-scrollbar{-ms-overflow-style:none;scrollbar-width:none}.placeholder\:text-zinc-400::-moz-placeholder{--tw-text-opacity: 1;color:rgb(161 161 170 / var(--tw-text-opacity, 1))}.placeholder\:text-zinc-400::placeholder{--tw-text-opacity: 1;color:rgb(161 161 170 / var(--tw-text-opacity, 1))}.placeholder\:text-zinc-600::-moz-placeholder{--tw-text-opacity: 1;color:rgb(82 82 91 / var(--tw-text-opacity, 1))}.placeholder\:text-zinc-600::placeholder{--tw-text-opacity: 1;color:rgb(82 82 91 / var(--tw-text-opacity, 1))}.placeholder\:text-zinc-700::-moz-placeholder{--tw-text-opacity: 1;color:rgb(63 63 70 / var(--tw-text-opacity, 1))}.placeholder\:text-zinc-700::placeholder{--tw-text-opacity: 1;color:rgb(63 63 70 / var(--tw-text-opacity, 1))}.placeholder\:text-opacity-50::-moz-placeholder{--tw-text-opacity: .5}.placeholder\:text-opacity-50::placeholder{--tw-text-opacity: .5}.after\:absolute:after{content:var(--tw-content);position:absolute}.after\:left-\[2px\]:after{content:var(--tw-content);left:2px}.after\:top-\[2px\]:after{content:var(--tw-content);top:2px}.after\:h-5:after{content:var(--tw-content);height:1.25rem}.after\:w-5:after{content:var(--tw-content);width:1.25rem}.after\:rounded-full:after{content:var(--tw-content);border-radius:9999px}.after\:bg-white:after{content:var(--tw-content);--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.after\:transition-all:after{content:var(--tw-content);transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.after\:content-\[\'\'\]:after{--tw-content: "";content:var(--tw-content)}.focus-within\:border-blue-500\/30:focus-within{border-color:#3b82f64d}.focus-within\:border-blue-500\/50:focus-within{border-color:#3b82f680}.hover\:h-6:hover{height:1.5rem}.hover\:scale-100:hover{--tw-scale-x: 1;--tw-scale-y: 1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\:border-blue-300:hover{--tw-border-opacity: 1;border-color:rgb(147 197 253 / var(--tw-border-opacity, 1))}.hover\:border-blue-400:hover{--tw-border-opacity: 1;border-color:rgb(96 165 250 / var(--tw-border-opacity, 1))}.hover\:border-blue-500:hover{--tw-border-opacity: 1;border-color:rgb(59 130 246 / var(--tw-border-opacity, 1))}.hover\:border-blue-500\/30:hover{border-color:#3b82f64d}.hover\:border-blue-500\/50:hover{border-color:#3b82f680}.hover\:border-green-400:hover{--tw-border-opacity: 1;border-color:rgb(74 222 128 / var(--tw-border-opacity, 1))}.hover\:border-green-500:hover{--tw-border-opacity: 1;border-color:rgb(34 197 94 / var(--tw-border-opacity, 1))}.hover\:border-zinc-300:hover{--tw-border-opacity: 1;border-color:rgb(212 212 216 / var(--tw-border-opacity, 1))}.hover\:border-zinc-400:hover{--tw-border-opacity: 1;border-color:rgb(161 161 170 / var(--tw-border-opacity, 1))}.hover\:border-zinc-500:hover{--tw-border-opacity: 1;border-color:rgb(113 113 122 / var(--tw-border-opacity, 1))}.hover\:border-zinc-600:hover{--tw-border-opacity: 1;border-color:rgb(82 82 91 / var(--tw-border-opacity, 1))}.hover\:border-zinc-700:hover{--tw-border-opacity: 1;border-color:rgb(63 63 70 / var(--tw-border-opacity, 1))}.hover\:bg-black\/70:hover{background-color:#000000b3}.hover\:bg-black\/80:hover{background-color:#000c}.hover\:bg-blue-100:hover{--tw-bg-opacity: 1;background-color:rgb(219 234 254 / var(--tw-bg-opacity, 1))}.hover\:bg-blue-200:hover{--tw-bg-opacity: 1;background-color:rgb(191 219 254 / var(--tw-bg-opacity, 1))}.hover\:bg-blue-400:hover{--tw-bg-opacity: 1;background-color:rgb(96 165 250 / var(--tw-bg-opacity, 1))}.hover\:bg-blue-400\/30:hover{background-color:#60a5fa4d}.hover\:bg-blue-500:hover{--tw-bg-opacity: 1;background-color:rgb(59 130 246 / var(--tw-bg-opacity, 1))}.hover\:bg-blue-500\/30:hover{background-color:#3b82f64d}.hover\:bg-blue-600:hover{--tw-bg-opacity: 1;background-color:rgb(37 99 235 / var(--tw-bg-opacity, 1))}.hover\:bg-blue-600\/30:hover{background-color:#2563eb4d}.hover\:bg-blue-600\/50:hover{background-color:#2563eb80}.hover\:bg-blue-700:hover{--tw-bg-opacity: 1;background-color:rgb(29 78 216 / var(--tw-bg-opacity, 1))}.hover\:bg-green-500:hover{--tw-bg-opacity: 1;background-color:rgb(34 197 94 / var(--tw-bg-opacity, 1))}.hover\:bg-green-600:hover{--tw-bg-opacity: 1;background-color:rgb(22 163 74 / var(--tw-bg-opacity, 1))}.hover\:bg-green-600\/60:hover{background-color:#16a34a99}.hover\:bg-purple-400:hover{--tw-bg-opacity: 1;background-color:rgb(192 132 252 / var(--tw-bg-opacity, 1))}.hover\:bg-purple-500:hover{--tw-bg-opacity: 1;background-color:rgb(168 85 247 / var(--tw-bg-opacity, 1))}.hover\:bg-red-100:hover{--tw-bg-opacity: 1;background-color:rgb(254 226 226 / var(--tw-bg-opacity, 1))}.hover\:bg-red-200:hover{--tw-bg-opacity: 1;background-color:rgb(254 202 202 / var(--tw-bg-opacity, 1))}.hover\:bg-red-50:hover{--tw-bg-opacity: 1;background-color:rgb(254 242 242 / var(--tw-bg-opacity, 1))}.hover\:bg-red-500:hover{--tw-bg-opacity: 1;background-color:rgb(239 68 68 / var(--tw-bg-opacity, 1))}.hover\:bg-red-500\/10:hover{background-color:#ef44441a}.hover\:bg-red-600:hover{--tw-bg-opacity: 1;background-color:rgb(220 38 38 / var(--tw-bg-opacity, 1))}.hover\:bg-red-600\/50:hover{background-color:#dc262680}.hover\:bg-red-700:hover{--tw-bg-opacity: 1;background-color:rgb(185 28 28 / var(--tw-bg-opacity, 1))}.hover\:bg-red-800:hover{--tw-bg-opacity: 1;background-color:rgb(153 27 27 / var(--tw-bg-opacity, 1))}.hover\:bg-white:hover{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.hover\:bg-white\/20:hover{background-color:#fff3}.hover\:bg-yellow-400:hover{--tw-bg-opacity: 1;background-color:rgb(250 204 21 / var(--tw-bg-opacity, 1))}.hover\:bg-yellow-500:hover{--tw-bg-opacity: 1;background-color:rgb(234 179 8 / var(--tw-bg-opacity, 1))}.hover\:bg-zinc-100:hover{--tw-bg-opacity: 1;background-color:rgb(244 244 245 / var(--tw-bg-opacity, 1))}.hover\:bg-zinc-200:hover{--tw-bg-opacity: 1;background-color:rgb(228 228 231 / var(--tw-bg-opacity, 1))}.hover\:bg-zinc-300:hover{--tw-bg-opacity: 1;background-color:rgb(212 212 216 / var(--tw-bg-opacity, 1))}.hover\:bg-zinc-600:hover{--tw-bg-opacity: 1;background-color:rgb(82 82 91 / var(--tw-bg-opacity, 1))}.hover\:bg-zinc-700:hover{--tw-bg-opacity: 1;background-color:rgb(63 63 70 / var(--tw-bg-opacity, 1))}.hover\:bg-zinc-800:hover{--tw-bg-opacity: 1;background-color:rgb(39 39 42 / var(--tw-bg-opacity, 1))}.hover\:bg-zinc-800\/50:hover{background-color:#27272a80}.hover\:from-purple-500:hover{--tw-gradient-from: #a855f7 var(--tw-gradient-from-position);--tw-gradient-to: rgb(168 85 247 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\:to-indigo-500:hover{--tw-gradient-to: #6366f1 var(--tw-gradient-to-position)}.hover\:text-blue-300:hover{--tw-text-opacity: 1;color:rgb(147 197 253 / var(--tw-text-opacity, 1))}.hover\:text-blue-400:hover{--tw-text-opacity: 1;color:rgb(96 165 250 / var(--tw-text-opacity, 1))}.hover\:text-blue-500:hover{--tw-text-opacity: 1;color:rgb(59 130 246 / var(--tw-text-opacity, 1))}.hover\:text-blue-600:hover{--tw-text-opacity: 1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.hover\:text-green-600:hover{--tw-text-opacity: 1;color:rgb(22 163 74 / var(--tw-text-opacity, 1))}.hover\:text-red-400:hover{--tw-text-opacity: 1;color:rgb(248 113 113 / var(--tw-text-opacity, 1))}.hover\:text-red-500:hover{--tw-text-opacity: 1;color:rgb(239 68 68 / var(--tw-text-opacity, 1))}.hover\:text-red-600:hover{--tw-text-opacity: 1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.hover\:text-white:hover{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.hover\:text-zinc-200:hover{--tw-text-opacity: 1;color:rgb(228 228 231 / var(--tw-text-opacity, 1))}.hover\:text-zinc-300:hover{--tw-text-opacity: 1;color:rgb(212 212 216 / var(--tw-text-opacity, 1))}.hover\:text-zinc-600:hover{--tw-text-opacity: 1;color:rgb(82 82 91 / var(--tw-text-opacity, 1))}.hover\:text-zinc-700:hover{--tw-text-opacity: 1;color:rgb(63 63 70 / var(--tw-text-opacity, 1))}.hover\:text-zinc-800:hover{--tw-text-opacity: 1;color:rgb(39 39 42 / var(--tw-text-opacity, 1))}.hover\:text-zinc-900:hover{--tw-text-opacity: 1;color:rgb(24 24 27 / var(--tw-text-opacity, 1))}.hover\:underline:hover{text-decoration-line:underline}.hover\:opacity-100:hover{opacity:1}.hover\:shadow-md:hover{--tw-shadow: 0 4px 6px -1px rgb(0 0 0 / .1), 0 2px 4px -2px rgb(0 0 0 / .1);--tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.focus\:border-blue-500:focus{--tw-border-opacity: 1;border-color:rgb(59 130 246 / var(--tw-border-opacity, 1))}.focus\:border-blue-500\/50:focus{border-color:#3b82f680}.focus\:border-blue-600\/50:focus{border-color:#2563eb80}.focus\:ring-2:focus{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.focus\:ring-blue-500\/50:focus{--tw-ring-color: rgb(59 130 246 / .5)}.active\:scale-95:active{--tw-scale-x: .95;--tw-scale-y: .95;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.disabled\:cursor-not-allowed:disabled{cursor:not-allowed}.disabled\:opacity-50:disabled{opacity:.5}.group\/insert:hover .group-hover\/insert\:scale-100{--tw-scale-x: 1;--tw-scale-y: 1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.group:hover .group-hover\:bg-blue-500{--tw-bg-opacity: 1;background-color:rgb(59 130 246 / var(--tw-bg-opacity, 1))}.group:hover .group-hover\:bg-zinc-200{--tw-bg-opacity: 1;background-color:rgb(228 228 231 / var(--tw-bg-opacity, 1))}.group:hover .group-hover\:bg-zinc-800{--tw-bg-opacity: 1;background-color:rgb(39 39 42 / var(--tw-bg-opacity, 1))}.group\/cell:hover .group-hover\/cell\:opacity-100,.group\/insert:hover .group-hover\/insert\:opacity-100,.group\/main:hover .group-hover\/main\:opacity-100,.group\/preview:hover .group-hover\/preview\:opacity-100,.group:hover .group-hover\:opacity-100{opacity:1}.peer:checked~.peer-checked\:after\:translate-x-full:after{content:var(--tw-content);--tw-translate-x: 100%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.peer:checked~.peer-checked\:after\:border-white:after{content:var(--tw-content);--tw-border-opacity: 1;border-color:rgb(255 255 255 / var(--tw-border-opacity, 1))}.peer:focus~.peer-focus\:outline-none{outline:2px solid transparent;outline-offset:2px}.peer:focus~.peer-focus\:ring-2{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.peer:focus~.peer-focus\:ring-blue-500\/50{--tw-ring-color: rgb(59 130 246 / .5)}@media (prefers-color-scheme: dark){.dark\:border-zinc-700{--tw-border-opacity: 1;border-color:rgb(63 63 70 / var(--tw-border-opacity, 1))}.dark\:bg-blue-900\/30{background-color:#1e3a8a4d}.dark\:bg-zinc-700{--tw-bg-opacity: 1;background-color:rgb(63 63 70 / var(--tw-bg-opacity, 1))}.dark\:bg-zinc-800{--tw-bg-opacity: 1;background-color:rgb(39 39 42 / var(--tw-bg-opacity, 1))}.dark\:text-blue-300{--tw-text-opacity: 1;color:rgb(147 197 253 / var(--tw-text-opacity, 1))}.dark\:text-blue-400{--tw-text-opacity: 1;color:rgb(96 165 250 / var(--tw-text-opacity, 1))}.dark\:text-zinc-200{--tw-text-opacity: 1;color:rgb(228 228 231 / var(--tw-text-opacity, 1))}.dark\:text-zinc-300{--tw-text-opacity: 1;color:rgb(212 212 216 / var(--tw-text-opacity, 1))}.dark\:text-zinc-400{--tw-text-opacity: 1;color:rgb(161 161 170 / var(--tw-text-opacity, 1))}.dark\:hover\:bg-blue-900\/30:hover{background-color:#1e3a8a4d}.dark\:hover\:bg-zinc-700:hover{--tw-bg-opacity: 1;background-color:rgb(63 63 70 / var(--tw-bg-opacity, 1))}.dark\:hover\:bg-zinc-800:hover{--tw-bg-opacity: 1;background-color:rgb(39 39 42 / var(--tw-bg-opacity, 1))}.dark\:hover\:text-zinc-300:hover{--tw-text-opacity: 1;color:rgb(212 212 216 / var(--tw-text-opacity, 1))}}</style>
</head>

<body style="margin: 0; padding: 0; background-color: #09090b;">
    <div id="root"></div>
</body>

</html>